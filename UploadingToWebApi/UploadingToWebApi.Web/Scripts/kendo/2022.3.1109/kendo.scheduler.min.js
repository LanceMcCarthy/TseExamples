/**
 * Kendo UI v2022.3.1109 (http://www.telerik.com/kendo-ui)
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e){"function"==typeof define&&define.amd?define(["kendo.dropdownlist.min","kendo.editable.min","kendo.multiselect.min","kendo.window.min","kendo.datetimepicker.min","kendo.scheduler.recurrence.min","kendo.scheduler.view.min","kendo.scheduler.dayview.min","kendo.scheduler.agendaview.min","kendo.scheduler.monthview.min","kendo.scheduler.timelineview.min","kendo.scheduler.yearview.min","kendo.dialog.min","kendo.pane.min","kendo.pdf.min","kendo.switch.min"],e):e()}((function(){!function(e,t){var i=window.kendo,n=i.date,a=n.MS_PER_DAY,o=n.getDate,r=i.date.getMilliseconds,s=i.recurrence,l=e.extend({F10:121},i.keys),d=i.ui,c=d.Widget,u=d.DataBoundWidget,p="string",f=d.Popup,h=d.Calendar,v=i.data.DataSource,m=e.isPlainObject,g=e.extend,k=Object.prototype.toString,b=Array.isArray,_=".kendoScheduler",w="click",y="mousedown",z=i.support.pointers?"pointerdown":"touchstart",T=i.support.pointers?"pointermove":"touchmove",D=i.support.pointers?"pointerup":"touchend",S=i.support.mousemove,x="change",E="progress",R="error",C="cancel",V="remove",P="resetSeries",F="save",O="edit",I="disabled",M="k-focus",A=/(?:value:start|value:end)(?:,|$)/,H=o(new Date),B=",",N=/\;/g,W="recurrenceException",L="Do you want to edit only this event occurrence or the whole series?",U=i.template('<select aria-label="#= label #" class="k-picker k-dropdown-list k-dropdown k-views-dropdown" tabindex="-1">#for (var view in views) {#<option value="#= view #">${views[view].title}</option>#}#</select>'),K=i.template('<div class="k-scheduler-toolbar k-toolbar" role="toolbar"># if (pdf) { #<button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-pdf"><span class="k-button-icon k-icon k-i-file-pdf"></span><span class="k-button-text">${messages.pdf}</span></button># } #<span class="k-scheduler-navigation k-button-group"><button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-nav-today" title="${messages.today}"><span class="k-button-text">${messages.today}</span></button><button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-prev" title="${messages.previous}" aria-label="${messages.previous}"><span class="k-button-icon k-icon k-i-arrow-60-left"></span></button><button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-next" title="${messages.next}" aria-label="${messages.next}"><span class="k-button-icon k-icon k-i-arrow-60-right"></span></button></span><a tabindex="-1" role="button" href="\\#" class="k-nav-current" aria-live="polite"><span class="k-icon k-i-calendar"></span><span class="k-sm-date-format" data-#=ns#bind="text: formattedShortDate"></span><span class="k-lg-date-format" data-#=ns#bind="text: formattedDate"></span></a><span class="k-spacer k-toolbar-spacer"></span># if (search) { #<span class="k-scheduler-search k-textbox k-input k-input-md k-rounded-md k-input-solid"><input tabindex="-1" autocomplete="off" placeholder="${messages.search}" title="${messages.search}" class="k-input-inner k-scheduler-search-input k-input-inner" /><span class="k-input-suffix"><span class="k-icon k-i-search"></span></span></span># } ## if (viewsCount === 1) { #<a role="button" tabindex="-1" data-#=ns#name="#=view#" href="\\#" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-scheduler-refresh" aria-label="${messages.refresh}"><span class="k-button-icon k-icon k-i-reload"></span></a># } else { #<span class="k-scheduler-views-wrapper"><span class="k-scheduler-views k-button-group"># for (var view in views) { #<button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-view-#= view.toLowerCase() #" data-#=ns#name="#=view#"><span class="k-button-text">${views[view].title}</span></button># } #</span></span># } #</div>'),q=i.template('<div class="k-scheduler-toolbar k-toolbar" role="toolbar"><span class="k-scheduler-tools k-button-group"># if (pdf) { #<button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-pdf"><span class="k-button-icon k-icon k-i-file-pdf"></span></button># } #<button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-calendar"><span class="k-button-icon k-icon k-i-calendar"></span></button># if (editable) { #<button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-create-event"><span class="k-button-icon k-icon k-i-plus"></span></button># } #</span><span class="k-spacer k-toolbar-spacer"></span># if (search) { #<span class="k-scheduler-search k-textbox k-input k-input-md k-rounded-md k-input-solid"><input tabindex="-1" autocomplete="off" placeholder="${messages.search}" title="${messages.search}" class="k-scheduler-search-input k-input-inner" /><span class="k-input-suffix"><span class="k-icon k-i-search"></span></span></span># } ##if(viewsCount === 1){#<a role="button" tabindex="-1" data-#=ns#name="#=view#" href="\\#" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-scheduler-refresh"><span class="k-button-icon k-icon k-i-reload"></span></a>#} else {#<select tabindex="-1" class="k-picker k-dropdown-list k-dropdown k-scheduler-mobile-views">#for(var view in views){#<option class="k-view-#= view.toLowerCase() #" value="#=view#">${views[view].title}</option>#}#</select>#}#</div><div class="k-scheduler-toolbar k-toolbar" role="toolbar"><span class="k-scheduler-navigation"><button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-prev"><span class="k-button-icon k-icon k-i-arrow-chevron-left"></span></button><span class="k-nav-current"><span class="k-m-date-format" data-#=ns#bind="text: formattedMobileDate"></span><span class="k-y-date-format" data-#=ns#bind="text: formattedYear"></span></span><button tabindex="-1" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-nav-next"><span class="k-button-icon k-icon k-i-arrow-chevron-right"></span></button></span></div>');function Y(e,t){return t=t||"",e.startTimezone&&(t=e.startTimezone,e.endTimezone&&(t+=" | "+e.endTimezone)),t}function $(e,t){var n=t.timezone;n&&(e[i.attr("timezone")]=n)}function Q(e,t){var n=t.model.fields[t.field].validation;if(n){var a=n.validDateValidator;a&&m(a)&&a.message&&(e[i.attr("validDate-msg")]=a.message)}}function j(e,t){var n=t.model.fields[t.field].validation;if(n){var a=n.dateCompare;a&&m(a)&&a.message&&(e[i.attr("dateCompare-msg")]=a.message)}}function J(e,t,n,a){var o,r,s,l,d;for(r=0,s=(e=e||[]).length;r<s;r++)l=(o=e[r]).start?o.start.getTimezoneOffset():null,d=o.start?o.end.getTimezoneOffset():null,a?o.startTimezone||o.endTimezone?n?(o.start=i.timezone.convert(o.start,o.startTimezone||o.endTimezone,n),o.end=i.timezone.convert(o.end,o.endTimezone||o.startTimezone,n),o.start=i.timezone[t](o.start,n),o.end=i.timezone[t](o.end,n)):(o.start=i.timezone[t](o.start,o.startTimezone||o.endTimezone),o.end=i.timezone[t](o.end,o.endTimezone||o.startTimezone)):n&&(o.start=i.timezone[t](o.start,n),o.end=i.timezone[t](o.end,n)):o.startTimezone||o.endTimezone?(o.start=i.timezone[t](o.start,o.startTimezone||o.endTimezone),o.end=i.timezone[t](o.end,o.endTimezone||o.startTimezone),n&&(o.start=i.timezone.convert(o.start,o.startTimezone||o.endTimezone,n),o.end=i.timezone.convert(o.end,o.endTimezone||o.startTimezone,n))):n&&(o.start=i.timezone[t](o.start,n),o.end=i.timezone[t](o.end,n)),a&&delete o.uid,"remove"===t&&o.start&&l&&l!==o.start.getTimezoneOffset()&&(o.start=new Date(o.start.getTime()+6e4*(l-o.start.getTimezoneOffset()))),"remove"===t&&o.end&&d&&d!==o.end.getTimezoneOffset()&&(o.end=new Date(o.end.getTime()+6e4*(d-o.end.getTimezoneOffset())));return e}function G(e,t){for(var i,n=e.length,a=0;a<n;a++)if((i=e[a]).uid===t)return i}var X=i.Class.extend({init:function(e,t){var n=e.timezone;this.reader=t,t.model&&(this.model=t.model),this.timezone=n,this.data=function(e,t){return function(i){return J(i=e(i),"apply",t),i||[]}}(this.data.bind(this),n),this.serialize=function(e,t){return function(n){return n&&("[object Array]"===k.call(n)||n instanceof i.data.ObservableArray||(n=[n])),J(n,"remove",t,!0),(n=e(n))||[]}}(this.serialize.bind(this),n)},errors:function(e){return this.reader.errors(e)},parse:function(e){return this.reader.parse(e)},data:function(e){return this.reader.data(e)},total:function(e){return this.reader.total(e)},groups:function(e){return this.reader.groups(e)},aggregates:function(e){return this.reader.aggregates(e)},serialize:function(e){return this.reader.serialize(e)}});function Z(e,t,n){return e=n?i.timezone.convert(e,t,n):i.timezone.remove(e,t)}function ee(e){if(e.filter("[name=start]").length&&e.filter("[title=Start]").length||e.filter("[name=end]").length&&e.filter("[title=End]").length||e.filter(".k-recur-until").length){var t=i.widgetInstance(e,i.ui);return t?!!i.parseDate(e.val(),t.options.format)&&t.value():!!i.parseDate(e.val())}return!0}var te=i.data.Model.define({init:function(e){var t=this;i.data.Model.fn.init.call(t,e),t._defaultId=t.defaults[t.idField]},_time:function(e){var t=this[e],n="_"+e+"Time";return this[n]?this[n]-i.date.toUtcTime(i.date.getDate(t)):r(t)},_date:function(e){var t="_"+e+"Time";return this[t]?this[t]-this._time(e):i.date.getDate(this[e])},clone:function(t,i){var n=this.uid,a=new this.constructor(e.extend({},this.toJSON(),t));return i||(a.uid=n),a},duration:function(){var e=this.end,t=this.start,n=(e.getTimezoneOffset()-t.getTimezoneOffset())*i.date.MS_PER_MINUTE;return e-t-n},expand:function(e,t,i){return s?s.expand(this,e,t,i):[this]},update:function(e){for(var t in e)this.set(t,e[t]);this._startTime&&this.set("_startTime",i.date.toUtcTime(this.start)),this._endTime&&this.set("_endTime",i.date.toUtcTime(this.end))},isMultiDay:function(){return this.isAllDay||this.duration()>=i.date.MS_PER_DAY},isException:function(){return!this.isNew()&&this.recurrenceId},isOccurrence:function(){return this.isNew()&&this.recurrenceId},isRecurring:function(){return!(!this.recurrenceRule&&!this.recurrenceId)},isRecurrenceHead:function(){return!(!this.id||!this.recurrenceRule)},toOccurrence:function(t){return(t=e.extend(t,{recurrenceException:null,recurrenceRule:null,recurrenceId:this.id||this.recurrenceId}))[this.idField]=this.defaults[this.idField],this.clone(t,!0)},toJSON:function(){var e=i.data.Model.fn.toJSON.call(this);return e.uid=this.uid,delete e._startTime,delete e._endTime,e},shouldSerialize:function(e){return i.data.Model.fn.shouldSerialize.call(this,e)&&"_defaultId"!==e},set:function(e,t){var n=this.isAllDay||!1;if(i.data.Model.fn.set.call(this,e,t),"isAllDay"==e&&t!=n){var o=i.date.getDate(this.start),r=new Date(this.end),s=i.date.getMilliseconds(r);0===s&&t&&(s=a),this.set("start",o),!0===t?(i.date.setTime(r,-s),r<o&&(r=o)):i.date.setTime(r,a-s),this.set("end",r)}},id:"id",fields:{id:{type:"number"},title:{defaultValue:"",type:"string"},start:{type:"date",validation:{required:!0,validDate:{value:ee}}},startTimezone:{type:"string"},end:{type:"date",validation:{required:!0,validDate:{value:ee},dateCompare:{value:function(e){if(e.filter("[name=end]").length){var t=e.closest(".k-scheduler-edit-form"),n=t.find("[name=start]:visible"),a=t.find("[name=end]:visible");if(a[0]&&n[0]){var o,r,s=i.widgetInstance(n,i.ui),l=i.widgetInstance(a,i.ui),d=t.data("kendoEditable"),c=d?d.options.model:null;if(s&&l?(o=s.value(),r=l.value()):(o=i.parseDate(n.val()),r=i.parseDate(a.val())),o&&r){if(c){var u=n.attr(i.attr("timezone")),p=c.startTimezone,f=c.endTimezone;p=p||f,f=f||p,p&&(o=Z(o,p,u),r=Z(r,f,u))}return o<=r}}}return!0}}}},endTimezone:{type:"string"},recurrenceRule:{defaultValue:"",type:"string",validation:{validDate:{value:ee},untilDateCompare:{value:function(e){var t,n,a,o;return!(e.filter(".k-recur-until").length&&(t=i.widgetInstance(e,i.ui).value(),(n=e.closest(".k-scheduler-edit-form").find("[name=start]:visible"))[0]&&(a=(o=i.widgetInstance(n,i.ui))?o.value():i.parseDate(n.val()))&&t))||a<=t}}}},recurrenceException:{defaultValue:"",type:"string"},isAllDay:{type:"boolean",defaultValue:!1},description:{type:"string"}}}),ie=v.extend({init:function(e){v.fn.init.call(this,g(!0,{},{schema:{modelBase:te,model:te}},e)),this.reader=new X(this.options.schema,this.reader)},expand:function(e,t){var n,o=this.view(),r={};return e&&t&&(n=t.getTimezoneOffset(),(t=new Date(t.getTime()+a-1)).getTimezoneOffset()!==n&&(t=i.timezone.apply(t,n)),r={logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:e},{field:"end",operator:"gte",value:e},{field:"start",operator:"lte",value:t}]},{logic:"and",filters:[{field:"start",operator:"lte",value:new Date(e.getTime()+a-1)},{field:"end",operator:"gte",value:e}]}]},o=new i.data.Query(function(e,t,i,n){for(var a=e.length,o=[],r=0;r<a;r++)o=o.concat(e[r].expand(t,i,n));return o}(o,e,t,this.reader.timezone)).filter(r).toArray()),o},cancelChanges:function(e){e&&e.isOccurrence()&&this._removeExceptionDate(e),v.fn.cancelChanges.call(this,e)},insert:function(e,t){if(t){if(!(t instanceof te)){var i=t;(t=this._createNewModel()).accept(i)}return(!this._pushCreated&&t.isRecurrenceHead()||t.recurrenceId)&&(t=t.recurrenceId?t:t.toOccurrence(),this._addExceptionDate(t)),v.fn.insert.call(this,e,t)}},pushCreate:function(e){this._pushCreated=!0,v.fn.pushCreate.call(this,e),this._pushCreated=!1},remove:function(e){return e.isRecurrenceHead()?this._removeExceptions(e):e.isRecurring()&&this._addExceptionDate(e),v.fn.remove.call(this,e)},_removeExceptions:function(e){for(var t=this.data().slice(0),i=t.shift(),n=e.id;i;)i.recurrenceId===n&&v.fn.remove.call(this,i),i=t.shift();e.set(W,"")},_removeExceptionDate:function(e){if(e.recurrenceId){var t=this.get(e.recurrenceId);if(t){var i=e.defaults.start,n=new RegExp("(\\,?)"+s.toExceptionString(i,this.reader.timezone)),a=(t.recurrenceException||"").replace(N,B).replace(/\,$/,"");n.test(a)||(i=e.start,n=new RegExp("(\\,?)"+s.toExceptionString(i,this.reader.timezone))),t.set(W,a.replace(n,""))}}},_addExceptionDate:function(e){var t=e.start,i=this.reader.timezone,n=this.get(e.recurrenceId),a=(n.recurrenceException||"").replace(N,B).replace(/\,$/,"");if(!s.isException(a,t,i)){var o=s.toExceptionString(t,i);e.defaults.start=t,n.set(W,a+(a&&o?B:"")+o)}}});ie.create=function(e){(b(e)||e instanceof i.data.ObservableArray)&&(e={data:e});var t=e||{},n=t.data;if(t.data=n,!(t instanceof ie)&&t instanceof i.data.DataSource)throw new Error("Incorrect DataSource type. Only SchedulerDataSource instances are supported");return t instanceof ie?t:new ie(t)},g(!0,i.data,{SchedulerDataSource:ie,SchedulerDataReader:X,SchedulerEvent:te});var ne={update:{text:"Save",className:"k-button-solid-primary k-scheduler-update"},canceledit:{text:"Cancel",className:"k-scheduler-cancel"},destroy:{text:"Delete",imageClass:"k-i-close",className:"k-button-solid-primary k-scheduler-delete",iconClass:"k-icon"}};function ae(t){var i=oe(t.model,t.field);return function(t,n){e('<textarea name="description" class="k-input-inner" title="'+n.title+'"/>').attr(i).appendTo(t).wrap('<span class="k-input k-textarea k-input-solid k-input-md k-rounded-md"></span>')}}function oe(t,n){var a,o,r=(t.fields||t)[n],s=["url","email","number","date","boolean"],l=r?r.validation:{},d=i.attr("type"),c=e.inArray,u={};for(a in l)o=l[a],c(a,s)>=0?u[d]=a:i.isFunction(o)||(u[a]=m(o)?o.value||a:o),u[i.attr(a+"-msg")]=o.message;return u}function re(e,i,n,a){var o,r=e.value(),s=Array.isArray(r);o=s?JSON.parse(JSON.stringify(r)):[r.toString()],e.dataSource.data().forEach((function(r){if(null===r[n]||r[n]===t||r[n]==i)r.set(I,!1);else{var l=r.get(a);r.set(I,!0),(o.indexOf(l)>=0||o.indexOf(l.toString())>=0)&&(s?o.splice(o.indexOf(l),1):(e.value(null),e.trigger(x)))}})),s&&o.length<r.length&&(e.value(o),e.trigger(x))}function se(e,t,n,a){var o=e.closest(".k-edit-form-container").find("[data-"+i.ns+"bind='value:"+a+"']"),r=o.getKendoDropDownList();r?r.bind(x,(function(e){var i=e.sender.value();re(t,i,n.dataParentValueField,n.dataValueField)})):o.on(x,(function(e){var i=e.target.value;re(t,i,n.dataParentValueField,n.dataValueField)}))}function le(e,n,a){var o,r=n.find("option"),s=n.val(),l=Array.isArray(s);o=l?JSON.parse(JSON.stringify(s)):[s],e.dataSource.view().forEach((function(s,d){var c=i.getter(e.dataParentValueField)(s);if(null===c||c===t||c==a)r[d].removeAttribute(I);else{r[d].setAttribute(I,I);var u=""+s.get(e.dataValueField);o.indexOf(u)>=0&&(l?o.splice(o.indexOf(u),1):(n.val(null),n.trigger(x)))}})),l&&o.length<s.length&&(n.val(o),n.trigger(x))}function de(e,t){var n=e.end.getTime()-e.start.getTime(),a=new Date(e.start.getTime());i.date.setTime(a,t);var o=new Date(a.getTime());return i.date.setTime(o,n,!0),{start:a,end:o}}var ce={mobile:{dateRange:function(t,n){var a={name:n.field,title:n.title},o=n.model.isAllDay,r=i.attr("validate")+"='"+!o+"'",s=i.attr("validate")+"='"+!!o+"'";$(a,n),Q(a,n),j(a,n),e('<input type="datetime-local" required '+i.attr("type")+'="datetime-local" '+i.attr("bind")+'="value:'+n.field+', invisible:isAllDay" '+r+"/>").attr(a).appendTo(t),e('<input type="date" required '+i.attr("type")+'="date" '+i.attr("bind")+'="value:'+n.field+',visible:isAllDay" '+s+"/>").attr(a).appendTo(t),e("<span "+i.attr("for")+'="'+n.field+'" class="k-invalid-msg"/>').hide().appendTo(t)},timezonePopUp:function(t,i){var n=Y(i.model,i.messages.noTimezone);e('<span class="k-timezone-label"></span>').text(n).appendTo(t),e('<span class="k-icon k-i-arrow-chevron-right"></span>').appendTo(t),t.closest("li.k-item label").on(w,i.click)},timezone:function(t,n){e('<div class="k-mobiletimezoneeditor" '+i.attr("bind")+'="value:'+n.field+'" />').attr({name:n.field}).appendTo(t).kendoMobileTimezoneEditor({optionLabel:n.noTimezone})},recurrence:function(t,n){e("<div "+i.attr("bind")+'="value:'+n.field+'" />').attr({name:n.field}).appendTo(t).kendoMobileRecurrenceEditor({start:n.model.start,timezone:n.timezone,messages:n.messages,pane:n.pane,value:n.model[n.field]})},description:ae,multipleResources:function(t,n,a){var o=oe(n,t.field);return function(r){for(var s="",l=t.dataSource.view(),d=0,c=l.length;d<c;d++)s+=i.format('<option value="{0}">{1}</option>',i.getter(t.dataValueField)(l[d]),i.getter(t.dataTextField)(l[d]));var u=e(i.format('<select aria-labelledby="'+t.field+'_label" data-{0}bind="value:{1}" multiple="multiple">{2}</select>',i.ns,t.field,s)).appendTo(r).attr(o);a&&setTimeout((function(){var e=r.closest(".k-stretched-view").find("[data-"+i.ns+"bind='value:"+a+"']"),o=n[a];le(t,u,o),e.on(x,(function(e){var i=e.target.value;le(t,u,i)}))}))}},resources:function(t,n,a){var o=oe(n,t.field);return function(r){for(var s="",l=t.dataSource.view(),d=0,c=l.length;d<c;d++)s+=i.format('<option value="{0}">{1}</option>',i.getter(t.dataValueField)(l[d]),i.getter(t.dataTextField)(l[d]));var u=e(i.format('<select aria-labelledby="'+t.field+'_label" data-{0}bind="value:{1}">{2}</select>',i.ns,t.field,s)).appendTo(r).attr(o);a&&setTimeout((function(){var e=r.closest(".k-stretched-view").find("[data-"+i.ns+"bind='value:"+a+"']"),o=n[a];le(t,u,o),e.on(x,(function(e){var i=e.target.value;le(t,u,i)}))}))}},isAllDay:function(t,n){e('<input type="checkbox" data-role="switch"'+i.attr("bind")+'="value:'+n.field+'" />').appendTo(t)}},desktop:{dateRange:function(t,n){var a={name:n.field,title:n.title},o=n.model.isAllDay,r=i.attr("validate")+"='"+!o+"' ",s=i.attr("validate")+"='"+!!o+"' ";$(a,n),Q(a,n),j(a,n),e('<input type="text" required '+i.attr("type")+'="date" '+i.attr("role")+'="datetimepicker" '+i.attr("bind")+'="value:'+n.field+',invisible:isAllDay" '+r+"/>").attr(a).appendTo(t),e('<input type="text" required '+i.attr("type")+'="date" '+i.attr("role")+'="datepicker" '+i.attr("bind")+'="value:'+n.field+',visible:isAllDay" '+s+"/>").attr(a).appendTo(t),e("<span "+i.attr("bind")+'="text: '+n.field+'Timezone"></span>').appendTo(t),"end"===n.field&&e("<span "+i.attr("bind")+'="text: startTimezone, invisible: endTimezone"></span>').appendTo(t),e("<span "+i.attr("for")+'="'+n.field+'" class="k-invalid-msg"/>').hide().appendTo(t)},timezonePopUp:function(t,i){e('<a href="#" class="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base" data-bind="invisible:isAllDay"><span class="k-button-text">'+i.messages.timezoneEditorButton+"</span></a>").on(w,i.click).appendTo(t)},timezone:function(n,a){var o=a.visible||a.visible===t;e("<div "+i.attr("bind")+'="value:'+a.field+'" />').attr({name:a.field}).toggle(o).appendTo(n).kendoTimezoneEditor({optionLabel:a.noTimezone,title:a.title})},recurrence:function(t,n){e("<div "+i.attr("bind")+'="value:'+n.field+'" />').attr({name:n.field}).appendTo(t).kendoRecurrenceEditor({start:n.model.start,timezone:n.timezone,messages:n.messages})},description:ae,multipleResources:function(t,n,a){var o=oe(n,t.field);return function(r){var s;a&&setTimeout((function(){re(s,n[a],t.dataParentValueField,t.dataValueField),se(r,s,t,a)})),s=e(i.format('<select aria-labelledby="'+t.field+'_label" data-{0}bind="value:{1}">',i.ns,t.field)).appendTo(r).attr(o).kendoMultiSelect({dataTextField:t.dataTextField,dataValueField:t.dataValueField,dataSource:t.dataSource.data(),valuePrimitive:t.valuePrimitive,itemTemplate:i.format('<span #= data.disabled ? "data-disabled": "" #><span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#</span>',t.dataColorField,t.dataTextField),tagTemplate:i.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',t.dataColorField,t.dataTextField),select:function(e){e.dataItem&&e.dataItem.disabled&&e.preventDefault()},dataBound:function(t){t.sender.list.find("li").each((function(t,i){var n=e(i);n.find("[data-disabled]").length>0&&n.addClass("k-disabled")}))}}).data("kendoMultiSelect")}},resources:function(t,n,a){var o=oe(n,t.field);return function(r){var s;a&&setTimeout((function(){re(s,n[a],t.dataParentValueField,t.dataValueField),se(r,s,t,a)})),s=e(i.format('<select aria-labelledby="'+t.field+'_label" data-{0}bind="value:{1}" title="'+n.title+'">',i.ns,t.field)).appendTo(r).attr(o).kendoDropDownList({dataTextField:t.dataTextField,dataValueField:t.dataValueField,dataSource:t.dataSource.data(),valuePrimitive:t.valuePrimitive,optionLabel:"None",template:i.format('<span #= data.disabled ? "data-disabled": ""#><span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#</span>',t.dataColorField,t.dataTextField),select:function(e){e.dataItem&&e.dataItem.disabled&&e.preventDefault()},dataBound:function(t){t.sender.list.find("li").each((function(t,i){var n=e(i);n.find("[data-disabled]").length>0&&n.addClass("k-disabled")}))}}).data("kendoDropDownList")}},isAllDay:function(t,n){e('<input type="checkbox" data-role="checkbox"'+i.attr("bind")+'="value:'+n.field+'" data-label="'+n.title+'" />').attr({id:n.field,name:n.field,title:n.title?n.title:n.field}).appendTo(t)}}},ue=i.Observable.extend({init:function(e,t){i.Observable.fn.init.call(this),this.element=e,this.options=g(!0,{},this.options,t),this.createButton=this.options.createButton,this.toggleDateValidationHandler=this._toggleDateValidation.bind(this)},_toggleDateValidation:function(t){if("isAllDay"==t.field){var n,a,o,r=this.container,s=this.editable.options.model.isAllDay,l=i.attr("bind");r.find("["+l+"*=end],["+l+"*=start]").each((function(){n=e(this),A.test(n.attr(l))&&(a=n.is("["+i.attr("role")+"=datetimepicker],[type*=datetime]"),o=s!==a,n.attr(i.attr("validate"),o))}))}},fields:function(e,t){var n=this,a=n.options.messages,o=n.options.timezone,r=[{field:"title",title:a.editor.title},{field:"start",title:a.editor.start,editor:e.dateRange,timezone:o},{field:"end",title:a.editor.end,editor:e.dateRange,timezone:o},{field:"isAllDay",title:a.editor.allDayEvent,editor:e.isAllDay}],s=function(e){return!!e[u.dataParentValueField]};i.timezone.windows_zones&&(r.push({field:"timezone",title:a.editor.timezone,editor:e.timezonePopUp,click:function(e){e.preventDefault(),n._initTimezoneEditor(t,this)},messages:a.editor,model:t}),r.push({field:"startTimezone",title:a.editor.startTimezone,editor:e.timezone,noTimezone:a.editor.noTimezone}),r.push({field:"endTimezone",title:a.editor.endTimezone,editor:e.timezone,noTimezone:a.editor.noTimezone})),t.recurrenceId||r.push({field:"recurrenceRule",title:a.editor.repeat,editor:e.recurrence,timezone:o,messages:a.recurrenceEditor,pane:this.pane}),"description"in t&&r.push({field:"description",title:a.editor.description,editor:e.description({model:t,field:"description"})});for(var l=0;l<this.options.resources.length;l++){var d,c,u=this.options.resources[l];u.dataSource.view().some(s)&&(d=this.options.resources[l-1])&&(c=d.field),r.push({field:u.field,title:u.title,editor:u.multiple?e.multipleResources(u,t,c):e.resources(u,t,c)})}return r},end:function(){return this.editable.end()},_buildDesktopEditTemplate:function(t,n,a){var o=this.options.messages,r=g({},i.Template,this.options.templateSettings),s=r.paramName,l="";l+='<div class="k-form">';for(var d=0,c=n.length;d<c;d++){var u=n[d];if("startTimezone"===u.field&&(l+='<div class="k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones" style="display:none">',l+='<div class="k-form">',l+='<div class="k-form-field"><div class="k-form-field-wrap">'+i.html.renderCheckBox(e('<input class="k-timezone-toggle"/>'),{label:o.editor.separateTimezones})+"</div></div>"),t.fields[u.field]&&"boolean"===t.fields[u.field].type?l+='<div class="k-form-field">':l+='<div class="k-form-field"><label class="k-label k-form-label" for="'+u.field+'" id="'+u.field+'_label">'+(u.title||u.field||"")+"</label>",!t.editable||t.editable(u.field))a.push(u),l+="<div "+i.attr("container-for")+'="'+u.field+'" class="k-form-field-wrap"></div>';else{var p="#:";u.field?p+=(u=i.expr(u.field,s))+"==null?'':"+u:p+="''",p+="#",l+='<div class="k-form-field-wrap">'+(p=i.template(p,r))(t)+"</div>"}l+="</div>","endTimezone"===u.field&&(l+=this._createEndTimezoneButton())}return l+="</div>"},_buildMobileEditTemplate:function(e,t,n){var a=this.options.messages,o=g({},i.Template,this.options.templateSettings),r=o.paramName,s="";s+='<ul class="k-listgroup k-listgroup-flush">';for(var l=0,d=t.length;l<d;l++){var c=t[l];if("timezone"!==c.field&&"recurrenceRule"!==c.field||(s+='</ul><ul class="k-listgroup k-listgroup-flush">'),"startTimezone"===c.field&&(s+='<div class="k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones" style="display:none">',s+='<ul class="k-listgroup k-listgroup-flush">',s+='<li class="k-item k-listgroup-item">',s+='<label class="k-label k-listgroup-form-row">',s+='<span class="k-item-title k-listgroup-form-row">'+a.editor.separateTimezones+"</span>",s+='<span class="k-listgroup-form-field-wrapper">',s+='<input class="k-timezone-toggle" data-role="switch" type="checkbox" />',s+="</span>",s+="</label>",s+="</li>"),!e.editable||e.editable(c.field))s+='<li class="k-item k-listgroup-item">',"timezone"===c.field?s+='<label class="k-label k-listgroup-form-row" data-bind="css: { k-disabled: isAllDay }">':s+='<label class="k-label k-listgroup-form-row">',s+='<span class="k-item-title k-listgroup-form-field-label">'+(c.title||c.field||"")+"</span>",n.push(c),s+='<div class="k-listgroup-form-field-wrapper" '+i.attr("container-for")+'="'+c.field+'"></div>',s+="</label></li>";else{var u="#:";s+='<li class="k-item k-listgroup-item">',s+='<label class="k-label k-no-click k-listgroup-form-row">',s+='<span class="k-item-title k-listgroup-form-field-label">'+(c.title||c.field||"")+"</span>",c.field?u+=(c=i.expr(c.field,r))+"==null?'':"+c:u+="''",u+="#",s+='<span class="k-no-editor k-listgroup-form-field-wrapper">'+(u=i.template(u,o))(e)+"</span>",s+="</label></li>"}"recurrenceRule"===c.field&&(s+='</ul><ul class="k-listgroup k-listgroup-flush">'),"endTimezone"===c.field&&(s+="</ul></div>")}return s+="</ul>"},_buildEditTemplate:function(e,t,n,a){var o=g({},i.Template,this.options.templateSettings),r=this.options.editable.template,s="";return r?(typeof r===p&&(r=i.unescape(r)),s+=i.template(r,o)(e)):s+=a?'<div data-role="content">'+this._buildMobileEditTemplate(e,t,n)+"</div>":this._buildDesktopEditTemplate(e,t,n),s},_createEndTimezoneButton:function(){return"</ul></div>"},_revertTimezones:function(e){e.set("startTimezone",this._startTimezone),e.set("endTimezone",this._endTimezone),delete this._startTimezone,delete this._endTimezone}}),pe=ue.extend({init:function(){ue.fn.init.apply(this,arguments),this.pane=i.Pane.wrap(this.element,{viewEngine:{viewOptions:{renderOnInit:!0,wrap:!1,wrapInSections:!0,detachOnHide:!1,detachOnDestroy:!1}}}),this.pane.element.parent().css("height",this.options.height),this.view=this.pane.view()},options:{animations:{left:"slide",right:"slide:right"}},destroy:function(){this.close(),this.unbind(),this.pane.destroy()},_initTimezoneEditor:function(t){var i=this,n=i.pane,a=i.options.messages,o=i.timezoneView,r=o?o.content.find(".k-scheduler-timezones"):i.container.find(".k-scheduler-timezones"),s=r.find("input.k-timezone-toggle").data("kendoSwitch"),l=r.find("li.k-item:not(.k-zonepicker)").last();if(i._startTimezone=t.startTimezone||"",i._endTimezone=t.endTimezone||"",!o){var d='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form"><div data-role="header" class="k-header"><a href="\\#" class="k-header-cancel k-scheduler-cancel k-link" title="'+a.cancel+'"aria-label="'+a.cancel+'"><span class="k-icon k-i-arrow-chevron-left"></span></a>'+a.editor.timezoneTitle+'<a href="\\#" class="k-header-done k-scheduler-update k-link" title="'+a.save+'" aria-label="'+a.save+'"><span class="k-icon k-i-check"></span></a></div><div data-role="content"></div>';this.timezoneView=o=n.append(d),o.contentElement.append(r.show()),o.element.on(w+_,".k-scheduler-cancel, .k-scheduler-update",(function(o){o.preventDefault(),o.stopPropagation(),e(this).hasClass("k-scheduler-cancel")&&i._revertTimezones(t);var r=i._editPane,s=Y(t,a.editor.noTimezone);r.content.find(".k-timezone-label").text(s),n.navigate(r,i.options.animations.right)})),s.bind(x,(function(e){l.toggle(e.checked),t.set("endTimezone","")})),t.bind(x,(function(e){if("startTimezone"===e.field){var i=t.startTimezone;s.enable(i),i||(l.hide(),t.set("endTimezone",""),s.value(!1))}}))}s.value(!!t.endTimezone),s.enable(!!t.startTimezone),t.endTimezone?l.show():l.hide(),n.navigate(o,i.options.animations.left)},showDialog:function(t){var i=t.buttons.map((function(e){return{text:e.text,action:e.click}}));i.push({text:this.options.messages.cancel,primary:!0}),e("<div />").appendTo(document.body).kendoDialog({close:function(){this.destroy()},modal:{preventScroll:!0},closable:!1,title:!1,content:t.text,actions:i})},editEvent:function(t){var n=this.pane,a="",o=this.options.messages,r=o.save,s=o.destroy,l=o.cancel,d=o.editor.editorTitle,c=o.resetSeries;a+='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form"'+i.attr("uid")+'="'+t.uid+'"><div data-role="header" class="k-header"><a href="\\#" class="k-header-cancel k-scheduler-cancel k-link" title="'+l+'"aria-label="'+l+'"><span class="k-icon k-i-arrow-chevron-left"></span></a>'+d+'<a href="\\#" class="k-header-done k-scheduler-update k-link" title="'+r+'" aria-label="'+r+'"><span class="k-icon k-i-check"></span></a></div>';var u=this.fields(ce.mobile,t),p=this,f=[];a+=this._buildEditTemplate(t,u,f,!0),a+="</div>";var h=n.append(a);if(!t.isNew()&&this.options.editable&&!1!==this.options.editable.destroy&&t.isRecurrenceHead()&&t.recurrenceException){var v='<ul class="k-edit-buttons k-listgroup k-listgroup-flush"><li class="k-item k-listgroup-item"><span class="k-scheduler-resetSeries k-link k-label" aria-label="'+c+'">'+c+"</span></li></ul>";h.contentElement.append(v)}if(!t.isNew()&&this.options.editable&&!1!==this.options.editable.destroy){var m='<ul class="k-edit-buttons k-listgroup k-listgroup-flush"><li class="k-item k-listgroup-item"><span class="k-scheduler-delete k-link k-label" aria-label="'+s+'">'+s+"</span></li></ul>";h.contentElement.append(m)}this._editPane=h;var g=this.container=h.element;return this.editable=g.kendoEditable({fields:f,model:t,clearContainer:!1,target:p.options.target,validateOnBlur:!0}).data("kendoEditable"),this.trigger("edit",{container:g,model:t})?this.trigger("cancel",{container:g,model:t}):(g.on(w+_,"a.k-scheduler-edit, a.k-scheduler-cancel, a.k-scheduler-update, span.k-scheduler-delete, span.k-scheduler-resetSeries",(function(i){i.preventDefault(),i.stopPropagation();var a=e(this);if(a.hasClass("k-scheduler-edit"))n.navigate(this._editPane,p.options.animations.right);else{var o="cancel";a.hasClass("k-scheduler-update")?o="save":a.hasClass("k-scheduler-delete")?o="remove":a.hasClass("k-scheduler-resetSeries")&&(o=P),p.trigger(o,{container:g,model:t})}})),n.navigate(h,p.options.animations.left),t.bind(x,p.toggleDateValidationHandler)),this.editable},_views:function(){return this.pane.element.find(i.roleSelector("view")).not(this.view.element)},close:function(){if(this.container){this.pane.navigate("",this.options.animations.right);for(var e,t=this._views(),i=0,n=t.length;i<n;i++)(e=t.eq(i).data("kendoView"))&&e.purge();t.remove(),this.container=null,this.editable&&(this.editable.options.model.unbind(x,this.toggleDateValidationHandler),this.editable.destroy(),this.editable=null),this.timezoneView=null}}}),fe=ue.extend({destroy:function(){this.close(),this.unbind()},editEvent:function(t){var n,a,o=this,r=o.options.editable,s="<div "+i.attr("uid")+'="'+t.uid+'" class="k-popup-edit-form k-scheduler-edit-form"><div class="k-edit-form-container">',l=o.options.messages,d=l.save,c=l.cancel,u=l.destroy,p=l.resetSeries,f=this.fields(ce.desktop,t),h=[];s+=this._buildEditTemplate(t,f,h,!1);var v=m(r)?r.window:{};s+='<div class="k-edit-buttons">',s+=this.createButton({name:"update",text:d,attr:a})+this.createButton({name:"canceledit",text:c,attr:a}),!t.isNew()&&!1!==r.destroy&&t.isRecurrenceHead()&&t.recurrenceException&&(s+=this.createButton({name:"resetSeries",text:p,attr:a})),t.isNew()&&!t.isRecurring()||!1===r.destroy||(s+=this.createButton({name:"delete",text:u,attr:a})),s+="</div></div></div>";var k=this.container=e(s).appendTo(o.element).eq(0).kendoWindow(g({modal:!0,resizable:!1,draggable:!0,title:l.editor.editorTitle,visible:!1,close:function(e){e.userTriggered&&o.trigger(C,{container:k,model:t})&&e.preventDefault()}},v));for(var b in o.editable=k.kendoEditable({fields:h,model:t,clearContainer:!1,validateOnBlur:!0,target:o.options.target}).data("kendoEditable"),h)"recurrenceRule"!==h[b].field&&(n=h[b].field,k.find("[name='"+n+"']").attr("aria-labelledby",n+"_label")),"isAllDay"===h[b].field&&k.find("label[for='"+n+"']").attr("id",n+"_label");return o.trigger(O,{container:k,model:t})?o.trigger(C,{container:k,model:t}):(k.data("kendoWindow").center().open(),k.on(w+_,"button.k-scheduler-cancel",(function(e){e.preventDefault(),e.stopPropagation(),o.trigger(C,{container:k,model:t})})),k.on(w+_,"button.k-scheduler-update",(function(e){e.preventDefault(),e.stopPropagation(),o.trigger("save",{container:k,model:t})})),k.on(w+_,"button.k-scheduler-delete",(function(e){e.preventDefault(),e.stopPropagation(),o.trigger(V,{container:k,model:t})})),k.on(w+_,"button.k-scheduler-resetSeries",(function(e){e.preventDefault(),e.stopPropagation(),o.trigger(P,{container:k,model:t})})),i.cycleForm(k),t.bind(x,o.toggleDateValidationHandler)),o.editable},close:function(){var e=this,t=function(){e.editable&&(e.editable.options.model.unbind(x,e.toggleDateValidationHandler),e.editable.destroy(),e.editable=null,e.container=null),e.popup&&(e.popup.destroy(),e.popup=null)};e.editable?(e._timezonePopup&&e._timezonePopup.data("kendoWindow")&&(e._timezonePopup.data("kendoWindow").destroy(),e._timezonePopup=null),e.container.is(":visible")?e.container.data("kendoWindow").bind("deactivate",t).close():t()):t()},_createEndTimezoneButton:function(){var e=this.options.messages,t="";return t+='<div class="k-edit-buttons">',t+=this.createButton({name:"savetimezone",text:e.save})+this.createButton({name:"canceltimezone",text:e.cancel}),t+="</div></div></div>"},showDialog:function(t){var n=i.format("<div class='k-popup-edit-form'><div class='k-edit-form-container'><p class='k-popup-message'>{0}</p>",t.text);n+='<div class="k-edit-buttons">';for(var a=0;a<t.buttons.length;a++)n+=this.createButton(t.buttons[a]);n+="</div></div></div>";var o=this.element;this.popup&&this.popup.destroy();var r=this.popup=e(n).appendTo(o).eq(0).on(w,".k-button",(function(i){i.preventDefault(),r.close();var n=e(i.currentTarget).index();t.buttons[n].click()})).kendoWindow({modal:!0,resizable:!1,draggable:!1,title:t.title,visible:!1,close:function(){this.destroy(),o.trigger("focus")}}).getKendoWindow();r.center().open()},_initTimezoneEditor:function(e,t){var i,n=this,a=n.container.find(".k-scheduler-timezones"),o=a.find("input.k-timezone-toggle"),r=a.find(".k-form-field").last(),s=a.find(".k-scheduler-savetimezone"),l=a.find(".k-scheduler-canceltimezone"),d=n._timezonePopup,c=function(t){if("startTimezone"===t.field){var i=e.startTimezone;o.prop(I,!i),i||(r.hide(),e.set("endTimezone",""),o.prop("checked",!1))}};n._startTimezone=e.startTimezone,n._endTimezone=e.endTimezone,d||(n._timezonePopup=d=a.kendoWindow({modal:!0,resizable:!1,draggable:!0,title:n.options.messages.editor.timezoneEditorTitle,visible:!1,close:function(i){e.unbind(x,c),i.userTriggered&&n._revertTimezones(e),t&&t.focus()}}),o.on(w,(function(){r.toggle(o.prop("checked")),e.set("endTimezone","")})),s.on(w,(function(e){e.preventDefault(),i.close()})),l.on(w,(function(t){t.preventDefault(),n._revertTimezones(e),i.close()})),e.bind(x,c)),o.prop("checked",e.endTimezone).prop(I,!e.startTimezone),e.endTimezone?r.show():r.hide(),(i=d.data("kendoWindow")).center().open()}}),he=u.extend({init:function(t,n){var a=this;c.fn.init.call(a,t,n),a.options.views&&a.options.views.length||(a.options.views=["day","week"]),a.resources=[],a._initModel(),a._wrapper(),a.options.selectable&&a._tabindex(),a._views(),a._toolbar(),a._dataSource(),a._resources(),a._resizeHandler=function(){a.resize()},a.wrapper.on(y+_+" selectstart"+_,(function(t){e(t.target).is(":kendoFocusable")||t.preventDefault()})),a.options.editable&&!1!==a.options.editable.resize&&a._resizable(),a._movable(),a._bindResize(),a.options.messages&&a.options.messages.recurrence&&(s.options=a.options.messages.recurrence),a._navigation(),a._selectable(),a._touchHandlers(),a._ariaId=i.guid(),a._createEditor()},_bindResize:function(){e(window).on("resize"+_,this._resizeHandler)},_unbindResize:function(){e(window).off("resize"+_,this._resizeHandler)},dataItems:function(){var i,n,a=this.items(),o=this._data,r=e.map(a,(function(t){return e(t).attr("data-uid")})),s={},l=r.length;for(i=0;i<l;i++)s[r[i]]=null;var d=o.length;for(i=0;i<d;i++){var c=o[i];s[c.uid]!==t&&(s[c.uid]=c)}var u=[];for(n in s)u.push(s[n]);return u},_isMobile:function(){var e=this.options;return!0===e.mobile&&i.support.mobileOS||"phone"===e.mobile||"tablet"===e.mobile},_isTouch:function(e){return/touch/.test(e.type)||e.originalEvent&&/touch/.test(e.originalEvent.pointerType)},_isInverseColor:function(e){return e.hasClass("k-event-inverse")},_groupsByResource:function(e,t,n,a,o){n||(n=[]);var r=e[0];if(r){for(var s,l=r.dataSource.view(),d=0,c=0;c<l.length;c++){var u=i.getter(r.dataValueField)(l[c]),p=t+d+c;(s=this._groupsByResource(e.slice(1),p,n,u,r.field))[r.field]=u,d=s.groupIndex,o&&a&&(s[o]=a),1===e.length&&(s.groupIndex=t+c,n.push(s))}return s}return{}},data:function(){return this._data},select:function(e){var n,a=this,r=a.view(),s=a._selection,l=r.groups;if(e===t){var d,c=r._selectedSlots;return s?(s&&s.events&&(d=a._selectedEvents()),{start:s.start,end:s.end,events:d,slots:c,resources:r._resourceBySlot(s)}):[]}if(!e)return a._selection=null,a._old=null,void r.clearSelection();if(Array.isArray(e)&&(e={events:e.splice(0)}),e.resources){var u,p=[],f=[];for(u in r.groupedResources&&a._groupsByResource(r.groupedResources,0,f),e.resources)p.push({field:u,operator:"eq",value:e.resources[u]});n=new i.data.Query(f).filter(p).toArray()}if(e.events&&e.events.length)return a._selectEvents(e.events,n),void a._select();if(l&&e.start&&e.end){var h,v,m=o(r._startDate),g=i.date.addDays(o(r._endDate),1);e.start<g&&m<=e.end&&((h=n&&n.length?l[n[0].groupIndex]:l[0]).timeSlotCollectionCount()||(e.isAllDay=!0),(v=h.ranges(e.start,e.end,e.isAllDay,!1)).length&&(a._selection={start:i.timezone.toLocalDate(v[0].start.start),end:i.timezone.toLocalDate(v[v.length-1].end.end),groupIndex:v[0].start.groupIndex,index:v[0].start.index,isAllDay:v[0].start.isDaySlot,events:[]},a._select()))}},_selectEvents:function(e,t){var n,a=this,o=a.view(),r=o.groups,s=e.length,l=t&&t.length,d=a._ctrlKey;for(a._ctrlKey=!0,n=0;n<s;n++)if(r&&l){for(var c=r[t[0].groupIndex],u=[],p=c.timeSlotCollectionCount(),f=c.daySlotCollectionCount(),h=0;h<p;h++)u=u.concat(c.getTimeSlotCollection(h).events());for(var v=0;v<f;v++)u=u.concat(c.getDaySlotCollection(v).events());(u=new i.data.Query(u).filter({field:"element[0].getAttribute('data-uid')",operator:"eq",value:e[n]}).toArray())[0]&&a._createSelection(u[0].element)}else{var m=o.element.find(i.format(".k-event[data-uid={0}], .k-task[data-uid={0}]",e[n]));m.length&&a._createSelection(m[0])}a._ctrlKey=d},_touchHandlers:function(){var e,t,n,a,o,r=this,s=r.wrapper,l=r._touchMove.bind(r);s.on(z+_,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",(function(i){var n=r.wrapper.find(".k-scheduler-content");r._isTouch(i)&&(n.stop(!0,!1),r._touchPosX=e=r._tapPosition(i,"X"),r._touchPosY=t=r._tapPosition(i,"Y"),r._userTouched=!0,r.view()._scrolling=!1,o=Date.now(),s.on(T+_,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",l))})),s.on("contextmenu"+_,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",(function(e){r._preventFocus=!0})),s.on(D+_,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",(function(d){if(r._isTouch(d)){var c=Date.now()-o,u=r.wrapper.find(".k-scheduler-content"),p=-r._amplitude*(3e3/c);n=r._tapPosition(d,"X"),a=r._tapPosition(d,"Y"),r._dragging||(r.options.selectable&&(Math.abs(n-e)<=10||Math.abs(a-t)<=10)&&r._mouseDownSelection(d),!i.support.kineticScrollNeeded&&c<200&&Math.abs(n-e)>10&&u.animate({scrollTop:u[0].scrollTop+p}),s.off(T+_,".k-scheduler-header-all-day td, .k-scheduler-content td",l))}}))},_navigation:function(){var e=this,t=e.wrapper;t.on("focus"+_,(function(){var i=e._selection;setTimeout((function(){e._preventFocus?e._preventFocus=!1:(i&&!(i.events.length>0&&0===t.find("[data-uid='"+i.events[0]+"']").length)||e._userTouched||e._mouseDown?e._mouseDown=!1:e._initialFocus(),e._select())}),300)})),t.on("focusout"+_,(function(){e._ctrlKey=e._shiftKey=!1})),t.on("keydown"+_,e._keydown.bind(e)),t.on("keyup"+_,(function(t){e._ctrlKey=t.ctrlKey,e._shiftKey=t.shiftKey}))},_selectable:function(){var e=this,t=e.wrapper;if(e.options.selectable){t.on(y+_,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event, .k-scheduler-body td .k-link",(function(t){e._isTouch(t)||e._mouseDownSelection(t)}));var i=e._mouseMove.bind(e);t.on(y+_,".k-scheduler-header-all-day td, .k-scheduler-content td",(function(n){var a=n.which,o=n.button,r=a&&3===a||o&&2==o;e._isTouch(n)||r||t.on(S+_,".k-scheduler-header-all-day td, .k-scheduler-content td",i)})),t.on("mouseup"+_+" mousecancel"+_,(function(){t.off(S+_,".k-scheduler-header-all-day td, .k-scheduler-content td",i)}))}},_mouseDownSelection:function(t){var n=t.which,a=t.button;n&&3===n||a&&2==a||(t.ctrlKey&&(this._ctrlKey=t.ctrlKey),t.shiftKey&&(this._shiftKey=t.shiftKey),this._mouseDown=!0,this._createSelection(t.currentTarget),e(t.currentTarget).hasClass("k-event")&&(this._selection.eventElement=t.currentTarget)),i._activeElement()!==this.wrapper.get(0)?i.focusElement(this.wrapper):this._select(),this.toolbar&&this.toolbar.find(".k-focus").removeClass(M)},_selectFirstSlot:function(){var e,t=this.wrapper.find(".k-scheduler-header-all-day").find("td").first(),i=this.wrapper.find(".k-scheduler-content").find("td").first();e=t.length>0?t:i.length>0?i:this.wrapper.find(".k-scheduler-body").find(".k-link").first(),this._createSelection(e)},_firstEvent:function(){var e,t,i,n=this.wrapper.find(".k-scheduler-header-wrap .k-event, .k-task").first(),a=this.wrapper.find(".k-scheduler-content .k-event").first();return n.length>0?a.length>0?(t=this.occurrenceByUid(n.data("uid")),i=this.occurrenceByUid(a.data("uid")),e=t.start<=i.start?n:a):e=n:a&&(e=a),e},_initialFocus:function(){var e=this._firstEvent();this.options.selectable?e&&e.length>0?(this._createSelection(e),this._selection.eventElement=e[0]):this._selectFirstSlot():this.toolbar&&0===this.toolbar.find(".k-focus").length?this._focusToolbar():this.toolbar&&this.toolbar.find(".k-focus").removeClass(M)},_select:function(){var t=this,i=t.view(),n=t.wrapper,a=i.current(),o=t._selection,r=t._old?t._old.selection:null,s=t._old?t._old.eventsLength:null;if(o&&(a&&(a.removeAttribute("id"),n.removeAttr("aria-activedescendant")),i.select(o),t._selection.eventElement=null,(a=i.current())&&(a.setAttribute("id",t._ariaId),n.attr("aria-activedescendant",t._ariaId),r!==a||o.events&&s!==o.events.length))){var l=e(a).data("uid");if(t._old&&l&&l===e(t._old.selection).data("uid")&&o.events&&t._old.eventsLength===o.events.length)return;var d=t._selectedEvents(),c=i._selectedSlots;t._old={selection:a,eventsLength:d.length},t.trigger(x,{start:o.start,end:o.end,events:d,slots:c,resources:i._resourceBySlot(o)})}},_selectedEvents:function(){for(var e,t=this._selection.events,i=t.length,n=0,a=[];n<i;n++)(e=this.occurrenceByUid(t[n]))&&a.push(e);return a},_tapPosition:function(e,t){return/touch/.test(e.type)?(e.originalEvent||e).changedTouches[0]["page"+t]:e["page"+t]},_touchMove:function(e){var t=this,n=t.wrapper.find(".k-scheduler-content"),a=n[0].scrollHeight>n[0].clientHeight,o=n[0].scrollWidth>n[0].clientWidth,r=t._tapPosition(e,"Y"),s=t._tapPosition(e,"X"),l=n[0].scrollTop-Math.round(r-t._touchPosY),d=n[0].scrollLeft-Math.round(s-t._touchPosX),c=a&&Math.abs(r-t._touchPosY)>10,u=o&&Math.abs(r-t._touchPosY)>10;t._dragging||i.support.kineticScrollNeeded||!t._isTouch(e)||(c||u)&&(t._amplitude=Math.round(r-t._touchPosY),t._touchPosY=r,t._touchPosX=s,n.animate({scrollTop:l,scrollLeft:d},0),t.view()._scrolling=!0)},_mouseMove:function(t){var i=this;clearTimeout(i._moveTimer),i._isTouch(t)||(i._moveTimer=setTimeout((function(){var n=i.view(),a=i._selection;if(a){var o=n.selectionByElement(e(t.currentTarget));if(o&&a.groupIndex===o.groupIndex){var r=o.startDate(),s=o.endDate();r>=a.end?a.backward=!1:s<=a.start&&(a.backward=!0),a.backward?a.start=r:a.end=s,i._select()}}}),5))},_viewByIndex:function(e){var t,i=this.views;for(t in i){if(!e)return t;e--}},_keydownToolbar:function(t){var n,a=t.keyCode,o=this.toolbar.find("> .k-button,.k-scheduler-navigation > .k-button,.k-nav-current,.k-views-dropdown:visible,.k-scheduler-views:visible > .k-button,.k-scheduler-search-input,.k-scheduler-mobile-views,.k-button-group > .k-button"),r=e(t.target).closest(".k-scheduler-views").length||this.toolbar.find(".k-scheduler-views .k-focus").length,s=i.support.isRtl(this.element),d=this.toolbar.find(".k-focus, :focus"),c=o.index(d);if(a!==l.TAB||t.shiftKey&&!this.options.selectable){if(t.altKey&&a===l.DOWN&&this.toolbar.find(".k-nav-current").hasClass(M))return this._showCalendar(),void t.preventDefault();if(a===l.RIGHT||a===l.LEFT){if(a===l.RIGHT&&!s||a===l.LEFT&&s){if((c+=1)===o.length)return this.toolbar.find(".k-focus").removeClass(M),void this.element.focus()}else if((a===l.LEFT&&!s||a===l.RIGHT&&s)&&(c-=1)<0)return;return n=o[c],this.toolbar.find(".k-focus").removeClass(M),e(n).addClass(M).attr("tabindex",0).focus().attr("tabindex",-1),this._focusedView=null,void t.preventDefault()}if(a===l.ENTER||a===l.SPACEBAR){if(r&&this._focusedView&&!this._focusedView.hasClass("k-selected")){var u=this._focusedView.data().name;return this.trigger("navigate",{view:u,action:"changeView",date:this.date()})||this.view(u),void t.preventDefault()}return this.toolbar.find(".k-focus:visible").click(),void t.preventDefault()}if(a===l.DOWN&&!this.wrapper.find(".k-views-dropdown").hasClass("k-focus"))return this.toolbar.find(".k-focus").removeClass(M),"year"===this._selectedViewName?this.view().calendar.focus():document.activeElement!==this.element[0]&&this.element.focus(),void t.preventDefault()}else this.toolbar.find(".k-focus").removeClass(M)},_keydownView:function(e){var t,n,a,o=e.keyCode,r=16===o||18===o||17===o||91===o||92===o,s=this._selection,d=this.view(),c=d.options.editable,u=[l.LEFT,l.RIGHT,l.UP,l.DOWN],p=i.support.isRtl(this.element);r||s&&(o===l.ENTER?s.events.length&&c&&!1!==c.update&&this.editEvent(s.events[0]):o!==l.DELETE&&o!==l.BACKSPACE||!1===c||!1===c.destroy?u.indexOf(o)>-1?(t=o===l.UP||o===l.LEFT&&!p||o===l.RIGHT&&p,d.moveToEvent(s,t)&&(this._select(),document.activeElement!==this.element[0]&&this.element.focus(),e.preventDefault())):o!==l.HOME&&o!==l.END||(e.preventDefault(),n=this.view().content.eq(0),a=o===l.HOME?n.find(".k-scheduler-table td").first():n.find(".k-scheduler-table td").last(),this.view()._scrollTo(a[0],n[0])):this.removeEvent(s.events[0]))},_keydownShortcut:function(e){var t=new Date,a=this.options.timezone,o=this.view().options.editable;if(66===e&&this.view().toggleFullDay)this.view().toggleFullDay();else if(67===e&&o&&!1!==o.create)this.addEvent(g({},{start:this.date(),end:this.date()}));else if(84===e){if(a){var r=i.timezone.offset(t,a);n=i.timezone.convert(t,t.getTimezoneOffset(),r)}else n=t;this.trigger("navigate",{view:this._selectedViewName,action:"today",date:n})||this.date(n)}},_keydownYearView:function(e){var t=this.view(),i=this._selection,n=e.keyCode;n!==l.TAB&&(n===l.F10?(this._focusToolbar(),e.preventDefault()):(this.toolbar.find(".k-focus").removeClass(M),t.calendar.focus()),i&&this._adjustSelectedDate(),e.preventDefault())},_keydownAgendaView:function(e){var t,i,n=e.keyCode,a=this.view(),o=this._selection;a.move(o,n)?(e.preventDefault(),this.toolbar.find(".k-focus").removeClass(M),this._select()):n!==l.HOME&&n!==l.END||(e.preventDefault(),t=this.view().content.eq(0),i=n===l.HOME?t.find(".k-scheduler-table td").first():t.find(".k-scheduler-table td").last(),this.view()._scrollTo(i[0],t[0]))},_keydownChangeView:function(e){var t,i=e-49;-1===i&&(i=9),(t=this._viewByIndex(i))&&!this.trigger("navigate",{view:t,action:"changeView",date:this.date()})&&this.view(t)},_keydownChangeDate:function(e){var t=i.support.isRtl(this.element),a=t&&e===l.LEFT||!t&&e===l.RIGHT?"next":"previous";n="next"===a?this.view().nextDate():this.view().previousDate(),this.trigger("navigate",{view:this._selectedViewName,action:a,date:n})||(this.date(n),this._initialFocus(),this._select())},_keydown:function(t){var i=t.keyCode,n=e(t.target).closest(".k-toolbar").length>0,a=t.altKey;if(this._ctrlKey=t.ctrlKey,this._shiftKey=t.shiftKey,i===l.ESC&&this.popup&&this.popup.visible())return this.popup.close(),void t.preventDefault();if(i!==l.LEFT&&i!==l.RIGHT||!this._shiftKey)if(a&&i>=48&&i<=57)this._keydownChangeView(i);else if([66,67,84].indexOf(i)>-1)this._keydownShortcut(i);else if(n)this._keydownToolbar(t);else{if("year"===this._selectedViewName)return void this._keydownYearView(t);if(i===l.F10)return this._focusToolbar(),void t.preventDefault();if("agenda"===this._selectedViewName)return void this._keydownAgendaView(t);this._keydownView(t)}else this._keydownChangeDate(i)},_focusToolbar:function(){this.toolbar.find(".k-button").first().trigger("focus").addClass(M)},_createSelection:function(t){var n,a,o=this._selection;(t=e(t)).is(".k-event")&&(n=t.attr(i.attr("uid")),o&&-1!==o.events.indexOf(n)&&!this._ctrlKey)||(o&&(this._ctrlKey||this._shiftKey)||(o=this._selection={events:[],groupIndex:0}),(a=this.view().selectionByElement(t))&&(o.groupIndex=a.groupIndex||0),n&&(a=G(this._data,n)),a&&a.uid&&(n=[a.uid]),this._updateSelection(a,n),this._adjustSelectedDate())},_updateSelection:function(e,n,a){var o=this._selection;if(e&&o){var r=this.view();if(e.uid&&(e=r._updateEventForSelection(e)),this._shiftKey&&o.start&&o.end){var s=e.end<o.end;o.end=e.endDate?e.endDate():e.end,s&&r._timeSlotInterval&&i.date.setTime(o.end,-r._timeSlotInterval())}else o.start=e.startDate?e.startDate():e.start,o.end=e.endDate?e.endDate():e.end;if(o.isAllDay="isDaySlot"in e?e.isDaySlot:e.isAllDay,null!==a&&a!==t&&(o.groupIndex=a),o.index=e.index,this._ctrlKey){var l=n&&n.length?o.events.indexOf(n[0]):-1;l>-1?o.events.splice(l,1):o.events=o.events.concat(n||[])}else o.events=n||[]}},options:{name:"Scheduler",date:H,editable:!0,autoBind:!0,snap:!0,mobile:!1,timezone:"",allDaySlot:!0,min:new Date(1900,0,1),max:new Date(2099,11,31),toolbar:null,workWeekStart:1,workWeekEnd:5,workDays:null,showWorkHours:!1,startTime:H,endTime:H,currentTimeMarker:{updateInterval:1e4,useLocalTimezone:!0},footer:{},messages:{today:"Today",pdf:"Export to PDF",save:"Save",cancel:"Cancel",destroy:"Delete",resetSeries:"Reset Series",deleteWindowTitle:"Delete event",next:"Next",previous:"Previous",refresh:"Refresh",selectView:"Select view",ariaSlotLabel:"Selected from {0:t} to {1:t}",ariaEventLabel:{on:"on",at:"at",to:"to",allDay:"(all day)",prefix:""},search:"Search...",views:{day:"Day",week:"Week",workWeek:"Work Week",agenda:"Agenda",month:"Month",timeline:"Timeline",timelineWeek:"Timeline Week",timelineWorkWeek:"Timeline Work Week",timelineMonth:"Timeline Month",year:"Year"},recurrenceMessages:{deleteWindowTitle:"Delete Recurring Item",resetSeriesWindowTitle:"Reset Series",deleteWindowOccurrence:"Delete current occurrence",deleteWindowSeries:"Delete the series",editWindowTitle:"Edit Recurring Item",editWindowOccurrence:"Edit current occurrence",editWindowSeries:"Edit the series"},editable:{confirmation:"Are you sure you want to delete this event?"},editor:{title:"Title",start:"Start",end:"End",allDayEvent:"All day event",description:"Description",repeat:"Repeat",timezone:"Timezone",startTimezone:"Start timezone",endTimezone:"End timezone",separateTimezones:"Use separate start and end time zones",timezoneEditorTitle:"Timezones",timezoneEditorButton:"Time zone",timezoneTitle:"Time zones",noTimezone:"No timezone",editorTitle:"Event"}},height:null,width:null,resources:[],group:{resources:[],orientation:"horizontal"},views:[],selectable:!1},events:[V,O,C,F,"add","dataBinding","dataBound","moveStart","move","moveEnd","resizeStart","resize","resizeEnd","navigate",x],destroy:function(){var t=this;if(c.fn.destroy.call(t),t.dataSource&&(t.dataSource.unbind(x,t._refreshHandler),t.dataSource.unbind(E,t._progressHandler),t.dataSource.unbind(R,t._errorHandler)),t._resourceRefreshHandler)for(var n=0;n<t.resources.length;n++){var a=t.resources[n].dataSource;a.unbind(x,t._resourceRefreshHandler),a.unbind(E,t._resourceProgressHandler),a.unbind(R,t._resourceErrorHandler)}t.calendar&&(t.calendar.destroy(),t.popup.destroy()),t.view()&&t.view().destroy(),t._editor&&t._editor.destroy(),this._moveDraggable&&this._moveDraggable.destroy(),this._resizeDraggable&&this._resizeDraggable.destroy(),t.element.add(t.wrapper).add(t.toolbar).add(t.popup).off(_),clearTimeout(t._moveTimer),t._model=null,t.toolbar=null,t.element=null,e(window).off("resize"+_,t._resizeHandler),i.destroy(t.wrapper)},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.options.autoBind&&e.fetch?e.fetch():b(e)&&this.view(this._selectedView)},items:function(){var e=this.wrapper.find(".k-scheduler-content"),t=this.view();return t&&"agenda"===t.options.name?e.find(".k-task"):e.find(".k-event").add(this.wrapper.find(".k-scheduler-header-wrap").find(".k-scheduler-header-all-day").siblings())},_movable:function(){var t,n,a,o,r,s,l,d,c,u=this,p=0,f=[],h=[],v=u._isMobile(),m=u.options.editable&&!1!==u.options.editable.move,g=u.options.editable&&!1!==u.options.editable.resize;(m||g&&v)&&(u._dragging=!1,v&&i.support.mobileOS.android&&(p=5),u._moveDraggable=new i.ui.Draggable(u.element,{distance:p,filter:".k-event",ignore:".k-resize-handle",holdToDrag:v,autoScroll:!0}),m&&u._moveDraggable.bind("dragstart",(function(e){var r=u.view(),p=e.currentTarget,h=u._isTouch(e);if(u._dragging=!0,!r.options.editable||!1===r.options.editable.move)return u._dragging=!1,void e.preventDefault();if(h&&!p.hasClass("k-event-active"))return u._dragging=!1,u.element.find(".k-event-active").removeClass("k-event-active"),void e.preventDefault();if(s=u.occurrenceByUid(p.attr(i.attr("uid"))),l=s.clone(),s.clone(),l.update(r._eventOptionsForMove(l)),l.inverseColor=u._isInverseColor(p),f=[],u._selection)for(var v=u._selection.events,m=0;m<v.length;m++){var g=u.occurrenceByUid(v[m]).clone(),k=this.element.find('div.k-event[data-uid="'+g.uid+'"]').eq(0);g.update(r._eventOptionsForMove(g)),k.length&&(g.inverseColor=u._isInverseColor(k)),f.push(g)}else f.push(l);t=r._slotByPosition(e.x.startLocation,e.y.startLocation),a=r._resourceBySlot(t),c=o=t.startOffset(e.x.startLocation,e.y.startLocation,u.options.snap),n=t,d=t,t&&!u.trigger("moveStart",{event:s})||e.preventDefault()})).bind("drag",(function(a){var p,v,m,g=u.view(),k=g._slotByPosition(a.x.location,a.y.location);if(k){if(r=k.startOffset(a.x.location,a.y.location,u.options.snap),k.isDaySlot!==t.isDaySlot)if(k.isDaySlot!==d.isDaySlot){var b=e(t.element).index(),_=e(k.element).parent().children().eq(b);for(t=g._slotByPosition(_.offset().left,_.offset().top),o=t.startOffset(a.x.location,a.y.location,!0),h=f.map((function(e){return e.clone()})),m=0;m<f.length;m++)f[m].isAllDay!=k.isDaySlot&&(f[m].isAllDay=k.isDaySlot,f[m].end=i.date.getDate(f[m].start),f[m].start=i.date.getDate(f[m].start),k.isDaySlot||(i.date.setTime(f[m].start,i.date.getMilliseconds(g.startTime())),i.date.setTime(f[m].end,i.date.getMilliseconds(g.startTime())+g._timeSlotInterval())))}else t=e.extend(!0,{},d),o=c,f=h;for(p=r-o,m=0;m<f.length;m++)g._updateMoveHint(f[m],k.groupIndex,p);if(v=de(l,p),u.trigger("move",{event:s,slot:{element:k.element,start:k.startDate(),end:k.endDate(),isDaySlot:k.isDaySlot},resources:g._resourceBySlot(k),start:v.start,end:v.end}))for(m=0;m<f.length;m++)g._updateMoveHint(f[m],k.groupIndex,p);else n=k}})).bind("dragend",(function(t){u.view()._removeMoveHint();var c=r-o,p=de(l,c),v=p.start,m=p.end;u._dragging=!1;var g=u.view()._resourceBySlot(n);if(!u.trigger("moveEnd",{event:s,slot:{element:n.element,start:n.startDate(),end:n.endDate()},start:v,end:m,resources:g})&&(s.start.getTime()!==v.getTime()||s.end.getTime()!==m.getTime()||d.isDaySlot!==n.isDaySlot||i.stringify(g)!==i.stringify(a))){u._isMultiDrag=f.length>1;for(var k=0;k<f.length;k++){var b=f[k];p=de(b,c);var _=u.view()._eventOptionsForMove(b),w=e.extend({isAllDay:b.isAllDay,start:p.start,end:p.end},_,g);u._updateEvent(null,b,w)}u._isMultiDrag&&(u.dataSource.sync(),u._isMultiDrag=!1)}t.currentTarget.removeClass("k-event-active"),this.cancelHold(),f=[],h=[]})).bind("dragcancel",(function(){u.view()._removeMoveHint(),this.cancelHold(),f=[],h=[]})),u._moveDraggable.bind("hold",(function(e){u._isTouch(e)&&(u.element.find(".k-event-active").removeClass("k-event-active"),u.options.selectable&&u._createSelection(e.currentTarget),e.currentTarget.addClass("k-event-active"))})))},_resizable:function(){var t,n,a,o,r,s=this,l=0;function d(e){var t={"k-resize-e":"east","k-resize-w":"west","k-resize-n":"north","k-resize-s":"south"};for(var i in t)if(e.hasClass(i))return t[i]}s._isMobile()&&i.support.mobileOS.android&&(l=5),s._resizeDraggable=new i.ui.Draggable(s.element,{distance:l,filter:".k-resize-handle",autoScroll:!0,dragstart:function(l){var d=e(l.currentTarget).closest(".k-event").attr(i.attr("uid")),c=s.view();s._dragging=!0,a=s.occurrenceByUid(d),o=a.clone(),c._updateEventForResize(o),r=c._slotByPosition(l.x.startLocation,l.y.startLocation),s.trigger("resizeStart",{event:a})&&l.preventDefault(),t=i.date.toUtcTime(o.start),n=i.date.toUtcTime(o.end)},drag:function(l){if(r){var c=d(e(l.currentTarget)),u=s.view(),p=u._slotByPosition(l.x.location,l.y.location);if(p&&r.groupIndex==p.groupIndex){r=p;var f=t,h=n;"south"==c?!r.isDaySlot&&r.end-i.date.toUtcTime(o.start)>=u._timeSlotInterval()&&(n=o.isAllDay?r.startOffset(l.x.location,l.y.location,s.options.snap):r.endOffset(l.x.location,l.y.location,s.options.snap)):"north"==c?!r.isDaySlot&&i.date.toUtcTime(o.end)-r.start>=u._timeSlotInterval()&&(t=r.startOffset(l.x.location,l.y.location,s.options.snap)):"east"==c?r.isDaySlot&&i.date.toUtcTime(i.date.getDate(r.endDate()))>=i.date.toUtcTime(i.date.getDate(o.start))?n=o.isAllDay?r.startOffset(l.x.location,l.y.location,s.options.snap):r.endOffset(l.x.location,l.y.location,s.options.snap):!r.isDaySlot&&r.end-i.date.toUtcTime(o.start)>=u._timeSlotInterval()&&(n=r.endOffset(l.x.location,l.y.location,s.options.snap)):"west"==c&&(r.isDaySlot&&i.date.toUtcTime(i.date.getDate(o.end))>=i.date.toUtcTime(i.date.getDate(r.startDate()))||!r.isDaySlot&&i.date.toUtcTime(o.end)-r.start>=u._timeSlotInterval())&&(t=r.startOffset(l.x.location,l.y.location,s.options.snap)),s.trigger("resize",{event:a,slot:{element:r.element,start:r.startDate(),end:r.endDate()},start:i.timezone.toLocalDate(t),end:i.timezone.toLocalDate(n),resources:u._resourceBySlot(r)})?(t=f,n=h):u._updateResizeHint(o,r.groupIndex,t,n)}}},dragend:function(l){var c=e(l.currentTarget),u=new Date(o.start.getTime()),p=new Date(o.end.getTime()),f=d(c);s._dragging=!1,s.view()._removeResizeHint(),"south"==f?p=i.timezone.toLocalDate(n):"north"==f?u=i.timezone.toLocalDate(t):"east"==f?p=r.isDaySlot?i.date.getDate(i.timezone.toLocalDate(n)):i.timezone.toLocalDate(n):"west"==f&&(r.isDaySlot?((u=new Date(i.timezone.toLocalDate(t))).setHours(0),u.setMinutes(0)):u=i.timezone.toLocalDate(t)),!s.trigger("resizeEnd",{event:a,slot:{element:r.element,start:r.startDate(),end:r.endDate()},start:u,end:p,resources:s.view()._resourceBySlot(r)})&&p.getTime()>=u.getTime()&&(o.start.getTime()==u.getTime()&&o.end.getTime()==p.getTime()||(s.view()._updateEventForResize(a),s._updateEvent(f,a,{start:u,end:p}))),r=null,a=null},dragcancel:function(){s._dragging=!1,s.view()._removeResizeHint(),r=null,a=null}})},_updateEvent:function(e,t,n){var o=this,s=function(t,i){var r;try{o._preventRefresh=!0,t.update(n),o._convertDates(t),r=t.start,e&&t.duration()%a==0&&0===r.getHours()&&0===r.getMinutes()&&0===r.getSeconds()&&0===r.getMilliseconds()&&t.set("isAllDay",!0)}finally{o._preventRefresh=!1}o.trigger(F,{event:t})||(i&&i(),o._isMultiDrag||o.dataSource.sync())},l=function(e){return e.recurrenceRule?o.dataSource.getByUid(e.uid):o.dataSource.get(e.recurrenceId)};if(t.recurrenceRule||t.isOccurrence()){var d=o.options.messages.recurrenceMessages;o._showRecurringDialog(t,(function(){var e,i=l(t),n=i.toOccurrence({start:t.start,end:t.end});e=n.uid,s(o.dataSource.add(n),(function(){o._convertDates(i),o._selection&&o._selection.events.push(e)}))}),(function(){var a=l(t);if("south"==e||"north"==e){if(n.start){var d=i.date.getDate(a.start);i.date.setTime(d,r(n.start)),n.start=d}if(n.end){var c=i.date.getDate(a.end);i.date.setTime(c,r(n.end)),n.end=c}}o.dataSource._removeExceptions(a),s(a)}),{title:d.editWindowTitle,text:d.editRecurring?d.editRecurring:L,occurrenceText:d.editWindowOccurrence,seriesText:d.editWindowSeries})}else s(o.dataSource.getByUid(t.uid))},_modelForContainer:function(t){return t=e(t).closest("["+i.attr("uid")+"]"),this.dataSource.getByUid(t.attr(i.attr("uid")))},showDialog:function(e){this.toolbar.find(".k-focus").removeClass(M),this._editor.showDialog(e)},focus:function(){this.wrapper.trigger("focus")},_confirmation:function(e,t,n){var a=this.options.editable;if(!0===a||!1!==a.confirmation){var o=this.options.messages,r=o.deleteWindowTitle,s=typeof a.confirmation===p?a.confirmation:o.editable.confirmation;if(this._isEditorOpened()&&t.isRecurring()){var l=this.options.messages.recurrenceMessages;r=l.deleteWindowTitle,s=t.isException()||t.isNew()?l.deleteRecurringConfirmation?l.deleteRecurringConfirmation:"Are you sure you want to delete this event occurrence?":l.deleteSeriesConfirmation?l.deleteSeriesConfirmation:"Are you sure you want to delete the whole series?",n&&(r=l.resetSeriesWindowTitle,s=l.resetSeriesConfirmation?l.resetSeriesConfirmation:"Are you sure you want to reset the whole series?")}var d=[{name:"destroy",text:n?o.resetSeries:o.destroy,click:function(){e()}}];this._isMobile()&&i.Pane||d.push({name:"canceledit",text:o.cancel,click:function(){e(!0)}}),this._unbindResize(),this.showDialog({model:t,text:s,title:r,buttons:d}),this._bindResize()}else e()},addEvent:function(e){var t,i=this._editor.editable,n=this.dataSource;e=e||{},!this.trigger("add",{event:e})&&(i&&i.end()||!i)&&(this.cancelEvent(),e&&e.toJSON&&(e=e.toJSON()),(t=n.add(e))&&(this.cancelEvent(),this._editEvent(t)))},saveEvent:function(){var e=this,t=e._editor,i=e.dataSource;if(t){var n,a,o,r=t.editable,s=t.container,l=e._modelForContainer(s);if(s&&r&&r.end()&&!e.trigger(F,{container:s,event:l})){if(!l.isOccurrence()&&l.recurrenceException&&!l.recurrenceRule){for(a=(n=i.data()).length-1;a>=0;a-=1)(o=n[a])&&o.recurrenceId===l.id&&i.remove(o);l.set("recurrenceException","")}l.dirty||l.isOccurrence()||e._convertDates(l,"remove"),i.sync()}}},cancelEvent:function(){var e,t=this._editor,i=t.container;i&&((e=this._modelForContainer(i))&&e.isOccurrence()&&(this._convertDates(e,"remove"),this._convertDates(this.dataSource.get(e.recurrenceId),"remove")),this.dataSource.cancelChanges(e),t.close())},editEvent:function(e){var t="string"==typeof e?this.occurrenceByUid(e):e;t&&(this.cancelEvent(),t.isRecurring()?this._editRecurringDialog(t):this._editEvent(t))},_editEvent:function(e){this._preventRefresh=!0,this._unbindResize(),this._createPopupEditor(e),this.toolbar.find(".k-focus").removeClass(M),this._bindResize()},_editRecurringDialog:function(e){var t=this,i=t.options.messages.recurrenceMessages;t._showRecurringDialog(e,(function(){e.isException()?t._editEvent(e):t.addEvent(e)}),(function(){e.recurrenceId&&(e=t.dataSource.get(e.recurrenceId)),t._editEvent(e)}),{title:i.editWindowTitle,text:i.editRecurring?i.editRecurring:L,occurrenceText:i.editWindowOccurrence,seriesText:i.editWindowSeries})},_showRecurringDialog:function(e,t,i,n){var a=this.options.editable,o=m(a)?a.editRecurringMode:"dialog";"occurrence"===o||this._isMultiDrag?t():"series"===o?i():(this._unbindResize(),this.showDialog({model:e,title:n.title,text:n.text,buttons:[{text:n.occurrenceText,click:t},{text:n.seriesText,click:i}]}),this._bindResize())},_createButton:function(e){var t=e.template||'<button type="button" class="k-button k-button-md k-rounded-md k-button-solid #=className#" #=attr#><span class="k-button-text">#=text#</span></button>',n=typeof e===p?e:e.name||e.text,a={className:"k-scheduler-"+(n||"").replace(/\s/g,""),text:n,attr:""};if(!(n||m(e)&&e.template))throw new Error("Custom commands should have name specified");return m(e)?(e.className&&(e.className+=" "+a.className),"edit"===n&&m(e.text)&&((e=g(!0,{},e)).text=e.text.edit),a=g(!0,a,ne[n],e)):a=g(!0,a,ne[n]),a.className?-1===a.className.indexOf("k-button-solid-primary")&&(a.className+=" k-button-solid-base"):a.className="k-button-solid-base",i.template(t)(a)},_convertDates:function(e,t){var n=this.dataSource.reader.timezone,a=e.startTimezone,o=e.endTimezone,r=e.start,s=e.start;t=t||"apply",a=a||o,o=o||a,a&&(n?"apply"===t?(r=i.timezone.convert(e.start,n,a),s=i.timezone.convert(e.end,n,o)):(r=i.timezone.convert(e.start,a,n),s=i.timezone.convert(e.end,o,n)):(r=i.timezone[t](e.start,a),s=i.timezone[t](e.end,o)),e._set("start",r),e._set("end",s))},_createEditor:function(){var e,t=this;(e=this._isMobile()&&i.Pane?t._editor=new pe(this.wrapper,g({},this.options,{target:this,timezone:t.dataSource.reader.timezone,resources:t.resources,createButton:this._createButton.bind(this)})):t._editor=new fe(this.wrapper,g({},this.options,{target:this,createButton:this._createButton.bind(this),timezone:t.dataSource.reader.timezone,resources:t.resources}))).bind("cancel",(function(e){t.trigger("cancel",{container:e.container,event:e.model})?e.preventDefault():(t._preventRefresh=!1,t.cancelEvent(),t._attemptRefresh&&t.refresh(),t.focus())})),e.bind("edit",(function(e){t.trigger(O,{container:e.container,event:e.model})&&e.preventDefault()})),e.bind("save",(function(){t._preventRefresh=!1,t.saveEvent()})),e.bind("remove",(function(e){t._preventRefresh=!1,t.removeEvent(e.model)})),e.bind("resetSeries",(function(e){t._confirmation((function(i){t._preventRefresh=!1,i||(t.dataSource._removeExceptions(e.model),t.saveEvent())}),e.model,!0)}))},_createPopupEditor:function(e){var t=this._editor;e.isNew()&&!e.isOccurrence()||(e.isOccurrence()&&this._convertDates(e.recurrenceId?this.dataSource.get(e.recurrenceId):e),this._convertDates(e)),this.editable=t.editEvent(e)},removeEvent:function(e){var t=this,i="string"==typeof e?t.occurrenceByUid(e):e;i&&(i.isRecurring()?t._deleteRecurringDialog(i):t._confirmation((function(e){e||t._removeEvent(i)}),i))},occurrenceByUid:function(e){var t=this.dataSource.getByUid(e);return t||(t=G(this._data,e)),t},occurrencesInRange:function(e,t){return new i.data.Query(this._data).filter({logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:e},{field:"end",operator:"gte",value:e},{field:"start",operator:"lt",value:t}]},{logic:"and",filters:[{field:"start",operator:"lte",value:e},{field:"end",operator:"gt",value:e}]}]}).toArray()},_removeEvent:function(e){this.trigger(V,{event:e})||this.dataSource.remove(e)&&this.dataSource.sync()},_deleteRecurringDialog:function(e){var t,i,n,a,o,r,s=this,l=e,d=s.options.editable,c=m(d)?d.editRecurringMode:"dialog";t=function(){var e=l.recurrenceId?l:l.toOccurrence(),t=s.dataSource.get(e.recurrenceId);s._convertDates(t),s._removeEvent(e)},i=function(){l.recurrenceId&&(l=s.dataSource.get(l.recurrenceId)),s._removeEvent(l)},n=function(){s.dataSource.remove(l),s.dataSource.sync()},("dialog"!=c||s._isEditorOpened())&&(a=function(){s._confirmation((function(e){e||t()}),l)},o=function(){s._confirmation((function(e){e||i()}),l)},r=function(){s._confirmation((function(e){e||n()}),l)});var u=o||i,p=a||t,f=r||n;if(s._isEditorOpened())e.isException()?p():e.isNew()?f():u();else{var h=s.options.messages.recurrenceMessages;s._showRecurringDialog(e,p,u,{title:h.deleteWindowTitle,text:h.deleteRecurring?h.deleteRecurring:"Do you want to delete only this event occurrence or the whole series?",occurrenceText:h.deleteWindowOccurrence,seriesText:h.deleteWindowSeries})}},_isEditorOpened:function(){return!!this._editor.container},_unbindView:function(e){var t=this;t.angular("cleanup",(function(){return{elements:t.items()}})),e.destroy()},_bindView:function(t){var i=this;i.options.editable&&(i._viewRemoveHandler&&t.unbind(V,i._viewRemoveHandler),i._viewRemoveHandler=function(e){i.removeEvent(e.uid)},t.bind(V,i._viewRemoveHandler),i._viewAddHandler&&t.unbind("add",i._viewAddHandler),i._viewAddHandler=function(e){i.addEvent(e.eventInfo)},t.bind("add",this._viewAddHandler),i._viewEditHandler&&t.unbind(O,i._viewEditHandler),i._viewEditHandler=function(e){i.editEvent(e.uid)},t.bind(O,this._viewEditHandler)),i._viewNavigateHandler&&t.unbind("navigate",i._viewNavigateHandler),i._viewNavigateHandler=function(e){if(e.action)i.trigger("navigate",{view:e.view,isWorkDay:e.isWorkDay,action:e.action,date:e.date})||i.date(e.date);else if(e.view){var t="isWorkDay"in e,n=t?"changeWorkDay":"changeView";i.trigger("navigate",{view:e.view,isWorkDay:e.isWorkDay,action:n,date:e.date})||(t&&(i._workDayMode=e.isWorkDay),i._selectView(e.view),i.date(e.date))}},t.bind("navigate",i._viewNavigateHandler),i._viewActivateHandler&&t.unbind("activate",i._viewActivateHandler),i._viewActivateHandler=function(){i._selection&&(this.constrainSelection(i._selection),0===e(document.activeElement).closest(".k-scheduler-toolbar").length&&(document.activeElement!==i.wrapper[0]?i.element.focus():i._select()),i._adjustSelectedDate())},t.bind("activate",i._viewActivateHandler)},_selectView:function(e){var t=this;if(e&&t.views[e])if(t._selectedView&&t._unbindView(t._selectedView),t._selectedView=t._renderView(e),t._selectedViewName=e,t._viewsCount>1&&!t._isMobile()){var n=t.toolbar.find(".k-views-dropdown"),a=t.toolbar.find(".k-scheduler-views > .k-button");0===t.toolbar.find(".k-views-dropdown").length&&(t.toolbar.find(".k-scheduler-views-wrapper").prepend(U({views:t.views,view:e,ns:i.ns,label:t.options.messages.selectView})),n=t.toolbar.find(".k-views-dropdown")),n.val(e),a.removeClass("k-selected"),a.filter(".k-view-"+e.replace(/\./g,"\\.").toLowerCase()).addClass("k-selected")}else{t.toolbar.find(".k-scheduler-mobile-views").find("[value="+e.replace(/\./g,"\\.")+"]").prop("selected","selected")}},view:function(e){var t=this;return e?("year"===e?t.wrapper.removeAttr("tabindex"):t.wrapper.attr("tabindex",0),t._selectView(e),void t.rebind()):t._selectedView},viewName:function(){return this.view().name},_renderView:function(e){var t=this._initializeView(e);return this._bindView(t),(i.support.mouseAndTouchPresent||i.support.pointers)&&(t.content.css("-ms-touch-action","pinch-zoom"),t.content.css("touch-action","pinch-zoom")),this._model.set("formattedDate",t.dateForTitle()),this._model.set("formattedShortDate",t.shortDateForTitle()),this._model.set("formattedMobileDate",t.mobileDateForTitle?t.mobileDateForTitle():t.shortDateForTitle()),this._model.set("formattedYear",i.format("{0:yyyy}",t.startDate())),t},resize:function(e){var t=this.getSize(),i=this._size,n=this.view();n&&n.groups&&(!e&&i&&t.width===i.width&&t.height===i.height||(this.refresh({action:"resize"}),this._size=t))},_adjustSelectedDate:function(){var e=this._model.selectedDate,t=this._selection,n=t.start;n&&!i.date.isInDateRange(e,o(n),o(t.end))&&e.setFullYear(n.getFullYear(),n.getMonth(),n.getDate())},_initializeView:function(e){var t=this.views[e];if(t){var n=m(t),a={},o=t.type;if(typeof o===p&&(o=i.getter(t.type)(window)),n&&t.workDays&&t.workDays.length&&(a.workDays=t.workDays),!o)throw new Error("There is no such view");t=new o(this.wrapper,function(e,t){for(var i in delete e.name,delete e.prefix,delete e.remove,delete e.edit,delete e.add,delete e.navigate,t)e[i]=t[i];return e}(g(!0,{},this.options,n?t:{},{resources:this.resources,date:this.date(),startTime:i.parseDate(t.startTime)||i.parseDate(this.options.startTime),endTime:i.parseDate(t.endTime)||i.parseDate(this.options.endTime),showWorkHours:this._workDayMode}),a))}return t},_views:function(){var e,t,i,n,a,o,r,s=this.options.views;for(this.views={},this._viewsCount=0,o=0,r=s.length;o<r;o++){var l=!1;e=s[o],(n=m(e))?typeof(a=e.type?e.type:e)!==p&&(a=e.name||e.title,l=!0):(a=e,e={}),(t=ve[a])&&!l&&(e.type=t.type,t.title=this.options.messages.views[a],"day"===t.type?t.messages={allDay:this.options.messages.allDay}:"agenda"===t.type&&(t.messages={event:this.options.messages.event,date:this.options.messages.date,time:this.options.messages.time})),e=g({title:a},t,n?e:{}),a&&(this.views[a]=e,this._viewsCount++,i&&!e.selected||(i=a))}i&&(this._selectedViewName=i)},rebind:function(){var t=this,i=t.resources,n=[];t._preventRebind?t._preventRebind=!1:!1===t.options.autoBind&&i&&i.length>0?(i.forEach((function(e){0===e.dataSource.data().length&&(t._preventRebind=!0,n.push(e.dataSource.fetch()))})),e.when.apply(null,n).then((function(){t.dataSource.fetch(),t._preventRebind=!1}))):t.dataSource.fetch()},_dataSource:function(){var e=this,t=e.options,n=t.dataSource;n=b(n)?{data:n}:n,!t.timezone||n instanceof ie?n instanceof ie&&(t.timezone=n.options.schema?n.options.schema.timezone:""):n=g(!0,n,{schema:{timezone:t.timezone}}),e.dataSource&&e._refreshHandler?e.dataSource.unbind(x,e._refreshHandler).unbind(E,e._progressHandler).unbind(R,e._errorHandler):(e._refreshHandler=e.refresh.bind(e),e._progressHandler=e._requestStart.bind(e),e._errorHandler=e._error.bind(e)),e.dataSource=i.data.SchedulerDataSource.create(n).bind(x,e._refreshHandler).bind(E,e._progressHandler).bind(R,e._errorHandler),e.options.dataSource=e.dataSource},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_progress:function(e){var t=this.element.find(".k-scheduler-content");i.ui.progress(t,e)},_resources:function(){for(var t=this,i=t.options.resources,n=[],a=0;a<i.length;a++){var o=i[a],r=o.field,s=o.name||r,l=o.dataSource;if(!r||!l)throw new Error('The "field" and "dataSource" options of the scheduler resource are mandatory.');t.resources.push({field:r,name:s,title:o.title||r,dataTextField:o.dataTextField||"text",dataValueField:o.dataValueField||"value",dataColorField:o.dataColorField||"color",dataParentValueField:o.dataParentValueField||"parentValue",valuePrimitive:null==o.valuePrimitive||o.valuePrimitive,multiple:o.multiple||!1,dataSource:t._resourceDataSource(l,s,n)})}t.options.autoBind?e.when.apply(null,n).then((function(){t.view(t._selectedViewName)})):t._selectView(t._selectedViewName)},_resourceDataSource:function(e,t,n){var a=this,o=b(e)?{data:e}:e,r=i.data.DataSource.create(o);return a.options.autoBind?n.push(r.fetch((function(){a._bindResourceEvents(this,t)}))):a._bindResourceEvents(r,t),r},_bindResourceEvents:function(e,t){var i=this,n=i.options.group&&i.options.group.resources.length&&i.options.group.resources.indexOf(t)>-1;!i._resourceRefreshHandler&&n&&(i._resourceRefreshHandler=i._refreshResource.bind(i),i._resourceErrorHandler=i._error.bind(i)),n&&e.bind(x,i._resourceRefreshHandler).bind(R,i._resourceErrorHandler)},_refreshResource:function(){var e=this;e._editor&&e._editor.editable||e._preventRefresh||e.view(e._selectedViewName)},_initModel:function(){var e=this;e._model=i.observable({selectedDate:new Date(this.options.date),formattedDate:"",formattedShortDate:""}),e._model.bind(x,(function(t){"selectedDate"===t.field&&e.view(e._selectedViewName)}))},_wrapper:function(){var e=this,t=e.options,i=t.height,n=t.width;e.wrapper=e.element.addClass("k-widget k-scheduler k-floatwrap"),e._isMobile()&&e.wrapper.addClass("k-scheduler-mobile"),i&&e.wrapper.height(i),n&&e.wrapper.width(n)},date:function(e){return null!=e&&o(e)>=o(this.options.min)&&o(e)<=o(this.options.max)&&this._model.set("selectedDate",e),o(this._model.get("selectedDate"))},_toolbar:function(){var t=this,n=t.options,a=[];n.toolbar&&(a=Array.isArray(n.toolbar)?n.toolbar:[n.toolbar]);var o=this._isMobile()?q:K,r=e(o({messages:n.messages,pdf:e.grep(a,(function(e){return"pdf"==e||"pdf"==e.name})).length>0,search:e.grep(a,(function(e){return"search"==e||"search"==e.name})).length>0,ns:i.ns,view:t._selectedViewName,views:t.views,viewsCount:t._viewsCount,editable:t.options.editable}));t.wrapper.append(r),t.toolbar=r,i.bind(t.toolbar,t._model),r.on(w+_,".k-pdf",(function(e){e.preventDefault(),t.saveAsPDF()})),r.on("input"+_,".k-scheduler-search-input",i.throttle((function(e){t.dataSource.filter({logic:"or",filters:[{field:"title",operator:"contains",value:e.target.value},{field:"description",operator:"contains",value:e.target.value}]})}),250)),r.on(w+_,".k-create-event",(function(e){e.preventDefault(),t.addEvent()})),r.on(w+_,".k-nav-calendar",(function(e){e.preventDefault(),t._showCalendar(e.target)})),r.on(w+_,".k-scheduler-navigation > .k-button",(function(n){var a=e(this),o=new Date(t.date()),r="",s=new Date,l=t.options.timezone;if(t.toolbar.find(".k-focus").removeClass(M),a.addClass(M).attr("tabindex",0).trigger("focus").attr("tabindex",-1),!e(n.target).is("input")){if(n.preventDefault(),a.hasClass("k-nav-today"))if(r="today",l){var d=i.timezone.offset(s,l);o=i.timezone.convert(s,s.getTimezoneOffset(),d)}else o=s;else a.hasClass("k-nav-next")?(r="next",o=t.view().nextDate()):a.hasClass("k-nav-prev")&&(r="previous",o=t.view().previousDate());t.trigger("navigate",{view:t._selectedViewName,action:r,date:o})||t.date(o)}})),r.on(w+_,".k-nav-current",(function(i){i.preventDefault(),t.toolbar.find(".k-focus").removeClass(M),e(this).addClass(M),t._isMobile()||t._showCalendar()})),r.on(w+_,".k-scheduler-views > .k-button, .k-scheduler-refresh",(function(n){n.preventDefault();var a=e(this).attr(i.attr("name"));t.toolbar.find(".k-focus").removeClass(M),e(this).addClass(M).attr("tabindex",0).trigger("focus").attr("tabindex",-1),t.trigger("navigate",{view:a,action:"changeView",date:t.date()})||t.view(a)})),r.on(x+_,".k-views-dropdown, .k-scheduler-mobile-views",(function(){var e=this.value;t.trigger("navigate",{view:e,action:"changeView",date:t.date()})||t.view(e)}))},_showCalendar:function(t){var i=this,n=t||i.toolbar.find(".k-nav-current"),a=e('<div class="k-calendar-container"><div class="k-scheduler-calendar"></div></div>');i.popup||(i.popup=new f(a,{anchor:n,activate:function(){i.popup&&i.calendar&&(i.popup._toggleResize(!1),i.calendar.element.find("table").trigger("focus"),i.popup._toggleResize(!0))},open:function(){i.calendar||(i.calendar=new h(this.element.find(".k-scheduler-calendar"),{change:function(){var e=this.value();i.trigger("navigate",{view:i._selectedViewName,action:"changeDate",date:e})||(i.date(e),i.popup.close()),i._isMobile()||(i._selectedView.element.trigger("focus"),i.toolbar.find(".k-nav-current").trigger("focus").addClass(M))},min:i.options.min,max:i.options.max})),i.calendar.element.on("keydown"+_,(function(e){e.keyCode!==l.ESC&&e.keyCode!==l.TAB||(i.popup.close(),i._selectedView.element.trigger("focus"),i.toolbar.find(".k-nav-current").trigger("focus").addClass(M))})),i.calendar.setOptions({start:"year"===i._selectedViewName?"decade":"month",depth:"year"===i._selectedViewName?"decade":"month"}),i.calendar.value(i.date())},copyAnchorStyles:!1})),i.popup.open()},refresh:function(e){var t=this,i=this.view(),n=e&&"itemchange"===e.action&&(this._editor.editable||this._preventRefresh)||"signalr"===this.dataSource.options.type&&this._preventRefresh;this._progress(!1),this.angular("cleanup",(function(){return{elements:t.items()}})),e=e||{},i&&(n?this._attemptRefresh="signalr"===this.dataSource.options.type:this.trigger("dataBinding",{action:e.action||"rebind",index:e.index,items:e.items})||(e&&"resize"===e.action||!this._editor||this._editor.close(),this._data=this.dataSource.expand(i.startDate(),i.visibleEndDate()),i.refreshLayout(),i.render(this._data),this.trigger("dataBound"),this._attemptRefresh=!1))},slotByPosition:function(e,t){var i=this.view();if(!i._slotByPosition)return null;var n=i._slotByPosition(e,t);return n?{startDate:n.startDate(),endDate:n.endDate(),groupIndex:n.groupIndex,element:n.element,isDaySlot:n.isDaySlot}:null},slotByElement:function(t){var i=e(t),n=i.offset(),a=i.width(),o=i.height(),r=n.left+a/2,s=n.top+o/2;n=e(t).offset();return this.slotByPosition(r,s)},resourcesBySlot:function(e){return this.view()._resourceBySlot(e)}}),ve={day:{type:"kendo.ui.DayView"},week:{type:"kendo.ui.WeekView"},workWeek:{type:"kendo.ui.WorkWeekView"},agenda:{type:"kendo.ui.AgendaView"},month:{type:"kendo.ui.MonthView"},timeline:{type:"kendo.ui.TimelineView"},timelineWeek:{type:"kendo.ui.TimelineWeekView"},timelineWorkWeek:{type:"kendo.ui.TimelineWorkWeekView"},timelineMonth:{type:"kendo.ui.TimelineMonthView"},year:{type:"kendo.ui.YearView"}};if(d.plugin(he),i.PDFMixin){i.PDFMixin.extend(he.prototype);var me="k-scheduler-pdf-export";he.fn._drawPDF=function(t){var i=this.wrapper,n=i[0].style.cssText;i.css({width:i.width(),height:i.height()}),i.addClass(me);var a=this,o=new e.Deferred,r=i.find(".k-scheduler-content").find("table").css("table-layout","auto");return setTimeout((function(){r.css("table-layout","fixed"),a.resize(!0),a._drawPDFShadow({},{avoidLinks:a.options.pdf.avoidLinks}).done((function(e){var i={page:e,pageNumber:1,progress:1,totalPages:1};t.notify(i),o.resolve(i.page)})).fail((function(e){o.reject(e)})).always((function(){i[0].style.cssText=n,i.removeClass(me),a.resize(!0),a.resize(!0)}))})),o}}var ge=c.extend({init:function(e,t){var n=this,a=i.timezone.windows_zones;if(!a||!i.timezone.zones_titles)throw new Error("kendo.timezones.min.js is not included.");c.fn.init.call(n,e,t),n.wrapper=n.element,n._zonesQuery=new i.data.Query(a),n._zoneTitleId=i.guid(),n._zoneTitlePicker(),n._zonePicker(),n._zoneTitle.bind("cascade",(function(){this.value()||n._zone.wrapper.hide()})),n._zone.bind("cascade",(function(){n._value=this.value(),n.trigger(x)})),n.value(n.options.value)},options:{name:"TimezoneEditor",value:"",optionLabel:"No timezone"},events:[x],_zoneTitlePicker:function(){var t=this,n=e('<input id="'+t._zoneTitleId+'" aria-label="'+t.options.title+'"/>').appendTo(t.wrapper);t._zoneTitle=new i.ui.DropDownList(n,{dataSource:i.timezone.zones_titles,dataValueField:"other_zone",dataTextField:"name",optionLabel:t.options.optionLabel})},_zonePicker:function(){var t=this,n=e('<input aria-label="'+t.options.title+'"/>').appendTo(this.wrapper);t._zone=new i.ui.DropDownList(n,{dataValueField:"zone",dataTextField:"territory",dataSource:t._zonesQuery.data,cascadeFrom:t._zoneTitleId,dataBound:function(){t._value=this.value(),this.wrapper.toggle(this.dataSource.view().length>1)}}),t._zone.wrapper.hide()},destroy:function(){c.fn.destroy.call(this),i.destroy(this.wrapper)},value:function(e){var i,n=this;if(e===t)return n._value;(i=n._zonesQuery.filter({field:"zone",operator:"eq",value:e}).data[0])?(n._zoneTitle.value(i.other_zone),n._zone.value(i.zone)):n._zoneTitle.select(0)}});d.plugin(ge);var ke=i.template('<option value="#=other_zone#">#=name#</option>'),be=i.template('<option value="#=zone#">#=territory#</option>'),_e=c.extend({init:function(e,t){var n=this,a=i.timezone.windows_zones;if(!a||!i.timezone.zones_titles)throw new Error("kendo.timezones.min.js is not included.");c.fn.init.call(n,e,t),n.wrapper=n.element,n._zonesQuery=new i.data.Query(a),n._zoneTitlePicker(),n._zonePicker(),n.value(n.options.value)},options:{name:"MobileTimezoneEditor",optionLabel:"No timezone",value:""},events:[x],_bindZones:function(e){var t=e?this._filter(e):[];this._zone.html(this._options(t,be))},_filter:function(e){return this._zonesQuery.filter({field:"other_zone",operator:"eq",value:e}).data},_options:function(e,t,i){var n=0,a="",o=e.length;for(i&&(a+=t({other_zone:"",name:i}));n<o;n++)a+=t(e[n]);return a},_zoneTitlePicker:function(){var t=this,n=t._options(i.timezone.zones_titles,ke,t.options.optionLabel);t._zoneTitle=e("<select>"+n+"</select>").appendTo(t.wrapper).on("change",(function(){var e=this.value,i=t._zonePickerLabel,n=i.find("select");t._bindZones(e),e&&n.children().length>1?i.show():i.hide(),t._value=t._zone[0].value,t.trigger(x)}))},_zonePicker:function(){var t=this;t._zonePickerLabel=e("<li class='k-item k-listgroup-item k-zonepicker' style='display:none'><label class='k-label k-listgroup-form-row'><span class='k-item-title k-listgroup-form-field-label'></span><div class='k-listgroup-form-field-wrapper'></div></label></li>"),t._zone=e("<select></select>").appendTo(t._zonePickerLabel.find("div")).on("change",(function(){t._value=this.value,t.trigger(x)})),this.wrapper.closest(".k-item").after(t._zonePickerLabel),t._bindZones(t._zoneTitle.val()),t._value=t._zone[0].value},destroy:function(){c.fn.destroy.call(this),i.destroy(this.wrapper)},value:function(e){var i,n=this,a=n._zone,o="",r="";if(e===t)return n._value;(i=n._zonesQuery.filter({field:"zone",operator:"eq",value:e}).data[0])&&(r=i.zone,o=i.other_zone),n._zoneTitle.val(o),n._bindZones(o),a.val(r),(r=a[0].value)&&a.children.length>1?n._zonePickerLabel.show():n._zonePickerLabel.hide(),n._value=r}});d.plugin(_e)}(window.kendo.jQuery)}));
//# sourceMappingURL=kendo.scheduler.min.js.map
