{"version":3,"file":"kendo.spreadsheet.min.js","names":["factory","define","amd","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","$","window","LRUCache","Class","size","_size","_length","_map","put","key","value","map","entry","_head","_tail","newer","older","get","REPLACE_REGEX","normalizeText","text","String","replace","objectKey","object","parts","sort","join","hashKey","str","hash","i","charCodeAt","defaultMeasureBox","DEFAULT_OPTIONS","baselineMarkerSize","document","createElement","style","cssText","TextMetrics","_cache","measure","width","height","baseline","cacheKey","cachedResult","measureBox","box","baselineMarker","_baselineMarker","cloneNode","textStr","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","current","measureText","jQuery","now","Date","getTime","renderPos","pos","result","toHyphens","split","renderSize","sqr","romanToArabic","r","toLowerCase","digits","v","x","l","c","d","m","prev","charAt","arabicToRoman","n","literals","values","roman","shift","memoize","f","cache","Object","create","arguments$1","arguments","id","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","withExit","obj","Return","ex","RegExp","STRING","fromCharCode","ENTITIES","amp","lt","gt","quot","apos","nbsp","CODE","out","UCS2","code","START_CDATA","END_CDATA","END_COMMENT","START_COMMENT","END_SHORT_TAG","END_TAG","END_DECLARATION","QUESTION_MARK","LESS_THAN","GREATER_THAN","SEMICOLON","EQUAL","AMPERSAND","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","EXIT","parse$2","data","callbacks","index","is","selector","j","$tag","exit","readChar","croak","msg","Error","readWhile","pred","a","readAsciiWhile","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlTag","name","attrs","xmlName","xmlAttrs","xmlComment","xmlEntity","xmlContent","pop","xmlString","quote","parseInt","isNaN","undefined","what","thing","arg1","arg2","tmp","parseXML","COMMAND_TYPES","Command","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","select","exec","setState","getState","state","rejectState","validationState","title","message","reason","type","_forEachCell","callback","_ref","forEach","ref","sheet","toRangeRef","bind","usesImage","DrawingUpdateCommand","_sheet","_drawing","drawing","_orig","clone","_previous","previous","reset","_activeDrawing","triggerChange","layout","img","image","DrawingCommand","InsertImageCommand","_blob","blob","_width","_height","aspect","Math","min","addDrawing","topLeftCell","topLeft","offsetX","offsetY","opacity","addImage","removeDrawing","DeleteDrawingCommand","ReorderDrawingsCommand","_origIndex","_drawings","indexOf","splice","_newIndex","_reorder","drawings","BringToFrontCommand","SendToBackCommand","TargetValueCommand","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","PropertyChangeCommand","prototype","skipHiddenCells","enable","ClearContentCommand","rowValues","nullValues","currentRange","canEditArrayFormula","refs","concat","row","changeType","clearContent","_getValidationState","cell","EditCommand","_editRange","arrayFormula","activeCellSelection","withCultureDecimals","_exec","editRange","input","wrap","_adjustRowHeight","calc","ParseError","InsertCommentCommand","TextWrapCommand","forEachRow","_rowHeight","AdjustDecimalsCommand","_delta","delta","formatting","batch","forEachCell","col","format","adjustDecimals","BorderChangeCommand","_type","border","_style","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","recalc","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","parse","_event","event","_clipboardContent","_content","activeSheet","selection","pasteRef","_targetRangeRefs","UnionRef","status","canPaste","menuInvoked","pasteOnMerged","pasteOnDisabled","preventDefault","clipboardContent","_processPaste","_adjustPasteTarget","multipliers","sourceRows","sourceCols","refToSelect","rangeToSelect","multiplier","that","targetRangeRefs","RangeRef","cols","b","topLeftA","topLeftB","sourceData","_targetRanges","bottomRight","_rows","_count","_columns","resize","max","_populateTargetRange","_targetRangeDimensions","targetRangeRows","targetRangeCols","rowsMultiplier","colsMultiplier","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","support","paste","_view","focus","execCommand","CutCommand","_eventType","currentRow","canCopy","multiSelection","cut","copy","CopyCommand","noop","ToolbarCopyCommand","AutoFillCommand","origin","_origin","autoFillData","intersectingArrayFormula","_previewFillFrom","props","dest","_properties","Range","FillError","ToolbarCutCommand","cannotUndo","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","ApplyFilterCommand","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","DeleteCommand","_expandedRange","_expand","_indexes","_undoOne","_restoreModifiedFormulas","formulas","isValue","DeleteRowCommand","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","AddCommand","_pos","count","base","AddColumnCommand","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","NameCommand","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","FormulaBar","ui","Widget","addClass","classNames","wrapper","prependTo","formulaBarWidth","formulaInput","FormulaInput","appendTo","destroy","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","attr","css","autoScale","on","scale","_highlightedRefs","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","div","sel","getSelection","lookup","focusNode","focusOffset","anchorNode","anchorOffset","begin","end","collapsed","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","setPos","eiv","createRange","setStart","setEnd","getRangeAt","startOffset","endOffset","startContainer","endContainer","removeAllRanges","addRange","len","el","home","runtime","FUNCS","toUpperCase","formulaSource","DataSource","list","StaticList","listWrapper","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","tokenCtx","_tokenContext","_mute","activeToken","token","completion","ctx","nextToken","_replaceAt","popup","close","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_sync","_focusTimeout","ev","browser","msie","clipboardData","getData","originalEvent","val","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","point","tok","tokens","tokenize","touches","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","_canInsertRef","strictMode","canReplace","afterPoint","canInsertBetween","isOpenParen","refAtPoint","simplify","relative","isMerged","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","html","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","open","isMatchingParen","reverse","htmlEncode","substring","insertNewline","eof","Mac","navigator","platform","EventListener","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","touchProxy","touch","threshold","_pressLocation","documentElement","altKey","handleEvent","isAlphaNum","rightClick","which","button","pageX","y","pageY","dx","dy","sqrt","eventKey","mod","metaKey","ctrlKey","shiftKey","catchAllHandler","RangeTreeNode","level","NilNode","skew","temp","insert","start","remove","diff","heir","intersects","RangeTree","root","findrange","intersecting","ranges","tree","first","last","RangeList","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","Iterator","toJSON","fromJSON","unique","at","SparseRangeList","_defaultValue","lastRangeStart","ValueRange","Property","set","dst","JsonProperty","JSON","stringify","ValueProperty","formats","dateToNumber","culture","calendar","patterns","limitPrecision","cloneFormulaValue","deepClone","cloneFormulaTree","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","formula","_resize","new_rows","new_cols","old_rows","cell_count","scaleIndex","scaleNode","si","prop","iter","iterators","reduce","ret","hBorders","leftBorders","rightBorders","addBorder","forEachProperty","ALL_PROPERTIES","spreadsheet$8","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref$4","hasSheet","_hasSheet","absolute","adjust","toString","intersect","NULL$1","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","r1","r2","CellRef$5","RangeRef$4","UnionRef$3","single","refs1","refs2","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","valid","renameSheet","oldSheetName","newSheetName","display","NameRef$3","trow","tcol","abs","arow","acol","forRow","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","limit","num","move","tr","u","empty","theRef","newRefs","NULLREF","SHEETREF","FIRSTREF","Ref","NameRef","CellRef","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","lower","further","bottomLeft","topRight","EdgeNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","SheetNavigator","autoFillCalculator","colEdge","columnRange","rowEdge","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","selectDrawingForContextMenu","modifySelection","action","scrollInto","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","nextUntil","makeWordMovement","prevUntil","newSelection","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","selTopLeft","selBottomRight","isFirstCell","isLastCell","setSelection","currentNavigationRange","done","navigatedAway","singleCellSelection","focusNextElement","nextNavigationRange","find","previousNavigationRange","shouldSkip","extendSelection","resizeAutoFill","isHiddenRow","isHiddenColumn","forEachMergedCell","merged","hint","_autoFillOrigin","punch","preview","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","isCol","firstVal","advanced","hidden","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hideColumn","hasRight","hasLeft","hideRow","hasBottom","hasTop","unhideColumn","unhideRow","selectedRows","Clipboard","_externalContent","_internalContent","iframe","className","setAttribute","_uid","guid","intersectsMerged","origRef","plain","destination","originActiveCell","rowDelta","colDelta","external","isExternal","_isInternal","newState","setStateData","ri","ci","parseTSV","doc","contentWindow","write","table","querySelector","richState","Matrix","vBorders","td","rowSpan","colSpan","getAttribute","ignoreColspan","cellState","mergedCells","dr","dc","parseHTML","rowData","colData","internalHTML","internalPlain","foreign","stripStyle","getComputedStyle","borders","color","borderObject","fontSize","background","italic","bold","textAlign","verticalAlign","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","partition","_set","noTrigger","topLeftRef","_get","_resizedRef","existingFormat","compile","existingFormatType","currency","editorChange","isInEditMode","OUT","t1","numberToDate","_useCultureDecimals","numberFormat","_","__","setArrayFormulaRange","_forFormulas","arrayFormulaRange","intersection","_validation","_merge","mergedRef","vi","isAutofill","setProp","propName","propValue","isFilteredRow","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","_getMergedCells","primary","secondary","cant","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","sum","textHeight","getTextHeight","fontFamily","hasValue","defStyle","_defaultCellStyle","flag","draw","predicate","each","calc$4","spreadsheet$7","exports$3","Class$1","Ref$3","CellRef$4","RangeRef$3","UnionRef$2","NULL","CalcError$2","Context","ss","parent","resolve","resolveCells","_resolve","error","isArray","asMatrix","limitPrecision$1","_arrayArg","onFormula","context","add","getRefCells","pending","cellValues","wantNulls","getRefData","Matrix$1","fetchName","nameValue","Formula$1","ValidationFormulaContext","force","func","fname","args","bool","line","h","isRange","Number","hiddenInfo","getNA","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","t","inverse","augment","imax","argmax","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","affectedSheet","operation","formulaRow","formulaCol","formulaSheet","formulaMoves","newFormulaRow","newFormulaCol","prevRefs","newRef","sameRef","prevRange","constructor","compileArgumentChecks","functionName","forced","arrayArgs","main","haveForced","canBeArrayArg","hasArrayArgs","comp","cond","allowError","typeCheck","Function","forceNum","round","err","toPrecision","withErrorHandling","defineFunction$2","log","console","check","doit","xargs","arrays","kendoSpreadsheetArgs","argsAsync","makeCallback","dateToJulianDays","co","th","comatrix","thmatrix","elmatrix","BASE_DATE","DAYS_IN_MONTH","ORDINAL_ADD_DAYS","isLeapYear$1","yr","daysInMonth$2","mo","unpackDate$2","serial","jd","year","month","date","day","ord","packDate$2","MS_IN_MIN","MS_IN_HOUR","unpackTime","frac","ms","hours","minutes","seconds","milliseconds","serialToDate","packTime","hh","mm","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","CalcError","packDate","unpackDate","daysInMonth","validDate","da","isLeapYear","daysInYear","parseDate","makeDateFormat","parseExactDate","defineFunction","defineAlias","alias","orig","kendoSpreadsheetAliases","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","equals","binaryCompare","pow","$$2","spreadsheet$6","exports$2","calc$3","DATE_FORMAT","from","to","dataType","comparerType","allowNulls","fromIsDateValue","toIsDateValue","showButton","fromIsListValue","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","from_value","to_value","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","_getListData","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","validationHandler","parseFormula","validationComparers","custom","valueToCompare","toValue","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","pane","_currentView","Sheet","_reinit","headerHeight","headerWidth","defaultCellStyle","Axis","_filteredRows","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","newRows","newCols","oldRows","oldCols","_resizeAddRow","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","_valueChanged","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forValidations","adjustNames","skipDataSourceInsert","nextRef","isEnabledRow","skipDataSourceDelete","isEnabledColumn","_filterRow","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","resizeHintPosition","handlePosition","resizeHandlePosition","_visualRange","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","startDragging","completeDragging","drag","drawingBoundingBox","indexVisible","refBox","refBoundingBox","dragging","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEdit","_setFormulaSelections","_viewActiveCell","positions","viewSelection","hyperlinks","clearDefaultStyle","src","parseColor","toCss","json","_sort","_compileFormula","_compileValidation","Drawing","activeCellRef","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","useCultureDecimals","dot","withDecimalSeparator","Rectangle","drw","outerWidth","_outerWidth","DOT","EMPTYCHAR","SheetsBar","sheetsBarWrapper","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","sheetsBarRemove","_onSheetRemove","_onSheetSelect","sheetsBarActive","_createEditor","sheetsBarAdd","_onAddSelect","scrollable","distance","_editor","_renderSheets","_selectedIndex","sheetsBarEditor","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","sheetsBarScrollable","sheetsBarSheetsWrapper","_toggleScrollButtons","ul","_sheetsGroup","scrollLeft","sheetsBarPrev","sheetsBarNext","scrollWidth","scrollPrevButton","scrollNextButton","sheetsWrapper","stopPropagation","_nowScrollingSheets","_scrollSheetsByDelta","renderScrollButtons","idx","sheetElements","isSelectedSheet","sheetsBarKItem","elementContent","sheetsBarKActive","sheetsBarInactive","sheetsBarKTextbox","maxlength","sheetsBarKLink","deleteIcon","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKIconX","itemsWrapper","childrenElements","sheetsBarKReset","baseButtonClass","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","children","sheetsBarItems","Sortable","container","animation","ignore","draggable","sheetsBarHintWrapper","sheetsBarKResetItems","closest","oldIndex","newIndex","removedSheetName","closeCallback","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","sheetsBarKButtonDefaults","sheetsBarKIconPlus","item","itemPosition","sheetsGroup","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","finish","animate","scrLeft","sheetsBarKSprite","ops","util$2","spreadsheet$5","Ref$2","RangeRef$2","CellRef$3","NameRef$2","exports$1","runtime$4","OPERATORS_STANDARD","OPERATORS_COMMA","op","OPERATORS","SEPARATORS","DEC","ARG","COL","setDecimalSeparator","sep","_separators","TRUE","FALSE","getcol","getrow","TokenStream$1","ast","parseExpression","addReference","allowEOF","peek","commas","maybeBinary","exp","parseAtom","parseFuncall","parseArray","upper","maybePercent","my_prec","his_prec","makeClosure","toCPS","GENSYM","cps","makeContinuation","cpsNameRef","cpsAtom","cpsRef","cpsUnary","cpsBinary","thenK","gensym","elseK","vars","cpsIf","cpsAnd","cpsOr","cpsFunc","cont","cpsLambda","cpsMatrix","elements","isMatrix","FORMULA_CACHE","makeFormula","prec","withParens","parenthesize","arg","needParens","makePrinter","js","jsArray","identity","ahead","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","parseFloat","symbol","space","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","readNext","forEditor","EOF","RawTokenStream","InputStream","fixCell","addPos","startToken","endToken","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","g","escaped","rx","forward","FORMAT_PARSERS","registerFormatParser","p","parseNameDefinition","def","nameRef","defAST","noThrow","stream","parseSqref","monthFirst","comma","rxnum","NUMBER_FORMAT_RX","getNumberRegexp","rxcur","suffix","has_currency","has_percent","repeat","$$1","MAP_EXCEL_OPERATOR","greaterThanOrEqual","lessThanOrEqual","ERROR_LOG","SEL_CELL","SEL_COL","SEL_DEFINED_NAME","SEL_FORMULA","SEL_MERGE","SEL_PANE","SEL_ROW","SEL_SELECTION","SEL_SHEET","SEL_STRING","SEL_TEXT","SEL_SHARED_STRING","SEL_VALUE","SEL_VIEW","SEL_SHEET_VIEW","SEL_HYPERLINK","SEL_VALIDATION","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","SEL_VALIDATION_INSANE","SEL_VALIDATION_SQREF_INSANE","SEL_VALIDATION_FORMULA1_INSANE","SEL_VALIDATION_FORMULA2_INSANE","SEL_COMMENT","SEL_AUTHOR","SEL_COMMENT_TEXT","xl","readWorkbook","zip","progress","strings","readStrings","relationships","readRelationships","theme","readTheme","byType","readStyles","items","parse$1","enter","tag","relId","byId","dim","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","sheetDimensions","activeTab","integer","vbProcedure","localSheetId","withErrorLog","loading","Deferred","notify","recalcSheets","ready","insertSheet","promise","queueSheet","loadSheets","deferred","readSheet","pts","formulaRange","isArrayFormula","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","sharedFormulas","nCols","prevCellRef","filters","closed","percent","styleIndex","applyStyle","stop","ht","acRef","xSplit","ySplit","addAutoFilter","colId","and","ourOp","equal","notEqual","getFilterVal","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","blank","leave","sqref","showErrorMessage","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","comments","author","authors","authorId","readComments","relative_file","cdr","sel_two_cell_anchor","sel_ext","sel_one_cell_anchor","sel_from","sel_to","sel_row","sel_col","sel_row_offset","sel_col_offset","sel_blip","relsFile","filename","jpg","jpeg","png","gif","wmf","getContentType","files","asArrayBuffer","edge","Blob","File","excelToPixels","cx","cy","colOffset","rowOffset","brCell","brX","brY","readDrawings","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","BORDER_WIDTHS","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","DEFAULT_FORMATS","xf","inlineStyles","shouldSet","applyName","xfId","namedStyles","side","up","down","setBorder","setFont","fonts","indent","fills","formatCode","setFormat","numFmts","part","asUint8Array","Id","Target","Type","entries","SEL_BORDER","SEL_FILL","SEL_FONT","SEL_INLINE_STYLE","SEL_NAMED_STYLE","SEL_NUM_FMT","INDEXED_COLORS","toCSSColor","font","fill","getXf","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","addBool","getColor","defaultThemeColor","rgb","indexed","themeColor","colorScheme","tint","toHSL","toCssRgba","patternType","diagonalUp","diagonalDown","diagonal","horizontal","vertical","wrapText","SEL_SCHEME_RGBCLR","SEL_SCHEME_SYSCLR","scheme","swap","arr","readExcel","reader","FileReader","onload","JSZip","readAsArrayBuffer","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","messages","defaultSheetName","Workbook","_images","_imgID","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChanging","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetDataBinding","_sheetDataBound","_sheetProgress","_sheetCommandRequest","_inputForRef","execute","commandOptions","cleanupImages","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","sheetName","insertIndex","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","images","url","sheetParamsFromJSON","names","localName","saveJSON","ids","readAsDataURL","reject","excel","xhr","XMLHttpRequest","response","getResponseHeader","onerror","responseType","send","ooxml","saveAs","dataURI","forceProxy","toDataURL","toBlob","proxyURL","group","nameForRef","imageUrl","URL","createObjectURL","revokeObjectURL","or","PDFMixin","_drawPDF","exportPDF","exportPDFToBlob","proxyTarget","fail","area","spreadsheet$4","CellRef$2","RangeRef$1","UnionRef$1","NameRef$1","Ref$1","fsheet","frow","fcol","states","_displayString","arrayRange","tlRow","tlCol","vrow","vcol","_formulaContextRefresh","alphaNumRegExp","ACTIONS","pageup","pagedown","ENTRY_ACTIONS","tab","delete","backspace","CONTAINER_EVENTS","wheel","contextmenu","mousemove","CLIPBOARD_EVENTS","mouseup","EDITOR_EVENTS","esc","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","rowheader","columnheader","topcorner","autofill","toActionSelector","selectors","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","drawingContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","onMouseDown","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","deactivate","showError","activateEditor","_lastEditorValue","_activeTooltip","activeSheetName","clientHeight","isEditorDisabled","resetEditorValue","scroll","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","casual","onShiftAction","appendSelection","onMouseMove","objectAt","originFrame","_startResizingDrawing","win","widgetInstance","modal","startBox","onEditorEsc","openCustomEditor","_selectionMode","openFilterMenu","handle","translateCoords","startX","startY","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","_dragDrawing","onMouseDrag","clientX","clientY","selectToLocation","frame","scrollTop","startAutoScroll","onMouseUp","stopAutoScroll","activeEditor","onDblClick","onCut","clipBoardValue","_pasteImage","Image","onPaste","hasHTML","hasPlainText","DOMStringList","types","kind","getAsFile","onCopy","scrollRight","getBoundingClientRect","noDrawing","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","_saveEditorValue","onEditorArrayFormula","onEditorBarFocus","rect","activeCellRectangle","onEditorCellFocus","onEditorBlur","isFiltered","onEditorAction","_casualEditing","deactivateEditor","onEditorShiftAction","additionalOptions","pdfExport","excelExport","viewClassNames","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonSelected","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","shouldDraw","dBorders","defaultBorder","toHSV","outline","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","applyIndent","paneClassNames","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","insertRowBelowLastRow","insertColAfterLastCol","tabs","menus","bringToFront","sendToBack","HtmlTable","trs","addColumn","addRow","addCell","Node","toDomTree","offset","role","ContextMenu","VIEW_CONTENTS","within","View","_chrome","_dialogs","append","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","contextMenuConfig","showOn","enableClipboard","isClipboardDeactivated","actionBar","formulaBar","parents","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","sheetsBarHeight","quickAccessAdjust","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","_headerWidth","frozen","locate","w","RESIZE_HANDLE_WIDTH","isRowResizer","_headerHeight","isFilterIcon","theGrid","filterIconRect","isAutoFill","isEditButton","activeCellCustomEditor","_editorInLastColumn","drawingAt","drx","dry","clientWidth","paneAt","selecting","containingPane","refreshTools","totalHeight","totalWidth","_pane","_destroyFilterMenu","FilterMenu","_filterMenu","selectClipboardContents","selectNodeContents","selectElementContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","currentDialogs","errorMessages","hasOpenedError","focusButton","ESC","onClose","dlg","_retry","registered","dialogOptions","_filterMenuColumn","scrollbarSize","scrollbar","contentWidth","contentHeight","resizeDirection","toplevelElements","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","rangeDimensions","primaryMergedCells","secondaryMergedCells","backgroundColor","borderRightColor","borderBottomColor","sibling","cellBefore","borderLeftColor","prevRow","cellAbove","borderTopColor","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","paneClasses","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","activeCellRange","absRow","absCol","_activeFormulaColor","_directionClasses","vert","rendered","borderWidth","transform","horiz","renderDrawings","toDiv","backgroundImage","drawingResizeHandles","_start","_addDiv","filtered","classes","selections","selectionClasses","_renderCustomEditorButton","autoFillRectangle","cssClass","_axis","ed","btnClass","isLastColumn","_buttonOutOfVisiblePane","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","fromValidation","toValidation","_rowAndColPresent","disableDates","kendoStaticList","getKendoStaticList","read","intersectsRect","total","PaneGrid","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startSegment","endSegment","lastPage","_pixelValues","startIndex","endIndex","nowCount","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","dayOfWeek","secondWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","accentFoldingFiltering","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","util$1","calc$2","RX_COLORS","RX_CONDITION","decimalPart","sections","haveConditional","sec","readSection","maybeColor","readFormat","maybeFraction","fraction","decimal","am","pm","maybeCondition","compileFormatPart","restart","hasDate","hasTime","hasAmpm","percentCount","scaleCount","separeThousands","declen","intFormat","decFormat","condition","preamble","checkComma","TEXT","runtime$3","section","found","fmt","padLeft","calendars","standard","days","namesAbbr","ampm","fraclen","toFixed","eltime","formatInt","lastPart","shouldInsertMinus","iv","skipMinus","chf","formatDec","decimals","intpart","decpart","padRight","digNumber","span","textAndColor","adjusted","printToken","spreadsheet$3","calc$1","runtime$2","defineFunction$1","CalcError$1","CellRef$1","daysInMonth$1","packDate$1","unpackDate$1","daysInYear$1","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","matrix","parseCriteria","PI","rad","deg","cos","sin","atan","tan","ceil","mult","numbers","prod","coef","seen","ARGS_COUNTIFS","m1","ARGS_SUMIFS","numericPredicate","ARGS_SUMIF","fetchSumRange","continuation","sumRange","_avg","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","nth","descending","res","discard","bins","asc","variance","stddev","ARGS_PERCENTRANK","_covariance","ax","ay","significance","_fact","fact","_combinations","f1","f2","p1","p2","_percentile","rank","_percentile_inc","_percentile_exc","AGGREGATE_FUNCS","fetchValuesForAggregate","fetchValues","_binom_dist","cumulative","weeksInYear","_days_360$1","method","d1","d2","funcId","ignoreHidden","alpha","s2","a1","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","_days_360","random","rom","radix","minLen","RX_NON_PRINTABLE","Hyperlink","dec","denomitator","string","noCommas","newText","oldText","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","runtime$1","ll","ERF","ERFC","GAMMALN","GAMMA","GAMMA_DIST","GAMMA_INV","NORM_S_DIST","NORM_S_INV","NORM_INV","M","betastd_cdf","cdf","BETALN","betastd_pdf","BETA_INV","chisq_left","chisq_right","chisq_left_inv","ac","obsv","expect","eij","chisq_test","lnf","Fdist","arr1","arr2","n1","n2","va1","_var_sq","_mean","va2","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","gr1","gr2","tail","t_st","df","md","m2","v1","v2","u1","u2","q1","q2","f_abs","z","x_","p_","lw","y_","mx","my","b1","b2","pearson","s1","s3","t2","linest","Y","X","konst","stats","trend","new_X","FV","rate","nper","pmt","fv","h1","PMT","pv","guess","root_newton","h2","IPMT","per","tn","ts","te","monthlyPayment","cip","flows","npv","npv1","nominal_rate","npery","effect_rate","cost","salvage","life","period","db","factor","prior","dep","no_switch","interest","_getGDA","gda","oldValue","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","COUPS_ARGS","settlement","maturity","frequency","basis","_daysBetween","_borderCoupons","settl","matur","freq","sett","mat","issue","par","year_days","brace","prev1","next1","nrc","accr","annual","_numCoupons","periods","_edate","_borderCoupons_fw","pr","redemption","investment","discount","yld","N","beg_settl","settl_end","beg_end","den","yf","dsm","MAX_IT","EPS","FP_MIN","S","an","cof","ser","pi","BETA","gamma_inc","ap","gln","g_series","aj","bj","g_contfrac","ab","q","plow","beta_lentz","del","qab","qam","qap","betastd_inv","cds","me","whipNumberArrays","_mat_mean","Mat","_mat_devsq","mean","sq","Xt","B","line_1","Y1","y_y1","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","W","max_it","eps","f_d","ipmt","BORDER_TYPES","BORDER_PALETTE_MESSAGES","borderPalette","COLOR_PICKER_MESSAGES","colorPicker","customColor","cancel","withPreventDefault","ColorChooser","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","kendoWindow","resizable","maximizable","center","one","_hueSlider","kendoFlatColorPicker","viewModel","observable","BorderPalette","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","insertComment","insertImage","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","toolDefaults","overflow","iconClass","dialogName","togglable","separator","formatCells","SpreadsheetToolBar","_expandTools","tools","toolbarName","handleClick","_addSeparators","removeClass","click","_nextTool","not","activeIndex","activeElement","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","tool","attributes","menuButtons","commandType","checked","_tools","setToggle","hasOwnProperty","update","enabled","isFunction","toArray","_getItem","instance","DropDownTool","TemplateItem","dropDownList","kendoDropDownList","autoWidth","_open","listWidth","ddl","_listWidth","dataItem","popupName","PopupTool","Item","addUidAttr","addOverflowAttr","registerComponent","ToolBarButton","_dialogName","_title","OverflowDialogButton","OverflowButton","ColorPicker","ColorPickerButton","iconName","FONT_SIZES","FontSize","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","FontSizeButton","sizes","defaultSize","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","fontFamilies","FontFamilyButton","defaultFont","defaultFormats","Format","_revertTitle","dataValuePrimitive","valueTemplate","sample","FormatButton","BorderChangeTool","_borderPalette","_action","BorderChangeButton","AlignmentTool","_defineButtons","_commandPalette","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","contentElement","_tabIndex","quickAccessToolBar","buttonTemplate","insertBefore","tabGroup","ObservableObject","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","defaultFileName","xlsx","description","paper","a2","a3","a4","a5","b3","b4","b5","folio","legal","tabloid","executive","margin","normal","narrow","wide","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","intersectsArrayDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","removeLink","insertCommentDialog","removeComment","insertImageDialog","info","typeError","registry","register","dialogClass","SpreadsheetDialog","translate","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","formattedValue","FormatCellsViewModel","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","_currency","iso","convert","categoryFilter","uniqueBy","inArray","pattern","abbr","FormatCellsDialog","defaultOptions","_generateFormats","currenciesFrom","numberFormats","dateFormats","calendarPatterns","currencyFilter","roleSelector","MessageDialog","messageId","getter","ConfirmationDialog","confirm","_confirmed","ValidationErrorDialog","FontFamilyDialog","_list","fetch","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","_colorPicker","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","defaultComparers","text_comparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","ValidationDialog","errorTemplate","validatable","Validator","validateOnBlur","validate","ExportAsDialog","fileFormats","autoPrint","subject","keywords","creator","fitWidth","areas","paperSizes","landscape","hCenter","vCenter","basicErrorDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","model","InsertCommentDialog","InsertImageDialog","okEnabled","hasImage","isHovered","_url","_image","stopEvent","drop","selectFile","dataTransfer","dragEnter","dragLeave","Localizable","path","trans","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","normalizedRefs","setValues","record","valueIndex","colValueIndex","currentValue","_skipRebind","_changeHandler","_progressHandler","_errorHandler","_requestStart","_error","_progress","getterIdx","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","sortAscending","sortDescending","search","addToCurrent","operatorNone","operators","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","Details","_summary","_toggle","_icon","_container","fx","expand","binders","spreadsheetFilterValue","Binder","bindings","widget","templates","menuItem","query","hasVisibleChildren","HierarchicalDataSource","toLocaleLowerCase","itemVisible","anyVisibleChildren","filterSpread","uncheckAll","hasChildren","FilterMenuViewModel","valuesChange","valuesDataSource","appendToSearch","lastIndexOf","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","flattenOperators","FilterMenuController","valuesTree","distinctValues","filterType","filterForColumn","topValue","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","hasClass","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","isExpanded","activeContainer","barInput","cellInput","_triggerUpdate","viewWidth","scrollerElement","scrollbarWidth","viewElement","_rect","noChange","inputType","oldRect","newRect","spreadsheet$1","ERR_INCOMPATIBLE","linearRegression","findSeries","getType","forEachSeries","findStep","lst","strl","findStringList","srcRange","destRange","srcIdx","fillFrom","CLASS_NAMES","comboBoxTitle","transport","success","comboElement","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","CONT","kdrw","geo","geometry","GUIDELINE_WIDTH","distributeCoords","heights","pageHeight","maxEmpty","headerRows","headerCoords","curr","header","wholeRect","rowHeights","colWidths","relrow","relcol","rh","cw","nonEmpty","shouldDrawCell","emptyCells","pageWidth","scaleFactor","hyCoords","boxWidth","boxHeight","headerCells","orlast","orderCoords","orderCells","assign","sameBorder","drawLayout","ncols","nrows","addPage","endbottom","endright","isInside","page","Group","clip","Path","fromRect","Rect","multiplyCopy","moveTo","lineTo","stroke","guideColor","r2d2","boxSizing","lineHeight","padding","makeFontDef","createTextNode","vtrans","text_group","drawDOM","drawText","bordersGroup","paddingLeft","paddingRight","getPaperOptions","multiPage","Container","addVert","addHoriz","pb","CACHE_CHAR_WIDTH","charWidthFunction","widths","drawTabularData","headerBackground","headerColor","oddBackground","evenBackground","useGridFormat","defineFont","getFontFaces","charWidth","textWidth","mkCell","columnTitles","columnWidths","label","undefined$1","version","F10","F11","I","U","H","A","DELETE","R","NS","Spreadsheet","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","_workbookChanging","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","_workbookDataBinding","_workbookDataBound","_workbookProgress","plugin"],"sources":["kendo.spreadsheet.js"],"mappings":"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","sourcesContent":["(function (factory) {\n    typeof define === 'function' && define.amd ? define(['kendo.core', 'kendo.excel', 'kendo.progressbar', 'kendo.pdf', 'kendo.binder', 'kendo.window', 'kendo.list', 'kendo.tabstrip', 'kendo.color', 'kendo.sortable', 'kendo.menu', 'kendo.popup', 'kendo.calendar', 'kendo.listview', 'kendo.data', 'kendo.dom', 'kendo.toolbar', 'kendo.colorpicker', 'kendo.combobox', 'kendo.dropdownlist', 'kendo.validator', 'kendo.treeview', 'kendo.numerictextbox', 'kendo.datepicker', 'kendo.datetimepicker'], factory) :\n    factory();\n})((function () {\n    (function(kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function(options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [ \"undo\", \"redo\" ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger(\"undo\", { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger(\"redo\", { command: command });\n                }\n            },\n            clear: function() {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n\n        kendo.deepExtend(kendo, {\n            util: {\n                UndoRedoStack: UndoRedoStack\n            }\n        });\n    })(kendo);\n\n    /***********************************************************************\n     * WARNING: this file is auto-generated.  If you change it directly,\n     * your modifications will eventually be lost.  The source code is in\n     * `kendo-drawing` repository, you should make your changes there and\n     * run `src-modules/sync.sh` in this repository.\n     */\n\n    (function($) {\n    /* eslint-disable space-before-blocks, space-before-function-paren */\n\n    window.kendo.util = window.kendo.util || {};\n\n    var LRUCache = kendo.Class.extend({\n        init: function(size) {\n\n            this._size = size;\n            this._length = 0;\n            this._map = {};\n        },\n\n        put: function(key, value) {\n            var map = this._map;\n            var entry = { key: key, value: value };\n\n            map[key] = entry;\n\n            if (!this._head) {\n                this._head = this._tail = entry;\n            } else {\n                this._tail.newer = entry;\n                entry.older = this._tail;\n                this._tail = entry;\n            }\n\n            if (this._length >= this._size) {\n                map[this._head.key] = null;\n                this._head = this._head.newer;\n                this._head.older = null;\n            } else {\n                this._length++;\n            }\n        },\n\n        get: function(key) {\n            var entry = this._map[key];\n\n            if (entry) {\n                if (entry === this._head && entry !== this._tail) {\n                    this._head = entry.newer;\n                    this._head.older = null;\n                }\n\n                if (entry !== this._tail) {\n                    if (entry.older) {\n                        entry.older.newer = entry.newer;\n                        entry.newer.older = entry.older;\n                    }\n\n                    entry.older = this._tail;\n                    entry.newer = null;\n\n                    this._tail.newer = entry;\n                    this._tail = entry;\n                }\n\n                return entry.value;\n            }\n        }\n    });\n\n    var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n    var SPACE = ' ';\n\n    function normalizeText(text) {\n        return String(text).replace(REPLACE_REGEX, SPACE);\n    }\n\n    function objectKey(object) {\n        var parts = [];\n        for (var key in object) {\n            parts.push(key + object[key]);\n        }\n\n        return parts.sort().join(\"\");\n    }\n\n    // Computes FNV-1 hash\n    // See http://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function\n    function hashKey(str) {\n        // 32-bit FNV-1 offset basis\n        // See http://isthe.com/chongo/tech/comp/fnv/#FNV-param\n        var hash = 0x811C9DC5;\n\n        for (var i = 0; i < str.length; ++i) {\n            hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n            hash ^= str.charCodeAt(i);\n        }\n\n        return hash >>> 0;\n    }\n\n    function zeroSize() {\n        return { width: 0, height: 0, baseline: 0 };\n    }\n\n    var DEFAULT_OPTIONS = {\n        baselineMarkerSize: 1\n    };\n\n    var defaultMeasureBox;\n\n    if (typeof document !== \"undefined\") {\n        defaultMeasureBox = document.createElement(\"div\");\n        defaultMeasureBox.style.cssText = \"position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;\" +\n                  \"padding: 0 !important; margin: 0 !important; border: 0 !important;\" +\n                  \"line-height: normal !important; visibility: hidden !important; white-space: pre!important;\";\n    }\n\n    var TextMetrics = kendo.Class.extend({\n        init: function(options) {\n\n            this._cache = new LRUCache(1000);\n            this.options = $.extend({}, DEFAULT_OPTIONS, options);\n        },\n\n        measure: function(text, style, options) {\n            if (options === void 0) { options = {}; }\n\n            if (typeof text === 'undefined' || text === null) {\n                return zeroSize();\n            }\n\n            var styleKey = objectKey(style);\n            var cacheKey = hashKey(text + styleKey);\n            var cachedResult = this._cache.get(cacheKey);\n\n            if (cachedResult) {\n                return cachedResult;\n            }\n\n            var size = zeroSize();\n            var measureBox = options.box || defaultMeasureBox;\n            var baselineMarker = this._baselineMarker().cloneNode(false);\n\n            for (var key in style) {\n                var value = style[key];\n                if (typeof value !== \"undefined\") {\n                    measureBox.style[key] = value;\n                }\n            }\n\n            var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n\n            measureBox.textContent = textStr;\n            measureBox.appendChild(baselineMarker);\n            document.body.appendChild(measureBox);\n\n            if (textStr.length) {\n                size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                size.height = measureBox.offsetHeight;\n                size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n            }\n\n            if (size.width > 0 && size.height > 0) {\n                this._cache.put(cacheKey, size);\n            }\n\n            measureBox.parentNode.removeChild(measureBox);\n\n            return size;\n        },\n\n        _baselineMarker: function() {\n            var marker = document.createElement(\"div\");\n            marker.style.cssText = \"display: inline-block; vertical-align: baseline;width: \" +\n                this.options.baselineMarkerSize + \"px; height: \" + this.options.baselineMarkerSize + \"px;overflow: hidden;\";\n\n            return marker;\n        }\n    });\n\n    TextMetrics.current = new TextMetrics();\n\n    function measureText(text, style, measureBox) {\n        return TextMetrics.current.measure(text, style, measureBox);\n    }\n\n    kendo.deepExtend(kendo.util, {\n        LRUCache: LRUCache,\n        TextMetrics: TextMetrics,\n        measureText: measureText,\n        objectKey: objectKey,\n        hashKey: hashKey,\n        normalizeText: normalizeText\n    });\n\n    })(window.kendo.jQuery);\n\n    (function () {\r\n        // Imports ================================================================\r\n        var kendo = window.kendo,\r\n            deepExtend = kendo.deepExtend;\r\n\r\n        function sqr(value) {\r\n            return value * value;\r\n        }\r\n\r\n        var now = Date.now;\r\n        if (!now) {\r\n            now = function() {\r\n                return new Date().getTime();\r\n            };\r\n        }\r\n\r\n        // Template helpers =======================================================\r\n\r\n        function renderSize(size) {\r\n            if (typeof size !== \"string\") {\r\n                size += \"px\";\r\n            }\r\n\r\n            return size;\r\n        }\r\n\r\n        function renderPos(pos) {\r\n            var result = [];\r\n\r\n            if (pos) {\r\n                var parts = kendo.toHyphens(pos).split(\"-\");\r\n\r\n                for (var i = 0; i < parts.length; i++) {\r\n                    result.push(\"k-pos-\" + parts[i]);\r\n                }\r\n            }\r\n\r\n            return result.join(\" \");\r\n        }\r\n\r\n        function arabicToRoman(n) {\r\n            var literals = {\r\n                1    : \"i\",       10   : \"x\",       100  : \"c\",\r\n                2    : \"ii\",      20   : \"xx\",      200  : \"cc\",\r\n                3    : \"iii\",     30   : \"xxx\",     300  : \"ccc\",\r\n                4    : \"iv\",      40   : \"xl\",      400  : \"cd\",\r\n                5    : \"v\",       50   : \"l\",       500  : \"d\",\r\n                6    : \"vi\",      60   : \"lx\",      600  : \"dc\",\r\n                7    : \"vii\",     70   : \"lxx\",     700  : \"dcc\",\r\n                8    : \"viii\",    80   : \"lxxx\",    800  : \"dccc\",\r\n                9    : \"ix\",      90   : \"xc\",      900  : \"cm\",\r\n                1000 : \"m\"\r\n            };\r\n            var values = [ 1000,\r\n                           900 , 800, 700, 600, 500, 400, 300, 200, 100,\r\n                           90  , 80 , 70 , 60 , 50 , 40 , 30 , 20 , 10 ,\r\n                           9   , 8  , 7  , 6  , 5  , 4  , 3  , 2  , 1 ];\r\n            var roman = \"\";\r\n            while (n > 0) {\r\n                if (n < values[0]) {\r\n                    values.shift();\r\n                } else {\r\n                    roman += literals[values[0]];\r\n                    n -= values[0];\r\n                }\r\n            }\r\n            return roman;\r\n        }\r\n\r\n        function romanToArabic(r) {\r\n            r = r.toLowerCase();\r\n            var digits = {\r\n                i: 1,\r\n                v: 5,\r\n                x: 10,\r\n                l: 50,\r\n                c: 100,\r\n                d: 500,\r\n                m: 1000\r\n            };\r\n            var value = 0, prev = 0;\r\n            for (var i = 0; i < r.length; ++i) {\r\n                var v = digits[r.charAt(i)];\r\n                if (!v) {\r\n                    return null;\r\n                }\r\n                value += v;\r\n                if (v > prev) {\r\n                    value -= 2 * prev;\r\n                }\r\n                prev = v;\r\n            }\r\n            return value;\r\n        }\r\n\r\n        function memoize(f) {\r\n            var cache = Object.create(null);\r\n            return function() {\n                var arguments$1 = arguments;\n\r\n                var id = \"\";\r\n                for (var i = arguments.length; --i >= 0;) {\r\n                    id += \":\" + arguments$1[i];\r\n                }\r\n                return id in cache ? cache[id] : (cache[id] = f.apply(this, arguments));\r\n            };\r\n        }\r\n\r\n        function isUnicodeLetter(ch) {\r\n            return RX_UNICODE_LETTER.test(ch);\r\n        }\r\n\r\n        function withExit(f, obj) {\r\n            try {\r\n                return f.call(obj, function(value){\r\n                    throw new Return(value);\r\n                });\r\n            } catch(ex) {\r\n                if (ex instanceof Return) {\r\n                    return ex.value;\r\n                }\r\n                throw ex;\r\n            }\r\n            function Return(value) {\r\n                this.value = value;\r\n            }\r\n        }\r\n\r\n        // Exports ================================================================\r\n        deepExtend(kendo, {\r\n            util: {\r\n                now: now,\r\n                renderPos: renderPos,\r\n                renderSize: renderSize,\r\n                sqr: sqr,\r\n                romanToArabic: romanToArabic,\r\n                arabicToRoman: arabicToRoman,\r\n                memoize: memoize,\r\n                isUnicodeLetter: isUnicodeLetter,\r\n                withExit: withExit\r\n            }\r\n        });\r\n\r\n        var RX_UNICODE_LETTER = new RegExp(\"[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]\");\r\n\r\n    })();\n\n    \"use strict\";\r\n\r\n        // SAX-style XML parser ====================================================\r\n        var STRING = String.fromCharCode;\r\n\r\n        // XXX: add more here?\r\n        var ENTITIES = {\r\n            \"amp\"  : 38,\r\n            \"lt\"   : 60,\r\n            \"gt\"   : 62,\r\n            \"quot\" : 34,\r\n            \"apos\" : 39,\r\n            \"nbsp\" : 160\r\n        };\r\n\r\n        function CODE(str) {\r\n            var out = [];\r\n            for (var i = 0; i < str.length; ++i) {\r\n                out.push(str.charCodeAt(i));\r\n            }\r\n            return out;\r\n        }\r\n\r\n        function UCS2(out, code) {\r\n            if (code > 0xFFFF) {\r\n                code -= 0x10000;\r\n                out.push(code >>> 10 & 0x3FF | 0xD800,\r\n                         0xDC00 | code & 0x3FF);\r\n            } else {\r\n                out.push(code);\r\n            }\r\n        }\r\n\r\n        var START_CDATA     = CODE(\"<![CDATA[\");\r\n        var END_CDATA       = CODE(\"]]>\");\r\n        var END_COMMENT     = CODE(\"-->\");\r\n        var START_COMMENT   = CODE(\"!--\");\r\n        var END_SHORT_TAG   = CODE(\"/>\");\r\n        var END_TAG         = CODE(\"</\");\r\n        var END_DECLARATION = CODE(\"?>\");\r\n        var QUESTION_MARK   = CODE(\"?\");\r\n        var LESS_THAN       = CODE(\"<\");\r\n        var GREATER_THAN    = CODE(\">\");\r\n        var SEMICOLON       = CODE(\";\");\r\n        var EQUAL           = CODE(\"=\");\r\n        var AMPERSAND       = CODE(\"&\");\r\n        var QUOTE           = CODE('\"');\r\n        var APOSTROPHE      = CODE(\"'\");\r\n        var SHARP           = CODE(\"#\");\r\n        var LOWERCASE_X     = CODE(\"x\");\r\n        var UPPERCASE_X     = CODE(\"X\");\r\n\r\n        var EXIT = {};\r\n\r\n        function parse$2(data, callbacks) {\r\n            var index = 0;\r\n            var stack = [];\r\n            var object = {\r\n                is: function(selector) {\r\n                    var i = stack.length, j = selector.length;\r\n                    while (--i >= 0 && --j >= 0) {\r\n                        if (stack[i].$tag != selector[j] && selector[j] != \"*\") {\r\n                            return false;\r\n                        }\r\n                    }\r\n                    return j < 0 ? stack[stack.length - 1] : null;\r\n                },\r\n                exit: function() {\r\n                    throw EXIT;\r\n                },\r\n                stack: stack\r\n            };\r\n\r\n            function readChar(body) {\r\n                var code = data[index++];\r\n                if (!(code & 0xF0 ^ 0xF0)) {// 4 bytes\r\n                    UCS2(body,\r\n                         ((code & 0x03) << 18) |\r\n                         ((data[index++] & 0x3F) << 12) |\r\n                         ((data[index++] & 0x3F) << 6) |\r\n                         (data[index++] & 0x3F));\r\n                } else if (!(code & 0xE0 ^ 0xE0)) {// 3 bytes\r\n                    UCS2(body,\r\n                         ((code & 0x0F) << 12) |\r\n                         ((data[index++] & 0x3F) << 6) |\r\n                         (data[index++] & 0x3F));\r\n                } else if (!(code & 0xC0 ^ 0xC0)) {// 2 bytes\r\n                    UCS2(body,\r\n                         ((code & 0x1F) << 6) |\r\n                         (data[index++] & 0x3F));\r\n                } else {\r\n                    body.push(code);\r\n                }\r\n            }\r\n\r\n            function croak(msg) {\r\n                throw new Error(msg + \", at \" + index);\r\n            }\r\n\r\n            function readWhile(pred) {\r\n                var a = [];\r\n                while (index < data.length && pred(data[index])) {\r\n                    a.push(data[index++]);\r\n                }\r\n                return a;\r\n            }\r\n\r\n            function readAsciiWhile(pred) {\r\n                return STRING.apply(0, readWhile(pred));\r\n            }\r\n\r\n            function skipWhitespace() {\r\n                readWhile(isWhitespace);\r\n            }\r\n\r\n            function eat(a) {\r\n                var save = index;\r\n                for (var i = 0; i < a.length; ++i) {\r\n                    if (data[index++] != a[i]) {\r\n                        index = save;\r\n                        return false;\r\n                    }\r\n                }\r\n                return a;\r\n            }\r\n\r\n            function skip(code) {\r\n                if (!eat(code)) {\r\n                    croak(\"Expecting \" + code.join(\", \"));\r\n                }\r\n            }\r\n\r\n            function isWhitespace(code) {\r\n                return code == 9 || code == 10 || code == 13 || code == 32;\r\n            }\r\n\r\n            function isDigit(code) {\r\n                return code >= 48 && code <= 57;\r\n            }\r\n\r\n            function isHexDigit(code) {\r\n                return (code >= 48 && code <= 57) ||\r\n                       ((code|=32) >= 97 && code <= 102); // a..f or A..F\r\n            }\r\n\r\n            function isNameStart(code) {\r\n                return code == 58 ||                      // :\r\n                       code == 95 ||                      // _\r\n                       ((code|=32) >= 97 && code <= 122); // a..z or A..Z\r\n            }\r\n\r\n            function isName(code) {\r\n                return code == 45 ||                      // -\r\n                       isDigit(code) ||\r\n                       isNameStart(code);\r\n            }\r\n\r\n            function xmlComment() {\r\n                var body = [];\r\n                while (index < data.length) {\r\n                    if (eat(END_COMMENT)) {\r\n                        return call(\"comment\", STRING.apply(0, body));\r\n                    }\r\n                    readChar(body);\r\n                }\r\n            }\r\n\r\n            function xmlTag() {\r\n                var name, attrs;\r\n                if (eat(QUESTION_MARK)) {\r\n                    xmlDecl();\r\n                } else if (eat(START_COMMENT)) {\r\n                    xmlComment();\r\n                } else {\r\n                    name = xmlName();\r\n                    attrs = xmlAttrs(name);\r\n                    stack.push(attrs);\r\n                    if (eat(END_SHORT_TAG)) {\r\n                        call(\"enter\", name, attrs, true);\r\n                    } else {\r\n                        skip(GREATER_THAN);\r\n                        call(\"enter\", name, attrs);\r\n                        xmlContent(name);\r\n                        if (name != xmlName()) {\r\n                            croak(\"Bad closing tag\");\r\n                        }\r\n                        call(\"leave\", name, attrs);\r\n                        skipWhitespace();\r\n                        skip(GREATER_THAN);\r\n                    }\r\n                    stack.pop();\r\n                }\r\n            }\r\n\r\n            function xmlContent(name) {\r\n                var body = [];\r\n                while (index < data.length) {\r\n                    if (eat(END_TAG)) {\r\n                        return body.length && call(\"text\", STRING.apply(0, body));\r\n                    } else if (eat(START_CDATA)) {\r\n                        while (index < data.length && !eat(END_CDATA)) {\r\n                            readChar(body);\r\n                        }\r\n                    } else if (eat(LESS_THAN)) {\r\n                        if (body.length) {\r\n                            call(\"text\", STRING.apply(0, body));\r\n                        }\r\n                        xmlTag();\r\n                        body = [];\r\n                    } else if (eat(AMPERSAND)) {\r\n                        xmlEntity(body);\r\n                    } else {\r\n                        readChar(body);\r\n                    }\r\n                }\r\n                croak(\"Unclosed tag \" + name);\r\n            }\r\n\r\n            function xmlName() {\r\n                if (!isNameStart(data[index])) {\r\n                    croak(\"Expecting XML name\");\r\n                }\r\n                return readAsciiWhile(isName);\r\n            }\r\n\r\n            function xmlString() {\r\n                var quote = eat(QUOTE) || eat(APOSTROPHE);\r\n                if (!quote) {\r\n                    croak(\"Expecting string\");\r\n                }\r\n                var body = [];\r\n                while (index < data.length) {\r\n                    if (eat(quote)) {\r\n                        return STRING.apply(0, body);\r\n                    } else if (eat(AMPERSAND)) {\r\n                        xmlEntity(body);\r\n                    } else {\r\n                        readChar(body);\r\n                    }\r\n                }\r\n                croak(\"Unfinished string\");\r\n            }\r\n\r\n            function xmlEntity(body) {\r\n                var code;\r\n                if (eat(SHARP)) {\r\n                    if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\r\n                        code = parseInt(readAsciiWhile(isHexDigit), 16);\r\n                    } else {\r\n                        code = parseInt(readAsciiWhile(isDigit), 10);\r\n                    }\r\n                    if (isNaN(code)) {\r\n                        croak(\"Bad numeric entity\");\r\n                    }\r\n                } else {\r\n                    var name = xmlName();\r\n                    code = ENTITIES[name];\r\n                    if (code === undefined) {\r\n                        croak(\"Unknown entity \" + name);\r\n                    }\r\n                }\r\n                UCS2(body, code);\r\n                skip(SEMICOLON);\r\n            }\r\n\r\n            function xmlDecl() {\r\n                call(\"decl\", xmlName(), xmlAttrs());\r\n                skip(END_DECLARATION);\r\n            }\r\n\r\n            function xmlAttrs(name) {\r\n                var map = { $tag: name };\r\n                while (index < data.length) {\r\n                    skipWhitespace();\r\n                    var code = data[index];\r\n                    if (code == 63 || code == 62 || code == 47) { // ?, > or /\r\n                        break;\r\n                    }\r\n                    map[xmlName()] = ( skip(EQUAL), xmlString() );\r\n                }\r\n                return map;\r\n            }\r\n\r\n            function call(what, thing, arg1, arg2) {\r\n                var f = callbacks && callbacks[what];\r\n                if (f) {\r\n                    f.call(object, thing, arg1, arg2);\r\n                }\r\n            }\r\n\r\n            // skip BOM\r\n            var tmp = [];\r\n            readChar(tmp);\r\n            if (tmp[0] != 65279) {\r\n                index = 0;\r\n            }\r\n\r\n            while (index < data.length) {\r\n                skipWhitespace();\r\n                skip(LESS_THAN);\r\n                xmlTag();\r\n                skipWhitespace();\r\n            }\r\n        }\r\n\r\n        // Exports ================================================================\r\n        kendo.util.parseXML = function parseXML() {\r\n            try {\r\n                return parse$2.apply(this, arguments);\r\n            } catch(ex) {\r\n                if (ex !== EXIT) {\r\n                    throw ex;\r\n                }\r\n            }\r\n        };\n\n    (function(kendo) {\n        var $ = kendo.jQuery;\n\n        var COMMAND_TYPES = {\n            AUTO_FILL: \"autoFill\",\n            CLEAR: \"clear\",\n            CUT: \"cut\",\n            EDIT: \"edit\",\n            PASTE: \"paste\",\n            VALIDATION: \"validation\"\n        };\n\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function(options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function(range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n\n                return this._range;\n            },\n            _setRange: function(range) {\n                this._range = range;\n            },\n            redo: function() {\n                this.range().select();\n                this.exec();\n            },\n            undo: function() {\n                this.setState(this._state);\n            },\n            getState: function() {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function(state) {\n                this.range().setState(state);\n            },\n            rejectState: function(validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: \"error\",\n                    type: \"validationError\"\n                };\n            },\n            _forEachCell: function(callback) {\n                var range = this.range();\n                var ref = range._ref;\n\n                ref.forEach(function(ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            usesImage: function(/* image id from workbook._images */) {\n                return false;\n            }\n        });\n\n        kendo.spreadsheet.DrawingUpdateCommand = Command.extend({\n            init: function(options) {\n                this._sheet = options.sheet;\n                this._drawing = options.drawing;\n                this._orig = this._drawing.clone();\n                this._previous = options.previous;\n            },\n            exec: function() {},\n            undo: function() {\n                this._drawing.reset(this._previous);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            redo: function() {\n                this._drawing.reset(this._orig);\n                this._sheet._activeDrawing = this._drawing;\n                this._sheet.triggerChange({ layout: true });\n            },\n            usesImage: function(img) {\n                return this._drawing.image === img\n                    || this._orig.image === img\n                    || this._previous.image === img;\n            }\n        });\n\n        var DrawingCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._drawing = options.drawing;\n            },\n            usesImage: function(img) {\n                return this._drawing.image === img;\n            }\n        });\n\n        kendo.spreadsheet.InsertImageCommand = DrawingCommand.extend({\n            init: function(options) {\n                DrawingCommand.fn.init.call(this, options);\n                this._blob = options.blob;\n                this._width = options.width;\n                this._height = options.height;\n            },\n            exec: function() {\n                var range = this.range();\n                var sheet = range.sheet();\n                var width = this._width;\n                var height = this._height;\n                var aspect = width / height;\n                if (width > height) {\n                    width = Math.min(width, 300);\n                    height = width / aspect;\n                } else {\n                    height = Math.min(height, 300);\n                    width = height * aspect;\n                }\n                this._drawing = sheet.addDrawing({\n                    topLeftCell : range.topLeft(),\n                    offsetX     : 5,\n                    offsetY     : 5,\n                    width       : width,\n                    height      : height,\n                    opacity     : 1,\n                    image       : this._workbook.addImage(this._blob)\n                }, true);\n                this._blob = null;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            redo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            }\n        });\n\n        kendo.spreadsheet.DeleteDrawingCommand = DrawingCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = null;\n                sheet.removeDrawing(this._drawing);\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._activeDrawing = this._drawing;\n                sheet.addDrawing(this._drawing);\n            },\n            redo: function() {\n                this.exec();\n            }\n        });\n\n        var ReorderDrawingsCommand = DrawingCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._origIndex = sheet._drawings.indexOf(this._drawing);\n                sheet._drawings.splice(this._origIndex, 1);\n                this._newIndex = this._reorder();\n                sheet._drawings.splice(this._newIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet._drawings.splice(this._newIndex, 1);\n                sheet._drawings.splice(this._origIndex, 0, this._drawing);\n                sheet.triggerChange({ drawings: true });\n            }\n        });\n\n        kendo.spreadsheet.BringToFrontCommand = ReorderDrawingsCommand.extend({\n            _reorder: function() {\n                return this.range().sheet()._drawings.length;\n            }\n        });\n\n        kendo.spreadsheet.SendToBackCommand = ReorderDrawingsCommand.extend({\n            _reorder: function() {\n                return 0;\n            }\n        });\n\n        var TargetValueCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function(state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function(state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function() {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function() {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function(v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function(range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function() {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n\n                    if (this.options.property === \"format\") {\n                        this._workbook.trigger(\"changeFormat\", { range: range });\n                    }\n\n                    range[this._property](this._value);\n                }\n            }\n        });\n\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function() {\n                var values = [], range, rowValues, nullValues, validationState, currentRange;\n                if (!this.range().enable()) {\n                    return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                }\n                if (!this.range().canEditArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n                this.getState();\n                range = this.range().skipHiddenCells();\n\n                if(range._ref.refs && range._ref.refs.length > 1) {\n                    range._ref.refs.forEach(function(ref) {\n                        currentRange = range.sheet().range(ref);\n                        values = values.concat(currentRange.values());\n                    });\n                } else {\n                    values = range.values();\n                }\n                nullValues = [];\n                values.forEach(function(row) {\n                    rowValues = [];\n                    row.forEach(function() {\n                        rowValues.push(null);\n                    });\n                    nullValues.push(rowValues);\n                });\n                if (range.sheet().trigger(\"changing\", { data: nullValues, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                    return;\n                }\n                range.clearContent();\n                validationState = range._getValidationState();\n                if (validationState) {\n                    return this.rejectState(validationState);\n                }\n            },\n            undo: function() {\n                var range = this.range().skipHiddenCells();\n                var sheet = range.sheet();\n                var data = this._state.data;\n                var values = [];\n                var rowValues;\n                data.forEach(function(row) {\n                    rowValues = [];\n                    row.forEach(function(cell) {\n                        rowValues.push(cell.value);\n                    });\n                    values.push(rowValues);\n                });\n                if (sheet.trigger(\"changing\", { data: values, range: range, changeType: COMMAND_TYPES.CLEAR })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = options.property || \"input\";\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            _setRange: function(range) {\n                PropertyChangeCommand.prototype._setRange.apply(this, arguments);\n                this._editRange = this.options.arrayFormula ? range : range.sheet().activeCellSelection();\n            },\n            getState: function() {\n                this._state = this.range().getState();\n            },\n            exec: function() {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function() {\n                var editRange = this._editRange;\n                var state = this._state;\n                if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].value, range: editRange, changeType: COMMAND_TYPES.EDIT })) {\n                    return;\n                }\n                this.setState(this._state);\n            },\n            _exec: function() {\n                var arrayFormula = this.options.arrayFormula;\n                var editRange = this._editRange;\n\n                if (!editRange.enable()) {\n                    return { reason: \"error\", type: \"rangeDisabled\" };\n                }\n\n                if (!editRange.canEditArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n\n                var value = this._value;\n                this.getState();\n                if (this.range().sheet().trigger(\"changing\", { data: value, range: this._editRange, changeType: COMMAND_TYPES.EDIT })) {\n                    return;\n                }\n\n                if (this._property == \"value\") {\n                    editRange.value(value);\n                    return;\n                }\n\n                try {\n                    editRange.link(null);\n                    if (value === \"\") {\n                        editRange.value(null);\n                    } else {\n                        editRange.input(value, { arrayFormula: arrayFormula });\n                        if (/\\n/.test(editRange.value())) {\n                            editRange.wrap(true);\n                        }\n                    }\n                    editRange._adjustRowHeight();\n\n                    var validationState = editRange._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title : \"Error in formula\",\n                            body  : ex+\"\",\n                            reason: \"error\"\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n\n        kendo.spreadsheet.InsertCommentCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = \"comment\";\n                PropertyChangeCommand.fn.init.call(this, options);\n            }\n        });\n\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function(options) {\n                options.property = \"wrap\";\n                PropertyChangeCommand.fn.init.call(this, options);\n\n                this._value = options.value;\n            },\n            getState: function() {\n                var rowHeight = {};\n                this.range().forEachRow(function(range) {\n                    var index = range.topLeft().row;\n\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n\n                this.range().setState(this._state);\n\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function(options) {\n                this._delta = options.value;\n                options.property = \"format\";\n                Command.fn.init.call(this, options);\n            },\n            exec: function() {\n                var sheet = this.range().sheet();\n                var delta = this._delta;\n                var formatting = kendo.spreadsheet.formatting;\n\n                this.getState();\n\n                sheet.batch(function() {\n                    this.range().forEachCell(function(row, col, cell) {\n                        var format = cell.format;\n\n                        if (!format) {\n                            var value = cell.value;\n                            if (typeof value == \"number\" && /\\./.test(value)) {\n                                format = \"0.\" + String(value).split(\".\")[1].replace(/\\d/g, \"0\");\n                            }\n                        }\n\n                        if (format || delta > 0) {\n                            format = formatting.adjustDecimals(format || \"0\", delta);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function(options) {\n                options.property = \"border\";\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            _batch: function(f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function() {\n                var self = this;\n                self.getState();\n                self._batch(function(){\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function() {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function(style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function(style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function(style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function(style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function(style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function(style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function(style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function(style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function(style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this[this._type]();\n                this.range().sheet().triggerChange({ recalc: true });\n            },\n            activate: function(ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function() {\n                this._state = this.range().getState();\n            },\n            undo: function() {\n                if (this._type !== \"unmerge\") {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function() {\n                var range = this.range();\n                var ref = range._ref;\n\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function() {\n                var ref = this.range().topRow()._ref;\n\n                this.range().forEachRow(function(range) {\n                    range.merge();\n                });\n\n                this.activate(ref);\n            },\n            vertically: function() {\n                var ref = this.range().leftColumn()._ref;\n\n                this.range().forEachColumn(function(range) {\n                    range.merge();\n                });\n\n                this.activate(ref);\n            },\n            unmerge: function() {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function() {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function() {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function() {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function() {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function() {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._clipboard.parse();\n                this._event = options.event;\n                this._clipboardContent = this._clipboard._content;\n                this._sheet = this._workbook.activeSheet();\n                this._range = this._sheet.selection ? this._sheet.selection() : this._sheet.range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n                this._targetRangeRefs = (this._range._ref instanceof kendo.spreadsheet.UnionRef ? this._range._ref.refs : [this._range._ref]).map(function(ref){\n                    return ref.toRangeRef();\n                });\n            },\n            exec: function() {\n                return this.range().sheet().withCultureDecimals(this._exec.bind(this));\n            },\n            undo: function() {\n                var sheet = this._sheet;\n                var range = this._range;\n\n                if (sheet.trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                    return;\n                }\n\n                this.setState(this._state);\n            },\n            _exec: function() {\n                var status = this._clipboard.canPaste();\n\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return { reason: \"error\", type: \"useKeyboard\" };\n                    }\n                    if (status.pasteOnMerged) {\n                        return { reason: \"error\", type: \"modifyMerged\" };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                    }\n                    return { reason: \"error\" };\n                }\n\n                var sheet = this._sheet;\n                var range = this._range;\n\n                if(this._workbook.trigger(\"paste\", {range: range, clipboardContent: this._clipboardContent}) ||\n                    sheet.trigger(\"changing\", { data: this._clipboardContent.data, range: range, changeType: COMMAND_TYPES.PASTE })) {\n                    this._event.preventDefault();\n                    return;\n                } else {\n                    this._processPaste();\n                }\n            },\n            _adjustPasteTarget: function(multipliers, sourceRows, sourceCols) {\n                var that = this;\n                var targetRangeRefs = that._targetRangeRefs;\n                var sheet = that._sheet;\n                var RangeRef = kendo.spreadsheet.RangeRef;\n                var UnionRef = kendo.spreadsheet.UnionRef;\n                var refs = [];\n                var compare = function (a, b) {\n                    var result = 0;\n                    var topLeftA = a.topLeft;\n                    var topLeftB = b.topLeft;\n\n                    if (topLeftA.row > topLeftB.row) {\n                        result = 1;\n                    } else if (topLeftA.row < topLeftB.row) {\n                        result = -1;\n                    } else if (topLeftA.col > topLeftB.col) {\n                        result = 1;\n                    } else if (topLeftA.col < topLeftB.col) {\n                        result = -1;\n                    }\n\n                    return result;\n                };\n\n                var refToSelect, rangeToSelect, ref, topLeft, multiplier, i, bottomRight;\n\n                for(i = 0; i < targetRangeRefs.length; i += 1) {\n                    ref = targetRangeRefs[i];\n                    multiplier = multipliers[i];\n                    topLeft = ref.topLeft;\n                    bottomRight = {\n                        row: multiplier.rows * sourceRows + topLeft.row - 1,\n                        col: multiplier.cols * sourceCols + topLeft.col - 1\n                    };\n\n                    refToSelect = new RangeRef(topLeft, bottomRight);\n                    refs.push(refToSelect);\n                }\n\n                if(refs.length === 1) {\n                    rangeToSelect = sheet.range(refToSelect);\n                } else {\n                    refs.sort(compare);\n                    rangeToSelect = sheet.range(new UnionRef(refs));\n                }\n\n                rangeToSelect.select();\n                that._range = rangeToSelect;\n                that._state = that._range.getState();\n            },\n            _processPaste: function() {\n                var that = this;\n                var sheet = that._sheet;\n                var clipboardContent = that._clipboardContent;\n                var range = that._range;\n                var sourceData = clipboardContent.data;\n                var sourceRows = sourceData.length;\n                var sourceCols = sourceData[0].length;\n                var targetRangeRefs = that._targetRangeRefs;\n                var multipliers = that._targetRanges(sourceRows, sourceCols);\n                var i;\n\n                var pasteRef = this._clipboard.pasteRef();\n                if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                    sheet.resize(\n                        Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                        Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                    );\n                }\n\n                that._adjustPasteTarget(multipliers, sourceRows, sourceCols);\n\n                sheet.batch(function() {\n                    for(i = 0; i < targetRangeRefs.length; i++) {\n                        that._populateTargetRange(targetRangeRefs[i], sourceRows, sourceCols, multipliers[i]);\n                    }\n                }, {\n                    recalc: true,\n                    ref: that._range._ref\n                });\n\n                range._adjustRowHeight();\n            },\n            _populateTargetRange: function(ref, sourceRows, sourceCols, multipliers) {\n                var topLeft = ref.topLeft;\n                var range, i, j;\n\n                for(i = 0; i < multipliers.rows; i++) {\n                    for(j = 0; j < multipliers.cols; j++) {\n                        range = this._sheet.range(topLeft.row + sourceRows * i, topLeft.col + sourceCols * j);\n                        range.setState(this._clipboardContent, this._clipboard);\n                    }\n                }\n            },\n            _targetRangeDimensions: function(ref, sourceRows, sourceCols) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var targetRangeRows = bottomRight.row - topLeft.row + 1;\n                var targetRangeCols = bottomRight.col - topLeft.col + 1;\n                var rowsMultiplier = 1;\n                var colsMultiplier = 1;\n\n                if((targetRangeRows % sourceRows === 0 && targetRangeCols % sourceCols === 0)) {\n                    rowsMultiplier = targetRangeRows / sourceRows;\n                    colsMultiplier = targetRangeCols / sourceCols;\n                }\n\n                return {\n                    rows: rowsMultiplier,\n                    cols: colsMultiplier\n                };\n            },\n            _targetRanges: function(sourceRows, sourceCols) {\n                var targetRangeRefs = this._targetRangeRefs;\n                var multipliers = [];\n                var i;\n\n                for(i = 0; i < targetRangeRefs.length; i++) {\n                    multipliers.push(this._targetRangeDimensions(targetRangeRefs[i], sourceRows, sourceCols));\n                }\n\n                return multipliers;\n            }\n        });\n\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function() {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n\n                range._adjustRowHeight();\n            }\n        });\n\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function() {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    //reason : focusclipbord\n                    document.execCommand('paste');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.CutCommand = Command.extend({\n            _eventType: \"cut\",\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function() {\n                var status = this._clipboard.canCopy();\n                var data = [], rangeValues, currentRow;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return { reason: \"error\", type: \"useKeyboard\" };\n                    } else if (status.multiSelection) {\n                        return { reason: \"error\", type: \"unsupportedSelection\" };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                if (this._eventType == \"cut\") {\n                    if (!range.enable()) {\n                        this._event.preventDefault();\n                        return { reason: \"error\", type: \"cannotModifyDisabled\" };\n                    }\n                    this.getState();\n                }\n                if (this._workbook.trigger(this._eventType, { range: range })) {\n                    this._event.preventDefault();\n                } else if (this._eventType == \"cut\") {\n                    rangeValues = range.values();\n                    rangeValues.forEach(function(row){\n                        currentRow = [];\n                        row.forEach(function(){\n                            currentRow.push({});\n                        });\n                        data.push(currentRow);\n                    });\n                    if (range.sheet().trigger(\"changing\", { data: data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                        return;\n                    }\n                    this._clipboard.cut();\n                } else {\n                    this._clipboard.copy();\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                if (range.sheet().trigger(\"changing\", { data: this._state.data, range: range, changeType: COMMAND_TYPES.CUT })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.CopyCommand = kendo.spreadsheet.CutCommand.extend({\n            _eventType: \"copy\",\n            undo: $.noop\n        });\n\n        // function copyToClipboard(html) {\n        //     var textarea = document.createElement('textarea');\n        //     $(textarea).addClass(\"k-spreadsheet-clipboard\")\n        //         .val(html)\n        //         .appendTo(document.body)\n        //         .trigger(\"focus\")\n        //         .select();\n\n        //     document.execCommand('copy');\n\n        //     $(textarea).remove();\n        // }\n\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function() {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('copy');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function(origin) {\n                this._origin = origin;\n            },\n            exec: function() {\n                var range = this.range(), autoFillData;\n                if (!range.enable()) {\n                    return { reason: \"error\", type: \"rangeDisabled\" };\n                }\n                if (range.intersectingArrayFormula()) {\n                    return { reason: \"error\", type: \"intersectsArray\" };\n                }\n                this.getState();\n                try {\n                    autoFillData = range._previewFillFrom(this._origin);\n                    if (range.sheet().trigger(\"changing\", { data: autoFillData.props, range: autoFillData.dest, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                        return;\n                    }\n                    autoFillData.dest._properties(autoFillData.props, true);\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return { reason: \"error\", type: ex.code };\n                    }\n                    throw ex;\n                }\n            },\n            undo: function() {\n                var range = this.range();\n                var state = this._state;\n                if (range.sheet().trigger(\"changing\", { data: state.data, range: range, changeType: COMMAND_TYPES.AUTO_FILL })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            cannotUndo: true,\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function() {\n                if (kendo.support.clipboard.copy) {\n                    document.execCommand('cut');\n                } else {\n                    return { reason: \"error\", type: \"useKeyboard\" };\n                }\n            }\n        });\n\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function() {\n                this.range().filter(this._state);\n            },\n            exec: function() {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function() {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : (this.options.column || 0);\n                var ascending = this.options.value === \"asc\" ? true : false;\n\n                this._state = sheet.getState();\n\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n\n                var reason = range.cantSort();\n                if (reason) {\n                    return { reason: \"error\", type: reason.code };\n                }\n\n                range.sort({ column: col, ascending: ascending });\n            },\n            expandRange: function() {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function() {\n                return this.options.column || 0;\n            },\n            undo: function() {\n                var sheet = this.range().sheet();\n\n                sheet.clearFilter(this.column());\n\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function() {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n\n                if (current) {\n                    this._state = current.columns.filter(function(c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function() {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n\n                if (this.options.valueFilter) {\n                    filterRule = { column: column, filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter) };\n                } else if (this.options.customFilter) {\n                    filterRule = { column: column, filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter) };\n                }\n\n                this.getState();\n\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function(element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n\n                    options = current.columns.map(function(element) {\n                        return element.index === column ? filterRule : { column: element.index, filter: element.filter };\n                    });\n\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n\n                range.filter(options);\n            }\n        });\n\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function() {\n                var range = this.range();\n                var column = this.column();\n\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n\n            undo: function() {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n\n                if (this.axis == \"row\") {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function() {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n\n                if (this.axis == \"row\") {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n\n        var DeleteCommand = Command.extend({\n            exec: function() {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function() {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function(){\n                    self._indexes.forEach(function(x){\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, { layout: true, recalc: true, ref: range._ref, isValue: true });\n            }\n        });\n\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function(range) {\n                return range.resize({ left: -Infinity, right: +Infinity });\n            },\n            _exec: function(sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function(sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function(range) {\n                return range.resize({ top: -Infinity, bottom: +Infinity });\n            },\n            _exec: function(sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function(sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n\n        var AddCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function() {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function(){\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, { layout: true, recalc: true });\n            }\n        });\n\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function() {\n                var value = this._value;\n                var sheet = this.range().sheet();\n\n                if (value === \"left\") {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function(sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function() {\n                var value = this._value;\n                var sheet = this.range().sheet();\n\n                if (value === \"above\") {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function(sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function() {\n                var self = this, sheet = self.range().sheet();\n                this.getState();\n                if (sheet.trigger(\"changing\", { data: self._value, range: self.range(), changeType: COMMAND_TYPES.VALIDATION })) {\n                    return;\n                }\n                try {\n                    sheet.withCultureDecimals(function(){\n                        self.range().validation(self._value);\n                    });\n                } catch(ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title : \"Error in formula\",\n                            body  : ex+\"\",\n                            reason: \"error\"\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            },\n            undo: function() {\n                var editRange = this.range();\n                var state = this._state;\n                if (editRange.sheet().trigger(\"changing\", { data: state.data[0][0].validation, range: editRange, changeType: COMMAND_TYPES.VALIDATION })) {\n                    return;\n                }\n                this.setState(this._state);\n            }\n        });\n\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function() {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return { reason: \"error\", type: \"openUnsupported\" };\n                }\n\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function(){\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog(\"importError\", {\n                            errors: errors\n                        });\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            cannotUndo: true,\n            exec: function() {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === \".xlsx\") {\n                    this.options.workbook.saveAsExcel({\n                        fileName: fileName\n                    });\n                } else if (this.options.extension === \".pdf\") {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {workbook: this.options.workbook, fileName: fileName}));\n                }\n            }\n        });\n\n        var NameCommand = Command.extend({\n            init: function(options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function() {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function() {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger(\"change\", { recalc: true });\n            }\n        });\n\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function() {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger(\"change\", { recalc: true });\n                } catch(ex) {\n                    return {\n                        title: \"Error\",\n                        body: ex+\"\",\n                        reason: \"error\"\n                    };\n                }\n            }\n        });\n\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function() {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger(\"change\", { recalc: true });\n            }\n        });\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var classNames = {\n            wrapper: \"k-spreadsheet-formula-bar\"\n        };\n\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n\n                $(\"<span class='k-icon k-i-formula-fx' />\").prependTo(element);\n\n                var formulaBarWidth = element.width();\n\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($(\"<div/>\")\n                    .appendTo(element), { formulaBarWidth: formulaBarWidth });\n            },\n\n            destroy: function() {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    })(window.kendo);\n\n    (function(kendo, window) {\n\n\n\n\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = \".kendoFormulaInput\";\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: \"k-spreadsheet-formula-input\",\n            listWrapper: \"k-spreadsheet-formula-list\"\n        };\n        var styles = [\n            \"font-family\",\n            \"font-size\",\n            \"font-stretch\",\n            \"font-style\",\n            \"font-weight\",\n            \"letter-spacing\",\n            \"text-transform\",\n            \"line-height\"\n        ];\n\n        //move to core\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n\n        var FormulaInput = Widget.extend({\n            init: function(element, options) {\n                Widget.call(this, element, options);\n\n                element = this.element;\n\n                element.addClass(FormulaInput.classNames.wrapper)\n                    .attr(\"contenteditable\", true)\n                    .attr(\"spellcheck\", false)\n                    .css(\"white-space\", \"pre\");\n\n                if (options && options.formulaBarWidth) {\n                    element.css(\"max-width\", options.formulaBarWidth - 16 + \"px\");\n                }\n\n                if (this.options.autoScale) {\n                    element.on(\"input\", this.scale.bind(this));\n                }\n\n                this._highlightedRefs = [];\n\n                this._formulaSource();\n\n                this._formulaList();\n\n                this._popup();\n\n                this._tooltip();\n\n                element\n                    .on(\"keydown\", this._keydown.bind(this))\n                    .on(\"keyup\", this._keyup.bind(this))\n                    .on(\"blur\", this._blur.bind(this))\n                    .on(\"input click\", this._input.bind(this))\n                    .on(\"focus\", this._focus.bind(this))\n                    .on(\"paste\", this._paste.bind(this));\n            },\n\n            options: {\n                name: \"FormulaInput\",\n                autoScale: false,\n                filterOperator: \"startswith\",\n                scalePadding: 30,\n                minLength: 1,\n                formulaBarWidth: null\n            },\n\n            events: [\n                \"keyup\",\n                \"focus\"\n            ],\n\n            enable: function(enable) {\n                if (enable === undefined) {\n                    return this.element.attr(\"contenteditable\") === \"true\";\n                }\n\n                if (enable) {\n                    this.element.attr(\"contenteditable\", enable);\n                } else {\n                    this.element.removeAttr(\"contenteditable\");\n                }\n\n                this.element.toggleClass(\"k-disabled\", !enable);\n            },\n\n            getPos: function() {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return { begin: a, end: b, collapsed: a == b };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node){\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1 /* Element */) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3 /* Text */) {\n                                pos += node.nodeValue.length;\n                            }\n                        })(div);\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n\n            setPos: function(begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange))  {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return (\n                        a.startOffset != b.startOffset ||\n                        a.endOffset != b.endOffset ||\n                        a.startContainer != b.endContainer ||\n                        a.endContainer != b.endContainer\n                    );\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node){\n                            if (node.nodeType == 3 /* Text */) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1 /* Element */) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        })(node);\n                    } catch (el) {\n                        return { node: el, pos: pos };\n                    }\n                }\n            },\n\n            end: function() {\n                this.setPos(this.length());\n            },\n\n            home: function() {\n                this.setPos(0);\n            },\n\n            select: function() {\n                this.setPos(0, this.length());\n            },\n\n            length: function() {\n                return this.value().length;\n            },\n\n            _formulaSource: function() {\n                var result = [];\n                var value;\n\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({ value: value, text: value });\n                    }\n                }\n\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n\n            _formulaList: function() {\n                this.list = new kendo.ui.StaticList($('<ul />')\n                    .addClass(FormulaInput.classNames.listWrapper)\n                    .insertAfter(this.element), {\n                        autoBind: false,\n                        selectable: true,\n                        change: this._formulaListChange.bind(this),\n                        dataSource: this.formulaSource,\n                        dataValueField: \"value\",\n                        template: \"#:data.value#\"\n                    });\n\n                this.list.element.on(\"mousedown\", function(e) {\n                    e.preventDefault();\n                });\n            },\n\n            _formulaListChange: function() {\n                var tokenCtx = this._tokenContext();\n\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != \"(\") {\n                    completion += \"(\";\n                }\n\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n\n            _popup: function() {\n                this.popup = new kendo.ui.Popup(this.list.element, {\n                    anchor: this.element\n                });\n            },\n\n            _blur: function() {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger(\"blur\");\n            },\n\n            _isFormula: function() {\n                return /^=/.test(this.value());\n            },\n\n            _keydown: function(e) {\n                var key = e.keyCode;\n                var that = this;\n\n                if (KEY_NAMES[key]) {\n                    that.popup.close();\n                    that._navigated = true;\n                } else if (that._move(key)) {\n                    that._navigated = true;\n                    e.preventDefault();\n                }\n\n                that._keyDownTimeout = setTimeout(that._syntaxHighlight.bind(that));\n            },\n\n            _keyup: function() {\n                var popup = this.popup;\n                var value;\n\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n\n                    this.filter(value);\n\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? \"position\" : \"open\"]();\n                        this.list.focusFirst();\n                    }\n                }\n\n                this._navigated = false;\n                this._syntaxHighlight();\n\n                this.trigger(\"keyup\");\n            },\n\n            _input: function() {\n                this._syntaxHighlight();\n            },\n\n            _focus: function() {\n                setTimeout(this._sync.bind(this));\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger(\"focus\");\n            },\n\n            _paste: function(ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData(\"Text\");\n                } else {\n                    text = ev.originalEvent.clipboardData.getData(\"text/plain\");\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n\n            _move: function(key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n\n            _tokenContext: function() {\n                var point = this.getPos();\n                var value = this.value();\n\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return { token: tok, nextToken: tokens[i + 1] };\n                    }\n                }\n\n                return null;\n            },\n\n            _sync: function() {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n\n            _textContainer: function() {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n\n                computedStyles.position = \"absolute\";\n                computedStyles.visibility = \"hidden\";\n                computedStyles.whiteSpace = \"pre\";\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n\n                this._span = $(\"<span style='white-space: pre'/>\").css(computedStyles).insertAfter(this.element);\n            },\n\n            _tooltip: function() {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n\n            tooltip: function(value) {\n                this._cellTooltip.text(value);\n            },\n\n            toggleTooltip: function(show) {\n                this._cellTooltip.toggle(show);\n            },\n\n            isActive: function() {\n                return this.element[0] === kendo._activeElement();\n            },\n\n            filter: function(value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n\n            hide: function() {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n\n            show: function() {\n                this.enable(true);\n                this.element.show();\n            },\n\n            row: function() {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n\n            col: function() {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n\n            position: function(rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n\n                this.show();\n\n                this.element\n                    .css({\n                        \"top\": rectangle.top + 1 + \"px\",\n                        \"left\": rectangle.left + 1 + \"px\"\n                    });\n\n                this._cellTooltip.css({\n                    \"top\": (rectangle.top - this._cellTooltip.height() - 10) + \"px\",\n                    \"left\": rectangle.left\n                });\n            },\n\n            resize: function(rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n\n            canInsertRef: function(isKeyboardAction) {\n                return this._canInsertRef(isKeyboardAction);\n            },\n\n            _canInsertRef: function(isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i-1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n\n                return null;\n\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return { replace: true, token: tok, end: tok.end };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i+1]);\n                            }\n                            return canInsertBetween(tokens[i-1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return { token: left, end: point.end };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == \"op\" && /^(?:punc|op)$/.test(right.type)) {\n                            return { token: left, end: point.end };\n                        }\n                    } else {\n                        if (left.type == \"startexp\") {\n                            return { token: left, end: point.end };\n                        }\n                        if (/^(?:op|punc)$/.test(left.type) && /^[,;({]$/.test(left.value)) {\n                            return { token: left, end: point.end };\n                        }\n                        if (/^(?:ref|sym)/.test(left.type)) {\n                            return { token: left, replace: true, end: left.end };\n                        }\n                        if (/^(?:ref|sym)/.test(right.type)) {\n                            return { token: right, replace: true, end: right.end };\n                        }\n                    }\n                    return false;\n                }\n            },\n\n            refAtPoint: function(sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet.isMerged(ref)) {\n                        ref = ref.topLeft;\n                    }\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n\n            _replaceAt: function(ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n            },\n\n            syncWith: function(formulaInput) {\n                var self = this;\n\n                // IE does not support \"input\" event on elements with contenteditable\n                // https://developer.mozilla.org/en-US/docs/Web/Events/input#Browser_compatibility\n                var eventName = \"input\" + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = \"keydown\" + ns;\n                    iehandler = function() {\n                        setTimeout(handler);\n                    };\n                }\n\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n\n            scale: function() {\n                var element = this.element;\n                var width, height;\n\n                if (!this._span) {\n                    this._textContainer();\n                }\n\n                this._span.html(element.html());\n\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n\n                this._sync();\n            },\n\n            _value: function(value) {\n                this.element.text(value);\n            },\n\n            value: function(value) {\n                if (value === undefined) {\n                    // jQuery's .text() discards the newlines for some reason\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, \"\");\n                }\n\n                this._value(value);\n                this._syntaxHighlight();\n            },\n\n            highlightedRefs: function() {\n                return this._highlightedRefs.slice();\n            },\n\n            _syntaxHighlight: function() {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n\n                if (pos && !pos.collapsed) {\n                    // Backward selection (hold shift, move right to left)\n                    // will not work properly if we continuously re-set\n                    // the HTML.  If the selection is on, presumably the\n                    // text has already been highlighted, so stop here.\n                    return;\n                }\n\n                if (!(/^=/.test(value))) {\n                    // if an user deleted the initial =, reset the text to\n                    // discard any highlighting.  Only do that once.\n                    if (this._highlightedRefs.length) {\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n\n                    // also make sure the completion popup goes away\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n\n                    return; // avoid messing with the cursor position below\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function(tok){\n                        tok.active = false;\n                        tok.cls = [ \"k-syntax-\" + tok.type ];\n\n                        if (tok.type == \"ref\") {\n                            tok.colorClass = refClasses[(refIndex++) % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == \"punc\") {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push(\"k-syntax-paren-match\");\n                                            open.cls.push(\"k-syntax-paren-match\");\n                                        }\n                                    } else {\n                                        tok.cls.push(\"k-syntax-error\");\n                                        open.cls.push(\"k-syntax-error\");\n                                    }\n                                } else {\n                                    tok.cls.push(\"k-syntax-error\");\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push(\"k-syntax-at-point\");\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == \"func\" && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push(\"k-syntax-error\");\n                        }\n                    });\n                    tokens.reverse().forEach(function(tok){\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) +\n                            \"<span class='\" + tok.cls.join(\" \") + \"'>\" + text + \"</span>\" +\n                            value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n\n                this._highlightedRefs = highlightedRefs;\n            },\n\n            destroy: function() {\n                this._editorToSync = null;\n\n                this.element.off(ns);\n\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n\n                this._cellTooltip = null;\n                this._span = null;\n\n                this.popup.destroy();\n                this.popup = null;\n\n                Widget.fn.destroy.call(this);\n            },\n\n            insertNewline: function() {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? \"\\n\\n\" : \"\\n\" + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n\n        function isOpenParen(ch) {\n            return ch == \"(\" || ch == \"[\" || ch == \"{\";\n        }\n\n        function isCloseParen(ch) {\n            return ch == \")\" || ch == \"]\" || ch == \"}\";\n        }\n\n        function isMatchingParen(close, open) {\n            return open == \"(\" ? close == \")\"\n                :  open == \"[\" ? close == \"]\"\n                :  open == \"{\" ? close == \"}\"\n                :  false;\n        }\n\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    })(kendo, window);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n        var isAlphaNum = function(keyCode) {\n            if ((keyCode > 47 && keyCode < 58)   || // number keys\n                (keyCode > 64 && keyCode < 91)   || // letter keys\n                (keyCode > 95 && keyCode < 112)  || // numpad keys\n                (keyCode > 185 && keyCode < 193) || // ;=,-./` (in order)\n                (keyCode > 218 && keyCode < 223) || // [\\]' (in order)\n                (keyCode === 229)                   // combined key event?\n               ) {\n                return true;\n            }\n\n            return false;\n        };\n\n        var keyName = function(event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n\n            if (!name && isAlphaNum(keyCode)) {\n                name = \":alphanum\";\n            }\n\n            // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\n            //\n            // Fix for https://github.com/telerik/kendo-ui-core/issues/2284\n            // (starting editor with `=` on Firefox)\n            if (!name && event.key && event.key.length == 1) {\n                name = \":alphanum\";\n            }\n\n            return name;\n        };\n\n        var EventListener = kendo.Class.extend({\n            init: function(target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.touchProxy = this.touch.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n\n                target.on(\"keydown\", this.keyDownProxy);\n                target.on(\"contextmenu mousedown cut copy paste scroll wheel click dblclick focus\", this.mouseProxy);\n                target.on(\"touchmove touchend\", this.touchProxy);\n\n                $(document.documentElement).on(\"mousemove mouseup\", this.mouseProxy);\n                $(document.documentElement).on(\"touchmove touchend\", this.touchProxy);\n\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n\n            keyDown: function(e) {\n                // Do not handle keys for Toolbar Tab switch shortcuts\n                if (e.altKey && (e.key === \"n\" || e.key === \"h\" || e.key === \"a\")) {\n                    return;\n                }\n\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n\n            touch: function(e) {\n                this.handleEvent(e, e.type);\n            },\n\n            mouse: function(e) {\n                var rightClick;\n\n                if (e.which) {\n                    rightClick = (e.which == 3);\n                } else if (e.button) {\n                    rightClick = (e.button == 2);\n                }\n\n                var type = e.type;\n\n                if (type === \"mousedown\") {\n                    if (rightClick) {\n                       type = \"rightmousedown\";\n                    } else {\n                        this._pressLocation = { x: e.pageX, y: e.pageY };\n                    }\n                }\n\n                if (type === \"mouseup\") {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n\n                if (type === \"mousemove\" && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx*dx + dy*dy);\n\n                    if (distance > this.threshold) {\n                        type = \"mousedrag\";\n                    }\n                }\n\n                this.handleEvent(e, type);\n            },\n\n            handleEvent: function(e, name) {\n                var eventKey = \"\";\n\n                e.mod = Mac ? e.metaKey : (e.ctrlKey && !e.altKey);\n\n                if (e.altKey) {\n                    eventKey += \"alt+\";\n                }\n\n                if (e.shiftKey) {\n                    eventKey += \"shift+\";\n                }\n\n                if (e.ctrlKey) {\n                    eventKey += \"ctrl+\";\n                }\n\n                eventKey += name;\n\n                var catchAllHandler = this._handlers['*+' + name];\n\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n\n                var handler = this._handlers[eventKey];\n\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n\n            on: function(event, callback) {\n                var handlers = this._handlers;\n\n                if (typeof callback === \"string\") {\n                    callback = this._observer[callback];\n                }\n\n                if (typeof event === \"string\") {\n                    event = event.split(\",\");\n                }\n\n                event.forEach(function(e) {\n                    handlers[e] = callback;\n                });\n            },\n\n            destroy: function() {\n                this.target.off(\"keydown\", this.keyDownProxy);\n                this.target.off(\"keydown\", this.mouseProxy);\n                $(document.documentElement).off(\"mousemove mouseup\", this.mouseProxy);\n            }\n        });\n\n        kendo.spreadsheet.EventListener = EventListener;\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n\n        var NilNode = new (function NIL() { \n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        })();\n\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n\n            return node;\n        }\n\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n\n            return node;\n        }\n\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n\n            return split(skew(node));\n        }\n\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n\n            if (node.left.level < (node.level - 1) || node.right.level < (node.level - 1)) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n\n            return node;\n        }\n\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n\n            intersects: function(range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n\n            clone: function() {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n\n        var RangeTree = kendo.Class.extend({\n            init: function RangeTree() {\n                this.root = NilNode;\n            },\n\n            insert: function(value) {\n                this.root = insert(this.root, value);\n            },\n\n            remove: function(value) {\n                this.root = remove(this.root, value);\n            },\n\n            findrange: function(value) {\n                var node = this.root;\n\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n\n                return null;\n            },\n\n            values: function() {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n\n            intersecting: function(start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n\n            map: function(callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n\n            forEach: function(callback) {\n                forEach(this.root, callback);\n            },\n\n            clone: function() {\n                return this.map(function(value) {\n                    return value.clone();\n                });\n            },\n\n            first: function() {\n                var first = this.root;\n                while(first.left != NilNode) {\n                    first = first.left;\n                }\n\n                return first;\n            },\n\n            last: function() {\n                var last = this.root;\n                while(last.right != NilNode) {\n                    last = last.right;\n                }\n\n                return last;\n            }\n        });\n\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n\n            var value = node.value;\n\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n\n        function forEach(root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            forEach(root.left, callback);\n            callback(root.value);\n            forEach(root.right, callback);\n        }\n\n        var RangeList = kendo.Class.extend({\n            init: function RangeList(start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n\n            values: function() {\n                return this.tree.values();\n            },\n\n            map: function(callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n\n            forEach: function(callback) {\n                this.tree.forEach(callback);\n            },\n\n            intersecting: function(start, end) {\n                return this.tree.intersecting(start, end);\n            },\n\n            first: function() {\n                return this.tree.first().value;\n            },\n\n            last: function() {\n                return this.tree.last().value;\n            },\n\n            insert: function(start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n\n            value: function(start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n\n                        this.tree.remove(range);\n\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n\n                this.insert(start, end, value);\n            },\n\n            expandedValues: function(start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n\n                var rangeIndex = 0;\n\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex ++;\n                    }\n\n                    result.push({ index: i - start, value: ranges[rangeIndex].value });\n                }\n\n                return result;\n            },\n\n            sortedIndices: function(start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n\n                var comparer = function(a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n\n                    return valueComparer(a.value, b.value);\n                };\n\n                if (indices) {\n                    comparer = function(a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n\n                        return a.index - b.index;\n                    };\n                }\n\n                result.sort(comparer);\n\n                return result;\n            },\n\n            sort: function(start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n\n                var values = this.expandedValues(start, end);\n\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n\n            copy: function(sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n\n                var start = targetStart;\n                var end;\n\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n\n                    var rangeEnd = values[i].end;\n\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n\n                    end = start + (rangeEnd - rangeStart);\n\n                    this.value(start, end, values[i].value);\n\n                    start = ++end;\n                }\n            },\n\n            iterator: function(start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n\n            getState: function() {\n                return this.tree.clone();\n            },\n\n            setState: function(state) {\n                this.tree = state.clone();\n            },\n\n            toJSON: function() {\n                return this.values();\n            },\n\n            fromJSON: function(values) {\n                values.forEach(function(v){\n                    this.value(v.start, v.end, v.value);\n                }, this);\n            }\n        });\n\n        var Iterator = kendo.Class.extend({\n            init: function(start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n\n            unique: function() {\n                return this.ranges.map(function(range) {\n                    return range.value;\n                });\n            },\n\n            at: function(index) {\n                while (this.ranges[this.index] && this.ranges[this.index].end < index) {\n                    this.index ++;\n                }\n\n                return this.ranges[this.index] && this.ranges[this.index].value;\n            },\n\n            forEach: function(callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n\n                this.index = 0;\n            }\n        });\n\n        var SparseRangeList = RangeList.extend({\n            init: function(start, end, value) {\n                this._defaultValue = value;\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n\n            intersecting: function(start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n\n                if (!ranges.length) {\n                    return [this.range];\n                }\n\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n\n                    result.push(range);\n                    start = range.end + 1;\n                }\n\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n\n                return result;\n            },\n\n            insert: function(start, end, value) {\n                if (value == null) {\n                    value = this._defaultValue;\n                }\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n\n            lastRangeStart: function() {\n                var node = this.tree.root;\n\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n\n                while(node.right !== NilNode) {\n                    node = node.right;\n                }\n\n                return node.value.end + 1;\n            }\n        });\n\n\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    })(kendo);\n\n    (function(kendo) {\n\n        var Property = kendo.Class.extend({\n            init: function(list) {\n                this.list = list;\n            },\n\n            get: function(index) {\n                return this.parse(this.list.value(index, index));\n            },\n\n            set: function(start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n\n                this.list.value(start, end, value);\n            },\n\n            parse: function(value) {\n                return value;\n            },\n\n            copy: function(start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n\n            iterator: function(start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n\n        var JsonProperty = Property.extend({\n            set: function(start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n\n            parse: function(value) {\n                return JSON.parse(value);\n            }\n        });\n\n        var ValueProperty = Property.extend({\n            init: function(values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n\n            set: function(start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start,end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                } else if (typeof value == \"number\") {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n\n                this.list.value(start, end, value);\n            }\n        });\n\n        function toExcelFormat(format) {\n            return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n        }\n\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                { property: Property, name: \"format\", value: null, sortable: true, serializable: true },\n                { property: ValueProperty, name: \"value\", value: null, sortable: true, serializable: true, depends: \"format\" },\n                { property: Property, name: \"formula\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"background\", value: null, sortable: true, serializable: true },\n                { property: JsonProperty, name: \"vBorders\", value: null, sortable: false, serializable: false },\n                { property: JsonProperty, name: \"hBorders\", value: null, sortable: false, serializable: false },\n                { property: JsonProperty, name: \"dBorders\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"color\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"fontFamily\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"underline\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"fontSize\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"italic\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"bold\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"textAlign\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"indent\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"verticalAlign\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"wrap\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"validation\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"enable\", value: null, sortable: false, serializable: true },\n                { property: Property, name: \"link\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"editor\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"comment\", value: null, sortable: true, serializable: true },\n                { property: Property, name: \"html\", value: null, sortable: true, serializable: true }\n            ],\n\n            init: function(rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n\n                this.specs.forEach(function(spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n\n                // XXX: this is a hack but I have no better ideas at this\n                // point.  The getState() method in a SparseRangeList\n                // clones the tree (which just copies values over), but\n                // formulas are objects maintaining complex state.\n                // https://github.com/telerik/kendo-ui-core/issues/2816\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n\n            _resize: function(new_rows, new_cols) {\n                var self = this;\n                var old_rows = self.rowCount;\n                var cell_count = new_rows * new_cols - 1;\n                function scaleIndex(index) {\n                    var col = index / old_rows | 0;\n                    var row = index % old_rows;\n                    return col * new_rows + row;\n                }\n                function scaleNode(node) {\n                    // node is a ValueRange from rangelist.js\n                    // start/end are rowCount * col + row\n                    node.start = scaleIndex(node.start);\n                    node.end = scaleIndex(node.end);\n                }\n                Object.keys(self.lists).forEach(function(name) {\n                    var list = self.lists[name];\n                    if (new_rows != old_rows) {\n                        list.forEach(scaleNode);\n                    }\n                    list.range.end = cell_count;\n                });\n                self.rowCount = new_rows;\n                self.columnCount = new_cols;\n                self.cellCount = cell_count;\n            },\n\n            getState: function() {\n                var state = {};\n\n                this.specs.forEach(function(spec) {\n                   state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n\n                return state;\n            },\n\n            setState: function(state) {\n                this.specs.forEach(function(spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n\n            get: function(name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n\n                switch (name) {\n                  case \"borderRight\":\n                    index += this.rowCount;\n                    /* falls through */\n                  case \"borderLeft\":\n                    name = \"vBorders\";\n                    break;\n\n                  case \"borderBottom\":\n                    index++;\n                    /* falls through */\n                  case \"borderTop\":\n                    name = \"hBorders\";\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n\n            set: function(name, start, end, value) {\n                switch (name) {\n                  case \"borderRight\":\n                    start += this.rowCount;\n                    end += this.rowCount;\n                    /* falls through */\n                  case \"borderLeft\":\n                    name = \"vBorders\";\n                    break;\n\n                  case \"borderBottom\":\n                    start++;\n                    end++;\n                    /* falls through */\n                  case \"borderTop\":\n                    name = \"hBorders\";\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n\n            fromJSON: function(index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n\n                [ \"borderLeft\", \"borderRight\", \"borderTop\", \"borderBottom\" ].forEach(function(b){\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n\n            copy: function(sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function(spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n\n            iterator: function(name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function(index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n\n            sortable: function() {\n                return this.specs.filter(function(spec) { return spec.sortable; })\n                    .map(function(spec) {\n                        return this.lists[spec.name];\n                    }, this);\n            },\n\n            iterators: function(start, end) {\n                return this.specs.reduce(function(ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n\n            forEach: function(start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator(\"hBorders\", start, end + 1);\n                var leftBorders = this.iterator(\"vBorders\", start, end);\n                var rightBorders = this.iterator(\"vBorders\", start + this.rowCount, end + this.rowCount);\n                var values, index;\n\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n\n                for (index = start; index <= end; index++) {\n                    values = {};\n\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n\n                    addBorder(\"borderLeft\", leftBorders, index);\n                    addBorder(\"borderRight\", rightBorders, index + this.rowCount);\n                    addBorder(\"borderTop\", hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder(\"borderBottom\", hBorders, index + 1);\n                    }\n\n                    callback(values);\n                }\n            },\n\n            forEachProperty: function(callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone(); // x.value is Formula or Validation\n            return x;\n        }\n\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree; // because it's a new RangeTree now\n            return tree;\n        }\n\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function(a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [ \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\" ]);\n\n    })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n        \"use strict\";\n\n        var spreadsheet$8 = kendo.spreadsheet;\n        var Class$2 = kendo.Class;\n\n        function columnName(colIndex) {\n            var letter = Math.floor(colIndex / 26) - 1;\n            return (letter >= 0 ? columnName(letter) : \"\") + String.fromCharCode(65 + (colIndex % 26));\n        }\n\n        function displaySheet(sheet) {\n            if (/^[a-z_][a-z0-9_]*$/i.test(sheet)) {\n                return sheet;\n            }\n            return \"'\" + sheet.replace(/\\x27/g, \"\\\\'\") + \"'\";\n        }\n\n        function displayRef(sheet, row, col, rel) {\n            var aa = \"\";\n\n            ++row;\n\n            if (!isFinite(row)) {\n                row = \"\";\n            }\n            else if (rel != null && !(rel & 2)) {\n                row = \"$\" + row;\n            }\n\n            if (!isFinite(col)) {\n                col = \"\";\n            }\n            else {\n                aa = columnName(col);\n                if (rel != null && !(rel & 1)) {\n                    aa = \"$\" + aa;\n                }\n            }\n\n            if (sheet) {\n                return displaySheet(sheet) + \"!\" + aa + row;\n            } else {\n                return aa + row;\n            }\n        }\n\n        /* -----[ References ]----- */\n\n        var Ref$4 = Class$2.extend({\n            type: \"ref\",\n            sheet: \"\",\n            clone: function() {\n                return this;\n            },\n            hasSheet: function() {\n                return this._hasSheet;\n            },\n            simplify: function() {\n                return this;\n            },\n            setSheet: function(sheet, hasSheet) {\n                this.sheet = sheet;\n                if (hasSheet != null) {\n                    this._hasSheet = hasSheet;\n                }\n                return this;\n            },\n            absolute: function(){\n                return this;\n            },\n            relative: function(){\n                return this;\n            },\n            adjust: function(){\n                return this;\n            },\n            toString: function() {\n                return this.relative(0, 0, 3, 3).print(0, 0);\n            },\n            forEach: function(callback, obj) {\n                callback.call(obj, this);\n            },\n            map: function(callback, obj) {\n                return callback.call(obj, this);\n            },\n            intersects: function(ref) {\n                return this.intersect(ref) !== NULL$1;\n            },\n            isCell: function() {\n                return false;\n            },\n            toRow: function() {\n                return this;\n            },\n            toColumn: function() {\n                return this;\n            },\n\n            // UnionRef overrides these, to access its subranges.\n            first: function() {\n                return this;\n            },\n            lastRange: function() {\n                return this;\n            },\n            size: function() {\n                return 1;\n            },\n            rangeAt: function() {\n                return this;\n            },\n            nextRangeIndex: function() {\n                return 0;\n            },\n            previousRangeIndex: function() {\n                return 0;\n            },\n            eq: function(reference) {\n                var r1 = this;\n                var r2 = reference;\n\n                if (r1 === NULL$1 || r2 === NULL$1) {\n                    return r1 === r2;\n                }\n\n                // make positions consistent\n                if ((r2 instanceof CellRef$5) || (r2 instanceof RangeRef$4 && !(r1 instanceof CellRef$5))) {\n                   r1 = reference;\n                   r2 = this;\n                }\n\n                if (r1 instanceof CellRef$5) { // cell eq *\n                    r2 = r2.simplify();\n                    return r2 instanceof CellRef$5 && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n                }\n                else if (r1 instanceof RangeRef$4) { // range eq range/union\n                    if (r2 instanceof RangeRef$4) {\n                        return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                    }\n                    if (r2 instanceof UnionRef$3) {\n                        return r2.single() && r1.eq(r2.refs[0]);\n                    }\n                }\n                else if (r1 instanceof UnionRef$3 && r2 instanceof UnionRef$3) { // union eq union\n                    var refs1 = r1.refs;\n                    var refs2 = r2.refs;\n                    if (refs1.length != refs2.length) {\n                       return false;\n                    }\n\n                    for (var i = 0, len = refs1.length; i < len; i++) {\n                        if (!refs1[i].eq(refs2[i])) {\n                            return false;\n                        }\n                    }\n\n                    return true;\n                }\n\n                return r1 === r2;   // XXX: possibly NameRef when we'll support it.\n            },\n\n            concat: function(ref) {\n                return new UnionRef$3([this, ref]);\n            },\n\n            replaceAt: function(index, ref) {\n                return ref;\n            },\n\n            forEachColumnIndex: function(callback) {\n                this.forEachAxisIndex('col', callback);\n            },\n\n            forEachRowIndex: function(callback) {\n                this.forEachAxisIndex('row', callback);\n            },\n\n            forEachAxisIndex: function(axis, callback) {\n                var sorted = [];\n\n                var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n\n                this[method](function(ref) {\n                    var index = ref.first()[axis];\n                    if (sorted.indexOf(index) === -1) {\n                        sorted.push(index);\n                    }\n                });\n\n                sorted.sort(function(a,b) {\n                    return a > b ? 1 : (a < b ? -1 : 0);\n                }).forEach(callback);\n            },\n\n            valid: function() {\n                return false;\n            },\n\n            renameSheet: function(oldSheetName, newSheetName) {\n                if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                    this.sheet = newSheetName;\n                    return true;\n                }\n            }\n        });\n\n        Ref$4.display = displayRef;\n\n        /* -----[ Null reference ]----- */\n\n        var NULL$1 = new (Ref$4.extend({\n            init: function NullRef(){},\n            print: function() {\n                return \"#NULL!\";\n            },\n            eq: function(ref) {\n                return ref === this;\n            },\n            forEach: function() {}\n        }))();\n\n        /* -----[ Name reference ]----- */\n\n        var NameRef$3 = Ref$4.extend({\n            ref: \"name\",\n            init: function NameRef(name){\n                this.name = name;\n            },\n            clone: function() {\n                return new NameRef$3(this.name)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            print: function() {\n                var ret = displaySheet(this.name);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + \"!\" + ret;\n                }\n                return ret;\n            }\n        });\n\n        /* -----[ Cell reference ]----- */\n\n        var CellRef$5 = Ref$4.extend({\n            ref: \"cell\",\n            init: function CellRef(row, col, rel) {\n                this.row = row;\n                this.col = col;\n                this.rel = rel || 0;\n            },\n            clone: function() {\n                return new CellRef$5(this.row, this.col, this.rel)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            intersect: function(ref) {\n                if (ref instanceof CellRef$5) {\n                    if (this.eq(ref)) {\n                        return this;\n                    } else {\n                        return NULL$1;\n                    }\n                }\n                return ref.intersect(this);\n            },\n            print: function(trow, tcol, mod) {\n                var col = this.col, row = this.row, rel = this.rel, abs;\n                if (trow == null && rel) {\n                    var sheet = this.hasSheet() ? displaySheet(this.sheet) + \"!\" : \"\";\n                    if (isFinite(col)) {\n                        col = rel & 1 ? (\"C[\" + col + \"]\") : (\"C\" + (col + 1));\n                    } else {\n                        col = \"\";\n                    }\n                    if (isFinite(row)) {\n                        row = rel & 2 ? (\"R[\" + row + \"]\") : (\"R\" + (row + 1));\n                    } else {\n                        row = \"\";\n                    }\n                    return sheet + row + col;\n                } else {\n                    abs = this.absolute(trow, tcol);\n                    if (mod) {\n                        // Hacks: see the big comment below in `absolute()`\n                        row = abs.row % 0x100000;\n                        col = abs.col % 0x4000;\n                        if (row < 0) {\n                            row += 0x100000;\n                        }\n                        if (col < 0) {\n                            col += 0x4000;\n                        }\n                        return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                    }\n                    return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : \"#REF!\";\n                }\n            },\n            absolute: function(arow, acol) {\n                var ret = this.clone();\n                if (ret.rel & 3 === 0) {\n                    return ret;    // already absolute\n                }\n\n                // Hacks: we make coordinates modulo 0x4000 (max col) and 0x100000 (max row).  This\n                // fixes importing relative references in definedName-s from Excel.  Example in\n                // Excel: select cell E3, open the Name Manager (in Formula tab) and define name\n                // TEST with value Sheet1!A1:C3.  The serialization of this name in XLSX is:\n                //\n                //     <definedName name=\"TEST\">Sheet1!XFA1048575:XFC1</definedName>\n                //\n                // This is insane, of course, but oh well.  Excel.  If you type in E3 =SUM(TEST) it\n                // works (it actually sums the cells), but if you type =SUM(Sheet1!XFA1048575:XFC1)\n                // you get back zero.  Let's see why SUM(TEST) works:\n                //\n                //     XFA1048575:XFC1                   E3\n                //     (zero-based indexes below)\n                //\n                //     R[1048574]C[16380]:R[0]C[16382] + R2C4 = R1048576C16384:R2C16386\n                //                                            % (0x100000, 0x4000)\n                //                                            = R0C0:R2C2 (== A1:C3)\n                //\n                // So XFA1048575:XFC1 is relocated to E3 at evaluation time, and because we take\n                // rows modulo 0x100000 and cols modulo 0x4000, we get back the correct range.\n                //\n                // IMO Excel should disallow A1-style relative references in name definitions\n                // (simply because the meaning of the A1:C3 you type in Name Manager depends on the\n                // active cell) and only allow R1C1 notation — that's unambiguous.  But it doesn't.\n                // Moreover, R1C1-style refs in XLSX are explicitly forbidden by the spec, and the\n                // hacks above are not documented — how else could we have fun implementing a XLSX\n                // reader?\n                if (ret.rel & 1) {\n                    // relative col, add anchor\n                    ret.col = (ret.col + acol) % 0x4000;\n                }\n                if (ret.rel & 2) {\n                    // relative row, add anchor\n                    ret.row = (ret.row + arow) % 0x100000;\n                }\n\n                ret.rel = 0;\n                return ret;\n            },\n            toRangeRef: function() {\n                return new RangeRef$4(this, this);\n            },\n            relative: function(arow, acol, rel) {\n                if (rel == null) {\n                    rel = this.rel;\n                }\n                var row = rel & 2 ? this.row - arow : this.row;\n                var col = rel & 1 ? this.col - acol : this.col;\n                return new CellRef$5(row, col, rel)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            height: function() {\n                return 1;\n            },\n            width: function() {\n                return 1;\n            },\n            toString: function() {\n                return displayRef(null, this.row, this.col, 3);\n            },\n            isCell: function() {\n                return true;\n            },\n            leftColumn: function() {\n                return this;\n            },\n            rightColumn: function() {\n                return this;\n            },\n            topRow: function() {\n                return this;\n            },\n            bottomRow: function() {\n                return this;\n            },\n            forEachRow: function(callback) {\n                callback(this.toRangeRef());\n            },\n            forEachColumn: function(callback) {\n                callback(this.toRangeRef());\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                var ref = this.absolute(row, col);\n                if (forRow) {\n                    if (ref.row >= start) {\n                        if (delta < 0 && ref.row < start - delta) {\n                            return NULL$1;\n                        }\n                        ref.row += delta;\n                    }\n                } else {\n                    if (ref.col >= start) {\n                        if (delta < 0 && ref.col < start - delta) {\n                            return NULL$1;\n                        }\n                        ref.col += delta;\n                    }\n                }\n                if (trow != null && tcol != null) {\n                    ref = ref.relative(trow, tcol, this.rel);\n                }\n                return ref;\n            },\n            valid: function() {\n                if (this.rel) {\n                    throw new Error(\"valid() called on relative reference\");\n                }\n                var col = this.col, row = this.row;\n                return !((isFinite(col) && col < 0) || (isFinite(row) && row < 0));\n            }\n        });\n\n        /* -----[ Range reference ]----- */\n\n        var RangeRef$4 = Ref$4.extend({\n            ref: \"range\",\n            init: function RangeRef(tl, br) {\n                if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                    // \"3D\" reference\n                    this.endSheet = br.sheet;\n                }\n                // we want to drop any sheet information from the cells here.\n                this.topLeft = new CellRef$5(tl.row, tl.col, tl.rel);\n                this.bottomRight = new CellRef$5(br.row, br.col, br.rel);\n                this.normalize();\n            },\n            clone: function() {\n                return new RangeRef$4(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n            },\n            _containsRange: function(range) {\n                return this._containsCell(range.topLeft)\n                    && this._containsCell(range.bottomRight);\n            },\n            _containsCell: function(cell) {\n                return cell.sheet == this.sheet\n                    && cell.row >= this.topLeft.row\n                    && cell.col >= this.topLeft.col\n                    && cell.row <= this.bottomRight.row\n                    && cell.col <= this.bottomRight.col;\n            },\n            contains: function(ref) {\n                if (ref instanceof Array) {\n                    var that = this;\n\n                    return ref.some(function(_ref) { return that.contains(_ref); });\n                }\n                if (ref instanceof CellRef$5) {\n                    return this._containsCell(ref);\n                }\n                if (ref instanceof RangeRef$4) {\n                    return this._containsRange(ref);\n                }\n                return false;\n            },\n            _intersectRange: function(ref) {\n                if (this.sheet != ref.sheet) {\n                    return NULL$1;\n                }\n                var a_left    = this.topLeft.col;\n                var a_top     = this.topLeft.row;\n                var a_right   = this.bottomRight.col;\n                var a_bottom  = this.bottomRight.row;\n                var b_left    = ref.topLeft.col;\n                var b_top     = ref.topLeft.row;\n                var b_right   = ref.bottomRight.col;\n                var b_bottom  = ref.bottomRight.row;\n                if (a_left <= b_right &&\n                    b_left <= a_right &&\n                    a_top <= b_bottom &&\n                    b_top <= a_bottom)\n                {\n                    return new RangeRef$4(\n                        // topLeft\n                        new CellRef$5(Math.max(a_top, b_top),\n                                    Math.max(a_left, b_left)),\n                        // bottomRight\n                        new CellRef$5(Math.min(a_bottom, b_bottom),\n                                    Math.min(a_right, b_right))\n                    ).setSheet(this.sheet, this.hasSheet());\n                } else {\n                    return NULL$1;\n                }\n            },\n            intersect: function(ref) {\n                if (ref instanceof CellRef$5) {\n                    return this._containsCell(ref) ? ref : NULL$1;\n                }\n                if (ref instanceof RangeRef$4) {\n                    return this._intersectRange(ref).simplify();\n                }\n                if (ref instanceof UnionRef$3) {\n                    return ref.intersect(this);\n                }\n                return NULL$1;        // can't handle NameRef-s here.\n            },\n            simplify: function() {\n                if (this.isCell()) {\n                    return new CellRef$5(\n                        this.topLeft.row,\n                        this.topLeft.col,\n                        this.topLeft.rel\n                    ).setSheet(this.sheet, this.hasSheet());\n                }\n                return this;\n            },\n            normalize: function() {\n                var a = this.topLeft, b = this.bottomRight;\n                var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n                var rr1 = a.rel & 2, rc1 = a.rel & 1;\n                var rr2 = b.rel & 2, rc2 = b.rel & 1;\n                var tmp, changes = false;\n                // do not attempt to normalize unless relativeness of rows and cols are the same.\n                // https://github.com/telerik/kendo-ui-core/issues/4278\n                if (rr1 === rr2 && rc1 === rc2) {\n                    if (r1 > r2) {\n                        changes = true;\n                        tmp = r1; r1 = r2; r2 = tmp;\n                        tmp = rr1; rr1 = rr2; rr2 = tmp;\n                    }\n                    if (c1 > c2) {\n                        changes = true;\n                        tmp = c1; c1 = c2; c2 = tmp;\n                        tmp = rc1; rc1 = rc2; rc2 = tmp;\n                    }\n                    if (changes) {\n                        this.topLeft = new CellRef$5(r1, c1, rc1 | rr1);\n                        this.bottomRight = new CellRef$5(r2, c2, rc2 | rr2);\n                    }\n                }\n                return this;\n            },\n            print: function(trow, tcol, mod) {\n                if (mod || this.absolute(trow, tcol).valid()) {\n                    var ret = this.topLeft.print(trow, tcol, mod)\n                        + \":\"\n                        + this.bottomRight.print(trow, tcol, mod);\n                    if (this.hasSheet()) {\n                        ret = displaySheet(this.sheet)\n                            + (this.endSheet ? \":\" + displaySheet(this.endSheet) : \"\")\n                            + \"!\" + ret;\n                    }\n                    return ret;\n                }\n                return \"#REF!\";\n            },\n            absolute: function(arow, acol) {\n                return new RangeRef$4(\n                    this.topLeft.absolute(arow, acol),\n                    this.bottomRight.absolute(arow, acol)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            relative: function(arow, acol, relTL, relBR) {\n                if (relBR == null) {\n                    relBR = relTL;\n                }\n                return new RangeRef$4(\n                    this.topLeft.relative(arow, acol, relTL),\n                    this.bottomRight.relative(arow, acol, relBR)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            height: function() {\n                if (this.topLeft.rel != this.bottomRight.rel) {\n                    throw new Error(\"Mixed relative/absolute references\");\n                }\n                return this.bottomRight.row - this.topLeft.row + 1;\n            },\n            width: function() {\n                if (this.topLeft.rel != this.bottomRight.rel) {\n                    throw new Error(\"Mixed relative/absolute references\");\n                }\n                return this.bottomRight.col - this.topLeft.col + 1;\n            },\n            collapse: function() {\n                return this.topLeft.toRangeRef();\n            },\n            leftColumn: function() {\n                return new RangeRef$4(this.topLeft, new CellRef$5(this.bottomRight.row, this.topLeft.col));\n            },\n            rightColumn: function() {\n                return new RangeRef$4(new CellRef$5(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n            },\n            topRow: function() {\n                return new RangeRef$4(this.topLeft, new CellRef$5(this.topLeft.row, this.bottomRight.col));\n            },\n            bottomRow: function() {\n                return new RangeRef$4(new CellRef$5(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n            },\n            toRangeRef: function() {\n                return this;\n            },\n            toRow: function(row) {\n                row += Math.max(0, this.topLeft.row);\n                return new RangeRef$4(\n                    new CellRef$5(row, this.topLeft.col),\n                    new CellRef$5(row, this.bottomRight.col)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            toColumn: function(col) {\n                col += Math.max(0, this.topLeft.col);\n                return new RangeRef$4(\n                    new CellRef$5(this.topLeft.row, col),\n                    new CellRef$5(this.bottomRight.row, col)\n                ).setSheet(this.sheet, this.hasSheet());\n            },\n            toCell: function(row, col) {\n                row += Math.max(0, this.topLeft.row);\n                col += Math.max(0, this.topLeft.col);\n                return new CellRef$5(row, col, 0)\n                    .setSheet(this.sheet, this.hasSheet());\n            },\n            forEachRow: function(callback) {\n                var startRow = this.topLeft.row;\n                var endRow = this.bottomRight.row;\n                var startCol = this.topLeft.col;\n                var endCol = this.bottomRight.col;\n\n                for (var i = startRow; i <= endRow; i++) {\n                    callback(new RangeRef$4(\n                        new CellRef$5(i, startCol),\n                        new CellRef$5(i, endCol)\n                    ));\n                }\n            },\n            forEachColumn: function(callback) {\n                var startRow = this.topLeft.row;\n                var endRow = this.bottomRight.row;\n                var startCol = this.topLeft.col;\n                var endCol = this.bottomRight.col;\n\n                for (var i = startCol; i <= endCol; i++) {\n                    callback(new RangeRef$4(\n                        new CellRef$5(startRow, i),\n                        new CellRef$5(endRow, i)\n                    ));\n                }\n            },\n            intersecting: function(refs) {\n                return refs.filter(function(ref) {\n                    return ref.toRangeRef().intersects(this);\n                }, this);\n            },\n\n            union: function(refs, callback) {\n                var intersecting = this.intersecting(refs);\n\n                var topLeftRow = this.topLeft.row;\n                var topLeftCol = this.topLeft.col;\n                var bottomRightRow = this.bottomRight.row;\n                var bottomRightCol = this.bottomRight.col;\n\n                var modified = false;\n\n                intersecting.forEach(function(ref) {\n                    ref = ref.toRangeRef();\n                    if (ref.topLeft.row < topLeftRow) {\n                        modified = true;\n                        topLeftRow = ref.topLeft.row;\n                    }\n\n                    if (ref.topLeft.col < topLeftCol) {\n                        modified = true;\n                        topLeftCol = ref.topLeft.col;\n                    }\n\n                    if (ref.bottomRight.row > bottomRightRow) {\n                        modified = true;\n                        bottomRightRow = ref.bottomRight.row;\n                    }\n\n                    if (ref.bottomRight.col > bottomRightCol) {\n                        modified = true;\n                        bottomRightCol = ref.bottomRight.col;\n                    }\n\n                    if (callback) {\n                        callback(ref);\n                    }\n                });\n\n                var result = new RangeRef$4(\n                    new CellRef$5(topLeftRow, topLeftCol),\n                    new CellRef$5(bottomRightRow, bottomRightCol)\n                );\n\n                if (modified) {\n                    return result.union(refs, callback);\n                } else {\n                    return result;\n                }\n            },\n            resize: function(options) {\n                var limit = Math.max.bind(Math, 0);\n                function num(value) { return value || 0; }\n\n                var top = this.topLeft.row + num(options.top);\n                var left = this.topLeft.col + num(options.left);\n                var bottom = this.bottomRight.row + num(options.bottom);\n                var right = this.bottomRight.col + num(options.right);\n\n                if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                    return NULL$1;\n                } else if (top <= bottom && left <= right) {\n                    return new RangeRef$4(new CellRef$5(limit(top), limit(left)),\n                                        new CellRef$5(limit(bottom), limit(right)));\n                } else {\n                    return NULL$1;\n                }\n            },\n            move: function(rows, cols) {\n                return new RangeRef$4(\n                    new CellRef$5(this.topLeft.row + rows,\n                                this.topLeft.col + cols),\n                    new CellRef$5(this.bottomRight.row + rows,\n                                this.bottomRight.col + cols)\n                );\n            },\n            first: function() {\n                return this.topLeft.clone().setSheet(this.sheet, this.hasSheet());\n            },\n            isCell: function() {\n                return !this.endSheet && this.topLeft.eq(this.bottomRight);\n            },\n            toString: function() {\n                return this.topLeft + \":\" + this.bottomRight;\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n                var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n                if (tl === NULL$1 && tr === NULL$1) {\n                    return NULL$1;\n                }\n                if (tl === NULL$1) {\n                    tl = this.topLeft.absolute(row, col);\n                    if (forRow) {\n                        tl.row = start;\n                    } else {\n                        tl.col = start;\n                    }\n                    if (trow != null && tcol != null) {\n                        tl = tl.relative(trow, tcol, this.topLeft.rel);\n                    }\n                }\n                else if (tr === NULL$1) {\n                    tr = this.bottomRight.absolute(row, col);\n                    if (forRow) {\n                        tr.row = start - 1;\n                    } else {\n                        tr.col = start - 1;\n                    }\n                    if (trow != null && tcol != null) {\n                        tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                    }\n                }\n                return new RangeRef$4(tl, tr)\n                    .setSheet(this.sheet, this.hasSheet())\n                    .simplify();\n            },\n            valid: function() {\n                return this.topLeft.valid() && this.bottomRight.valid();\n            }\n        });\n\n        /* -----[ Union reference ]----- */\n\n        var UnionRef$3 = Ref$4.extend({\n            init: function UnionRef(refs){\n                this.refs = refs;\n                this.length = refs.length;\n            },\n            clone: function() {\n                return new UnionRef$3(this.refs.slice());\n            },\n            intersect: function(ref) {\n                var a = [];\n                for (var i = 0; i < this.length; ++i) {\n                    var x = ref.intersect(this.refs[i]);\n                    if (x !== NULL$1) {\n                        a.push(x);\n                    }\n                }\n                if (a.length > 0) {\n                    return new UnionRef$3(a).simplify();\n                }\n                return NULL$1;\n            },\n            simplify: function() {\n                var u = new UnionRef$3(this.refs.reduce(function(a, ref){\n                    ref = ref.simplify();\n                    if (ref !== NULL$1) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []));\n                if (u.empty()) {\n                    return NULL$1;\n                }\n                if (u.single()) {\n                    return u.refs[0];\n                }\n                return u;\n            },\n            absolute: function(arow, acol) {\n                return new UnionRef$3(this.refs.map(function(ref){\n                    return ref.absolute(arow, acol);\n                }));\n            },\n            forEach: function(callback, obj) {\n                this.refs.forEach(function(ref){\n                    if (ref instanceof UnionRef$3) {\n                        ref.forEach(callback, obj);\n                    } else {\n                        callback.call(obj, ref);\n                    }\n                }, obj);\n            },\n            toRangeRef: function() {\n                return this.refs[0].toRangeRef();\n            },\n            contains: function(theRef) {\n                return this.refs.some(function(ref) { return ref.contains(theRef); });\n            },\n            map: function(callback, obj) {\n                var refs = [];\n                this.forEach(function(ref){\n                    refs.push(callback.call(obj, ref));\n                });\n                return new UnionRef$3(refs);\n            },\n            first: function() {\n                return this.refs[0].first();\n            },\n            lastRange: function() {\n                return this.refs[this.length - 1];\n            },\n            size: function() {\n                return this.length;\n            },\n            single: function() {\n                return this.length == 1;\n            },\n            empty: function() {\n                return this.length === 0;\n            },\n            isCell: function() {\n                return this.single() && this.refs[0].isCell();\n            },\n            rangeAt: function(index) {\n                return this.refs[index];\n            },\n            nextRangeIndex: function(index) {\n                if (index === this.length - 1) {\n                    return 0;\n                } else {\n                    return index + 1;\n                }\n            },\n            previousRangeIndex: function(index) {\n                if (index === 0) {\n                    return this.length - 1;\n                } else {\n                    return index - 1;\n                }\n            },\n            concat: function(ref) {\n                return new UnionRef$3(this.refs.concat([ref]));\n            },\n            print: function(row, col, mod) {\n                return this.refs.map(function(ref) { return ref.print(row, col, mod); }).join(\",\");\n            },\n\n            replaceAt: function(index, ref) {\n                var newRefs = this.refs.slice();\n                newRefs.splice(index, 1, ref);\n                return new UnionRef$3(newRefs);\n            },\n\n            leftColumn: function() {\n                return this.map(function(ref) {\n                    return ref.leftColumn();\n                });\n            },\n            rightColumn: function() {\n                return this.map(function(ref) {\n                    return ref.rightColumn();\n                });\n            },\n            topRow: function() {\n                return this.map(function(ref) {\n                    return ref.topRow();\n                });\n            },\n            bottomRow: function() {\n                return this.map(function(ref) {\n                    return ref.bottomRow();\n                });\n            },\n            forEachRow: function(callback) {\n                this.forEach(function(ref) {\n                    ref.forEachRow(callback);\n                });\n            },\n            forEachColumn: function(callback) {\n                this.forEach(function(ref) {\n                    ref.forEachColumn(callback);\n                });\n            },\n            adjust: function(row, col, trow, tcol, forRow, start, delta) {\n                return this.map(function(ref){\n                    return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n                }).simplify();\n            },\n            toString: function() {\n                return this.refs.map(function(ref){\n                    return ref.toString();\n                }).join(\", \");\n            },\n            valid: function() {\n                for (var i = this.refs.length; --i >= 0;) {\n                    if (this.refs[i].valid()) {\n                        return false;\n                    }\n                }\n                return true;\n            },\n            renameSheet: function(oldSheetName, newSheetName) {\n                this.refs.forEach(function(ref){\n                    ref.renameSheet(oldSheetName, newSheetName);\n                });\n            }\n        });\n\n        /* -----[ exports ]----- */\n\n        spreadsheet$8.NULLREF = NULL$1;\n        spreadsheet$8.SHEETREF = new RangeRef$4(new CellRef$5(0, 0), new CellRef$5(Infinity, Infinity));\n        spreadsheet$8.FIRSTREF = new CellRef$5(0, 0);\n        spreadsheet$8.Ref = Ref$4;\n        spreadsheet$8.NameRef = NameRef$3;\n        spreadsheet$8.CellRef = CellRef$5;\n        spreadsheet$8.RangeRef = RangeRef$4;\n        spreadsheet$8.UnionRef = UnionRef$3;\n\n        spreadsheet$8.SHEETREF.print = function() {\n            return \"#SHEET\";\n        };\n\n    (function(kendo) {\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function(grid) {\n                this._grid = grid;\n            },\n\n            rectIsVertical: function(start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n\n            autoFillDest: function(selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n\n                var pivot, opposite, cornerResult, expanding;\n\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) { // vertical\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) { // vertical\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2){\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) { // horizontal\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) { // horizontal\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    })(kendo);\n\n    (function(kendo) {\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var EdgeNavigator = kendo.Class.extend({\n            init: function(field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n\n                this.prevLeft = function(index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n\n                this.nextRight = function(index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n\n                // these two don't look like the other ones, as they \"shrink\"\n                this.nextLeft = function(index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n\n                this.prevRight = function(index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n\n            boundary: function(top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n\n            range: function(index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n\n        var SheetNavigator = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n\n                this.colEdge = new EdgeNavigator(\"col\", this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator(\"row\", this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n\n            height: function(height) {\n                this._viewPortHeight = height;\n            },\n\n            union: function(ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n\n            columnRange: function(col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n\n            rowRange: function(row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n\n            selectionIncludesMergedCells: function() {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n\n            setSelectionValue: function(value) {\n                var selection = this._sheet.selection();\n\n                setTimeout(function() {\n                    selection.value(value());\n                });\n            },\n\n            selectAll: function() {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n\n            select: function(ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n\n                this._sheet.select(ref);\n            },\n\n            refForMode: function(ref, mode) {\n                var grid = this._sheet._grid;\n\n                switch(mode) {\n                    case \"range\":\n                        ref = grid.normalize(ref);\n                        break;\n                    case \"row\":\n                        ref = grid.rowRef(ref.row);\n                        break;\n                    case \"column\":\n                        ref = grid.colRef(ref.col);\n                        break;\n                    case \"sheet\":\n                        ref = this._sheet._sheetRef;\n                        break;\n                }\n\n                return ref;\n            },\n\n            startSelection: function(ref, mode, addToExisting, shiftKey, view) {\n                if (mode == \"autofill\") {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == \"range\") {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection(view);\n                } else {\n                    this._sheet.startSelection(view);\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n\n            completeSelection: function() {\n                this._sheet.completeSelection();\n            },\n\n            selectForContextMenu: function(ref, mode) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = null;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n\n            selectDrawingForContextMenu: function(drawing) {\n                var sheet = this._sheet;\n                sheet._activeDrawing = drawing;\n                sheet.triggerChange({ selection: true });\n            },\n\n            modifySelection: function(action) {\n                var direction = this.determineDirection(action);\n\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var bottomLeft = new CellRef(bottomRight.row, topLeft.col);\n\n                var scrollInto;\n\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n\n                switch (direction) {\n                  case \"expand-left\": // <| |\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-right\": // |>|\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-right\": // | |>\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-left\": // |<|\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n\n                    // four actions below mirror the upper ones, on the vertical axis\n                  case \"expand-up\":\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-down\":\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-down\":\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-up\":\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n\n                    // pageup/down - may need improvement\n                  case \"expand-page-up\":\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                  case \"shrink-page-up\":\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                  case \"expand-page-down\":\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                  case \"shrink-page-down\":\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n\n                  case \"first-col\":\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                  case \"last-col\":\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"first-row\":\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                  case \"last-row\":\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"last\":\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                  case \"first\":\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n\n                  case \"expand-word-right\":\n                    bottomRight.col = columns.nextUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-word-right\":\n                    topLeft.col = columns.nextUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                  case \"expand-word-left\":\n                    topLeft.col = columns.prevUntil(bottomLeft.col, makeWordMovement(sheet, bottomLeft, true));\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-word-left\":\n                    bottomRight.col = columns.prevUntil(bottomRight.col, makeWordMovement(sheet, bottomRight, true));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"expand-word-up\":\n                    topLeft.row = rows.prevUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                  case \"shrink-word-up\":\n                    bottomRight.row = rows.prevUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"expand-word-down\":\n                    bottomRight.row = rows.nextUntil(bottomRight.row, makeWordMovement(sheet, bottomRight, false));\n                    scrollInto = bottomRight;\n                    break;\n                  case \"shrink-word-down\":\n                    topLeft.row = rows.nextUntil(topLeft.row, makeWordMovement(sheet, topLeft, false));\n                    scrollInto = topLeft;\n                    break;\n                }\n\n                var newSelection = new RangeRef(topLeft, bottomRight);\n\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    // throw new Error(newSelection.print() + \" does not contain \" + activeCell.print());\n                    this.modifySelection(direction.replace(\"shrink\", \"expand\"));\n                    return;\n                }\n\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n\n                this.updateCurrentSelectionRange(newSelection);\n            },\n\n            moveActiveCell: function(direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var row = cell.row;\n                var column = cell.col;\n\n                switch (direction) {\n                  case \"left\":\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                  case \"up\":\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                  case \"right\":\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                  case \"down\":\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                  case \"first-col\":\n                    column = columns.firstVisible();\n                    break;\n                  case \"last-col\":\n                    column = columns.lastVisible();\n                    break;\n                  case \"first-row\":\n                    row = rows.firstVisible();\n                    break;\n                  case \"last-row\":\n                    row = rows.lastVisible();\n                    break;\n                  case \"last\":\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                  case \"first\":\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                  case \"next-page\":\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                  case \"prev-page\":\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n\n                  case \"word-right\":\n                    column = columns.nextUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                  case \"word-left\":\n                    column = columns.prevUntil(column, makeWordMovement(sheet, bottomRight, true));\n                    break;\n                  case \"word-up\":\n                    row = rows.prevUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                  case \"word-down\":\n                    row = rows.nextUntil(row, makeWordMovement(sheet, bottomRight, false));\n                    break;\n                }\n\n                sheet.select(new CellRef(row, column));\n            },\n\n            navigateInSelection: function(direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n\n                var row = cell.row;\n                var column = cell.col;\n\n                var isFirstCell = false;\n                var isLastCell = false;\n\n                var selTopLeft, selBottomRight;\n\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                var tmp;\n\n                function setSelection(sel) {\n                    selTopLeft = sel.topLeft;\n                    selBottomRight = sel.bottomRight;\n                }\n\n                setSelection(sheet.currentNavigationRange());\n\n                var done = false;\n                var navigatedAway = false;\n\n                while (!done && !navigatedAway) {\n                    var current = new CellRef(row, column);\n                    var isSingleCellSelected = sheet.singleCellSelection();\n\n                    if(isSingleCellSelected) {\n                        isFirstCell = selTopLeft.eq(current) && sheet._sheetRef.topLeft.eq(current);\n                        isLastCell = selBottomRight.eq(current) && sheet._sheetRef.bottomRight.eq(current);\n\n                        if(!isFirstCell) {\n                            isFirstCell = columns.firstVisible() === column && rows.firstVisible() === row;\n                        }\n\n                        if(!isLastCell) {\n                            isLastCell = columns.lastVisible() === column && rows.lastVisible() === row;\n                        }\n                    }\n\n                    switch (direction) {\n                        case \"next\":\n                            if(isLastCell) {\n                                navigatedAway = true;\n                                kendo.focusNextElement();\n                            } else if (selBottomRight.eq(current)) {\n                                setSelection(sheet.nextNavigationRange());\n                                row = selTopLeft.row;\n                                column = selTopLeft.col;\n                            } else {\n                                column = columns.nextVisible(topLeftCol);\n                                if (column == topLeftCol || column > selBottomRight.col) {\n                                    column = selTopLeft.col;\n                                    tmp = rows.nextVisible(row);\n                                    if (tmp == row || tmp > selBottomRight.row) {\n                                        row = selTopLeft.row;\n                                    } else {\n                                        row = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"previous\":\n                            if(isFirstCell) {\n                                navigatedAway = true;\n                                this._sheet._workbook._view.element.find('.k-spreadsheet-name-editor .k-input-inner').trigger(\"focus\");\n                            } else if (selTopLeft.eq(current)) {\n                                setSelection(sheet.previousNavigationRange());\n                                row = selBottomRight.row;\n                                column = selBottomRight.col;\n                            } else {\n                                column = columns.prevVisible(topLeftCol);\n                                if (column == topLeftCol || column < selTopLeft.col) {\n                                    column = selBottomRight.col;\n                                    tmp = rows.prevVisible(row);\n                                    if (tmp == row || tmp < selTopLeft.row) {\n                                        row = selBottomRight.row;\n                                    } else {\n                                        row = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"lower\":\n                            if (selBottomRight.eq(current)) {\n                                setSelection(sheet.nextNavigationRange());\n                                row = selTopLeft.row;\n                                column = selTopLeft.col;\n                            } else {\n                                row = rows.nextVisible(topLeftRow);\n                                if (row == topLeftRow || row > selBottomRight.row) {\n                                    row = selTopLeft.row;\n                                    tmp = columns.nextVisible(column);\n                                    if (tmp == column || tmp > selBottomRight.col) {\n                                        column = selTopLeft.col;\n                                    } else {\n                                        column = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        case \"upper\":\n                            if (selTopLeft.eq(current)) {\n                                setSelection(sheet.previousNavigationRange());\n                                row = selBottomRight.row;\n                                column = selBottomRight.col;\n                            } else {\n                                row = rows.prevVisible(topLeftRow);\n                                if (row == topLeftRow || row < selTopLeft.row) {\n                                    row = selBottomRight.row;\n                                    tmp = columns.prevVisible(column);\n                                    if (tmp == column || tmp < selTopLeft.col) {\n                                        column = selBottomRight.col;\n                                    } else {\n                                        column = tmp;\n                                    }\n                                }\n                            }\n                            break;\n                        default:\n                            throw new Error(\"Unknown entry navigation: \" + direction);\n                    }\n\n                    done = !this.shouldSkip(row, column);\n                    // if (!done) { console.log(\"skipping\", row, column); }\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n\n                if(done) {\n                    if (sheet.singleCellSelection()) {\n                        sheet.select(new CellRef(row, column));\n                    } else {\n                        sheet.activeCell(new CellRef(row, column));\n                    }\n                }\n            },\n\n            extendSelection: function(ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n\n                if (mode === \"autofill\") {\n                   this.resizeAutoFill(ref);\n                   return;\n                }\n                if (mode === \"range\") {\n                    ref = grid.normalize(ref);\n                }\n                else if (mode === \"row\") {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === \"column\") {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n\n            shouldSkip: function(row, col) {\n                if (this._sheet.isHiddenRow(row) || this._sheet.isHiddenColumn(col)) {\n                    return true;\n                }\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function(merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n\n                return isMerged;\n            },\n\n            resizeAutoFill: function(ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n\n                var punch = this.punch(selection, dest);\n                var hint, direction;\n\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        hint = preview.hint;\n                    }\n                }\n\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n\n            determineDirection: function(action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n\n                // There may be a third, indeterminate state, caused by a merged cell.\n                // In this state, all key movements are treated as shrinks.\n                // The navigator will reverse them if it detects this it will cause the selection to exclude the active cell.\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n\n                switch (action) {\n                  case \"left\":\n                    action = rightMode ? \"expand-left\" : \"shrink-left\";\n                    break;\n                  case \"right\":\n                    action = leftMode ? \"expand-right\" : \"shrink-right\";\n                    break;\n                  case \"up\":\n                    action = bottomMode ? \"expand-up\" : \"shrink-up\";\n                    break;\n                  case \"down\":\n                    action = topMode ? \"expand-down\" : \"shrink-down\";\n                    break;\n                  case \"prev-page\":\n                    action = bottomMode ? \"expand-page-up\" : \"shrink-page-up\";\n                    break;\n                  case \"next-page\":\n                    action = topMode ? \"expand-page-down\" : \"shrink-page-down\";\n                    break;\n                  case \"word-left\":\n                    action = rightMode ? \"expand-word-left\" : \"shrink-word-left\";\n                    break;\n                  case \"word-right\":\n                    action = leftMode ? \"expand-word-right\" : \"shrink-word-right\";\n                    break;\n                  case \"word-up\":\n                    action = bottomMode ? \"expand-word-up\" : \"shrink-word-up\";\n                    break;\n                  case \"word-down\":\n                    action = topMode ? \"expand-word-down\" : \"shrink-word-down\";\n                    break;\n                }\n\n                return action;\n            },\n\n            updateCurrentSelectionRange: function(ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n\n            punch: function(selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n\n                        punch = new RangeRef(\n                            new CellRef(bottomRow, selection.topLeft.col),\n                            selection.bottomRight\n                        );\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n\n                        punch = new RangeRef(\n                            new CellRef(selection.topLeft.row, bottomCol),\n                            selection.bottomRight\n                        );\n                    }\n                }\n\n                return punch;\n            }\n        });\n\n        function makeWordMovement(sheet, pivot, isCol) {\n            // the general idea is:\n            //\n            // - if we start on a non-empty cell, we should select the\n            //   range of non-empty cells that follow it.  If, however,\n            //   the second cell is empty, then we don't stop there; we\n            //   should skip all the empty cells and stop at the first\n            //   non-empty cell (and select it).\n            //\n            // - if we start on an empty cell, then skip all empty cells\n            //   and select the first non-empty one.\n\n            var firstVal = sheet.range(pivot).value();\n            return function(pos, advanced, hidden) {\n                if (hidden) { return true; }   // skip hidden cells\n                var val = ( isCol ?\n                            sheet.range(pivot.row, pos) :\n                            sheet.range(pos, pivot.col) ).value();\n                if (firstVal === null) {\n                    return val === null ? false : pos;\n                } else if (!advanced && val === null) {\n                    firstVal = null; // switch to the other mode\n                    return false;\n                } else {\n                    return val === null;\n                }\n            };\n        }\n\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    })(kendo);\n\n    (function(kendo) {\n\n        var AxisManager = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n            },\n\n            forEachSelectedColumn: function(callback) {\n                var sheet = this._sheet;\n\n                sheet.batch(function() {\n                    sheet.select().forEachColumnIndex(function(index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, { layout: true, recalc: true });\n            },\n\n            forEachSelectedRow: function(callback) {\n                var sheet = this._sheet;\n\n                sheet.batch(function() {\n                    sheet.select().forEachRowIndex(function(index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, { layout: true, recalc: true });\n            },\n\n            includesHiddenColumns: function(ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n\n            includesHiddenRows: function(ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n\n            selectionIncludesHiddenColumns: function() {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n\n            selectionIncludesHiddenRows: function() {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n\n            deleteSelectedColumns: function() {\n                var indexes = [], delta = 0;\n                this.forEachSelectedColumn(function(sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenColumn(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index    : index,\n                        formulas : formulas,\n                        width    : sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function(){\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n\n            deleteSelectedRows: function() {\n                var indexes = [], delta = 0;\n                this.forEachSelectedRow(function(sheet, index) {\n                    index -= delta;\n                    if (sheet.isHiddenRow(index)) {\n                        return;\n                    }\n                    delta++;\n                    var formulas = [];\n                    indexes.unshift({\n                        index    : index,\n                        formulas : formulas,\n                        height   : sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function(){\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n\n            hideSelectedColumns: function() {\n                this.forEachSelectedColumn(function(sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(\n                        new kendo.spreadsheet.CellRef(0, sel),\n                        new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel)\n                    );\n                    sheet.range(ref).select();\n                }\n            },\n\n            hideSelectedRows: function() {\n                this.forEachSelectedRow(function(sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(\n                        new kendo.spreadsheet.CellRef(sel, 0),\n                        new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1)\n                    );\n                    sheet.range(ref).select();\n                }\n            },\n\n            unhideSelectedColumns: function() {\n                this.forEachSelectedColumn(function(sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n\n            unhideSelectedRows: function() {\n                this.forEachSelectedRow(function(sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n\n            addColumnLeft: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function(){\n                    sheet.select().forEachColumnIndex(function(index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, { recalc: true, layout: true });\n                return { base: base, count: count };\n            },\n\n            addColumnRight: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function(){\n                    sheet.select().forEachColumnIndex(function(index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, { recalc: true, layout: true });\n                return { base: base, count: count };\n            },\n\n            addRowAbove: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n                var selectedRows = sheet.select();\n\n                sheet.batch(function(){\n                    selectedRows.forEachRowIndex(function(index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertRow(base);\n                        ++count;\n                    });\n                }, { recalc: true, layout: true });\n\n                return { base: base, count: count };\n            },\n\n            addRowBelow: function() {\n                var sheet = this._sheet;\n                var base, count = 0;\n\n                sheet.batch(function(){\n                    sheet.select().forEachRowIndex(function(index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertRow(base);\n                    }\n                }, { recalc: true, layout: true });\n\n                return { base: base, count: count };\n            }\n        });\n\n        kendo.spreadsheet.AxisManager = AxisManager;\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n\n        var Clipboard = kendo.Class.extend({\n            init: function(workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement(\"iframe\");\n                this.iframe.className = \"k-spreadsheet-clipboard-paste\";\n                this.iframe.setAttribute(\"title\", \"Spreadsheet clipboard iframe\");\n                this.menuInvoked = false;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n\n            destroy: function() {\n                $(this.iframe).remove();\n            },\n\n            canCopy: function() {\n                var status = {canCopy: true};\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n\n            canPaste: function() {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = { canPaste: true, pasteOnMerged: false, pasteOnDisabled: false };\n\n                if (!range.enable()) {\n                    status.canPaste =  false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n\n            intersectsMerged: function() {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n\n            copy: function() {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n\n            cut: function() {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n\n            pasteRef: function() {\n                var sheet = this.workbook.activeSheet();\n\n                // When pasting from an external source, origin will be\n                // NULLREF.  Just return the destination range.\n                // https://github.com/telerik/kendo-ui-core/issues/3486\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n\n            paste: function() {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                if (pasteRef.bottomRight.row >= sheet._rows._count || pasteRef.bottomRight.col >= sheet._columns._count) {\n                    sheet.resize(\n                        Math.max(pasteRef.bottomRight.row + 1, sheet._rows._count),\n                        Math.max(pasteRef.bottomRight.col + 1, sheet._columns._count)\n                    );\n                }\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({ recalc: true, ref: pasteRef });\n            },\n\n            external: function(data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n\n            isExternal: function() {\n                return !this._isInternal();\n            },\n\n            parse: function() {\n                var state;\n\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    state = data.plain ? parseTSV(data.plain) : newState();\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector(\"table\");\n                        if (table) {\n                            var richState = parseHTML(table);\n\n                            // fixup #### values that are sent by Excel when the column is too\n                            // narrow. It turns out that the plain text clipboard data contains the\n                            // actual values. https://github.com/telerik/kendo-ui-core/issues/5277\n                            richState.data.forEach(function(rowData, rowIndex){\n                                rowData.forEach(function(colData, colIndex){\n                                    if (/^\\s*#+\\s*$/.test(colData.value)) {\n                                        colData.value = state.data[rowIndex][colIndex].value;\n                                    }\n                                });\n                            });\n                            state = richState;\n                        }\n                    }\n                    this.origin = state.origRef;\n                }\n\n                this._content = state;\n            },\n\n            _isInternal: function() {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $(\"<div/>\").html(this._externalContent.html).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n                var internalPlain = $(\"<div/>\").html(this._externalContent.plain).find(\"table.kendo-clipboard-\"+ this._uid).length ? true : false;\n                return (internalHTML || internalPlain);\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref         : ref,\n                mergedCells : [],\n                data        : [],\n                foreign     : true,\n                origRef     : ref.toRangeRef()\n            };\n        }\n\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, \"\");\n        }\n\n        function borderObject(styles) {\n            var obj = {};\n            [\n                \"borderBottom\",\n                \"borderRight\",\n                \"borderLeft\",\n                \"borderTop\"\n            ].forEach(function(key) {\n                obj[key] = styles[key + \"Style\"] == \"none\" ? null : {\n                    size: 1,\n                    color: styles[key + \"Color\"]\n                };\n            });\n            return obj;\n        }\n\n        function cellState(row, col, element, hBorders, vBorders) {\n            var styles = window.getComputedStyle(element);\n\n            // note: Chrome 70 appends a \\t to a cell's text, which is actually mandated by the standard\n            // ([1] item 6).  We remove it below.  In [2] it's suggested they might switch back to\n            // previous behavior, but removing an eventual last TAB won't hurt anyway.\n            //\n            // [1] https://www.w3.org/TR/html53/dom.html#dom-htmlelement-innertext\n            // [2] https://bugs.chromium.org/p/chromium/issues/detail?id=897373\n            var text = element.innerText.replace(/\\t$/, \"\");\n\n            var borders = borderObject(styles);\n            var state = {\n                value: text === \"\" ? null : text,\n\n                borderTop    : borders.borderTop    || hBorders.get(row, col)     || null,\n                borderBottom : borders.borderBottom || hBorders.get(row + 1, col) || null,\n                borderLeft   : borders.borderLeft   || vBorders.get(row, col)     || null,\n                borderRight  : borders.borderRight  || vBorders.get(row, col + 1) || null,\n\n                fontSize : parseInt(styles[\"font-size\"], 10)\n            };\n\n            hBorders.set(row, col, state.borderTop);\n            hBorders.set(row + 1, col, state.borderBottom);\n            vBorders.set(row, col, state.borderLeft);\n            vBorders.set(row, col + 1, state.borderRight);\n\n            if (styles[\"background-color\"] !== \"rgb(0, 0, 0)\" && styles[\"background-color\"] !== \"rgba(0, 0, 0, 0)\") {\n                state.background = styles[\"background-color\"];\n            }\n            if (styles.color !== \"rgb(0, 0, 0)\" && styles.color !== \"rgba(0, 0, 0, 0)\") {\n                state.color = styles.color;\n            }\n            if (styles[\"text-decoration\"] == \"underline\") {\n                state.underline = true;\n            }\n            if (styles[\"font-style\"] == \"italic\") {\n                state.italic = true;\n            }\n            if (styles[\"font-weight\"] == \"bold\") {\n                state.bold = true;\n            }\n            if (stripStyle(styles[\"text-align\"]) !== \"right\") {\n                state.textAlign = stripStyle(styles[\"text-align\"]);\n            }\n            if (styles[\"vertical-align\"] !== \"middle\") {\n                state.verticalAlign = styles[\"vertical-align\"];\n            }\n            if (styles[\"word-wrap\"] !== \"normal\" ) {\n                state.wrap = true;\n            }\n\n            return state;\n        }\n\n        function parseHTML(table) {\n            var state = newState();\n\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            var hBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n            var vBorders = new kendo.spreadsheet.calc.runtime.Matrix();\n\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n\n                    // A cell containing a long text overflowing the next (empty) cell will weirdly be\n                    // reported as merged by Excel (has colspan=2).  Then, Excel informatively suggests\n                    // us to ignore the colSpan by passing mso-ignore:colspan in the style.  Much thanks!\n                    // https://github.com/telerik/kendo-ui-core/issues/3760\n                    var style = td.getAttribute(\"style\");\n                    var ignoreColspan = /mso-ignore:colspan/.test(style);\n\n                    setStateData(state, row, col, cellState(row, col, td, hBorders, vBorders));\n                    if (rowSpan > 1 || (colSpan > 1 && !ignoreColspan)) {\n                        state.mergedCells.push(\n                            new kendo.spreadsheet.RangeRef(\n                                new CellRef(row, col),\n                                new CellRef(row + rowSpan - 1, col + colSpan - 1)\n                            ).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            return state;\n        }\n\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf(\"\\t\") === -1 && data.indexOf(\"\\n\") == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split(\"\\n\");\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split(\"\\t\");\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n\n        var PROPERTIES = [\n            \"color\", \"fontFamily\", \"underline\",\n            \"italic\", \"bold\", \"textAlign\", \"indent\",\n            \"verticalAlign\", \"background\", \"format\", \"link\", \"editor\",\n            \"borderTop\", \"borderRight\", \"borderBottom\", \"borderLeft\",\n            \"comment\", \"html\"\n        ];\n\n        var Range = kendo.Class.extend({\n            init: function(ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n\n            clone: function() {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n\n            skipHiddenCells: function() {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function(ref){\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(\n                                new CellRef(rows[i].begin, cols[j].begin),\n                                new CellRef(rows[i].end, cols[j].end)\n                            ));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n\n            _normalize: function(ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n\n            _set: function(name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function(ref) {\n                    var result = ref;\n                    var valueProp = name === \"value\" || name === \"formula\" || name === \"link\";\n\n                    // Set values/formulas/links only to the topLeft cell when merged\n                    if(valueProp && ref.topLeft) {\n                        var topLeftRef = new CellRef(ref.topLeft.row, ref.topLeft.col);\n\n                        sheet.forEachMergedCell(function(f){\n                            if(f.intersects(topLeftRef)) {\n                                result = topLeftRef;\n                            }\n                        });\n                    }\n\n                    sheet._set(result.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc  : name == \"formula\" || name == \"value\" || name == \"validation\",\n                        value   : value,\n                        range   : self,\n                        ref     : self._ref,\n                        isValue : name == \"value\"\n                    });\n                }\n                return self;\n            },\n\n            _get: function(name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n\n            _property: function(name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n\n            value: function(value) {\n                if (value !== undefined) {\n                    // When value is set through the public API we must clear the\n                    // formula.  Don't trigger change (third parameter), it'll be\n                    // done when setting the value below\n                    this._set(\"formula\", null, true);\n                }\n                return this._property(\"value\", value);\n            },\n\n            html: function(value) {\n                return this._property(\"html\", value);\n            },\n\n            resize: function(direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n\n            _resizedRef: function(direction) {\n                return this._ref.map(function(ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n\n            input: function(value, options) {\n                options = $.extend({\n                    arrayFormula: false\n                }, options);\n                var existingFormat = this._get(\"format\"), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function() {\n                        var formula = null;\n                        if (x.type == \"exp\") {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != \"@\") {\n                            var existingFormatType = existingFormat &&\n                                kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == \"date\" && existingFormatType != \"date\") {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == \"percent\" && existingFormatType != \"percent\") {\n                                this.format(x.value*100 == (x.value*100|0) ? \"0%\" : \"0.00%\");\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency ||\n                                    (existingFormatType == \"number\" && x.type == \"number\" &&\n                                     x.format.length > existingFormat.length)) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != \"string\") {\n                            x.value = value;\n                        }\n                        this.formula(formula, options.arrayFormula);\n                        if (!formula) {\n                            // value() will clear the formula.  Lucky for us,\n                            // x.value is undefined so it actually won't, but let's\n                            // be explicit and only set value if formula is not\n                            // present.\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc       : true,\n                        value        : value,\n                        ref          : this._ref,\n                        editorChange : this._sheet.isInEditMode(),\n                        isValue      : true\n                    });\n\n                    return this;\n                } else {\n                    value = this._get(\"value\");\n                    var formula = this._get(\"formula\");\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n\n                    if (formula) {\n                        // it's a Formula object which stringifies to the\n                        // formula as text (without the starting `=`).\n                        value = \"=\" + formula;\n                    } else { OUT: { \n                        if (existingFormat && type == \"date\") {\n                            // check if we could parse back the displayed value.\n                            // https://github.com/telerik/kendo/issues/5335\n                            var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                            x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat); // it's not a formula so we don't need sheet/row/col\n                            var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                            if (t1 == t2) {\n                                value = t1;\n                                break OUT; \n                            }\n                        }\n                        if (type === \"date\") {\n                            value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                        } else if (type === \"percent\") {\n                            value = kendo.spreadsheet.calc.runtime.limitPrecision(value * 100) + \"%\";\n                        } else if (typeof value == \"string\" &&\n                                   (/^[=']/.test(value) ||\n                                    (/^(?:true|false)$/i).test(value) ||\n                                    looksLikeANumber(value))) {\n                            value = \"'\" + value;\n                        } else if (this._sheet._useCultureDecimals() &&\n                                   typeof value == \"number\" &&\n                                   value != Math.floor(value)) {\n                            value = String(value).replace(\".\", kendo.culture().numberFormat[\".\"]);\n                        }\n                    } }\n\n                    return value;\n                }\n            },\n\n            enable: function(value) {\n                if (value === undefined) {\n                    return !kendo.util.withExit(function(exit){\n                        this._sheet.forEach(this._ref, function(_, __, data) {\n                            if (data.enable === false) {\n                                exit(true);\n                            }\n                        });\n                    }, this);\n                }\n\n                return this._property(\"enable\", value);\n            },\n\n            formula: function(value, arrayFormula) {\n                var self = this;\n                if (value === undefined) {\n                    var f = self._get(\"formula\");\n                    return f ? \"\" + f : null; // stringify if present\n                }\n                if (arrayFormula) {\n                    // when setting an array formula, we want to set it on\n                    // the first cell only, as it will fill the whole\n                    // range.\n                    var ref = this._ref.toRangeRef();\n                    value = self._sheet.range(ref.topLeft)\n                        ._set(\"formula\", value)\n                        ._get(\"formula\"); // make sure we get the compiled Formula, not a string\n\n                    if (value) {    // could be null.\n                        // this will be used in FormulaContext -- it's the\n                        // range that the formula must populate.\n                        value.setArrayFormulaRange(ref);\n                    }\n                } else {\n                    self._set(\"formula\", value);\n                }\n                return self;\n            },\n\n            intersectingArrayFormula: function() {\n                var ref = this._ref.clone().simplify().setSheet(this._sheet.name());\n                return kendo.util.withExit(function(exit){\n                    this._sheet._forFormulas(function(f){\n                        var r = f.arrayFormulaRange;\n                        if (r && (r = ref.intersect(r)) !== kendo.spreadsheet.NULLREF) {\n                            exit({ formula: f, intersection: r });\n                        }\n                    });\n                }, this);\n            },\n\n            canEditArrayFormula: function() {\n                var x = this.intersectingArrayFormula();\n                if (x) {\n                    // we want to allow editing only when the new range is\n                    // at least as big as the original range (i.e. no\n                    // cells removed)\n                    return x.formula.arrayFormulaRange.eq(x.intersection);\n                }\n                return true;\n            },\n\n            validation: function(value) {\n                //TODO: Accept objects only?\n\n                if (value === undefined) {\n                    var f = this._get(\"validation\");\n\n                    return f ? f.toJSON() : null; // stringify if present\n                }\n                return this._property(\"validation\", value);\n            },\n\n            _getValidationState: function() {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n\n                for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                        var validation = this._sheet._validation(ri, ci);\n\n                        if (validation && validation.type === \"reject\" && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n\n                return false;\n            },\n\n            merge: function() {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n\n            unmerge: function() {\n                var mergedCells = this._sheet._mergedCells;\n\n                this._ref.forEach(function(ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function(mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n\n                this._sheet.triggerChange({});\n\n                return this;\n            },\n\n            select: function() {\n                this._sheet.select(this._ref);\n\n                return this;\n            },\n\n            values: function(values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error(\"Unsupported for NULLREF.\");\n                    } else {\n                        return [];\n                    }\n                }\n\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n\n                if (values === undefined) {\n                    values = new Array(ref.height());\n\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n\n                    return values;\n                } else {\n                    this._sheet._set(ref, \"formula\", null);\n\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            var row = values[ri - topLeftRow];\n\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n\n                    this._sheet.triggerChange({ recalc: true, ref: ref });\n\n                    return this;\n                }\n            },\n\n            _properties: function(props, isAutofill) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error(\"Unsupported for NULLREF.\");\n                    } else {\n                        return [];\n                    }\n                }\n\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function(row, col, data){\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                }\n                else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function(propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n\n                        if (propName == \"value\") {\n                            sheet._set(ref, \"formula\", null);\n                        }\n\n                        sheet._set(ref, propName, propValue);\n                    };\n\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci ++) {\n                        if (!isAutofill && sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri ++) {\n                            if (!isAutofill && sheet.isHiddenRow(ri)) {\n                                continue;\n                            }\n                            if (isAutofill && sheet.isFilteredRow(ri)) {\n                                continue;\n                            }\n                            var row = props[ri - topLeftRow];\n                            if (row) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({ recalc: true, ref: this._ref });\n                    return this;\n                }\n            },\n\n            clear: function(options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n\n                var sheet = this._sheet;\n\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref\n                };\n\n                sheet.batch(function() {\n\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function(x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.fontSize(null);\n                        this.wrap(null);\n                        this.unmerge();\n                    }\n\n                }.bind(this), reason);\n\n                return this;\n            },\n\n            clearContent: function() {\n                return this.clear({ contentsOnly: true });\n            },\n\n            clearFormat: function() {\n                return this.clear({ formatOnly: true });\n            },\n\n            isSortable: function() {\n                return !this.cantSort();\n            },\n\n            cantSort: function() {\n                if (this._ref instanceof UnionRef) {\n                    return { code: \"cantSortMultipleSelection\",\n                             message: \"Unsupported for multiple ranges.\" };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return { code: \"cantSortNullRef\",\n                             message: \"Unsupported for NULLREF.\" };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function(row, col){\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        }\n                        else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch(ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: \"cantSortMixedCells\",\n                        message: \"Unsupported for range containing cells of different shapes.\"\n                    };\n                }\n                return false;\n            },\n\n            sort: function(spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n\n                spec = spec instanceof Array ? spec : [spec];\n\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                    if (typeof spec === \"number\") {\n                        spec = { column: spec };\n                    }\n\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n\n                return this;\n            },\n\n            isFilterable: function() {\n                return !(this._ref instanceof UnionRef);\n            },\n\n            filter: function(spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error(\"Unsupported for multiple ranges.\");\n                }\n\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function(spec, index) {\n                        return {\n                            index: spec.column === undefined ? spec.index === undefined ? index : spec.index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n\n                return this;\n            },\n\n            clearFilter: function(spec) {\n                this._sheet.clearFilter(spec);\n            },\n\n            clearFilters: function() {\n                var filter = this._sheet.filter();\n                var spec = [];\n\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(filter.columns[i].index);\n                    }\n\n                    this._sheet.batch(function() {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, { layout: true, filter: true });\n                }\n            },\n\n            hasFilter: function() {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n\n            leftColumn: function() {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n\n            rightColumn: function() {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n\n            topRow: function() {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n\n            bottomRow: function() {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n\n            column: function(column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n\n            row: function(row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n\n            forEachRow: function(callback) {\n                this._ref.forEachRow(function(ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n\n            forEachColumn: function(callback) {\n                this._ref.forEachColumn(function(ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n\n            sheet: function() {\n                return this._sheet;\n            },\n\n            topLeft: function() {\n                return this._ref.toRangeRef().topLeft;\n            },\n\n            intersectingMerged: function() {\n                var sheet = this._sheet;\n                var mergedCells = [];\n\n                sheet._mergedCells.forEach(function(ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n\n                return mergedCells;\n            },\n\n            getState: function(propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref     : topLeft,\n                    data    : [],\n                    origRef : this._ref,\n\n                    // save row heights\n                    rows    : this._sheet._rows.getState()\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === \"input\") {\n                    properties = [\"value\", \"formula\"];\n                } else if (propertyName === \"border\") {\n                    properties = [\"borderLeft\", \"borderTop\", \"borderRight\", \"borderBottom\"];\n                } else {\n                    properties = [propertyName];\n                }\n\n                var data = state.data;\n                this.forEachCell(function(row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n\n                    properties.forEach(function(property) {\n                        var value = typeof cell[property] == \"undefined\" ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula ||\n                            value instanceof kendo.spreadsheet.validation.Validation)\n                        {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n\n                return state;\n            },\n\n            setState: function(state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n\n                sheet.batch(function() {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n\n                    if (!clipboard) {\n                        // restore row heights.  they won't be available\n                        // when this function is called from the clipboard\n                        // code.\n                        this._sheet._rows.setState(state.rows);\n                    }\n\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function(data, dr){\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function(cellState, dc){\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col)\n                                : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != \"value\") {\n                                        // make sure value comes last (after the loop),\n                                        // because if we set value here and get get to\n                                        // formula later and cellState.formula is null,\n                                        // it'll clear the value.\n\n                                        // when pasting, do not copy \"disabled\" state\n                                        if (!(clipboard && property == \"enable\")) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    // only need to set the value if we don't have a\n                                    // formula.  Go through the lower level setter rather\n                                    // than range.value(...), because range.value will clear\n                                    // the formula!  chicken and egg issues.\n                                    if (externalClipboard) {\n                                        // https://github.com/telerik/kendo-ui-core/issues/1688\n                                        // if we have a paste from external source, we should parse the\n                                        // value as if it were inputted.  This allows to treat numbers\n                                        // as numbers, or `=sum(a1:b2)` as formula (Google Sheets does\n                                        // the same).  A difference though is that we can't store an\n                                        // invalid Formula and display #ERROR, like G.S. does, so in\n                                        // case of a parse error we'll just set the value as string.\n                                        try {\n                                            if (cellState.value == null) { \n                                                range._set(\"value\", null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch(ex) {\n                                            range._set(\"value\", cellState.value);\n                                        }\n                                    } else {\n                                        range._set(\"value\", cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function(merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), { recalc: true, ref: this._ref });\n            },\n\n            _adjustRowHeight: function() {\n                var that = this;\n                var sheet = that._sheet;\n                var mc = sheet._getMergedCells(that._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n\n                sheet.batch(function() {\n                    that.forEachRow(function(rowRange){\n                        var row = rowRange._ref.topLeft.row;\n                        var height = sheet.rowHeight(row);\n                        if (!height) {\n                            // do not adjust if hidden.\n                            // https://github.com/telerik/kendo-ui-core/issues/6272\n                            // (case 2)\n                            return;\n                        }\n                        rowRange.forEachCell(function(row, col, cell){\n                            var id = new CellRef(row, col).print();\n                            if (secondary[id]) {\n                                return;\n                            }\n                            var merged = primary[id];\n                            var width;\n                            if (merged) {\n                                width = sheet._columns.sum(merged.topLeft.col,\n                                                           merged.bottomRight.col);\n                            } else {\n                                width = sheet.columnWidth(col);\n                            }\n                            var data = cell.value;\n                            if (cell.format && data != null) { \n                                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                            }\n                            var textHeight = kendo.spreadsheet.util.getTextHeight(\n                                data, width, cell.fontFamily, cell.fontSize, cell.wrap);\n                            height = Math.max(height, textHeight);\n                        });\n                        sheet.rowHeight(row, height);\n                    });\n                }, { layout: true });\n            },\n\n            forEachCell: function(callback) {\n                this._ref.forEach(function(ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n\n            hasValue: function() {\n                var defStyle = this._sheet._defaultCellStyle;\n                return kendo.util.withExit(function(exit){\n                    this.forEachCell(function(row, col, cell) {\n                        // we must not consider cells that only have same values\n                        // as defaultCellStyle, or otherwise we will forbid\n                        // inserting rows/cols in an empty sheet.\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                exit(true);\n                            }\n                        }\n                    });\n                }, this);\n            },\n\n            wrap: function(flag) {\n                if (flag === undefined) {\n                    return !!this._property(\"wrap\");\n                }\n                this._property(\"wrap\", flag);\n                if (flag !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n\n            fontSize: function(size) {\n                if (size === undefined) {\n                    return this._property(\"fontSize\");\n                }\n                this._property(\"fontSize\", size);\n                if (size !== null) {\n                    this._adjustRowHeight();\n                }\n                return this;\n            },\n\n            draw: function(options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n\n            insideBorders: function(value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n\n            insideVerticalBorders: function(value) {\n                this._ref.forEach(function(ref){\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set(\"vBorders\", value);\n                    }\n                }, this);\n                return this;\n            },\n\n            insideHorizontalBorders: function(value) {\n                this._ref.forEach(function(ref){\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set(\"hBorders\", value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [\n                        { begin: begin, end: i - 1 }\n                    ].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{ begin: begin, end: end }];\n        }\n\n        // use $.each instead of forEach to work in oldIE\n        $.each(PROPERTIES, function(i, property) {\n            Range.prototype[property] = function(value) {\n                return this._property(property, value);\n            };\n        });\n\n        function toExcelFormat(format) {\n            return format.replace(/M/g, \"m\").replace(/'/g, '\"').replace(/tt/, \"am/pm\");\n        }\n\n        function looksLikeANumber(str) {\n            // XXX: could do with just a regexp instead of calling parse.\n            return !(/^=/.test(str)) && (/number|percent/).test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' +\n                            'padding: 1px 3px !important; box-sizing: border-box; margin: 0 !important; border: 1px solid black !important;' +\n                            'line-height: normal !important; visibility: hidden !important;' +\n                            'white-space: pre-wrap;\"></div>'\n                          )[0];\n\n        function getTextHeight(text, width, fontFamily, fontSize, wrap) {\n            var styles = {\n                \"baselineMarkerSize\" : 0,\n                \"width\" : (wrap === true) ? width + \"px\" : \"auto\",\n                \"font-size\" : (fontSize || 12) + \"px\",\n                \"font-family\" : fontFamily || \"Arial\",\n                \"white-space\" : (wrap === true) ? \"pre-wrap\" : \"pre\",\n                \"overflow-wrap\" : (wrap === true) ? \"break-word\" : \"normal\",\n                \"word-wrap\" : (wrap === true) ? \"break-word\" : \"normal\"\n            };\n\n            return kendo.util.measureText(text, styles, { box: measureBox, normalizeText: false }).height;\n        }\n\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n        /* global console */\n\n\n        var calc$4 = {};\n        var spreadsheet$7 = kendo.spreadsheet;\n        spreadsheet$7.calc = calc$4;\n        var exports$3 = calc$4.runtime = {};\n        var Class$1 = kendo.Class;\n\n        var Ref$3 = spreadsheet$7.Ref;\n        var CellRef$4 = spreadsheet$7.CellRef;\n        var RangeRef$3 = spreadsheet$7.RangeRef;\n        var UnionRef$2 = spreadsheet$7.UnionRef;\n        var NULL = spreadsheet$7.NULLREF;\n\n        /* -----[ Errors ]----- */\n\n        function CalcError$2(code) {\n            if (code instanceof CalcError$2) {\n                return code;\n            }\n            this.code = code;\n        }\n\n        CalcError$2.prototype.toString = function() {\n            return \"#\" + this.code + (this.code == \"NAME\" ? \"?\" : \"!\");\n        };\n\n        /* -----[ Context ]----- */\n\n        var Context = Class$1.extend({\n            init: function Context(callback, formula, ss, parent) {\n                this.callback = callback;\n                this.formula = formula;\n                this.ss = ss;\n                this.parent = parent;\n            },\n\n            resolve: function(val) {\n                var self = this;\n                if (val instanceof Ref$3) {\n                    self.resolveCells([ val ], function(){\n                        self._resolve(val);\n                    });\n                } else {\n                    self._resolve(val);\n                }\n            },\n\n            error: function(val) {\n                return new CalcError$2(val);\n            },\n\n            _resolve: function(val) {\n                if (val === undefined) {\n                    val = null;\n                } else if (Array.isArray(val)) {\n                    val = this.asMatrix(val);\n                } else {\n                    val = maybeRoundFloatErrors(val);\n                }\n                var f = this.formula;\n                if (f.arrayFormulaRange) {\n                    // when this is an array formula, make sure we return a Matrix.  The value already\n                    // *should* be a Matrix, so this won't incur speed penalty in normal cases.\n                    val = this.asMatrix(val) || this.asMatrix([[ val ]]);\n                } else if (val instanceof RangeRef$3) {\n                    val = this._arrayArg(val);\n                }\n                f.value = val;\n                if (this.ss.onFormula(f) && this.callback) {\n                    this.callback.call(f, val);\n                }\n            },\n\n            resolveCells: function(a, f) {\n                var context = this, formulas = [];\n\n                (function loop(a){\n                    for (var i = 0; i < a.length; ++i) {\n                        var x = a[i];\n                        if (x instanceof Ref$3) {\n                            add(context.getRefCells(x));\n                        }\n                        if (Array.isArray(x)) {\n                            // make sure we resolve cells in literal matrices\n                            loop(x);\n                        }\n                    }\n                })(a);\n\n                if (!formulas.length) {\n                    return f.call(context);\n                }\n\n                for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                    fetch(formulas[i]);\n                }\n                function fetch(formula) { \n                    formula.exec(context.ss, function(){\n                        if (!--pending) {\n                            f.call(context);\n                        }\n                    }, context);\n                }\n                function add(a) {\n                    for (var i = 0; i < a.length; ++i) {\n                        var cell = a[i];\n                        if (cell.formula) {\n                            formulas.push(cell.formula);\n                        }\n                    }\n                    return true;\n                }\n            },\n\n            cellValues: function(a, wantNulls) {\n                var ret = [];\n                for (var i = 0; i < a.length; ++i) {\n                    var val = a[i];\n                    if (val instanceof Ref$3) {\n                        val = this.getRefData(val, wantNulls);\n                        ret = ret.concat(val);\n                    } else if (Array.isArray(val)) {\n                        ret = ret.concat(this.cellValues(val, wantNulls));\n                    } else if (val instanceof Matrix$1) {\n                        ret = ret.concat(this.cellValues(val.data, wantNulls));\n                    } else {\n                        ret.push(val);\n                    }\n                }\n                return ret;\n            },\n\n            fetchName: function(ref, callback) {\n                var f = this.formula;\n                var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n                if (val instanceof Formula$1) {\n                    // clone and relocate to calling formula, so that relative references in a named\n                    // formula would work as expected.\n                    val = val.clone(f.sheet, f.row, f.col, true);\n\n                    // XXX: I don't like this dependency here; basically we only need ss.onFormula to\n                    // return true and do nothing else.\n                    var ss = new spreadsheet$7.ValidationFormulaContext(this.ss.workbook);\n\n                    val.exec(ss, callback, this);\n                } else {\n                    if (val instanceof Ref$3) {\n                        // relocate for relative refs\n                        val = val.absolute(f.row, f.col);\n                        if (val instanceof RangeRef$3 && this.ss.isMerged(val)) {\n                            val = val.topLeft;\n                        }\n                        if (!val.sheet) {\n                            val.sheet = f.sheet;\n                        }\n                    }\n                    callback(val == null ? new CalcError$2(\"NAME\") : val);\n                }\n            },\n\n            force: function(val) {\n                if (val instanceof Ref$3) {\n                    return this.getRefData(val);\n                }\n                return val;\n            },\n\n            func: function(fname, callback, args) {\n                fname = fname.toLowerCase();\n                var f = FUNCS[fname];\n                if (f) {\n                    return f.call(this, callback, args);\n                }\n                callback(new CalcError$2(\"NAME\"));\n            },\n\n            bool: function(val) {\n                if (val instanceof Ref$3) {\n                    val = this.getRefData(val);\n                }\n                if (typeof val == \"string\") {\n                    return val.toLowerCase() == \"true\";\n                }\n                if (typeof val == \"number\") {\n                    return val !== 0;\n                }\n                if (typeof val == \"boolean\") {\n                    return val;\n                }\n                return val != null;\n            },\n\n            _arrayArg: function(ref) { // not necessarily a reference though\n                var f = this.formula;\n                if (!f.arrayFormulaRange && ref instanceof RangeRef$3) {\n                    // if formula wasn't saved with Ctrl-Shift-Enter but a range is passed, Excel does\n                    // something special:\n                    //\n                    // - if range is Wx1 (horizontal array) and current formula resides within the\n                    //   horizontal bounds of the range, the appropriate cell is selected.  Example:\n                    //   A1..D1 contain 1, 2, 3, 4 and we have in B2: =A1:D1, then B2 will get 2 (the\n                    //   value in A2).  If the same formula is typed outside the horizontal span of the\n                    //   range, say in E2: =A1:D1, then #VALUE! is returned.\n                    //\n                    // - similarly, if the range is 1xH (vertical array), the formula must reside within\n                    //   the vertical bounds of the range and it gets the corresponding cell; otherwise,\n                    //   #VALUE!.\n                    if (ref.height() == 1 && f.col >= ref.topLeft.col && f.col <= ref.bottomRight.col) {\n                        return this.getRefData(new CellRef$4(ref.topLeft.row, f.col).setSheet(ref.sheet));\n                    }\n                    if (ref.width() == 1 && f.row >= ref.topLeft.row && f.row <= ref.bottomRight.row) {\n                        return this.getRefData(new CellRef$4(f.row, ref.topLeft.col).setSheet(ref.sheet));\n                    }\n                    return new CalcError$2(\"VALUE\");\n                } else {\n                    return this.asMatrix(ref);\n                }\n            },\n\n            asMatrix: function(range) {\n                if (range instanceof Matrix$1) {\n                    return range;\n                }\n                var self = this;\n                if (range instanceof RangeRef$3) {\n                    var tl = range.topLeft;\n                    var top = tl.row, left = tl.col;\n                    var cells = self.getRefCells(range);\n                    var m = new Matrix$1(self);\n                    if (isFinite(range.width())) {\n                        m.width = range.width();\n                    }\n                    if (isFinite(range.height())) {\n                        m.height = range.height();\n                    }\n                    if (!isFinite(top)) {\n                        top = 0;\n                    }\n                    if (!isFinite(left)) {\n                        left = 0;\n                    }\n                    cells.forEach(function(cell){\n                        m.set(cell.row - top,\n                              cell.col - left,\n                              cell.value);\n                    });\n                    return m;\n                }\n                if (Array.isArray(range) && range.length > 0) {\n                    var m = new Matrix$1(self), row = 0;\n                    range.forEach(function(line){\n                        var col = 0;\n                        var h = 1;\n                        line.forEach(function(el){\n                            var isRange = el instanceof RangeRef$3;\n                            if (el instanceof Ref$3 && !isRange) {\n                                el = self.getRefData(el);\n                            }\n                            if (isRange || Array.isArray(el)) {\n                                el = self.asMatrix(el);\n                            }\n                            if (el instanceof Matrix$1) {\n                                el.each(function(el, r, c){\n                                    m.set(row + r, col + c, el);\n                                });\n                                h = Math.max(h, el.height);\n                                col += el.width;\n                            } else {\n                                if(typeof el === \"string\" && el.length && !isNaN(el)) {\n                                    el = Number(el);\n                                }\n\n                                m.set(row, col++, el);\n                            }\n                        });\n                        row += h;\n                    });\n                    return m;\n                }\n            },\n\n            getRefCells: function(refs, hiddenInfo, wantNulls) {\n                var f = this.formula;\n                return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col, wantNulls);\n            },\n\n            getRefData: function(ref, wantNulls) {\n                var f = this.formula;\n                return this.ss.getData(ref, f.sheet, f.row, f.col, wantNulls);\n            },\n\n            workbook: function() {\n                return this.ss.workbook;\n            }\n        });\n\n        var Matrix$1 = Class$1.extend({\n            init: function Matrix(context) {\n                this.context = context;\n                this.height = 0;\n                this.width = 0;\n                this.data = [];\n            },\n            clone: function() {\n                var m = new Matrix$1(this.context);\n                m.height = this.height;\n                m.width = this.width;\n                m.data = this.data.map(function(row){ return row.slice(); });\n                return m;\n            },\n            get: function(row, col) {\n                var line = this.data[row];\n                var val = line ? line[col] : null;\n                return val instanceof Ref$3 ? this.context.getRefData(val) : val;\n            },\n            getNA: function(row, col) {\n                if (row < this.height && col < this.width) {\n                    return this.get(row, col);\n                }\n                return new CalcError$2(\"N/A\");\n            },\n            set: function(row, col, data) {\n                var line = this.data[row];\n                if (line == null) {\n                    line = this.data[row] = [];\n                }\n                line[col] = data;\n                if (row >= this.height) {\n                    this.height = row + 1;\n                }\n                if (col >= this.width) {\n                    this.width = col + 1;\n                }\n            },\n            each: function(f, includeEmpty) {\n                for (var row = 0; row < this.height; ++row) {\n                    for (var col = 0; col < this.width; ++col) {\n                        var val = this.get(row, col);\n                        if (includeEmpty || val != null) {\n                            val = f.call(this.context, val, row, col);\n                            if (val !== undefined) {\n                                return val;\n                            }\n                        }\n                    }\n                }\n            },\n            map: function(f, includeEmpty) {\n                var m = new Matrix$1(this.context);\n                this.each(function(el, row, col){\n                    // here `this` is actually the context\n                    m.set(row, col, f.call(this, el, row, col));\n                }, includeEmpty);\n                return m;\n            },\n            eachRow: function(f) {\n                for (var row = 0; row < this.height; ++row) {\n                    var val = f.call(this.context, row);\n                    if (val !== undefined) {\n                        return val;\n                    }\n                }\n            },\n            eachCol: function(f) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = f.call(this.context, col);\n                    if (val !== undefined) {\n                        return val;\n                    }\n                }\n            },\n            mapRow: function(f) {\n                var m = new Matrix$1(this.context);\n                this.eachRow(function(row){\n                    m.set(row, 0, f.call(this.context, row));\n                });\n                return m;\n            },\n            mapCol: function(f) {\n                var m = new Matrix$1(this.context);\n                this.eachCol(function(col){\n                    m.set(0, col, f.call(this.context, col));\n                });\n                return m;\n            },\n            toString: function() {\n                return JSON.stringify(this.data);\n            },\n            transpose: function() {\n                var m = new Matrix$1(this.context);\n                this.each(function(el, row, col){\n                    m.set(col, row, el);\n                });\n                return m;\n            },\n            unit: function(n) {\n                this.width = this.height = n;\n                var a = this.data = new Array(n);\n                for (var i = n; --i >= 0;) {\n                    var row = a[i] = new Array(n);\n                    for (var j = n; --j >= 0;) {\n                        row[j] = i == j ? 1 : 0;\n                    }\n                }\n                return this;\n            },\n            multiply: function(b) {\n                var a = this, m = new Matrix$1(a.context);\n                for (var row = 0; row < a.height; ++row) {\n                    for (var col = 0; col < b.width; ++col) {\n                        var s = 0;\n                        for (var i = 0; i < a.width; ++i) {\n                            var va = a.get(row, i);\n                            var vb = b.get(i, col);\n                            if (typeof va != \"number\" || typeof vb != \"number\") {\n                                throw new CalcError$2(\"VALUE\");\n                            }\n                            s += va * vb;\n                        }\n                        m.set(row, col, s);\n                    }\n                }\n                return m;\n            },\n            adds: function(b, s) {\n                var a = this, m = new Matrix$1(a.context);\n                var sign = s ? -1 : 1;\n                for (var row = 0; row < a.height; ++row) {\n                    for (var col = 0; col < a.width; ++col) {\n                        var x = a.get(row, col),\n                            y = b.get(row, col);\n                        m.set(row, col, x + sign * y);\n                    }\n                }\n                return m;\n            },\n            determinant: function() {\n                var a = this.clone().data;\n                var n = a.length;\n                var d = 1, C, L, i, k;\n                for (C = 0; C < n; C++) {\n                    for (L = C; (L < n) && (!a[L][C]); L++) {}\n                    if (L == n) {\n                        return 0;\n                    }\n                    if (L != C) {\n                        d = -d;\n                        for (k = C; k < n; k++) {\n                            var t = a[C][k];\n                            a[C][k] = a[L][k];\n                            a[L][k] = t;\n                        }\n                    }\n                    for (i = C+1; i < n; i++) {\n                        for (k = C+1; k < n; k++) {\n                            a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                        }\n                    }\n                    d *= a[C][C];\n                }\n                return d;\n            },\n            inverse: function() {\n                var n = this.width;\n                var m = this.augment(new Matrix$1(this.context).unit(n));\n                var a = m.data;\n                var tmp;\n\n                // Gaussian elimination\n                // https://en.wikipedia.org/wiki/Gaussian_elimination#Finding_the_inverse_of_a_matrix\n\n                // 1. Get zeros below main diagonal\n                for (var k = 0; k < n; ++k) {\n                    var imax = argmax(k, n, function(i){ return a[i][k]; });\n                    if (!a[imax][k]) {\n                        return null; // singular matrix\n                    }\n                    if (k != imax) {\n                        tmp = a[k];\n                        a[k] = a[imax];\n                        a[imax] = tmp;\n                    }\n                    for (var i = k+1; i < n; ++i) {\n                        for (var j = k+1; j < 2*n; ++j) {\n                            a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                        }\n                        a[i][k] = 0;\n                    }\n                }\n\n                // 2. Get 1-s on main diagonal, dividing by pivot\n                for (var i = 0; i < n; ++i) {\n                    for (var f = a[i][i], j = 0; j < 2*n; ++j) {\n                        a[i][j] /= f;\n                    }\n                }\n\n                // 3. Get zeros above main diagonal.  Actually, we only care to compute the right side\n                // here (that will be the inverse), so in the inner loop below we go while j >= n,\n                // instead of j >= k.\n                for (var k = n; --k >= 0;) {\n                    for (var i = k; --i >= 0;) {\n                        if (a[i][k]) {\n                            for (var j = 2*n; --j >= n;) {\n                                a[i][j] -= a[k][j] * a[i][k];\n                            }\n                        }\n                    }\n                }\n\n                return m.slice(0, n, n, n);\n            },\n            augment: function(m) {\n                var ret = this.clone(), n = ret.width;\n                m.each(function(val, row, col){\n                    ret.set(row, col + n, val);\n                });\n                return ret;\n            },\n            slice: function(row, col, height, width) {\n                var m = new Matrix$1(this.context);\n                for (var i = 0; i < height; ++i) {\n                    for (var j = 0; j < width; ++j) {\n                        m.set(i, j, this.get(row + i, col + j));\n                    }\n                }\n                return m;\n            }\n\n            // XXX: debug\n            // dump: function() {\n            //     this.data.forEach(function(row){\n            //         console.log(row.map(function(val){\n            //             var str = val.toFixed(3).replace(/\\.?0*$/, function(s){\n            //                 return [ \"\", \" \", \"  \", \"   \", \"    \" ][s.length];\n            //             });\n            //             if (val >= 0) { str = \" \" + str; }\n            //             return str;\n            //         }).join(\"  \"));\n            //     });\n            // }\n        });\n\n        function argmax(i, end, f) {\n            var max = f(i), pos = i;\n            while (++i < end) {\n                var v = f(i);\n                if (v > max) {\n                    max = v;\n                    pos = i;\n                }\n            }\n            return pos;\n        }\n\n        /* -----[ Formula ]----- */\n\n        var Formula$1 = Class$1.extend({\n            init: function Formula(refs, handler, printer, sheet, row, col, arrayFormulaRange){\n                this.refs = refs;\n                this.handler = handler;\n                this.print = printer;\n                this.absrefs = null;\n                this.sheet = sheet;\n                this.row = row;\n                this.col = col;\n                this.onReady = [];\n                this.pending = false;\n                this.arrayFormulaRange = arrayFormulaRange;\n            },\n            setArrayFormulaRange: function(ref) {\n                this.arrayFormulaRange = ref.clone().setSheet(this.sheet);\n            },\n            clone: function(sheet, row, col, forceRefs) {\n                var lcsheet = sheet.toLowerCase();\n                var refs = this.refs;\n                var range = this.arrayFormulaRange;\n                if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                    refs = refs.map(function(ref){\n                        if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                            ref = ref.clone().setSheet(sheet);\n                        }\n                        return ref;\n                    });\n                    if (range) {\n                        range = range.clone().setSheet(sheet);\n                    }\n                }\n                return new Formula$1(refs, this.handler, this.print, sheet, row, col, range);\n            },\n            deepClone: function() {\n                var refs = this.refs.map(function(ref){ return ref.clone(); });\n                return new Formula$1(refs, this.handler, this.print, this.sheet, this.row, this.col, this.arrayFormulaRange);\n            },\n            resolve: function(val) {\n                this.pending = false;\n                this.onReady.forEach(function(callback){\n                    callback(val);\n                });\n            },\n            exec: function(ss, callback, parentContext) {\n                if (\"value\" in this) {\n                    if (callback) {\n                        callback(this.value);\n                    }\n                } else {\n                    if (callback) {\n                        this.onReady.push(callback);\n                    }\n\n                    var ctx = new Context(this.resolve, this, ss, parentContext);\n                    var level = 0;\n                    // if the call chain leads back to this same formula, we have a circular dependency.\n                    while (parentContext) {\n                        if (parentContext.formula === this) {\n                            this.pending = false;\n                            ctx.resolve(new CalcError$2(\"CIRCULAR\"));\n                            return;\n                        }\n                        parentContext = parentContext.parent;\n                        ++level;\n                    }\n\n                    // pending is still useful for ASYNC formulas\n                    if (this.pending) {\n                        return;\n                    }\n                    this.pending = true;\n\n                    var next = function() {\n                        // compute and cache the absolute references\n                        if (!this.absrefs) {\n                            this.absrefs = this.refs.map(function(ref){\n                                return ref.absolute(this.row, this.col);\n                            }, this);\n                        }\n\n                        // finally invoke the handler given to us by the compiler in calc.js\n                        this.handler.call(ctx);\n                    }.bind(this);\n\n                    if (level < 20) {\n                        next();\n                    } else {\n                        setTimeout(next, 0);\n                    }\n                }\n            },\n            reset: function() {\n                this.onReady = [];\n                this.pending = false;\n                delete this.value;\n            },\n            renameSheet: function(oldSheetName, newSheetName) {\n                oldSheetName = oldSheetName.toLowerCase();\n                this.absrefs = null;\n                if (this.sheet.toLowerCase() == oldSheetName) {\n                    this.sheet = newSheetName;\n                }\n                this.refs.forEach(function(ref){\n                    ref.renameSheet(oldSheetName, newSheetName);\n                });\n            },\n            adjust: function(affectedSheet, operation, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                var formulaSheet = this.sheet.toLowerCase();\n                var formulaMoves = false;\n                if (formulaSheet == affectedSheet) {\n                    // move formula if it's after the change point\n                    if (operation == \"row\" && formulaRow >= start) {\n                        this.row += delta;\n                        formulaMoves = true;\n                    }\n                    if (operation == \"col\" && formulaCol >= start) {\n                        this.col += delta;\n                        formulaMoves = true;\n                    }\n                }\n                var newFormulaRow = this.row;\n                var newFormulaCol = this.col;\n                this.absrefs = null;\n                var prevRefs = this.refs;\n                var modified = formulaMoves;\n                this.refs = prevRefs.map(function(ref){\n                    var newRef = adjust(ref);\n                    if (!modified && !sameRef(newRef, ref)) {\n                        modified = true;\n                    }\n                    return newRef;\n                });\n\n                var prevRange = this.arrayFormulaRange;\n                if (prevRange) {\n                    this.arrayFormulaRange = adjust(prevRange);\n                    if (!modified && !sameRef(prevRange, this.arrayFormulaRange)) {\n                        modified = true;\n                    }\n                }\n\n                if (modified) {\n                    // return a clone of the original formula.  needed to undo operations like\n                    // deleteRow, which can transform a reference into NULL.\n                    return new Formula$1(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol, prevRange);\n                }\n\n                function adjust(ref){\n                    if (ref === NULL) {\n                        return ref;\n                    }\n                    if (ref.sheet.toLowerCase() != affectedSheet) {\n                        if (formulaMoves) {\n                            // a reference to another sheet should still point to the same location\n                            // after adjustment; thus if row/col was removed before formula, relative\n                            // references must be adjusted by delta.\n                            if (operation == \"row\" && formulaRow >= start) {\n                                ref = ref.relative(delta, 0);\n                            }\n                            if (operation == \"col\" && formulaCol >= start) {\n                                ref = ref.relative(0, delta);\n                            }\n                        }\n                        return ref;\n                    }\n                    return ref.adjust(\n                        formulaRow, formulaCol,\n                        newFormulaRow, newFormulaCol,\n                        operation == \"row\",\n                        start, delta\n                    );\n                }\n            },\n            toString: function() {\n                return this.print(this.row, this.col);\n            }\n        });\n\n        function sameRef(r1, r2) {\n            // note: r1.eq(r2) will not do, because it returns true for A1 and A1:A1 (CellRef\n            // vs. RangeRef).  To properly undo we need to assert that the references are exactly the\n            // same (including type).\n            if (r1.constructor !== r2.constructor) {\n                return false;\n            }\n            if (r1 instanceof CellRef$4) {\n                return r1.sheet == r2.sheet\n                    && r1.row == r2.row\n                    && r1.col == r2.col\n                    && r1.rel == r2.rel;\n            }\n            if (r1 instanceof RangeRef$3) {\n                return sameRef(r1.topLeft     , r2.topLeft)\n                    && sameRef(r1.bottomRight , r2.bottomRight)\n                    && r1.endSheet == r2.endSheet;\n            }\n            if (r1 instanceof UnionRef$2) {\n                var i = r1.refs.length;\n                if (i != r2.refs.length) {\n                    return false;\n                }\n                while (--i >= 0) {\n                    if (!sameRef(r1.refs[i], r2.refs[i])) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        }\n\n        // spreadsheet functions --------\n        var FUNCS = Object.create(null);\n\n        FUNCS[\"if\"] = function(callback, args) {\n            var self = this;\n            var co = args[0], th = args[1], el = args[2];\n            // XXX: I don't like this resolveCells here.  We should try to declare IF with\n            // defineFunction.\n            this.resolveCells([ co ], function(){\n                var comatrix = self.asMatrix(co);\n                if (comatrix) {\n                    // XXX: calling both branches in this case, since we'll typically need values from\n                    // both.  We could optimize and call them only when first needed, but oh well.\n                    th(function(th){\n                        el(function(el){\n                            var thmatrix = self.asMatrix(th);\n                            var elmatrix = self.asMatrix(el);\n                            callback(comatrix.map(function(val, row, col){\n                                if (val instanceof CalcError$2) {\n                                    return val;\n                                } else if (self.bool(val)) {\n                                    return thmatrix ? thmatrix.get(row, col) : th;\n                                } else {\n                                    return elmatrix ? elmatrix.get(row, col) : el;\n                                }\n                            }));\n                        });\n                    });\n                } else {\n                    co = this.force(co);\n                    if (co instanceof CalcError$2) {\n                        callback(co);\n                    } else if (self.bool(co)) {\n                        th(callback);\n                    } else {\n                        el(callback);\n                    }\n                }\n            });\n        };\n\n        FUNCS[\"φ\"] = function(callback) {\n            callback((1+Math.sqrt(5))/2);\n        };\n\n        // Lasciate ogni speranza, voi ch'entrate.\n        //\n        // XXX: document this function.\n        function compileArgumentChecks(functionName, args) {\n            var arrayArgs = \"function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; \";\n            var resolve = \"function resolve(args, callback) { var toResolve = [], i = 0; \";\n            var name, forced, main = \"'use strict'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = 'VALUE'; \", haveForced = false;\n            var canBeArrayArg = false, hasArrayArgs = false;\n            main += args.map(comp).join(\"\");\n            main += \"if (i < args.length) return new CalcError('N/A'); \";\n            main += \"return xargs; } \";\n            arrayArgs += \"return { args: xargs, width: width, height: height, arrays: arrays }; } \";\n\n            var f;\n            if (haveForced) {\n                resolve += \"this.resolveCells(toResolve, callback); } \";\n                f = new Function(\"CalcError\", \"round\", main + resolve + arrayArgs + \" return { resolve: resolve, check: check, arrayArgs: arrayArgs };\");\n            } else {\n                f = new Function(\"CalcError\", \"round\", main + \" return { check: check };\");\n            }\n            f = f(CalcError$2, limitPrecision$1);\n            if (!hasArrayArgs) {\n                delete f.arrayArgs;\n            }\n            return f;\n\n            function comp(x) {\n                name = x[0];\n                var code = \"{ \";\n                if (Array.isArray(name)) {\n                    arrayArgs += \"while (i < args.length) { \";\n                    resolve += \"while (i < args.length) { \";\n                    code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                    code += \"while (i < args.length) { \";\n                    code += x.map(comp).join(\"\");\n                    code += \"} \";\n                    code += \"xargs = stack.pop(); \";\n                    resolve += \"} \";\n                    arrayArgs += \"} \";\n                } else if (name == \"+\") {\n                    arrayArgs += \"while (i < args.length) { \";\n                    resolve += \"while (i < args.length) { \";\n                    code += \"if (i >= args.length) return new CalcError('N/A'); \";\n                    code += \"xargs.push(tmp = []); stack.push(xargs); xargs = tmp; \";\n                    code += \"do { \";\n                    code += x.slice(1).map(comp).join(\"\");\n                    code += \"} while (i < args.length); \";\n                    code += \"xargs = stack.pop(); \";\n                    resolve += \"} \";\n                    arrayArgs += \"} \";\n                } else if (name == \"?\") {\n                    // standalone assertion without a new argument\n                    code += \"if (!(\" + cond(x[1]) + \")) return new CalcError(err); \";\n                } else {\n                    var type = x[1];\n                    if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                        var wantNulls = /!$/.test(type[0]);\n                        var n = type[2];\n                        force();\n                        code += \"try {\"\n                            + \"var $\" + name + \" = this.cellValues(args.slice(i\";\n                        if (n) {\n                            code += \", i + \" + n;\n                        }\n                        code += \")\" + (wantNulls ? \",true\" : \"\") + \").reduce(function(ret, $\"+name+\"){ \";\n                        if (type[0].charAt(0) != \"#\") {\n                            code += \"if ($\"+name+\" instanceof CalcError) throw $\"+name+\"; \";\n                        }\n                        code += \"if (\" + cond(type[1]) + \") ret.push($\"+name+\"); \";\n                        code += \"return ret; \";\n                        code += \"}.bind(this), []); \";\n                        if (n) {\n                            code += \"i += \" + n + \"; \";\n                        } else {\n                            code += \"i = args.length; \";\n                        }\n                        code += \"xargs.push($\"+name+\")\"\n                            + \"} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } \";\n                        resolve += \"toResolve.push(args.slice(i)); \";\n                    } else if (type == \"rest\") {\n                        code += \"xargs.push(args.slice(i)); i = args.length; \";\n                    } else {\n                        if ((canBeArrayArg = /^\\*/.test(name))) {\n                            hasArrayArgs = true;\n                            name = name.substr(1);\n                        }\n                        code += \"var $\" + name + \" = args[i++]; \";\n                        var allowError = false;\n                        if (/!$/.test(type)) {\n                            type = type.substr(0, type.length - 1);\n                            allowError = true;\n                        } else {\n                            code += \"if ($\"+name+\" instanceof CalcError) return $\"+name+\"; \";\n                        }\n                        code += typeCheck(type, allowError) + \"xargs.push($\"+name+\"); \";\n                    }\n                }\n                code += \"} \";\n                return code;\n            }\n\n            function force() {\n                if (forced) {\n                    return \"$\"+name+\"\";\n                }\n                haveForced = true;\n                forced = true;\n                resolve += \"toResolve.push(args[i++]); \";\n                return \"($\"+name+\" = this.force($\"+name+\"))\";\n            }\n\n            function forceNum(round) {\n                return \"(\"\n                    +     (round\n                           ? (\"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false) || \")\n                           : (\"(typeof \" + force() + \" == 'number') || \"))\n                    +     \"(typeof $\"+name+\" == 'boolean' ? ($\"+name+\" = +$\" + name + \", true) : false) || \"\n                    +     \"(typeof $\"+name+\" == 'string' && !/^(?:=|true|false)/i.test($\"+name+\") ? (\"\n                    +       \"tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $\"+name+\"), \"\n                    +       \"/^date|number|percent$/.test(tmp.type) ? ($\"+name+\" = +tmp.value, true) : false\"\n                    +     \") : false)\"\n                    +  \")\";\n            }\n\n            function typeCheck(type, allowError) {\n                forced = false;\n                var ret = \"if (!(\" + cond(type) + \")) { \";\n                if (forced && !allowError) {\n                    ret += \" if ($\" + name + \" instanceof CalcError) return $\" + name + \"; \";\n                }\n                ret += \"return new CalcError(err); } \";\n                if (!forced) {\n                    resolve += \"i++; \";\n                }\n                if (canBeArrayArg) {\n                    arrayArgs += \"var $\" + name + \" = this._arrayArg(args[i]); \"\n                        + \"if ($\" + name + \") { \"\n                        + \"xargs.push($\" + name + \"); \"\n                        + \"width = Math.max(width, $\" + name + \".width); \"\n                        + \"height = Math.max(height, $\" + name + \".height); \"\n                        + \"arrays.push(true) } else { \"\n                        + \"xargs.push(args[i]); \"\n                        + \"arrays.push(false); } i++; \";\n                } else {\n                    arrayArgs += \"xargs.push(args[i++]); arrays.push(false); \";\n                }\n                return ret;\n            }\n\n            function cond(type) {\n                if (Array.isArray(type)) {\n                    if (type[0] == \"or\") {\n                        return \"(\" + type.slice(1).map(cond).join(\") || (\") + \")\";\n                    }\n                    if (type[0] == \"and\") {\n                        return \"(\" + type.slice(1).map(cond).join(\") && (\") + \")\";\n                    }\n                    if (type[0] == \"values\") {\n                        return \"(\" + type.slice(1).map(function(val){\n                            return force() + \" === \" + val;\n                        }).join(\") || (\") + \")\";\n                    }\n                    if (type[0] == \"null\") {\n                        return \"(\" + cond(\"null\") + \" ? (($\"+name+\" = \" + type[1] + \"), true) : false)\";\n                    }\n                    if (type[0] == \"between\" || type[0] == \"[between]\") {\n                        return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"(between)\") {\n                        return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"(between]\") {\n                        return \"(\" + force() + \" > \" + type[1] + \" && \" + \"$\"+name+\" <= \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"[between)\") {\n                        return \"(\" + force() + \" >= \" + type[1] + \" && \" + \"$\"+name+\" < \" + type[2] + \" ? true : ((err = 'NUM'), false))\";\n                    }\n                    if (type[0] == \"assert\") {\n                        var err = type[2] || \"N/A\";\n                        return \"((\" + type[1] + \") ? true : (err = \" + JSON.stringify(err) + \", false))\";\n                    }\n                    if (type[0] == \"not\") {\n                        return \"!(\" + cond(type[1]) + \")\";\n                    }\n                    throw new Error(\"Unknown array type condition: \" + type[0]);\n                }\n                if (type == \"number\" || type == \"datetime\") {\n                    return forceNum(true);\n                }\n                if (type == \"number!\") {\n                    return \"(typeof \" + force() + \" == 'number' ? ($\"+name+\" = round($\"+name+\"), true) : false)\";\n                }\n                if (type == \"integer\" || type == \"date\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0), true))\";\n                }\n                if (type == \"divisor\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" == 0 ? ((err = 'DIV/0'), false) : true))\";\n                }\n                if (type == \"number+\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" >= 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"integer+\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) >= 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"number++\") {\n                    return \"(\" + forceNum(true) + \" && ($\"+name+\" > 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"integer++\") {\n                    return \"(\" + forceNum() + \" && (($\"+name+\" |= 0) > 0 ? true : ((err = 'NUM'), false)))\";\n                }\n                if (type == \"string\") {\n                    return \"((typeof \" + force() + \" == 'string' || typeof $\"+name+\" == 'boolean' || typeof $\"+name+\" == 'number') ? ($\"+name+\" += '', true) : ($\"+name+\" === undefined ? (($\"+name+\" = ''), true) : false))\";\n                }\n                if (type == \"boolean\") {\n                    return \"(typeof \" + force() + \" == 'boolean')\";\n                }\n                if (type == \"logical\") {\n                    return \"(typeof \" + force() + \" == 'boolean' || (typeof $\"+name+\" == 'number' ? ($\"+name+\" = !!$\"+name+\", true) : false))\";\n                }\n                if (type == \"matrix\") {\n                    force();\n                    return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n                }\n                if (type == \"#matrix\") {\n                    return \"((m = this.asMatrix($\"+name+\")) ? ($\"+name+\" = m) : false)\";\n                }\n                if (type == \"ref\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.Ref)\";\n                }\n                if (type == \"area\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef || $\"+name+\" instanceof kendo.spreadsheet.RangeRef)\";\n                }\n                if (type == \"cell\") {\n                    return \"($\"+name+\" instanceof kendo.spreadsheet.CellRef)\";\n                }\n                if (type == \"null\") {\n                    return \"(\" + force() + \" == null)\";\n                }\n                if (type == \"anyvalue\") {\n                    return \"(\" + force() + \" != null && i <= args.length)\";\n                }\n                if (type == \"forced\") {\n                    return \"(\" + force() + \", i <= args.length)\";\n                }\n                if (type == \"anything\") {\n                    return \"(i <= args.length)\";\n                }\n                if (type == \"blank\") {\n                    return \"(\" + force() + \" == null || $\"+name+\" === '')\";\n                }\n                throw new Error(\"Can't check for type: \" + type);\n            }\n        }\n\n        function limitPrecision$1(num) {\n            return num === parseInt(num, 10) ? num : +num.toPrecision(16);\n        }\n\n        function maybeRoundFloatErrors(num) {\n            if (typeof num == \"number\") {\n                return limitPrecision$1(num);\n            } else {\n                return num;\n            }\n        }\n\n        function withErrorHandling(obj, f, args) {\n            if (args instanceof CalcError$2) {\n                return args;\n            }\n            try {\n                return f.apply(obj, args);\n            } catch(ex) {\n                if (ex instanceof CalcError$2) {\n                    return ex;\n                } else {\n                    throw ex;\n                }\n            }\n        }\n\n        function makeSyncFunction(handler, resolve, check, arrayArgs) {\n            return function(callback, args) {\n                function doit() {\n                    if (arrayArgs) {\n                        var x = arrayArgs.call(this, args);\n                        args = x.args;\n                        if (x.width > 0 && x.height > 0) {\n                            var result = new Matrix$1(this);\n                            for (var row = 0; row < x.height; ++row) {\n                                for (var col = 0; col < x.width; ++col) {\n                                    var xargs = [];\n                                    for (var i = 0; i < args.length; ++i) {\n                                        if (x.arrays[i]) {\n                                            xargs[i] = args[i].getNA(row, col);\n                                        } else {\n                                            xargs[i] = args[i];\n                                        }\n                                    }\n                                    xargs = check.call(this, xargs);\n                                    result.set(row, col, withErrorHandling(this, handler, xargs));\n                                }\n                            }\n                            return callback(result);\n                        }\n                    }\n                    var xargs = check.call(this, args);\n                    callback(withErrorHandling(this, handler, xargs));\n                }\n                if (resolve) {\n                    resolve.call(this, args, doit);\n                } else {\n                    doit.call(this);\n                }\n            };\n        }\n\n        function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n            return function(callback, args) {\n                function doit() {\n                    if (arrayArgs) {\n                        var x = arrayArgs.call(this, args);\n                        args = x.args;\n                        if (x.width > 0 && x.height > 0) {\n                            var result = new Matrix$1(this);\n                            var count = x.width * x.height;\n                            var makeCallback = function(row, col) {\n                                return function(value) {\n                                    result.set(row, col, value);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                };\n                            };\n                            for (var row = 0; row < x.height && count > 0; ++row) {\n                                for (var col = 0; col < x.width && count > 0; ++col) {\n                                    var xargs = [];\n                                    for (var i = 0; i < args.length; ++i) {\n                                        if (x.arrays[i]) {\n                                            xargs[i] = args[i].getNA(row, col);\n                                        } else {\n                                            xargs[i] = args[i];\n                                        }\n                                    }\n                                    xargs = check.call(this, xargs);\n                                    if (xargs instanceof CalcError$2) {\n                                        result.set(row, col, xargs);\n                                        --count;\n                                        if (count === 0) {\n                                            return callback(result);\n                                        }\n                                    } else {\n                                        xargs.unshift(makeCallback(row, col));\n                                        handler.apply(this, xargs);\n                                    }\n                                }\n                            }\n                            return;\n                        }\n                    }\n                    var x = check.call(this, args);\n                    if (x instanceof CalcError$2) {\n                        callback(x);\n                    } else {\n                        x.unshift(callback);\n                        handler.apply(this, x);\n                    }\n                }\n                if (resolve) {\n                    resolve.call(this, args, doit);\n                } else {\n                    doit.call(this);\n                }\n            };\n        }\n\n        function defineFunction$2(name, func) {\n            name = name.toLowerCase();\n            FUNCS[name] = func;\n            return {\n                args: function(args, log) {\n                    var code = compileArgumentChecks(name, args);\n                    // XXX: DEBUG\n                    if (log) {\n                        if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                        if (code.resolve) {console.log(code.resolve.toString());}\n                        if (code.check) {console.log(code.check.toString());}\n                    }\n                    var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                    f.kendoSpreadsheetArgs = args;\n                    return this;\n                },\n                argsAsync: function(args, log) {\n                    var code = compileArgumentChecks(name, args);\n                    // XXX: DEBUG\n                    if (log) {\n                        if (code.arrayArgs) {console.log(code.arrayArgs.toString());}\n                        if (code.resolve) {console.log(code.resolve.toString());}\n                        if (code.check) {console.log(code.check.toString());}\n                    }\n                    var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                    f.kendoSpreadsheetArgs = args;\n                    return this;\n                }\n            };\n        }\n\n        /* -----[ date calculations ]----- */\n\n        // Julian days algorithms from http://www.hermetic.ch/cal_stud/jdn.htm#comp\n\n        function dateToJulianDays(y, m, d) {\n            m++;\n            return ((1461 * (y + 4800 + ((m - 14) / 12 | 0))) / 4 | 0) +\n                ((367 * (m - 2 - 12 * ((m - 14) / 12 | 0))) / 12 | 0) -\n                ((3 * (((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0))) / 4 | 0) +\n                d - 32075;\n        }\n\n        function julianDaysToDate(jd) {\n            var l, n, j, i, m, d, y;\n            l = jd + 68569;\n            n = (4 * l) / 146097 | 0;\n            l = l - ((146097 * n + 3) / 4 | 0);\n            i = (4000 * (l + 1) / 1461001) | 0;\n            l = l - ((1461 * i) / 4 | 0) + 31;\n            j = (80 * l) / 2447 | 0;\n            d = l - ((2447 * j) / 80 | 0);\n            l = j / 11 | 0;\n            m = j + 2 - (12 * l);\n            y = 100 * (n - 49) + i + l;\n            m--;\n            return {\n                year  : y,\n                month : m,\n                date  : d,\n                day   : (jd + 1) % 7,\n                ord   : ORDINAL_ADD_DAYS[isLeapYear$1(y)][m] + d\n            };\n        }\n\n        // This uses the Google Spreadsheet approach: treat 1899-12-31 as day 1, allowing to avoid\n        // implementing the \"Leap Year Bug\" yet still be Excel compatible for dates starting 1900-03-01.\n        var BASE_DATE = dateToJulianDays(1900, 0, -1);\n\n        var DAYS_IN_MONTH = [ 31, 28, 31,\n                              30, 31, 30,\n                              31, 31, 30,\n                              31, 30, 31 ];\n\n        var ORDINAL_ADD_DAYS = [\n            [ 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 ], // non-leap year\n            [ 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335 ]  // leap year\n        ];\n\n        function isLeapYear$1(yr) {\n            if (yr % 4) {\n                return 0;\n            }\n            if (yr % 100) {\n                return 1;\n            }\n            if (yr % 400) {\n                return 0;\n            }\n            return 1;\n        }\n\n        function daysInYear$2(yr) {\n            return isLeapYear$1(yr) ? 366 : 365;\n        }\n\n        function daysInMonth$2(yr, mo) {\n            return (isLeapYear$1(yr) && mo == 1) ? 29 : DAYS_IN_MONTH[mo];\n        }\n\n        function validDate(yr, mo, da) {\n            return mo >= 1 && mo <= 12 && da >= 1 && da <= daysInMonth$2(yr, mo - 1);\n        }\n\n        function unpackDate$2(serial) {\n            return julianDaysToDate((serial | 0) + BASE_DATE);\n        }\n\n        function packDate$2(year, month, date) {\n            return dateToJulianDays(year, month, date) - BASE_DATE;\n        }\n\n        var MS_IN_MIN = 60 * 1000;\n        var MS_IN_HOUR = 60 * MS_IN_MIN;\n        var MS_IN_DAY = 24 * MS_IN_HOUR;\n\n        function unpackTime(serial) {\n            var frac = serial - (serial|0);\n            if (frac < 0) {\n                frac++;\n            }\n            var ms = Math.round(MS_IN_DAY * frac);\n            var hours = Math.floor(ms / MS_IN_HOUR);\n            ms -= hours * MS_IN_HOUR;\n            var minutes = Math.floor(ms / MS_IN_MIN);\n            ms -= minutes * MS_IN_MIN;\n            var seconds = Math.floor(ms / 1000);\n            ms -= seconds * 1000;\n            return {\n                hours: hours,\n                minutes: minutes,\n                seconds: seconds,\n                milliseconds: ms\n            };\n        }\n\n        function serialToDate(serial) {\n            var d = unpackDate$2(serial), t = unpackTime(serial);\n            return new Date(d.year, d.month, d.date,\n                            t.hours, t.minutes, t.seconds, t.milliseconds);\n        }\n\n        function packTime(hh, mm, ss, ms) {\n            return (hh+(mm+(ss+ms/1000)/60)/60)/24;\n        }\n\n        function dateToSerial(date) {\n            var time = packTime(date.getHours(),\n                                date.getMinutes(),\n                                date.getSeconds(),\n                                date.getMilliseconds());\n            date = packDate$2(date.getFullYear(),\n                            date.getMonth(),\n                            date.getDate());\n            if (date < 0) {\n                return date - 1 + time;\n            } else {\n                return date + time;\n            }\n        }\n\n        function parseDate(str, format) {\n            if (format) {\n                format = kendo.spreadsheet.formatting.makeDateFormat(format);\n            }\n            return kendo.parseExactDate(str, format)\n                || kendo.parseExactDate(str)\n                || kendo.parseExactDate(str, [\n                    \"MMMM dd yyyy\",\n                    \"MMMM dd yy\",\n                    \"MMM dd yyyy\",\n                    \"MMM dd yy\",\n                    \"dd MMMM yyyy\",\n                    \"dd MMMM yy\",\n                    \"dd MMM yyyy\",\n                    \"dd MMM yy\",\n                    \"MMMM dd, yyyy\",\n                    \"MMMM dd, yy\",\n                    \"MMM dd, yyyy\",\n                    \"MMM dd, yy\",\n                    \"MMMM dd\",\n                    \"MMM dd\",\n                    \"MMMM yyyy\",\n                    \"MMM yyyy\",\n                    \"dd MMMM\",\n                    \"dd MMM\"\n                ]);\n        }\n\n        /* -----[ exports ]----- */\n\n        exports$3.CalcError = CalcError$2;\n        exports$3.Formula = Formula$1;\n        exports$3.Matrix = Matrix$1;\n\n        exports$3.packDate = packDate$2;\n        exports$3.unpackDate = unpackDate$2;\n        exports$3.packTime = packTime;\n        exports$3.unpackTime = unpackTime;\n        exports$3.serialToDate = serialToDate;\n        exports$3.dateToSerial = dateToSerial;\n        exports$3.daysInMonth = daysInMonth$2;\n        exports$3.validDate = validDate;\n        exports$3.isLeapYear = isLeapYear$1;\n        exports$3.daysInYear = daysInYear$2;\n        exports$3.parseDate = parseDate;\n        exports$3.limitPrecision = limitPrecision$1;\n\n        spreadsheet$7.dateToNumber = dateToSerial;\n        spreadsheet$7.numberToDate = serialToDate;\n        spreadsheet$7.defineFunction = defineFunction$2;\n        spreadsheet$7.CalcError = CalcError$2;\n\n        exports$3.defineFunction = defineFunction$2;\n        exports$3.defineAlias = function(alias, name) {\n            var orig = FUNCS[name];\n            if (!orig) {\n                throw new Error(\"Function \" + name + \" is not yet defined\");\n            }\n            if (!orig.kendoSpreadsheetAliases) {\n                orig.kendoSpreadsheetAliases = [ name ];\n            }\n            orig.kendoSpreadsheetAliases.push(alias);\n            FUNCS[alias] = orig;\n        };\n        exports$3.FUNCS = FUNCS;\n\n        /* -----[ Excel operators ]----- */\n\n        var NUMBER_OR_ZERO = [ \"or\", \"number\", [ \"null\", 0 ] ];\n\n        var ARGS_NUMERIC = [\n            [ \"*a\", NUMBER_OR_ZERO ],\n            [ \"*b\", NUMBER_OR_ZERO ]\n        ];\n\n        var ARGS_ANYVALUE = [\n            [ \"*a\", \"forced\" ],\n            [ \"*b\", \"forced\" ]\n        ];\n\n        defineFunction$2(\"binary+\", function(a, b){\n            return a + b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary-\", function(a, b){\n            return a - b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary*\", function(a, b){\n            return a * b;\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary/\", function(a, b){\n            return a / b;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$2(\"binary^\", function(a, b){\n            return Math.pow(a, b);\n        }).args(ARGS_NUMERIC);\n\n        defineFunction$2(\"binary&\", function(a, b){\n            if (a == null) { a = \"\"; }\n            if (b == null) { b = \"\"; }\n            return \"\" + a + b;\n        }).args([\n            [ \"*a\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ],\n            [ \"*b\", [ \"or\", \"number\", \"string\", \"boolean\", \"null\" ] ]\n        ]);\n\n        function equals(a, b){\n            a = typeof(a) === \"string\" ? a.toLowerCase() : a;\n            b = typeof(b) === \"string\" ? b.toLowerCase() : b;\n\n            // special cases\n            if (a === false && b == null) { return true; }\n            if (b === false && a == null) { return true; }\n            if (a === 0     && b == null) { return true; }\n            if (b === 0     && a == null) { return true; }\n            if (a === \"\"    && b == null) { return true; }\n            if (b === \"\"    && a == null) { return true; }\n\n            return a === b;\n        }\n\n        defineFunction$2(\"binary=\", equals).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<>\", function(a, b){\n            return !equals(a, b);\n        }).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<\", binaryCompare(function(a, b){\n            return a < b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary<=\", binaryCompare(function(a, b){\n            return a <= b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary>\", binaryCompare(function(a, b){\n            return a > b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"binary>=\", binaryCompare(function(a, b){\n            return a >= b;\n        })).args(ARGS_ANYVALUE);\n\n        defineFunction$2(\"unary+\", function(a){\n            return a;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        defineFunction$2(\"unary-\", function(a){\n            return -a;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        defineFunction$2(\"unary%\", function(a){\n            return a / 100;\n        }).args([\n            [ \"*a\", NUMBER_OR_ZERO ]\n        ]);\n\n        // range operator\n        defineFunction$2(\"binary:\", function(a, b){\n            return new RangeRef$3(a, b)\n                .setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n        }).args([\n            [ \"a\", \"cell\" ],\n            [ \"b\", \"cell\" ]\n        ]);\n\n        // union operator\n        defineFunction$2(\"binary,\", function(a, b){\n            return new UnionRef$2([ a, b ]);\n        }).args([\n            [ \"a\", \"ref\" ],\n            [ \"b\", \"ref\" ]\n        ]);\n\n        // intersection operator\n        defineFunction$2(\"binary \", function(a, b){\n            return a.intersect(b);\n        }).args([\n            [ \"a\", \"ref\" ],\n            [ \"b\", \"ref\" ]\n        ]);\n\n        /* -----[ conditionals ]----- */\n\n        defineFunction$2(\"not\", function(a){\n            return !this.bool(a);\n        }).args([\n            [ \"*a\", [ \"or\", \"anyvalue\", [ \"null\", 0 ] ] ]\n        ]);\n\n        /* -----[ the IS* functions ]----- */\n\n        defineFunction$2(\"isblank\", function(val){\n            if (val instanceof CellRef$4) {\n                val = this.getRefData(val);\n                return val == null;\n            }\n            return false;\n        }).args([\n            [ \"*value\", \"anything!\" ]\n        ]);\n\n        defineFunction$2(\"iserror\", function(val){\n            return val instanceof CalcError$2;\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"iserr\", function(val){\n            return val instanceof CalcError$2 && val.code != \"N/A\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isna\", function(val){\n            return val instanceof CalcError$2 && val.code == \"N/A\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"islogical\", function(val){\n            return typeof val == \"boolean\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isnontext\", function(val){\n            return typeof val != \"string\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"istext\", function(val){\n            return typeof val == \"string\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isnumber\", function(val){\n            return typeof val == \"number\";\n        }).args([\n            [ \"*value\", \"forced!\" ]\n        ]);\n\n        defineFunction$2(\"isref\", function(val){\n            // apparently should return true only for cell and range\n            return val instanceof CellRef$4 || val instanceof RangeRef$3;\n        }).args([\n            [ \"*value\", \"anything!\" ]\n        ]);\n\n        /* -----[ resolve NameRef-s ]----- */\n\n        FUNCS[\",getname\"] = function(callback, args) {\n            this.fetchName(args[0], callback);\n        };\n\n        /// utils\n\n        function binaryCompare(func) {\n            return function(left, right){\n                if (typeof left == \"string\" && typeof right != \"string\") {\n                    right = right == null ? \"\" : right + \"\";\n                }\n                if (typeof left != \"string\" && typeof right == \"string\") {\n                    left = left == null ? \"\" : left + \"\";\n                }\n                if (typeof left == \"number\" && right == null) {\n                    right = 0;\n                }\n                if (typeof right == \"number\" && left == null) {\n                    left = 0;\n                }\n                if (typeof left == \"string\" && typeof right == \"string\") {\n                    // string comparison is case insensitive\n                    left = left.toLowerCase();\n                    right = right.toLowerCase();\n                }\n                if (typeof right == typeof left) {\n                    return func(left, right);\n                } else {\n                    return new CalcError$2(\"VALUE\");\n                }\n            };\n        }\n\n    \"use strict\";\n\n        var $$2 = kendo.jQuery;\n\n        var spreadsheet$6 = kendo.spreadsheet;\n\n        var exports$2 = {};\n        spreadsheet$6.validation = exports$2;\n        var calc$3 = spreadsheet$6.calc;\n        var Class = kendo.Class;\n        var TRANSPOSE_FORMAT = \"_matrix({0})\";\n        var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n\n        calc$3.runtime.defineFunction(\"_matrix\", function(m){\n            if (typeof m == \"string\") {\n                // for constant list validation, Excel includes a string\n                // with comma-separated values — make a Matrix from it.\n                m = this.asMatrix([ m.split(/\\s*,\\s*/) ]);\n            }\n            return m;\n        }).args([\n            [ \"m\", [ \"or\", \"matrix\", \"string\" ] ]\n        ]);\n\n        function compileValidation(sheet, row, col, validation) {\n            var validationHandler;\n            var comparer;\n            var parsedFromDate;\n            var parsedToDate;\n\n            if (typeof validation === \"string\") {\n                validation = JSON.parse(validation);\n            }\n\n            if (validation.from) {\n                if (validation.dataType === \"list\" && !validation.fromIsListValue) {\n                    // We need to convert the {...} validation.from value to a string, so that it would work when exported to XLSX\n                    if(validation.from.indexOf(\"{\") > -1) {\n                        validation.from = validation.from.replace(/\\\"/g,\"\").replace(\"{\",\"\\\"\").replace(\"}\", \"\\\"\");\n                    }\n                    validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                    validation.fromIsListValue = true;\n                }\n\n                if (validation.dataType === \"date\") {\n                    parsedFromDate = calc$3.runtime.parseDate(validation.from);\n                    if (parsedFromDate) {\n                        validation.from = kendo.format(DATE_FORMAT, validation.from);\n                        validation.fromIsDateValue = true;\n                    }\n                }\n\n                validation.from = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.from));\n            }\n\n            if (validation.to) {\n                if (validation.dataType === \"date\") {\n                    parsedToDate = calc$3.runtime.parseDate(validation.to);\n                    if (parsedToDate) {\n                        validation.to = kendo.format(DATE_FORMAT, validation.to);\n                        validation.toIsDateValue = true;\n                    }\n                }\n\n                validation.to = calc$3.compile(calc$3.parseFormula(sheet, row, col, validation.to));\n            }\n\n            if (validation.dataType == \"custom\") {\n                comparer = exports$2.validationComparers.custom;\n            } else if (validation.dataType == \"list\") {\n                comparer = exports$2.validationComparers.list;\n            } else {\n                comparer = exports$2.validationComparers[validation.comparerType];\n            }\n\n            if (!comparer) {\n                throw kendo.format(\"'{0}' comparer is not implemented.\", validation.comparerType);\n            }\n\n            validationHandler = function (valueToCompare) { //add 'valueFormat' arg when add isDate comparer\n                var toValue = this.to && (this.to_value || this.to_value === 0) ? this.to_value : undefined;\n\n                if (valueToCompare === null || valueToCompare === \"\") {\n                    if (this.allowNulls) {\n                        this.value = true;\n                    } else {\n                        this.value = false;\n                    }\n                } else if (this.dataType == \"custom\") {\n                    this.value = comparer(valueToCompare, this.from_value,  toValue);\n                } else if (this.dataType == \"list\") {\n                    var data = this._getListData();\n\n                    this.value = comparer(valueToCompare, data, toValue);\n                } else {\n                    //TODO: TYPE CHECK IS REQUIRED ONLY FOR DATE TYPE WHEN SPECIAL COMPARER (ISDATE) IS USED\n                    this.value = comparer(valueToCompare, this.from_value,  toValue);\n                }\n\n                return this.value;\n            };\n\n            return new kendo.spreadsheet.validation.Validation($$2.extend(validation, {\n                handler: validationHandler,\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        }\n\n        var Validation = Class.extend({\n            init: function Validation(options){\n                this.handler = options.handler;\n                this.from = options.from;\n                this.to = options.to;\n                this.dataType = options.dataType; //date, time etc\n                this.comparerType =  options.comparerType; //greaterThan, EqaulTo etc\n                this.type = options.type ? options.type : \"warning\"; //info, warning, reject\n                this.allowNulls = options.allowNulls ? true : false;\n                this.fromIsDateValue = options.fromIsDateValue ? true : false;\n                this.toIsDateValue = options.toIsDateValue ? true : false;\n                this.showButton = options.showButton;\n                this.fromIsListValue = options.fromIsListValue ? true : false;\n\n                //TODO: address to be range / cell ref, and adjust it based on it\n                this.sheet = options.sheet;\n                this.row = options.row;\n                this.col = options.col;\n\n                if (options.tooltipMessageTemplate) {\n                    this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n                }\n\n                if (options.tooltipTitleTemplate) {\n                    this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n                }\n\n                if (options.messageTemplate) {\n                    this.messageTemplate = options.messageTemplate;\n                }\n\n                if (options.titleTemplate) {\n                    this.titleTemplate = options.titleTemplate;\n                }\n            },\n\n            _formatMessages: function(format) {\n                var from = this.from ? this.from_value : \"\";\n                var to = this.to ? this.to_value : \"\";\n\n                var fromFormula = this.from ? this.from.toString() : \"\";\n                var toFormula = this.to ? this.to.toString() : \"\";\n                var dataType = this.dataType;\n                var type = this.type;\n                var comparerType = this.comparerType;\n\n                return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n            },\n\n            _setMessages: function() {\n                this.title = \"\";\n                this.message = \"\";\n\n                if (this.tooltipTitleTemplate) {\n                    this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n                }\n\n                if (this.tooltipMessageTemplate) {\n                    this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n                }\n\n                if (this.titleTemplate) {\n                    this.title = this._formatMessages(this.titleTemplate);\n                }\n\n                if (this.messageTemplate) {\n                    this.message = this._formatMessages(this.messageTemplate);\n                }\n            },\n\n            _getListData: function() {\n                if (!this.from_value || !this.from_value.data) {\n                    return [];\n                }\n\n                var cube = this.from_value.data;\n                var i;\n                var y;\n                var data = [];\n\n                for (i = 0; i < cube.length; i++ ) {\n                    var array = cube[i];\n\n                    if (array) {\n                        for (y = 0; y < array.length; y++ ) {\n                            data.push(array[y]);\n                        }\n                    }\n                }\n\n                return data;\n            },\n\n            clone: function(sheet, row, col) {\n                var options = this._getOptions();\n\n                if (options.from) {\n                    options.from = options.from.clone(sheet, row, col);\n                }\n\n                if (options.to) {\n                    options.to = options.to.clone(sheet, row, col);\n                }\n\n                return new Validation($$2.extend(options,\n                    { handler: this.handler },\n                    { sheet: sheet, row: row, col: col }\n                ));\n            },\n\n            deepClone: function() {\n                var v = new Validation(this);\n                v.from = v.from.deepClone();\n                if (v.to) {\n                    v.to = v.to.deepClone();\n                }\n                return v;\n            },\n\n            exec: function(ss, compareValue, compareFormat, callback) {\n                var self = this;\n\n                function getValue(val) {\n                    if (val instanceof kendo.spreadsheet.Ref) {\n                        val = ss.getData(val);\n                        if (Array.isArray(val)) {\n                            val = val[0];\n                        }\n                    }\n                    return val;\n                }\n\n                var calculateFromCallBack = function(val) {\n                    self.from_value = getValue(val);\n                    self.value = self.handler.call(self, compareValue, compareFormat);\n                    self._setMessages();\n                    if (callback) {\n                        callback(self.value);\n                    }\n                };\n\n                if (self.to) {\n                    self.to.exec(ss, function(val) {\n                        self.to_value = getValue(val);\n                        self.from.exec(ss, calculateFromCallBack);\n                    });\n                } else {\n                    self.from.exec(ss, calculateFromCallBack);\n                }\n            },\n\n            reset: function() {\n                if (this.from) {\n                    this.from.reset();\n                }\n                if (this.to) {\n                    this.to.reset();\n                }\n                delete this.value;\n            },\n\n            adjust: function(affectedSheet, operation, start, delta) {\n                var prevFrom, prevTo, modified;\n                var formulaRow = this.row;\n                var formulaCol = this.col;\n                if (this.from) {\n                    prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n                }\n                if (this.to) {\n                    prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n                }\n                if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                    switch (operation) {\n                      case \"row\":\n                        if (formulaRow >= start) {\n                            modified = true;\n                            this.row += delta;\n                        }\n                        break;\n                      case \"col\":\n                        if (formulaCol >= start) {\n                            modified = true;\n                            this.col += delta;\n                        }\n                        break;\n                    }\n                }\n                if (modified || prevFrom || prevTo) {\n                    var v = new Validation(this);\n                    v.from = prevFrom;\n                    v.to = prevTo;\n                    v.row = formulaRow;\n                    v.col = formulaCol;\n                    return v;\n                }\n            },\n\n            toJSON: function() {\n                var options = this._getOptions();\n\n                if (options.from) {\n                    options.from = options.from.toString();\n\n                    if (options.dataType === \"list\") {\n                        options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, \"$1\");\n                        delete options.fromIsListValue;\n                    }\n\n                    if (options.dataType === \"date\") {\n                        if (this.fromIsDateValue) {\n                            options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                            delete options.fromIsDateValue;\n                        }\n                    }\n                }\n\n                if (options.to) {\n                    options.to = options.to.toString();\n\n                    if (options.dataType === \"date\") {\n                        if (this.toIsDateValue) {\n                            options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, \"$1\");\n                            delete options.toIsDateValue;\n                        }\n                    }\n                }\n\n                return options;\n            },\n\n            _getOptions: function () {\n                return {\n                    from: this.from,\n                    to: this.to,\n                    dataType: this.dataType,\n                    type: this.type,\n                    comparerType: this.comparerType,\n                    row: this.row,\n                    col: this.col,\n                    sheet: this.sheet,\n                    allowNulls: this.allowNulls,\n                    fromIsListValue: this.fromIsListValue,\n                    fromIsDateValue: this.fromIsDateValue,\n                    toIsDateValue: this.toIsDateValue,\n                    tooltipMessageTemplate: this.tooltipMessageTemplate,\n                    tooltipTitleTemplate: this.tooltipTitleTemplate,\n                    //TODO: export generated messages instead?\n                    messageTemplate: this.messageTemplate,\n                    titleTemplate: this.titleTemplate,\n                    showButton: this.showButton\n                };\n            }\n        });\n        exports$2.compile = compileValidation;\n        exports$2.validationComparers = {\n            greaterThan: function (valueToCompare, from) {\n                return valueToCompare > from;\n            },\n\n            lessThan: function (valueToCompare, from) {\n                return valueToCompare < from;\n            },\n\n            between: function (valueToCompare, from, to) {\n                return valueToCompare >= from && valueToCompare <= to;\n            },\n\n            equalTo: function (valueToCompare, from) {\n                return valueToCompare == from;\n            },\n\n            notEqualTo: function (valueToCompare, from) {\n                return valueToCompare != from;\n            },\n\n            greaterThanOrEqualTo: function (valueToCompare, from) {\n                return valueToCompare >= from;\n            },\n\n            lessThanOrEqualTo: function (valueToCompare, from) {\n                return valueToCompare <= from;\n            },\n\n            notBetween: function (valueToCompare, from, to) {\n                return valueToCompare < from || valueToCompare > to;\n            },\n\n            custom: function (valueToCompare, from) {\n                return from;\n            },\n\n            list: function (valueToCompare, data) {\n                return data.indexOf(valueToCompare) > -1;\n            }\n        };\n\n        exports$2.Validation = Validation;\n\n    (function(kendo) {\n\n\n\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n\n        // This is a “dynamic variable” (see Greenspun's 10th rule).  It's\n        // bound to an array via sheet._saveModifiedFormulas (which see)\n        // while the callback runs.  The goal is to enable external code\n        // to get a list of formulas or validations that have been\n        // adjusted as an effect of an insert/delete row/column operation,\n        // to be able to undo it.\n        //\n        // The reason why simply saving the state via sheet.getState() or\n        // range.getState() won't suffice is that an insert or delete\n        // operation can have far-reaching effects, like adjusting\n        // formulas from another sheet.\n        var MODIFIED_FORMULAS;\n\n        var Selection = kendo.Class.extend({\n            init: function(sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n\n            currentSelectionRange: function() {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n\n            currentOriginalNavigationRange: function() {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n\n            currentNavigationRange: function() {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n\n            nextNavigationRange: function() {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n\n                return this.currentNavigationRange();\n            },\n\n            previousNavigationRange: function() {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n\n                return this.currentNavigationRange();\n            },\n\n            activeCell: function(ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({ activeCell: true, selection: true });\n                }\n\n                return this._activeCell;\n            },\n\n            select: function(ref, expanded, changeActiveCell, view) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n\n                    this.originalSelection = ref;\n\n                    this.selection = expanded;\n\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                            // is requested, mark A1 as the actually active cell.\n                            // https://github.com/telerik/kendo/issues/7698\n                            this._sheet.forEachMergedCell(ref, function(merged){\n                                ref = merged.topLeft;\n                            });\n                            this.activeCell(ref);\n                        } else {\n                            ref = this.selection.lastRange();\n                            if (view && view._sheet === this._sheet && view.panes[0]) {\n                                // we should intersect this ref with the range that's currently on\n                                // screen, so that the view doesn't scroll (that is, keep the activeCell\n                                // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 —\n                                // XXX: fiddling with View internals here is probably bad practice, but\n                                // this whole thing is a mess already, so it can be forgiven. :-/\n                                var panes = view.panes;\n                                var i, pane, rows, cols, visible, newRef;\n\n                                for (i = 0; i < panes.length; i++) {\n                                    pane = panes[i];\n                                    if (!pane._currentView) {\n                                        continue;\n                                    }\n                                    rows = pane._currentView.rows.values;\n                                    cols = pane._currentView.columns.values;\n\n                                    visible = new RangeRef(\n                                        new CellRef(rows.start, cols.start),\n                                        new CellRef(rows.end, cols.end)\n                                    );\n\n                                    newRef = ref.intersect(visible);\n\n                                    if (newRef !== kendo.spreadsheet.NULLREF) {\n                                        break;\n                                    }\n                                }\n\n                                if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                                    ref = newRef;\n                                }\n                            }\n                            this.activeCell(ref.first());\n                        }\n\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n\n                return this.selection;\n            },\n\n            singleCellSelection: function() {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n\n        var Sheet = kendo.Observable.extend({\n            init: function() {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n\n\n            events: [\n                \"changing\",\n                \"commandRequest\",\n                \"afterInsertRow\",\n                \"afterDeleteRow\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"dataBinding\",\n                \"dataBound\",\n                \"progress\"\n            ],\n\n            _reinit: function(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap,\n                    verticalAlign: defaultCellStyle.verticalAlign,\n                    textAlign: defaultCellStyle.textAlign\n                };\n\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n\n                this._viewSelection = new Selection(this);\n\n                this._editSelection = new Selection(this);\n\n                this._formulaSelections = [];\n                this._drawings = [];\n            },\n\n            resize: function(newRows, newCols) {\n                newRows = Math.max(newRows, 1);\n                newCols = Math.max(newCols, 1);\n                var oldRows = this._rows._count;\n                var oldCols = this._columns._count;\n                if (newRows < oldRows) {\n                    this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n                }\n                if (newCols < oldCols) {\n                    this.range(0, newCols, oldRows, oldCols - newCols).clear();\n                }\n                this._rows._resize(newRows);\n                this._columns._resize(newCols);\n                this._grid._resize(newRows, newCols);\n                this._properties._resize(newRows, newCols);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                if (newRows > oldRows) {\n                    this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n                    this._filteredRows.value(oldRows, newRows - 1, false);\n                }\n                if (newCols > oldCols) {\n                    this.range(0, oldCols, newRows, newCols - oldCols).clear();\n                }\n                this.triggerChange({ layout: true });\n            },\n\n            _resizeAddRow: function(count) {\n                this.resize(this._rows._count + (count || 1), this._columns._count);\n            },\n\n            _resizeAddColumn: function(count) {\n                this.resize(this._rows._count, this._columns._count + (count || 1));\n            },\n\n            _resizeDeleteRow: function(count) {\n                this._resizeAddRow(-(count || 1));\n            },\n\n            _resizeDeleteColumn: function(count) {\n                this._resizeAddColumn(-(count || 1));\n            },\n\n            _resizeForJSON: function(rows) {\n                var rowCount = rows.length, colCount = 0;\n                for (var ri = 0; ri < rows.length; ++ri) {\n                    var row = rows[ri];\n                    if (row.index != null) {\n                        rowCount = Math.max(rowCount, row.index + 1);\n                    }\n                    if (row.cells) {\n                        colCount = Math.max(colCount, row.cells.length);\n                        for (var ci = 0; ci < row.cells.length; ++ci) {\n                            var cell = row.cells[ci];\n                            if (cell.index != null) {\n                                colCount = Math.max(colCount, cell.index + 1);\n                            }\n                        }\n                    }\n                }\n                this.resize(Math.max(rowCount, this._rows._count),\n                            Math.max(colCount, this._columns._count));\n            },\n\n            _selectionState: function() {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n\n            navigator: function() {\n                if(!this._navigator) {\n                     this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n\n            axisManager: function() {\n                if(!this._axisManager) {\n                     this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n\n                return this._axisManager;\n            },\n\n            _name: function(value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n\n                this._sheetName = value;\n\n                return this;\n            },\n\n            name: function() {\n                return this._name();\n            },\n\n            _property: function(accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n\n                    return this.triggerChange(reason);\n                }\n            },\n\n            _field: function(name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n\n                    return this.triggerChange(reason);\n                }\n            },\n\n            suspendChanges: function(value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n\n                this._suspendChanges = value;\n\n                return this;\n            },\n\n            triggerChange: function(reason) {\n                if (!this._suspendChanges) {\n                    this.trigger(\"change\", reason);\n                } else if (reason && reason.isValue) {\n                    this._valueChanged = true;\n                }\n                return this;\n            },\n\n            triggerSelect: function(range) {\n                this.trigger(\"select\", { range: range });\n            },\n\n            setDataSource: function(dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n\n            hideColumn: function(columnIndex) {\n                if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n\n            unhideColumn: function(columnIndex) {\n                if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n\n            isHiddenColumn: function(columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n\n            _copyRange: function(sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n\n            _saveModifiedFormulas: function(array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n\n            _restoreModifiedFormulas: function(array) {\n                var wb = this._workbook;\n                array.forEach(function(f){\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f); // f has row, col\n                        sheet._properties.set(\"formula\", index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f); // f has row, col\n                        sheet._properties.set(\"validation\", index, index, f);\n                    }\n                });\n            },\n\n            _adjustReferences: function(operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function(a, ref){\n                    ref = ref.adjust(null, null, null, null, operation == \"row\", start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function(sheet){\n                        sheet._forFormulas(function(formula){\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                // if formula.adjust returns non-null,\n                                // that means the formula was indeed\n                                // modified and the returned value is a\n                                // copy of the previous Formula, which we\n                                // can use for undoing the operation.\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n\n                        sheet._forValidations(function(validation){\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == \"row\", start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == \"row\", start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                // adjust column widths or row heights and hidden attribute\n                var axis = operation == \"col\" ? this._columns : this._rows;\n                axis.adjust(start, delta);\n\n                if (operation == \"row\") {\n                    if (delta < 0) {\n                        this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                    } else {\n                        this._filteredRows.copy(start, this._rows._count, start + delta);\n                        this._filteredRows.value(start, start + delta - 1, false);\n                    }\n                }\n\n                // adjust drawing anchor cells\n                this._drawings.forEach(function(drawing){\n                    if (drawing.topLeftCell) {\n                        drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                         operation == \"row\", start, delta);\n                    }\n                });\n            },\n\n            _forFormulas: function(callback) {\n                var props = this._properties;\n                var formulas = props.get(\"formula\").values();\n                var n = formulas.length;\n                formulas.forEach(function(f, i){\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n\n            _forValidations: function(callback) {\n                var props = this._properties;\n                props.get(\"validation\").values().forEach(function(v){\n                    callback.call(this, v.value);\n                }, this);\n            },\n\n            insertRow: function(rowIndex, skipDataSourceInsert) {\n                if (this.trigger(\"insertRow\", { index: rowIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    this._resizeAddRow();\n\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n\n                    if (rowIndex + 1 == rowCount) {\n                        // we just inserted after the last one, no need to shift data\n                        return;\n                    }\n\n                    var frozenRows = this.frozenRows();\n\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col),\n                            new CellRef(rowCount - 2, bottomRight.col)\n                        );\n\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n                    }\n\n                    this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n\n                if (!skipDataSourceInsert) {\n                    this.trigger(\"afterInsertRow\", { index: rowIndex });\n                }\n\n                return this;\n            },\n\n            isEnabledRow: function(rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n\n            deleteRow: function(rowIndex, skipDataSourceDelete) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n\n                if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row + 1, topLeft.col),\n                            new CellRef(Infinity, bottomRight.col)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n\n                    this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n                    this._resizeDeleteRow();\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n\n                if (!skipDataSourceDelete) {\n                    this.trigger(\"afterDeleteRow\", { index: rowIndex });\n                }\n\n                return this;\n            },\n\n            insertColumn: function(columnIndex) {\n                if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    this._resizeAddColumn();\n\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    if (columnIndex + 1 == columnCount) {\n                        // we just inserted after the last one, no need to shift data\n                        return;\n                    }\n\n                    var frozenColumns = this.frozenColumns();\n\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        if (ci == columnIndex) {\n                            break;\n                        }\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col - 1),\n                            new CellRef(bottomRight.row, bottomRight.col - 1)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n                    }\n\n                    this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n\n                return this;\n            },\n\n            isEnabledColumn: function(columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n\n            deleteColumn: function(columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n\n                if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n                    return;\n                }\n\n                this.batch(function() {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n\n                    var frozenColumns = this.frozenColumns();\n\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n\n                    var mergedCells = this._mergedCells.slice();\n\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                        new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n\n                        var nextRef = new RangeRef(\n                            new CellRef(topLeft.row, topLeft.col + 1),\n                            new CellRef(bottomRight.row, bottomRight.col + 1)\n                        );\n\n                        this._copyRange(nextRef, topLeft);\n                    }\n\n                    this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n                    this._resizeDeleteColumn();\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n\n                return this;\n            },\n\n            _filterRow: function(rowIndex) {\n                this._rows.hide(rowIndex);\n                this._filteredRows.value(rowIndex, rowIndex, true);\n                this.triggerChange({ layout: true });\n            },\n\n            hideRow: function(rowIndex) {\n                if (this.trigger(\"hideRow\", { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n\n            unhideRow: function(rowIndex) {\n                if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n\n            isHiddenRow: function(rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n\n            isFilteredRow: function(rowIndex) {\n                return this._filteredRows.value(rowIndex);\n            },\n\n            columnWidth: function(columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n\n            rowHeight: function(rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n\n            frozenRows: function(value) {\n                return this._field(\"_frozenRows\", value, { layout: true });\n            },\n\n            frozenColumns: function(value) {\n                return this._field(\"_frozenColumns\", value, { layout: true });\n            },\n\n            showGridLines: function(value) {\n                return this._field(\"_showGridLines\", value, { layout: true });\n            },\n\n            gridLinesColor: function(value) {\n                return this._field(\"_gridLinesColor\", value, { layout: true });\n            },\n\n            _ref: function(row, column, numRows, numColumns) {\n                var ref = null;\n\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n\n                if (typeof row === \"string\") {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n\n                return ref;\n            },\n\n            range: function(row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n\n            _getMergedCells: function(range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n\n                this.forEachMergedCell(range, function(ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function(cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n\n                return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n            },\n\n            forEachMergedCell: function(ref, callback) {\n                var selectAll = false;\n\n                if (typeof callback === \"undefined\") {\n                    callback = ref;\n                    selectAll = true;\n                }\n\n                this._mergedCells.forEach(function(merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n\n            forEachFilterHeader: function(ref, callback) {\n                var selectAll = false;\n\n                if (typeof callback === \"undefined\") {\n                    callback = ref;\n                    selectAll = true;\n                }\n\n                if (this._filter) {\n                    var refs = [];\n\n                    // get refs of all columns\n                    this._filter.ref.forEachColumn(function(columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n\n                    // filter out merged references\n                    this._mergedCells.forEach(function(merged) {\n                        refs = refs.map(function(ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n\n                            return ref;\n                        });\n                    });\n\n                    // use only unique refs\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n\n            forEach: function(ref, callback) {\n                var self = this;\n                function forEachRange(ref) {\n                    if (!(ref instanceof RangeRef)) {\n                        ref = ref.toRangeRef();\n                    }\n                    var topLeft = self._grid.normalize(ref.topLeft);\n                    var bottomRight = self._grid.normalize(ref.bottomRight);\n                    var ci, ri;\n\n                    function doIt(value) {\n                        callback(ri++, ci, value);\n                    }\n\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        ri = topLeft.row;\n                        var startCellIndex = self._grid.index(ri, ci);\n                        var endCellIndex = self._grid.index(bottomRight.row, ci);\n                        self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                    }\n                }\n\n                if (!(ref instanceof RangeRef)) {\n                    ref = self._ref(ref);\n                }\n\n                if (ref instanceof UnionRef) {\n                    // _ref() might still return a UnionRef, for instance, if\n                    // `ref` happens to be one.  Probably an oversight, but it\n                    // turns out to be useful.\n                    ref.forEach(forEachRange);\n                } else {\n                    forEachRange(ref);\n                }\n            },\n\n            startResizing: function(initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n\n            startAutoFill: function() {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n\n            updateAutoFill: function(dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n\n            autoFillRef: function() {\n                return this._autoFillDest;\n            },\n\n            autoFillPunch: function() {\n                return this._autoFillPunch;\n            },\n\n            autoFillInProgress: function() {\n                return this._autoFillInProgress;\n            },\n\n            resizingInProgress: function() {\n                return this._resizeInProgress;\n            },\n\n            draggingInProgress: function() {\n                return this._draggingInProgress;\n            },\n\n            completeResizing: function() {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger(\"commandRequest\", {\n                                command: \"ColumnWidthCommand\",\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger(\"commandRequest\", {\n                                command: \"RowHeightCommand\",\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger(\"change\", { resize: true });\n                    }\n                }\n            },\n\n            _visualRange: function(ref) {\n                var merged = this._mergedCells;\n                for (var i = merged.length; --i >= 0;) {\n                    if (merged[i].intersects(ref)) {\n                        return this.range(merged[i]);\n                    }\n                }\n                return this.range(ref);\n            },\n\n            _renderComment: function(ref) {\n                var comment = null;\n                if (ref) {\n                    var range = this._visualRange(ref);\n                    comment = range.comment();\n                    ref = range._ref.toRangeRef().topLeft;\n                }\n                if (comment) {\n                    if (!this._commentRef || !ref.eq(this._commentRef)) {\n                        this._commentRef = ref;\n                        this.trigger(\"change\", { comment: true });\n                    }\n                } else {\n                    if (this._commentRef) {\n                        this._commentRef = null;\n                        this.trigger(\"change\", { comment: true });\n                    }\n                }\n            },\n\n            resizeHandlePosition: function() {\n                return this._resizeHandlePosition;\n            },\n\n            resizeHintPosition: function(location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger(\"change\", { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n\n            removeResizeHandle: function() {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger(\"change\", { resize: true });\n                }\n            },\n\n            positionResizeHandle: function(ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger(\"change\", { resize: true });\n            },\n\n            startDragging: function(data) {\n                this._draggingInProgress = data;\n            },\n\n            completeDragging: function() {\n                var drag = this._draggingInProgress;\n                if (drag) {\n                    this._draggingInProgress = null;\n                    var drawing = drag.drawing;\n                    if (drawing.eq(drag.copy)) {\n                        return;\n                    }\n                    if (drawing.topLeftCell) {\n                        // adjust reference - in case the top-left corner\n                        // was moving, select the cell beneath it.\n                        var box = this.drawingBoundingBox(drawing);\n                        var row = this._rows.indexVisible(box.top);\n                        var col = this._columns.indexVisible(box.left);\n                        var ref = new CellRef(row, col);\n                        var refBox = this.refBoundingBox(ref);\n                        drawing.offsetX = box.left - refBox.left;\n                        drawing.offsetY = box.top - refBox.top;\n                        drawing.topLeftCell = ref;\n                        this.triggerChange({ dragging: true });\n                    }\n                    this.trigger(\"commandRequest\", {\n                        command: \"DrawingUpdateCommand\",\n                        options: {\n                            sheet    : this,\n                            drawing  : drawing,\n                            previous : drag.copy\n                        }\n                    });\n                }\n            },\n\n            startSelection: function(view) {\n                if (this.frozenRows() || this.frozenColumns()) {\n                    this._currentView = null;\n                } else if (view && view._sheet === this) {\n                    this._currentView = view;\n                }\n                this._selectionInProgress = true;\n            },\n\n            completeSelection: function() {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger(\"change\", { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n\n                    if (this._autoFillPunch) { // we just clear data here\n                        this.trigger(\"commandRequest\", {\n                            command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger(\"commandRequest\", {\n                                command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n\n                    this.select(dest);\n                }\n            },\n\n            selectionInProgress: function() {\n                return this._selectionInProgress;\n            },\n\n            select: function(ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n\n                var expandedRef;\n\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n\n                return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n            },\n\n            originalSelect: function() {\n                return this._selectionState().originalSelection;\n            },\n\n            currentSelectionRange: function() {\n                return this._selectionState().currentSelectionRange();\n            },\n\n            currentOriginalSelectionRange: function() {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n\n            currentNavigationRange: function() {\n                return this._selectionState().currentNavigationRange();\n            },\n\n            nextNavigationRange: function() {\n                return this._selectionState().nextNavigationRange();\n            },\n\n            previousNavigationRange: function() {\n                return this._selectionState().previousNavigationRange();\n            },\n\n            selectionRangeIndex: function() {\n                return this._selectionState().selectionRangeIndex;\n            },\n\n            activeCell: function(ref) {\n                return this._selectionState().activeCell(ref);\n            },\n\n            originalActiveCell: function() {\n                return this._selectionState().originalActiveCell;\n            },\n\n            singleCellSelection: function() {\n                return this._selectionState().singleCellSelection();\n            },\n\n            unionWithMerged: function(ref) {\n                var mergedCells = this._mergedCells;\n\n                return ref.map(function(ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n\n            trim: function(ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function(property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n\n            focus: function(ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n\n            activeCellSelection: function() {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n\n            selection: function() {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n\n            selectedHeaders: function() {\n                var selection = this.select();\n\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n\n                selection.forEach(function(ref) {\n                    var i;\n                    var rowState = \"partial\";\n                    var colState = \"partial\";\n                    ref = ref.toRangeRef();\n\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n                    if (colSelection) { //column selection\n                        allRows = true;\n                        colState = \"full\";\n                    }\n\n                    if (rowSelection) { //row selection\n                        allCols = true;\n                        rowState = \"full\";\n                    }\n\n                    if (!colSelection) { //column selection\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== \"full\") {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== \"full\") {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n\n            isInEditMode: function(isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n\n                this._inEdit = isInEdit;\n\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n\n            _setFormulaSelections: function(selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n\n            _viewActiveCell: function() {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n\n            toJSON: function() {\n                var positions = {};\n\n                var rows = this._rows.toJSON(\"height\", positions);\n                var columns = this._columns.toJSON(\"width\", {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function(key){\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n\n                this.forEach(kendo.spreadsheet.SHEETREF, function(row, col, cell) {\n                    clearDefaultStyle(cell);\n\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref    : kendo.spreadsheet.Ref.display(null, row, col),\n                            target : cell.link\n                        });\n                    }\n\n                    var position = positions[row];\n\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n\n                    row = rows[position];\n\n                    cell.index = col;\n\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n\n                    if (cell.formula) {\n                        // stringify Formula object.\n                        if (cell.formula.arrayFormulaRange) {\n                            cell.formula = {\n                                src: cell.formula.toString(),\n                                ref: cell.formula.arrayFormulaRange.toString()\n                            };\n                        } else {\n                            cell.formula = cell.formula.toString();\n                        }\n                    }\n\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n\n                    row.cells.push(cell);\n                });\n\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function(ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle,\n                    drawings: this._drawings.map(function(dr){\n                        return dr.toJSON();\n                    })\n                };\n\n                if (this._sort) {\n                   json.sort = {\n                       ref: this._sort.ref.toString(),\n                       columns: this._sort.columns.map(function(column) {\n                           return {\n                               index: column.index,\n                               ascending: column.ascending\n                           };\n                       })\n                   };\n                }\n\n                if (this._filter) {\n                   json.filter = {\n                       ref: this._filter.ref.toString(),\n                       columns: this._filter.columns.map(function(column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                       })\n                   };\n                }\n\n                return json;\n            },\n\n            fromJSON: function(json) {\n                this.batch(function() {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON(\"width\", json.columns);\n                    }\n\n                    if (json.rows !== undefined) {\n                        this._resizeForJSON(json.rows);\n                        this._rows.fromJSON(\"height\", json.rows);\n\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n\n                                    if (cell.formula) {\n                                        var isArray = typeof cell.formula != \"string\";\n                                        var src = isArray ? cell.formula.src : cell.formula;\n                                        var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                        if (isArray) {\n                                            formula.setArrayFormulaRange(\n                                                kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                        }\n                                        cell.formula = formula;\n                                    }\n\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n\n                    if (json.drawings) {\n                        this._drawings = json.drawings.map(Drawing.fromJSON);\n                    }\n\n                    if (json.selection) {\n                        this._viewSelection.selection =\n                            this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef.first();\n                    }\n\n\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function(ref) {\n                           this.range(ref).merge();\n                        }, this);\n                    }\n\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns  === undefined ? [] : json.filter.columns;\n\n                        if (!ref) {\n                            kendo.logToConsole(\"Dropping filter for sheet '\" + json.name + \"' due to missing ref\");\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function(column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n\n                            this._refreshFilter();\n                        }\n                    }\n\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n\n                    this._gridLinesColor = json.gridLinesColor;\n\n                    if (json.sort) {\n                        this._sortBy(this._ref(json.sort.ref), json.sort.columns.slice(0));\n                    }\n                });\n\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n\n            formula: function(ref) {\n                return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n            },\n\n            validation: function(ref) {\n                return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n            },\n\n            // NOTE: resetFormulas should be called first.  We don't do it in this\n            // function because it should be done from the Workbook object for all\n            // sheets.\n            resetFormulas: function() {\n                this._forFormulas(function(formula){\n                    formula.reset();\n                });\n            },\n\n            resetValidations: function() {\n                this._forValidations(function(validation){\n                    validation.reset();\n                });\n            },\n\n            recalc: function(context, callback) {\n                var formulas = this._properties.get(\"formula\").values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n\n            revalidate: function(context) {\n                var self = this;\n                this._forValidations(function(validation){\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref =  new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n                });\n            },\n\n            _value: function(row, col, value) {\n                var index = this._grid.index(row, col);\n\n                if (value !== undefined) {\n                    this._properties.set(\"value\", index, index, value);\n                } else {\n                    return this._properties.get(\"value\", index);\n                }\n            },\n\n            _validation: function(row, col) {\n                var index = this._grid.index(row, col);\n\n                return this._properties.get(\"validation\", index);\n            },\n\n            _compileValidation: function(row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    // do not alter an existing object.\n                    return validation.clone(this._name(), row, col);\n                }\n\n                if (validation.from != null) {\n                    validation.from = (validation.from + \"\").replace(/^=/, \"\");\n                }\n\n                if (validation.to != null) {\n                    validation.to = (validation.to + \"\").replace(/^=/, \"\");\n                }\n\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n\n            _compileFormula: function(row, col, f) {\n                f = f.replace(/^=/, \"\");\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        // Even if it's the same formula in multiple cells, we\n                        // need to have different Formula objects, hence cloning\n                        // it.  Don't worry, clone() is fast.\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n\n            _set: function(ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n\n                if (typeof value == \"number\") {\n                    // Apparently, Excel (and LibreOffice and Google\n                    // Sheets) will limit precision to 14 digits; type:\n                    // -4.2524999999999995 and you get -4.2525.  The\n                    // formula engine already does something similar for\n                    // intermediate formula results, but we must do it\n                    // here as well for original input values.\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n\n                if (value && name == \"formula\") {\n                    if (typeof value == \"string\") {\n                        // get Formula object.  we don't care about handling errors\n                        // here since it won't be called interactively.\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n                } else if (value && name == \"validation\") {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == \"formula\") {\n                            // removing a formula, must clear value.\n                            this._properties.set(\"value\", start, end, null);\n                        }\n                    }\n                }\n            },\n\n            _get: function(ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n\n                var index = this._grid.index(topLeft.row, topLeft.col);\n\n                return this._properties.get(name, index);\n            },\n\n            batch: function(callback, reason) {\n                var suspended = this.suspendChanges();\n\n                this.suspendChanges(true);\n                this._valueChanged = false;\n\n                callback.call(this);\n\n                if (!reason) {\n                    reason = { recalc: true };\n                }\n                if (this._valueChanged) {\n                    reason.isValue = true;\n                }\n\n                return this.suspendChanges(suspended).triggerChange(reason);\n            },\n\n            _sortBy: function(ref, columns) {\n                var indices = null;\n\n                columns.forEach(function(column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n                }, this);\n\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n\n                this._refreshFilter();\n\n                this.forEach(ref, function(row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), \"row\", start, diff);\n                        }\n                    }\n                }.bind(this));\n\n                this.triggerChange({ recalc: true });\n            },\n\n            _refreshFilter: function() {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n\n            _filterBy: function(ref, columns) {\n                this.batch(function() {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this.isFilteredRow(ri)) {\n                            this._filteredRows.value(ri, ri, false);\n                            this._rows.unhide(ri);\n                        }\n                    }\n\n                    columns.forEach(function(column) {\n                        // do not filter header row\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                        var cells = [];\n\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n\n                        this.forEach(columnRef, function(row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n\n                        column.filter.prepare(cells);\n\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n\n                            if (column.filter.matches(value) === false) {\n                                this._filterRow(cell.row);\n                            }\n                        }\n                    }, this);\n\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, { recalc: true, layout: true, filter: true });\n            },\n\n            filterColumn: function(ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n\n            filter: function() {\n                return this._filter;\n            },\n\n            clearFilter: function(spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n\n            _clearFilter: function(indices) {\n                if (this._filter) {\n                    this.batch(function() {\n                        this._filter.columns = this._filter.columns.filter(function(column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n\n                        this._refreshFilter();\n                    }, { recalc: true, layout: true, filter: true });\n                }\n            },\n\n            getAxisState: function() {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n\n            setAxisState: function(state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n\n            getState: function() {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n                    properties: this._properties.getState()\n                };\n            },\n\n            setState: function(state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n\n            _merge: function(ref) {\n                var mergedCells = this._mergedCells;\n\n                var sheet = this;\n                var mergedRef;\n                this.batch(function() {\n                    mergedRef = ref.map(function(ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n\n                        var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get(\"formula\");\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n\n                        if (formula) {\n                            topLeft._set(\"formula\", formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n\n                    var viewSelection = sheet._viewSelection;\n\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, { activeCell: true, selection: true });\n\n                return mergedRef;\n            },\n\n            _useCultureDecimals: function() {\n                return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n\n            withCultureDecimals: function(f) {\n                var dot = \".\";\n                if (this._useCultureDecimals()) {\n                    dot = kendo.culture().numberFormat[\".\"];\n                }\n                return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            },\n\n            drawingBoundingBox: function(drawing) {\n                var left = drawing.offsetX;\n                var top = drawing.offsetY;\n                if (drawing.topLeftCell) {\n                    // offsets are relative to cell\n                    left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                    top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n                }\n                return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n            },\n\n            refBoundingBox: function(ref) {\n                return this._grid.rectangle(ref.toRangeRef());\n            },\n\n            addDrawing: function(drw, activate) {\n                if (!(drw instanceof Drawing)) {\n                    drw = new Drawing(drw);\n                }\n                this._drawings.push(drw);\n                if (activate) {\n                    this._activeDrawing = drw;\n                }\n                this.triggerChange({ layout: true });\n                return drw;\n            },\n\n            removeDrawing: function(drawing) {\n                var pos = this._drawings.indexOf(drawing);\n                if (pos >= 0) {\n                    this._drawings.splice(pos, 1);\n                    this.triggerChange({ layout: true });\n                }\n            },\n\n            usesImage: function(img) {\n                for (var i = this._drawings.length; --i >= 0;) {\n                    if (this._drawings[i].image === img) {\n                        return true;\n                    }\n                }\n                return false;\n            },\n\n            isMerged: function(ref) {\n                var merged = this._mergedCells;\n                for (var i = merged.length; --i >= 0;) {\n                    if (merged[i].eq(ref)) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        });\n\n        var Drawing = kendo.Class.extend({\n            init: function Drawing(args) {\n                this.reset(args);\n            },\n\n            toJSON: function() {\n                return {\n                    topLeftCell: this.topLeftCell.toString(),\n                    offsetX: this.offsetX,\n                    offsetY: this.offsetY,\n                    width: this.width,\n                    height: this.height,\n                    image: this.image,\n                    opacity: this.opacity\n                };\n            },\n\n            clone: function() {\n                return new Drawing(this);\n            },\n\n            reset: function(dr) {\n                var anchor = dr.topLeftCell;\n                if (typeof anchor == \"string\") {\n                    anchor = kendo.spreadsheet.calc.parseReference(anchor);\n                }\n                this.topLeftCell = anchor;\n                this.offsetX = dr.offsetX || 0;\n                this.offsetY = dr.offsetY || 0;\n                this.width = dr.width;\n                this.height = dr.height;\n                this.image = dr.image;\n                this.opacity = dr.opacity != null ? dr.opacity : 1;\n            },\n\n            eq: function(dr) {\n                return ((!this.topLeftCell && !dr.topLeftCell)\n                        || (this.topLeftCell && dr.topLeftCell\n                            && this.topLeftCell.eq(dr.topLeftCell)))\n                    && this.offsetX === dr.offsetX\n                    && this.offsetY === dr.offsetY\n                    && this.width === dr.width\n                    && this.height === dr.height\n                    && this.image === dr.image\n                    && this.opacity === dr.opacity;\n            }\n        });\n\n        Drawing.fromJSON = function(args) {\n            return new Drawing(args);\n        };\n\n        kendo.spreadsheet.Sheet = Sheet;\n        kendo.spreadsheet.Drawing = Drawing;\n    })(kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var outerWidth = kendo._outerWidth;\n            var DOT = \".\";\n            var EMPTYCHAR = \" \";\n            var sheetsBarClassNames = {\n                sheetsBarWrapper: \"k-widget k-header\",\n                sheetsBarSheetsWrapper: \"k-tabstrip k-floatwrap k-tabstrip-bottom\",\n                sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n                sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n                sheetsBarAdd: \"k-spreadsheet-sheets-bar-add\",\n                sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n                sheetsBarItems: \"k-spreadsheet-sheets-items\",\n                sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n                sheetsBarScrollable: \"k-tabstrip-scrollable\",\n                sheetsBarNext: \"k-tabstrip-next\",\n                sheetsBarPrev: \"k-tabstrip-prev\",\n                sheetsBarKItem: \"k-item k-tabstrip-item\",\n                sheetsBarKActive: \"k-active k-state-tab-on-top\",\n                sheetsBarKTextbox: \"k-textbox\",\n                sheetsBarKLink: \"k-link\",\n                sheetsBarKIcon: \"k-icon\",\n                sheetsBarKFontIcon: \"k-icon\",\n                sheetsBarKButton: \"k-button k-icon-button\",\n                sheetsBarKButtonDefaults: \"k-button-md k-rounded-md k-button-solid k-button-solid-base\",\n                sheetsBarKButtonBare: \"k-button-md k-rounded-md k-button-flat k-button-flat-base\",\n                sheetsBarKArrowW: \"k-i-arrow-60-left\",\n                sheetsBarKArrowE: \"k-i-arrow-60-right\",\n                sheetsBarKReset: \"k-reset k-tabstrip-items\",\n                sheetsBarKIconX: \"k-i-close\",\n                sheetsBarKSprite: \"k-sprite\",\n                sheetsBarKIconPlus: \"k-i-plus\",\n                sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n                sheetsBarKResetItems: \"k-reset k-tabstrip-items\"\n            };\n\n            var SheetsBar = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    var classNames = SheetsBar.classNames;\n\n                    kendo.ui.Widget.call(this, element, options);\n\n                    element = this.element;\n\n                    element.addClass(classNames.sheetsBarWrapper);\n\n                    this._openDialog = options.openDialog;\n\n                    this._tree = new kendo.dom.Tree(element[0]);\n\n                    this._tree.render([this._addButton(), this._createSheetsWrapper([])]);\n\n                    this._toggleScrollEvents(true);\n\n                    this._createSortable();\n\n                    this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                    this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                    element.on(\"click\", DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n\n                    element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                    element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n\n                    element.on(\"click\", DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n                },\n\n                options: {\n                    name: \"SheetsBar\",\n                    scrollable: {\n                        distance: 200\n                    }\n                },\n\n                events: [\n                    \"select\",\n                    \"reorder\",\n                    \"rename\"\n                ],\n\n                _createEditor: function () {\n                    if (this._editor) {\n                        return;\n                    }\n\n                    this._renderSheets(this._sheets, this._selectedIndex, true);\n                    this._editor = this.element\n                        .find(kendo.format(\"input{0}{1}\",DOT,SheetsBar.classNames.sheetsBarEditor))\n                        .trigger(\"focus\")\n                        .on(\"keydown\", this._onEditorKeydown.bind(this))\n                        .on(\"blur\", this._onEditorBlur.bind(this));\n                },\n\n                _destroyEditor: function(canceled) {\n                    var newSheetName = canceled ? null : this._editor.val();\n                    this._editor.off();\n                    this._editor = null;\n                    this._renderSheets(this._sheets, this._selectedIndex, false);\n                    this._onSheetRename(newSheetName);\n                },\n\n                renderSheets: function(sheets, selectedIndex) {\n                    if (!sheets || selectedIndex < 0) {\n                        return;\n                    }\n\n                    this._renderSheets(sheets, selectedIndex, false);\n                },\n\n                _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n\n                    that._isRtl = kendo.support.isRtl(that.element);\n                    that._sheets = sheets;\n                    that._selectedIndex = selectedIndex;\n\n                    that._renderHtml(isInEditMode, true);\n\n                    if (!that._scrollableAllowed()) {\n                        return;\n                    }\n\n                    var sheetsWrapper = that._sheetsWrapper();\n\n                    sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                    that._toggleScrollButtons();\n                },\n\n                _toggleScrollButtons: function (toggle) {\n                    var that = this;\n                    var ul = that._sheetsGroup();\n                    var wrapper = that._sheetsWrapper();\n                    var scrollLeft = kendo.scrollLeft(ul);\n                    var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                    var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                    if (toggle === false) {\n                        prev.addClass( 'k-disabled' );\n                        next.addClass( 'k-disabled' );\n                    } else {\n                        prev.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0) );\n                        next.toggleClass( 'k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1) );\n                    }\n\n                },\n\n                _toggleScrollEvents: function(toggle) {\n                    var that = this;\n                    var classNames = SheetsBar.classNames;\n                    var options = that.options;\n                    var scrollPrevButton;\n                    var scrollNextButton;\n                    var sheetsWrapper = that._sheetsWrapper();\n                    scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                    scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                    if (toggle) {\n                        scrollPrevButton.on(\"mousedown\", function (event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                        });\n\n                        scrollNextButton.on(\"mousedown\", function (event) {\n                            event.preventDefault();\n                            event.stopPropagation();\n                            that._nowScrollingSheets = true;\n                            that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                        });\n\n                        scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function () {\n                            that._nowScrollingSheets = false;\n                        });\n                    } else {\n                        scrollPrevButton.off();\n                        scrollNextButton.off();\n                    }\n                },\n\n                _renderHtml: function(isInEditMode, renderScrollButtons) {\n                    var idx;\n                    var sheetElements = [];\n                    var dom = kendo.dom;\n                    var element = dom.element;\n                    var sheets = this._sheets;\n                    var selectedIndex = this._selectedIndex;\n                    var classNames = SheetsBar.classNames;\n\n                    for (idx = 0; idx < sheets.length; idx++) {\n                        var sheet = sheets[idx];\n                        var isSelectedSheet = (idx === selectedIndex);\n                        var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                        var elementContent = [];\n\n                        if (isSelectedSheet) {\n                            attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                        } else {\n                            attr.className += classNames.sheetsBarInactive;\n                        }\n\n                        if (isSelectedSheet && isInEditMode) {\n                            elementContent.push(element(\"input\", {\n                                type: \"text\",\n                                value: sheet.name(),\n                                className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                                maxlength: 50\n                            }, []));\n                        } else {\n                            elementContent.push(element(\"span\", {\n                                className: classNames.sheetsBarKLink,\n                                title: sheet.name()\n                            }, [dom.text(sheet.name())]));\n\n                            if (sheets.length > 1) {\n                                var deleteIcon = element(\"span\", {\n                                    className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX\n                                }, []);\n\n                                elementContent.push(element(\"span\", {\n                                    className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove,\n                                    'data-type': 'remove'\n                                }, [deleteIcon]));\n                            }\n                        }\n\n                        sheetElements.push(element(\"li\", attr, elementContent));\n                    }\n\n                    this._tree.render([this._addButton(),  this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n                },\n\n                _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                    var element = kendo.dom.element;\n                    var classNames = SheetsBar.classNames;\n                    var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' } );\n                    var childrenElements = [null, element(\"ul\", {\n                        className: classNames.sheetsBarKReset\n                    }, sheetElements), null ];\n\n                    renderScrollButtons = true;\n\n                    if (renderScrollButtons) {\n                        var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                        childrenElements[0] = (element(\"span\", {className: baseButtonClass + classNames.sheetsBarPrev }, [\n                            element(\"span\", {className: \"k-button-icon\" + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW}, [])\n                        ]));\n\n                        childrenElements[2] = (element(\"span\", {className: baseButtonClass + classNames.sheetsBarNext }, [\n                            element(\"span\", {className: \"k-button-icon\" + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE}, [])\n                        ]));\n                    }\n\n                    itemsWrapper.children = childrenElements;\n\n                    return element(\"div\", { className: classNames.sheetsBarItems }, [ itemsWrapper ]);\n                },\n\n                _createSortable: function() {\n                    var classNames = SheetsBar.classNames;\n                    this._sortable = new kendo.ui.Sortable(this.element, {\n                        filter: kendo.format(\"ul li.{0},ul li.{1}\", classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                        container: DOT + classNames.sheetsBarItems,\n                        axis: \"x\",\n                        animation: false,\n                        ignore: \"input\",\n                        end: function () {\n                            if (this.draggable.hint) {\n                                this.draggable.hint.remove();\n                            }\n                        },\n                        hint: function (element) {\n                            var hint = $(element).clone();\n                            return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                        }\n                    });\n                },\n\n                _onEditorKeydown: function(e) {\n                    if (this._editor) {\n                        if (e.which === 13) {\n                            this._destroyEditor();\n                        }\n\n                        if (e.which === 27) {\n                            this._destroyEditor(true);\n                        }\n                    }\n                },\n\n                _onEditorBlur: function() {\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n                },\n\n                _onSheetReorderEnd: function(e) {\n                    e.preventDefault();\n                    this.trigger(\"reorder\", {oldIndex: e.oldIndex, newIndex: e.newIndex});\n                },\n\n                _onSheetReorderStart: function(e) {\n                    if (this._editor) {\n                        e.preventDefault();\n                    }\n                },\n\n                _onSheetRemove: function(e) {\n                    var removedSheetName = $(e.target).closest(\"li\").text();\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    var closeCallback = function(e) {\n                        var dlg = e.sender;\n\n                        if (dlg.isConfirmed()) {\n                            this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                        }\n                    }.bind(this);\n\n                    this._openDialog(\"confirmation\", {\n                        close: closeCallback\n                    });\n                },\n\n                _onSheetSelect: function(e) {\n                    var selectedSheetText = $(e.target).text();\n\n                    if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                        e.preventDefault();\n                        return;\n                    }\n\n                    if (this._editor) {\n                        this._destroyEditor();\n                    }\n\n                    this._scrollSheetsToItem($(e.target).closest(\"li\"));\n\n                    this.trigger(\"select\", {name: selectedSheetText, isAddButton: false});\n                },\n\n                _onSheetRename: function(newSheetName) {\n                    if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                        return;\n                    }\n\n                    this.trigger(\"rename\", {name: newSheetName, sheetIndex: this._selectedIndex });\n                },\n\n                _onAddSelect: function() {\n                    this.trigger(\"select\", {isAddButton: true});\n                },\n\n                _addButton: function() {\n                    var element = kendo.dom.element;\n                    var classNames = SheetsBar.classNames;\n                    return element(\"a\", {\n                        className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonDefaults\n                    }, [element(\"span\", {className: \"k-button-icon\" + EMPTYCHAR + classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus}, [])]);\n                },\n\n                destroy: function() {\n                    this._sortable.destroy();\n                },\n\n                _scrollableAllowed: function() {\n                    var options = this.options;\n                    return options.scrollable && !isNaN(options.scrollable.distance);\n                },\n\n                _scrollSheetsToItem: function (item) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                    var itemWidth = outerWidth(item);\n                    var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                    var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                    var itemPosition;\n\n                    if (that._isRtl) {\n                        if (itemOffset < 0) {\n                            itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                        } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                            itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                        }\n                    } else {\n                        if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                            itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                        } else if (currentScrollOffset > itemOffset) {\n                            itemPosition = itemOffset;\n                        }\n                    }\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function () {\n                        that._toggleScrollButtons();\n                    });\n                },\n\n                _sheetsGroup: function() {\n                    return this._sheetsWrapper().find(\"ul\");\n                },\n\n                _sheetsWrapper: function() {\n                    return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n                },\n\n                _scrollSheetsByDelta: function (delta) {\n                    var that = this;\n                    var sheetsGroup = that._sheetsGroup();\n                    var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                    sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function () {\n                        if (that._nowScrollingSheets) {\n                            that._scrollSheetsByDelta(delta);\n                        } else {\n                            that._toggleScrollButtons();\n                        }\n                    });\n                }\n            });\n\n            kendo.spreadsheet.SheetsBar = SheetsBar;\n            $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n        })(window.kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n        var util$2 = kendo.util;\n        var spreadsheet$5 = kendo.spreadsheet;\n        var Ref$2 = spreadsheet$5.Ref;\n        var RangeRef$2 = spreadsheet$5.RangeRef;\n        var CellRef$3 = spreadsheet$5.CellRef;\n        var NameRef$2 = spreadsheet$5.NameRef;\n        var exports$1 = spreadsheet$5.calc;\n        var runtime$4 = exports$1.runtime;\n\n        // Excel formula parser and compiler to JS.\n        // some code adapted from http://lisperator.net/pltut/\n\n        // these two will hold the same operators, except that when the comma is used as decimal\n        // separator, the union operator must be the semicolon (;) instead of comma.\n        var OPERATORS_STANDARD = Object.create(null);\n        var OPERATORS_COMMA = Object.create(null);\n\n        (function(ops){\n            ops.forEach(function(cls, i){\n                cls.forEach(function(op){\n                    OPERATORS_STANDARD[op] = ops.length - i;\n                    OPERATORS_COMMA[op == \",\" ? \";\" : op] = ops.length - i;\n                });\n            });\n        })([\n            [ \":\" ],\n            [ \" \" ],\n            [ \",\" ],\n            [ \"%\" ],\n            [ \"^\" ],\n            [ \"*\", \"/\" ],\n            [ \"+\", \"-\" ],\n            [ \"&\" ],\n            [ \"=\", \"<\", \">\", \"<=\", \">=\", \"<>\" ]\n        ]);\n\n        var OPERATORS = OPERATORS_STANDARD;\n\n        var SEPARATORS = {\n            DEC: \".\",\n            ARG: \",\",\n            COL: \",\"\n        };\n\n        function setDecimalSeparator(sep) {\n            SEPARATORS.DEC = sep;\n            SEPARATORS.ARG = sep == \",\" ? \";\" : \",\";\n            SEPARATORS.COL = sep == \",\" ? \"\\\\\" : \",\";\n            OPERATORS = sep == \",\" ? OPERATORS_COMMA : OPERATORS_STANDARD;\n        }\n\n        exports$1.withDecimalSeparator = function(sep, f) {\n            if (SEPARATORS.DEC == sep) {\n                return f();\n            }\n            var save = SEPARATORS.DEC;\n            setDecimalSeparator(sep);\n            try {\n                return f();\n            } finally {\n                setDecimalSeparator(save);\n            }\n        };\n\n        exports$1._separators = SEPARATORS;\n\n        var ParseError = kendo.Class.extend({\n            init: function ParseError(message, pos) {\n                this.message = message;\n                this.pos = pos;\n            },\n            toString: function() {\n                return this.message;\n            }\n        });\n\n        var TRUE = { type: \"bool\", value: true };\n        var FALSE = { type: \"bool\", value: false };\n\n        function getcol(str) {\n            str = str.toUpperCase();\n            for (var col = 0, i = 0; i < str.length; ++i) {\n                col = col * 26 + str.charCodeAt(i) - 64;\n            }\n            return col - 1;\n        }\n\n        function getrow(str) {\n            return parseInt(str, 10) - 1;\n        }\n\n        function parseReference$1(name, noThrow) {\n            if (name.toLowerCase() == \"#sheet\") {\n                return spreadsheet$5.SHEETREF;\n            }\n            OUT: {\n                // this is redundant, but let's keep it fast for the most\n                // common case — A1.  If this fails, we'll try to employ the\n                // whole tokenizer.\n                var m;\n                if ((m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name))) {\n                    var row = getrow(m[4]), col = getcol(m[2]);\n                    if (row < 0x100000 && col < 0x4000) {\n                        return new CellRef$3(getrow(m[4]), getcol(m[2]));\n                    }\n                    // no NameRef-s from this function\n                    break OUT;\n                }\n                var stream = TokenStream$1(name, {});\n                var a = [];\n                while (true) {\n                    var ref = stream.next();\n                    if (ref instanceof CellRef$3) {\n                        // this function always makes absolute references\n                        ref.rel = 0;\n                    } else if (ref instanceof RangeRef$2) {\n                        ref.topLeft.rel = 0;\n                        ref.bottomRight.rel = 0;\n                    } else {\n                        break OUT;\n                    }\n                    a.push(ref);\n                    if (stream.eof()) {\n                        break;\n                    }\n                    if (!stream.is(\"op\", SEPARATORS.ARG)) {\n                        break OUT;\n                    }\n                    stream.next();\n                }\n                return a.length == 1 ? a[0] : new spreadsheet$5.UnionRef(a);\n            }\n            if (!noThrow) {\n                throw new Error(\"Cannot parse reference: \" + name);\n            }\n        }\n\n        function parseFormula(sheet, row, col, input) {\n            var refs = [];\n            input = TokenStream$1(input, { row: row, col: col });\n            var is = input.is;\n\n            return {\n                type: \"exp\",\n                ast: parseExpression(true),\n                refs: refs,\n                sheet: sheet,\n                row: row,\n                col: col\n            };\n\n            function addReference(ref) {\n                ref.index = refs.length;\n                refs.push(ref);\n                return ref;\n            }\n\n            function skip(type, value, allowEOF) {\n                if (is(type, value)) {\n                    return input.next();\n                } else {\n                    var tok = input.peek();\n                    if (tok) {\n                        input.croak(\"Expected \" + type + \" «\" + value + \"» but found \" + tok.type + \" «\" + tok.value + \"»\");\n                    } else if (!allowEOF) {\n                        input.croak(\"Expected \" + type + \" «\" + value + \"»\");\n                    }\n                }\n            }\n\n            function parseExpression(commas) {\n                return maybeBinary(maybeIntersect(parseAtom()), 0, commas);\n            }\n\n            function parseSymbol(tok) {\n                if (tok.upper == \"TRUE\" || tok.upper == \"FALSE\") {\n                    return tok.upper == \"TRUE\" ? TRUE : FALSE;\n                }\n                return addReference(new NameRef$2(tok.value));\n            }\n\n            function parseFuncall() {\n                var fname = input.next();\n                fname = fname.value;\n                skip(\"punc\", \"(\");\n                var args = [];\n                while (1) {\n                    if (is(\"punc\", \")\")) {\n                        break;\n                    }\n                    if (is(\"op\", SEPARATORS.ARG)) {\n                        args.push({ type: \"null\" });\n                        input.next();\n                        continue;\n                    }\n                    args.push(parseExpression(false));\n                    if (input.eof() || is(\"punc\", \")\")) {\n                        break;\n                    }\n                    skip(\"op\", SEPARATORS.ARG);\n                }\n                skip(\"punc\", \")\", true);\n                return {\n                    type: \"func\",\n                    func: fname,\n                    args: args\n                };\n            }\n\n            function fixReference(ref) {\n                if (!ref.hasSheet()) {\n                    ref.setSheet(sheet);\n                }\n                return addReference(ref);\n            }\n\n            function parseAtom() {\n                var exp;\n                if (is(\"ref\")) {\n                    exp = fixReference(input.next());\n                }\n                else if (is(\"func\")) {\n                    exp = parseFuncall();\n                }\n                else if (is(\"punc\", \"(\")) {\n                    input.next();\n                    exp = parseExpression(true);\n                    skip(\"punc\", \")\", true);\n                }\n                else if (is(\"punc\", \"{\")) {\n                    input.next();\n                    exp = parseArray();\n                    skip(\"punc\", \"}\", true);\n                }\n                else if (is(\"num\") || is(\"str\") || is(\"error\")) {\n                    exp = input.next();\n                }\n                else if (is(\"sym\")) {\n                    exp = parseSymbol(input.next());\n                }\n                else if (is(\"op\", \"+\") || is(\"op\", \"-\")) {\n                    exp = {\n                        type: \"prefix\",\n                        op: input.next().value,\n                        exp: parseAtom()\n                    };\n                }\n                else if (!input.peek()) {\n                    input.croak(\"Incomplete expression\");\n                }\n                else if (is(\"punc\", \"[\")) {\n                    input.croak(\"External reference not supported\");\n                }\n                else {\n                    input.croak(\"Parse error\");\n                }\n                return maybePercent(exp);\n            }\n\n            function parseArray() {\n                var row = [], value = [ row ], first = true;\n                while (!input.eof() && !is(\"punc\", \"}\")) {\n                    if (first) {\n                        first = false;\n                    } else if (is(null, \";\")) {\n                        value.push(row = []);\n                        input.next();\n                    } else {\n                        skip(null, SEPARATORS.COL);\n                    }\n                    row.push(parseExpression(false));\n                }\n                return {\n                    type: \"matrix\",\n                    value: value\n                };\n            }\n\n            function maybeIntersect(exp) {\n                if (is(\"punc\", \"(\") || is(\"ref\") || is(\"num\") || is(\"func\")) {\n                    return {\n                        type: \"binary\",\n                        op: \" \",\n                        left: exp,\n                        right: parseExpression(false)\n                    };\n                } else {\n                    return exp;\n                }\n            }\n\n            function maybePercent(exp) {\n                if (is(\"op\", \"%\")) {\n                    input.next();\n                    return maybePercent({\n                        type: \"postfix\",\n                        op: \"%\",\n                        exp: exp\n                    });\n                } else {\n                    return exp;\n                }\n            }\n\n            function maybeBinary(left, my_prec, commas) {\n                var tok = is(\"op\");\n                if (tok && (commas || tok.value != SEPARATORS.ARG)) {\n                    var his_prec = OPERATORS[tok.value];\n                    if (his_prec > my_prec) {\n                        input.next();\n                        var right = maybeBinary(parseAtom(), his_prec, commas);\n                        return maybeBinary({\n                            type: \"binary\",\n                            op: tok.value == \";\" ? \",\" : tok.value, // translate union back to comma\n                            left: left,\n                            right: right\n                        }, my_prec, commas);\n                    }\n                }\n                return left;\n            }\n        }\n\n        function parseNameDefinition(name, def) {\n            var nameRef = parseFormula(null, 0, 0, name);\n            if (!(nameRef.ast instanceof NameRef$2)) {\n                throw new ParseError(\"Invalid name: \" + name);\n            }\n            nameRef = nameRef.ast;\n\n            if (!(def instanceof Ref$2)) {\n                var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n                if (defAST.ast instanceof Ref$2) {\n                    def = defAST.ast;   // single reference\n                } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                    def = defAST.ast.value; // constant\n                } else {\n                    def = makeFormula(defAST); // formula\n                }\n            }\n\n            return {\n                name: nameRef,\n                value: def\n            };\n        }\n\n        var makeClosure = (function(cache){\n            return function(code) {\n                var f = cache[code];\n                if (!f) {\n                    f = cache[code] = new Function(\"'use strict';return(\" + code + \")\")();\n                }\n                return f;\n            };\n        })(Object.create(null));\n\n        function makePrinter(exp) {\n            return makeClosure(\"function(row, col, mod){return(\" + print(exp.ast, exp, 0) + \")}\");\n            function print(node, parent, prec) {\n                switch (node.type) {\n                  case \"num\":\n                    return \"(kendo.spreadsheet.calc._separators.DEC == '.' ? \"\n                        +  JSON.stringify(JSON.stringify(node.value)) + \" : \"\n                        +  JSON.stringify(JSON.stringify(node.value))\n                        +  \".replace('.' , kendo.spreadsheet.calc._separators.DEC))\";\n                  case \"bool\":\n                    return JSON.stringify(node.value);\n                  case \"error\":\n                    return JSON.stringify(\"#\" + node.value);\n                  case \"str\":\n                    return JSON.stringify(JSON.stringify(node.value));\n                  case \"ref\":\n                    return \"this.refs[\" + node.index + \"].print(row, col, mod)\";\n                  case \"prefix\":\n                    return withParens(function(){\n                        return JSON.stringify(node.op) + \" + \" + print(node.exp, node, OPERATORS[node.op]);\n                    });\n                  case \"postfix\":\n                    return withParens(function(){\n                        return print(node.exp, node, OPERATORS[node.op]) + \" + \" + JSON.stringify(node.op);\n                    });\n                  case \"binary\":\n                    return withParens(function(){\n                        var left = parenthesize(\n                            print(node.left, node, OPERATORS[node.op]),\n                            node.left instanceof NameRef$2 && node.op == \":\"\n                        );\n                        var right = parenthesize(\n                            print(node.right, node, OPERATORS[node.op]),\n                            node.right instanceof NameRef$2 && node.op == \":\"\n                        );\n                        if (/^[,;]/.test(node.op)) {\n                            return left + \" + kendo.spreadsheet.calc._separators.ARG + \" + right;\n                        } else {\n                            return left + \" + \" + JSON.stringify(node.op) + \" + \" + right;\n                        }\n                    });\n                  case \"func\":\n                    return JSON.stringify(node.func + \"(\") + \" + \"\n                        + (node.args.length > 0\n                           ? node.args.map(function(arg){\n                               return print(arg, node, 0);\n                           }).join(\" + kendo.spreadsheet.calc._separators.ARG + ' ' + \")\n                           : \"''\")\n                        + \" + ')'\";\n                  case \"matrix\":\n                    return \"'{ ' + \" + node.value.map(function(el){\n                        return el.map(function(el){\n                            return print(el, node, 0);\n                        }).join(\" + kendo.spreadsheet.calc._separators.COL + ' ' + \");\n                    }).join(\" + '; ' + \") + \"+ ' }'\";\n                  case \"null\":\n                    return \"''\";\n                }\n                throw new Error(\"Cannot make printer for node \" + node.type);\n\n                function withParens(f) {\n                    var op = node.op;\n                    var needParens = (OPERATORS[op] < prec\n                                      || (!prec && op == \",\")\n                                      || (parent.type == \"prefix\" && prec == OPERATORS[op] && parent.op == \"-\")\n                                      || (parent.type == \"binary\" && prec == OPERATORS[op] && node === parent.right));\n                    return parenthesize(f(), needParens);\n                }\n            }\n            function parenthesize(code, cond) {\n                return cond ? \"'(' + \" + code + \" + ')'\" : code;\n            }\n        }\n\n        function toCPS(ast, k) {\n            var GENSYM = 0;\n            return cps(ast, k);\n\n            function cps(node, k){\n                switch (node.type) {\n                  case \"ref\"     : return cpsRef(node, k);\n                  case \"num\"     :\n                  case \"str\"     :\n                  case \"null\"    :\n                  case \"error\"   :\n                  case \"bool\"    : return cpsAtom(node, k);\n                  case \"prefix\"  :\n                  case \"postfix\" : return cpsUnary(node, k);\n                  case \"binary\"  : return cpsBinary(node, k);\n                  case \"func\"    : return cpsFunc(node, k);\n                  case \"lambda\"  : return cpsLambda(node, k);\n                  case \"matrix\"  : return cpsMatrix(node.value, k, true);\n                }\n                throw new Error(\"Cannot CPS \" + node.type);\n            }\n\n            function cpsRef(node, k) {\n                return node.ref == \"name\" ? cpsNameRef(node, k) : cpsAtom(node, k);\n            }\n\n            function cpsAtom(node, k) {\n                return k(node);\n            }\n\n            function cpsNameRef(node, k) {\n                return {\n                    type: \"func\",\n                    func: \",getname\",\n                    args: [ makeContinuation(k), node ]\n                };\n            }\n\n            function cpsUnary(node, k) {\n                return cps({\n                    type: \"func\",\n                    func: \"unary\" + node.op,\n                    args: [ node.exp ]\n                }, k);\n            }\n\n            function cpsBinary(node, k) {\n                return cps({\n                    type: \"func\",\n                    func: \"binary\" + node.op,\n                    args: [ node.left, node.right ]\n                }, k);\n            }\n\n            function cpsIf(co, th, el, k) {\n                return cps(co, function(co){\n                    // compile THEN and ELSE into a lambda which takes a callback to invoke with the\n                    // result of the branches, and the IF itself will become a call the internal \"if\"\n                    // function.\n                    var rest = makeContinuation(k);\n                    var thenK = gensym(\"T\");\n                    var elseK = gensym(\"E\");\n                    return {\n                        type: \"func\",\n                        func: \"if\",\n                        args: [\n                            rest,\n                            co, // condition\n                            { // then\n                                type: \"lambda\",\n                                vars: [ thenK ],\n                                body: cps(th || TRUE, function(th){\n                                    return {\n                                        type: \"call\",\n                                        func: { type: \"var\", name: thenK },\n                                        args: [ th ]\n                                    };\n                                })\n                            },\n                            { // else\n                                type: \"lambda\",\n                                vars: [ elseK ],\n                                body: cps(el || FALSE, function(el){\n                                    return {\n                                        type: \"call\",\n                                        func: { type: \"var\", name: elseK },\n                                        args: [ el ]\n                                    };\n                                })\n                            }\n                        ]\n                    };\n                });\n            }\n\n            function cpsAnd(args, k) {\n                if (args.length === 0) {\n                    return cpsAtom(TRUE, k);\n                }\n                return cps({\n                    type: \"func\",\n                    func: \"IF\",\n                    args: [\n                        // first item\n                        args[0],\n                        // if true, apply AND for the rest\n                        {\n                            type: \"func\",\n                            func: \"AND\",\n                            args: args.slice(1)\n                        },\n                        // otherwise return false\n                        FALSE\n                    ]\n                }, k);\n            }\n\n            function cpsOr(args, k) {\n                if (args.length === 0) {\n                    return cpsAtom(FALSE, k);\n                }\n                return cps({\n                    type: \"func\",\n                    func: \"IF\",\n                    args: [\n                        // first item\n                        args[0],\n                        // if true, return true\n                        TRUE,\n                        // otherwise apply OR for the rest\n                        {\n                            type: \"func\",\n                            func: \"OR\",\n                            args: args.slice(1)\n                        }\n                    ]\n                }, k);\n            }\n\n            function cpsFunc(node, k) {\n                switch (node.func.toLowerCase()) {\n                  case \"if\":\n                    return cpsIf(node.args[0], node.args[1], node.args[2], k);\n                  case \"and\":\n                    return cpsAnd(node.args, k);\n                  case \"or\":\n                    return cpsOr(node.args, k);\n                  case \"true\":\n                    return k(TRUE);\n                  case \"false\":\n                    return k(FALSE);\n                }\n                // actual function\n                return (function loop(args, i){\n                    if (i == node.args.length) {\n                        return {\n                            type : \"func\",\n                            func : node.func,\n                            args : args\n                        };\n                    }\n                    else {\n                        return cps(node.args[i], function(value){\n                            return loop(args.concat([ value ]), i + 1);\n                        });\n                    }\n                })([ makeContinuation(k) ], 0);\n            }\n\n            function cpsLambda(node, k) {\n                var cont = gensym(\"K\");\n                var body = cps(node.body, function(body){\n                    return { type: \"call\",\n                             func: { type: \"var\", value: cont },\n                             args: [ body ] };\n                });\n                return k({ type: \"lambda\",\n                           vars: [ cont ].concat(node.vars),\n                           body: body });\n            }\n\n            function cpsMatrix(elements, k, isMatrix) {\n                var a = [];\n                return (function loop(i){\n                    if (i == elements.length) {\n                        return k({\n                            type: \"matrix\",\n                            value: a\n                        });\n                    } else {\n                        return (isMatrix ? cpsMatrix : cps)(elements[i], function(val){\n                            a[i] = val;\n                            return loop(i + 1);\n                        });\n                    }\n                })(0);\n            }\n\n            function makeContinuation(k) {\n                var cont = gensym(\"R\");\n                return {\n                    type : \"lambda\",\n                    vars : [ cont ],\n                    body : k({ type: \"var\", name: cont })\n                };\n            }\n\n            function gensym(name) {\n                if (!name) {\n                    name = \"\";\n                }\n                name = \"_\" + name;\n                return name + (++GENSYM);\n            }\n        }\n\n        var FORMULA_CACHE = Object.create(null);\n\n        function makeFormula(exp) {\n            var printer = makePrinter(exp);\n            var hash = printer.call(exp); // needs .refs\n            var formula = FORMULA_CACHE[hash];\n            if (formula) {\n                // we need to clone because formulas cache the result; even if the formula is the same,\n                // its value will depend on its location, hence we need different objects.  Still, using\n                // this cache is a good idea because we'll reuse the same refs array, handler and\n                // printer instead of allocating new ones (and we skip compiling it).\n                return formula.clone(exp.sheet, exp.row, exp.col);\n            }\n            var code = js(toCPS(exp.ast, function(ret){\n                return {\n                    type: \"return\",\n                    value: ret\n                };\n            }));\n\n            code = [\n                \"function(){\",\n                \"var context = this, refs = context.formula.absrefs\",\n                code,\n                \"}\"\n            ].join(\";\\n\");\n\n            formula = new runtime$4.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n            FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n            return formula;\n\n            function js(node){\n                var type = node.type;\n                if (type == \"num\") {\n                    return node.value + \"\";\n                }\n                else if (type == \"str\") {\n                    return JSON.stringify(node.value);\n                }\n                else if (type == \"error\") {\n                    return \"context.error(\" + JSON.stringify(node.value) + \")\";\n                }\n                else if (type == \"return\") {\n                    return \"context.resolve(\" + js(node.value) + \")\";\n                }\n                else if (type == \"func\") {\n                    return \"context.func(\" + JSON.stringify(node.func) + \", \"\n                        + js(node.args[0]) + \", \" // the callback\n                        + jsArray(node.args.slice(1)) // the arguments\n                        + \")\";\n                }\n                else if (type == \"call\") {\n                    return js(node.func) + \"(\" + node.args.map(js).join(\", \") + \")\";\n                }\n                else if (type == \"ref\") {\n                    return \"refs[\" + node.index + \"]\";\n                }\n                else if (type == \"bool\") {\n                    return \"\" + node.value;\n                }\n                else if (type == \"if\") {\n                    return \"(context.bool(\" + js(node.co) + \") ? \" + js(node.th) + \" : \" + js(node.el) + \")\";\n                }\n                else if (type == \"lambda\") {\n                    return \"(function(\"\n                        + node.vars.join(\", \")\n                        + \"){ return(\" + js(node.body) + \") })\";\n                }\n                else if (type == \"var\") {\n                    return node.name;\n                }\n                else if (type == \"matrix\") {\n                    return jsArray(node.value);\n                }\n                else if (type == \"null\") {\n                    return \"null\";\n                }\n                else {\n                    throw new Error(\"Cannot compile expression \" + type);\n                }\n            }\n\n            function jsArray(a) {\n                return \"[ \" + a.map(js).join(\", \") + \" ]\";\n            }\n        }\n\n        function identity(x) {\n            return x;\n        }\n\n        function TokenStream$1(input, options) {\n            input = RawTokenStream(InputStream(input), options);\n            var ahead = input.ahead;\n            var skip = input.skip;\n            var token = null;\n            var fixCell = options.row != null && options.col != null\n                ? function(cell) {\n                    if (cell.rel & 1) {\n                        cell.col -= options.col;\n                    }\n                    if (cell.rel & 2) {\n                        cell.row -= options.row;\n                    }\n                    return cell;\n                }\n                : identity;\n\n            var addPos = options.forEditor\n                ? function(thing, startToken, endToken) {\n                    thing.begin = startToken.begin;\n                    thing.end = endToken.end;\n                    return thing;\n                }\n                : identity;\n\n            return {\n                peek  : peek,\n                next  : next,\n                croak : input.croak,\n                eof   : input.eof,\n                is    : is\n            };\n\n            function is(type, value) {\n                var tok = peek();\n                return tok != null\n                    && (type == null || tok.type === type)\n                    && (value == null || tok.value === value)\n                    ? tok : null;\n            }\n\n            function peek() {\n                if (token == null) {\n                    token = readNext();\n                }\n                return token;\n            }\n\n            function next() {\n                if (token != null) {\n                    var tmp = token;\n                    token = null;\n                    return tmp;\n                }\n                return readNext();\n            }\n\n            function readNext() {\n                var ret;\n                var t = input.peek();\n                if (t) {\n                    if (t.type == \"sym\" || t.type == \"rc\" || t.type == \"num\") {\n                        ret =  ahead(8, refRange3D)\n                            || ahead(6, refCell3D)\n                            || ahead(6, refSheetRange)\n                            || ahead(4, refSheetCell)\n                            || ahead(4, refRange)\n                            || ahead(2, refCell)\n                            || ahead(2, funcall);\n                    }\n                    if (!ret) {\n                        ret = input.next();\n                    }\n                }\n                return ret;\n            }\n\n            function toCell(tok, isFirst) {\n                if (tok.type == \"rc\") {\n                    // RC notation is read properly without knowing where\n                    // we are, so no need to fixCell on this one.\n                    // However, if only absolute refs were asked for (from\n                    // i.e. parseReference) I feel it's alright to yell\n                    // about it here.\n                    if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                        input.croak(\"Cannot read relative cell in RC notation\");\n                    }\n                    return new CellRef$3(tok.row, tok.col, tok.rel);\n                }\n                if (tok.type == \"num\") {\n                    if (tok.value <= 1048577) {\n                        // whole row\n                        return fixCell(new CellRef$3(\n                            getrow(tok.value),\n                            isFirst ? -Infinity : +Infinity,\n                            2\n                        ));\n                    } else {\n                        return null;\n                    }\n                }\n                // otherwise it's \"sym\".  The OOXML spec (SpreadsheetML\n                // 18.2.5) defines the maximum value to be interpreted as\n                // a cell reference to be XFD1048576.\n                var name = tok.value;\n                var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n                if (m) {\n                    var row = getrow(m[4]), col = getcol(m[2]);\n                    if (row <= 1048576 && col <= 16383) {\n                        return fixCell(new CellRef$3(\n                            getrow(m[4]),\n                            getcol(m[2]),\n                            (m[1] ? 0 : 1) | (m[3] ? 0 : 2)\n                        ));\n                    } else {\n                        return null;\n                    }\n                }\n                var abs = name.charAt(0) == \"$\";\n                if (abs) {\n                    name = name.substr(1);\n                }\n                if (/^\\d+$/.test(name)) {\n                    var row = getrow(name);\n                    if (row <= 1048576) {\n                        return fixCell(new CellRef$3(\n                            getrow(name),\n                            isFirst ? -Infinity : +Infinity,\n                            (abs ? 0 : 2)\n                        ));\n                    }\n                } else {\n                    var col = getcol(name);\n                    if (col <= 16383) {\n                        return fixCell(new CellRef$3(\n                            isFirst ? -Infinity : +Infinity,\n                            getcol(name),\n                            (abs ? 0 : 1)\n                        ));\n                    }\n                }\n            }\n\n            // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) :(f) C3(g) not followed by paren (h)\n            function refRange3D(a, b, c, d, e, f, g, h) {\n                if (a.type == \"sym\" &&\n                    b.type == \"op\" && b.value == \":\" &&\n                    c.type == \"sym\" &&\n                    d.type == \"punc\" && d.value == \"!\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    f.type == \"op\" && f.value == \":\" &&\n                    (g.type == \"sym\" || g.type == \"rc\" || (g.type == \"num\" && g.value == g.value|0)) &&\n                    g.type == e.type &&\n                    !(h.type == \"punc\" && h.value == \"(\" && !g.space))\n                {\n                    var tl = toCell(e, true), br = toCell(g, false);\n                    if (tl && br) {\n                        // skip them except the last one, we only wanted to\n                        // ensure it's not paren.\n                        skip(7);\n                        return addPos(new RangeRef$2(\n                            tl.setSheet(a.value, true),\n                            br.setSheet(c.value, true)\n                        ).setSheet(a.value, true), a, g);\n                    }\n                }\n            }\n\n            // Sheet1(a) :(b) Sheet2(c) !(d) A1(e) not followed by paren (f)\n            function refCell3D(a, b, c, d, e, f) {\n                if (a.type == \"sym\" &&\n                    b.type == \"op\" && b.value == \":\" &&\n                    c.type == \"sym\" &&\n                    d.type == \"punc\" && d.value == \"!\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n                {\n                    var tl = toCell(e);\n                    if (tl) {\n                        skip(5);\n                        var br = tl.clone();\n                        return addPos(new RangeRef$2(\n                            tl.setSheet(a.value, true),\n                            br.setSheet(c.value, true)\n                        ).setSheet(a.value, true), a, e);\n                    }\n                }\n            }\n\n            // Sheet1(a) !(b) A1(c) :(d) C3(e) not followed by paren (f)\n            function refSheetRange(a, b, c, d, e, f) {\n                if (a.type == \"sym\" &&\n                    b.type == \"punc\" && b.value == \"!\" &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    d.type == \"op\" && d.value == \":\" &&\n                    (e.type == \"sym\" || e.type == \"rc\" || (e.type == \"num\" && e.value == e.value|0)) &&\n                    !(f.type == \"punc\" && f.value == \"(\" && !e.space))\n                {\n                    var tl = toCell(c, true), br = toCell(e, false);\n                    if (tl && br) {\n                        skip(5);\n                        return addPos(new RangeRef$2(tl, br).setSheet(a.value, true), a, e);\n                    }\n                }\n            }\n\n            // Sheet1(a) !(b) A1(c) not followed by paren (d)\n            function refSheetCell(a, b, c, d) {\n                if (a.type == \"sym\" &&\n                    b.type == \"punc\" && b.value == \"!\" &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n                {\n                    skip(3);\n                    var x = toCell(c);\n                    if (!x || !isFinite(x.row)) {\n                        x = new NameRef$2(c.value);\n                    }\n                    return addPos(x.setSheet(a.value, true), a, c);\n                }\n            }\n\n            // A1(a) :(b) C3(c) not followed by paren (d)\n            function refRange(a, b, c, d) {\n                if ((a.type == \"sym\" || a.type == \"rc\" || (a.type == \"num\" && a.value == a.value|0)) &&\n                    (b.type == \"op\" && b.value == \":\") &&\n                    (c.type == \"sym\" || c.type == \"rc\" || (c.type == \"num\" && c.value == c.value|0)) &&\n                    !(d.type == \"punc\" && d.value == \"(\" && !c.space))\n                {\n                    var tl = toCell(a, true), br = toCell(c, false);\n                    if (tl && br) {\n                        skip(3);\n                        return addPos(new RangeRef$2(tl, br), a, c);\n                    }\n                }\n            }\n\n            // A1(a) not followed by paren (b)\n            function refCell(a, b) {\n                if ((a.type == \"sym\" || a.type == \"rc\") && !(b.type == \"punc\" && b.value == \"(\" && !a.space)) {\n                    var x = toCell(a);\n                    if (x && isFinite(x.row) && isFinite(x.col)) {\n                        skip(1);\n                        return addPos(x, a, a);\n                    }\n                }\n            }\n\n            function funcall(a, b) {\n                if (a.type == \"sym\" && b.type == \"punc\" && b.value == \"(\" && !a.space) {\n                    a.type = \"func\";\n                    skip(1);\n                    return a;       // already has position\n                }\n            }\n        }\n\n        function isWhitespace(ch) {\n            return \" \\t\\r\\n\\xa0\\u200b\".indexOf(ch) >= 0;\n        }\n\n        var EOF = { type: \"eof\" };\n\n        function RawTokenStream(input, options) {\n            var tokens = [], index = 0;\n            var readWhile = input.readWhile;\n\n            return {\n                next  : next,\n                peek  : peek,\n                eof   : eof,\n                croak : input.croak,\n                ahead : ahead,\n                skip  : skip\n            };\n\n            function isDigit(ch) {\n                return (/[0-9]/i.test(ch));\n            }\n\n            function isIdStart(ch) {\n                return (/[a-z$_]/i.test(ch) || util$2.isUnicodeLetter(ch));\n            }\n\n            function isId(ch) {\n                return isIdStart(ch) || isDigit(ch) || ch == \".\";\n            }\n\n            function isOpChar(ch) {\n                return ch in OPERATORS;\n            }\n\n            function isPunc(ch) {\n                return \"\\\\!;(){}[]\".indexOf(ch) >= 0;\n            }\n\n            function readNumber() {\n                // XXX: TODO: exponential notation\n                var has_dot = false;\n                var number = readWhile(function(ch){\n                    if (ch == SEPARATORS.DEC) {\n                        if (has_dot) {\n                            return false;\n                        }\n                        has_dot = true;\n                        return true;\n                    }\n                    return isDigit(ch);\n                });\n                if (number == SEPARATORS.DEC) {\n                    return { type: \"punc\", value: SEPARATORS.DEC };\n                } else {\n                    return { type: \"num\", value: parseFloat(number.replace(SEPARATORS.DEC, \".\")) };\n                }\n            }\n\n            function symbol(id, quote) {\n                return {\n                    type  : \"sym\",\n                    value : id,\n                    upper : id.toUpperCase(),\n                    space : isWhitespace(input.peek()),\n                    quote : quote\n                };\n            }\n\n            function getRC(a, b, c) {\n                if (!a && !b && !c) {\n                    return null;\n                }\n                if ((!a && !c) || (a && c)) {\n                    var num = b ? parseInt(b, 10) : 0;\n                    return a ? num : num - 1;\n                }\n            }\n\n            function readSymbol() {\n                var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n                if (m) {\n                    var row = getRC(m[1], m[2], m[3]);\n                    var col = getRC(m[4], m[5], m[6]);\n                    if (row != null && col != null) {\n                        input.skip(m);\n                        return {\n                            type: \"rc\",\n                            row: row,\n                            col: col,\n                            rel: ((m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) // col\n                                  |\n                                  (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0) // row\n                                 )\n                        };\n                    }\n                }\n                return symbol(readWhile(isId));\n            }\n\n            function readString() {\n                input.next();\n                return { type: \"str\", value: input.readEscaped('\"') };\n            }\n\n            function readSheetName() {\n                input.next();\n                return symbol(input.readEscaped(\"'\"), true);\n            }\n\n            function readOperator() {\n                return {\n                    type  : \"op\",\n                    value : readWhile(function(ch, op){\n                        return (op + ch) in OPERATORS;\n                    })\n                };\n            }\n\n            function readPunc() {\n                return {\n                    type  : \"punc\",\n                    value : input.next()\n                };\n            }\n\n            function readNext() {\n                if (input.eof()) {\n                    return null;\n                }\n                var ch = input.peek(), m;\n                if (ch == '\"') {\n                    return readString();\n                }\n                if (ch == \"'\") {\n                    return readSheetName();\n                }\n                if (isDigit(ch) || ch == SEPARATORS.DEC) {\n                    return readNumber();\n                }\n                if (isIdStart(ch)) {\n                    return readSymbol();\n                }\n                if (isOpChar(ch)) {\n                    return readOperator();\n                }\n                if (isPunc(ch)) {\n                    return readPunc();\n                }\n                if ((m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i))) {\n                    input.skip(m);\n                    return { type: \"error\", value: m[1] };\n                }\n                if (!options.forEditor) {\n                    input.croak(\"Can't handle character with code: \" + ch.charCodeAt(0));\n                }\n                return { type: \"error\", value: input.next() };\n            }\n\n            function peek() {\n                while (tokens.length <= index) {\n                    readWhile(isWhitespace);\n                    var begin = input.pos();\n                    var tok = readNext();\n                    if (options.forEditor && tok) {\n                        tok.begin = begin;\n                        tok.end = input.pos();\n                    }\n                    tokens.push(tok);\n                }\n                return tokens[index];\n            }\n\n            function next() {\n                var tok = peek();\n                if (tok) {\n                    index++;\n                }\n                return tok;\n            }\n\n            function ahead(n, f) {\n                var pos = index, a = [];\n                while (n-- > 0) {\n                    a.push(next() || EOF);\n                }\n                index = pos;\n                return f.apply(a, a);\n            }\n\n            function skip(n) {\n                index += n;\n            }\n\n            function eof() {\n                return peek() == null;\n            }\n        }\n\n        function InputStream(input) {\n            var pos = 0, line = 1, col = 0;\n            return {\n                next        : next,\n                peek        : peek,\n                eof         : eof,\n                croak       : croak,\n                readWhile   : readWhile,\n                readEscaped : readEscaped,\n                lookingAt   : lookingAt,\n                skip        : skip,\n                forward     : forward,\n                pos         : location\n            };\n            function location() {\n                return pos;\n            }\n            function next() {\n                var ch = input.charAt(pos++);\n                if (ch == \"\\n\") {\n                    line++;\n                    col = 0;\n                } else {\n                    col++;\n                }\n                return ch;\n            }\n            function peek() {\n                return input.charAt(pos);\n            }\n            function eof() {\n                return peek() === \"\";\n            }\n            function croak(msg) {\n                throw new ParseError(msg + \" (input: \" + input + \")\", pos);\n            }\n            function skip(ch) {\n                if (typeof ch == \"string\") {\n                    if (input.substr(pos, ch.length) != ch) {\n                        croak(\"Expected \" + ch);\n                    }\n                    forward(ch.length);\n                } else if (ch instanceof RegExp) {\n                    var m = ch.exec(input.substr(pos));\n                    if (m) {\n                        forward(m[0].length);\n                        return m;\n                    }\n                } else {\n                    // assuming RegExp match data\n                    forward(ch[0].length);\n                }\n            }\n            function forward(n) {\n                while (n-- > 0) {\n                    next();\n                }\n            }\n            function readEscaped(end) {\n                var escaped = false, str = \"\";\n                while (!eof()) {\n                    var ch = next();\n                    if (escaped) {\n                        str += ch;\n                        escaped = false;\n                    } else if (ch == \"\\\\\") {\n                        escaped = true;\n                    } else if (ch == end) {\n                        break;\n                    } else {\n                        str += ch;\n                    }\n                }\n                return str;\n            }\n            function readWhile(predicate) {\n                var str = \"\";\n                while (!eof() && predicate(peek(), str)) {\n                    str += next();\n                }\n                return str;\n            }\n            function lookingAt(rx) {\n                return rx.exec(input.substr(pos));\n            }\n        }\n\n        //// exports\n\n        var FORMAT_PARSERS = [];\n\n        var registerFormatParser = exports$1.registerFormatParser = function(p) {\n            FORMAT_PARSERS.push(p);\n        };\n\n        exports$1.parse = function(sheet, row, col, input, format) {\n            if (input instanceof Date) {\n                return { type: \"date\", value: runtime$4.dateToSerial(input) };\n            }\n            if (typeof input == \"number\") {\n                return { type: \"number\", value: input };\n            }\n            if (typeof input == \"boolean\") {\n                return { type: \"boolean\", value: input };\n            }\n            input += \"\";\n            if (/^'/.test(input)) {\n                return {\n                    type: \"string\",\n                    value: input.substr(1)\n                };\n            }\n            // trivial (integer) percent values; more complex formats are handled below via\n            // registerFormatParser; this case could be dropped completely.\n            if (/^-?[0-9]+%$/.test(input)) {\n                var str = input.substr(0, input.length - 1);\n                var num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    return {\n                        type: \"percent\",\n                        value: num / 100\n                    };\n                }\n            }\n            if (/^=/.test(input)) {\n                input = input.substr(1);\n                if (/\\S/.test(input)) {\n                    return parseFormula(sheet, row, col, input);\n                } else {\n                    return {\n                        type: \"string\",\n                        value: \"=\" + input\n                    };\n                }\n            }\n            for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n                var result = FORMAT_PARSERS[i](input, format);\n                if (result) {\n                    return result;\n                }\n            }\n            if (input.toLowerCase() == \"true\") {\n                return { type: \"boolean\", value: true };\n            }\n            if (input.toLowerCase() == \"false\") {\n                return { type: \"boolean\", value: false };\n            }\n            var date = runtime$4.parseDate(input, format);\n            if (date) {\n                return { type: \"date\", value: runtime$4.dateToSerial(date) };\n            }\n            var num = parseFloat(input);\n            if (!isNaN(num) && input.length > 0 && num == input) {\n                format = null;\n                if (num != Math.floor(num)) {\n                    format = \"0.\" + String(num).split(\".\")[1].replace(/\\d/g, \"0\");\n                }\n                return {\n                    type: \"number\",\n                    value: num,\n                    format: format\n                };\n            }\n            return {\n                type: \"string\",\n                value: input\n            };\n        };\n\n        function tokenize(input, row, col) {\n            var tokens = [];\n            input = TokenStream$1(input, { forEditor: true, row: row, col: col });\n            while (!input.eof()) {\n                tokens.push(next());\n            }\n            var tok = tokens[0];\n            if (tok.type == \"op\" && tok.value == \"=\") {\n                tok.type = \"startexp\";\n            }\n            return tokens;\n\n            function next() {\n                var tok = input.next();\n                if (tok.type == \"sym\") {\n                    if (tok.upper == \"TRUE\") {\n                        tok.type = \"bool\";\n                        tok.value = true;\n                    } else if (tok.upper == \"FALSE\") {\n                        tok.type = \"bool\";\n                        tok.value = false;\n                    }\n                } else if (tok.type == \"ref\") {\n                    tok = {\n                        type  : \"ref\",\n                        ref   : (row != null && col != null ? tok.absolute(row, col) : tok),\n                        begin : tok.begin,\n                        end   : tok.end\n                    };\n                }\n                return tok;\n            }\n        }\n\n        // The `sqref` attribute in dataValidation (XLSX) will contain a space-separated list of\n        // references.  This helper is called from excel-reader.js to parse them.\n        function parseSqref(input, row, col) {\n            row = row || 0;\n            col = col || 0;\n            input = TokenStream$1(input, { row: row, col: col });\n            var refs = [];\n            while (!input.eof()) {\n                var ref = input.next();\n                if (ref.type != \"ref\") {\n                    throw new ParseError(\"Expecting a reference but got: \" + JSON.stringify(ref));\n                }\n                refs.push(ref.absolute(row, col));\n            }\n            return refs;\n        }\n\n        exports$1.parseNameDefinition = parseNameDefinition;\n        exports$1.parseFormula = parseFormula;\n        exports$1.parseReference = parseReference$1;\n        exports$1.compile = makeFormula;\n        exports$1.parseSqref = parseSqref;\n\n        exports$1.InputStream = InputStream;\n        exports$1.ParseError = ParseError;\n        exports$1.tokenize = tokenize;\n\n        /* -----[ a few special formats ]----- */\n\n        // various time formats\n        registerFormatParser(function(input, existingFormat){\n            var m, date = 0, format = \"\";\n            // have date part?\n            if (!existingFormat) {\n                existingFormat = kendo.culture().calendar.patterns.d;\n            }\n            if ((m = /^(\\d+)([-/.])(\\d+)\\2(\\d{2}(?:\\d{2})?)(\\s*)/.exec(input))) {\n                var mo = parseInt(m[1], 10);\n                var sep = m[2];\n                var da = parseInt(m[3], 10);\n                var yr = parseInt(m[4], 10);\n                if (yr < 30) {\n                    yr += 2000;\n                } else if (yr < 100) {\n                    yr += 1900;\n                }\n                var monthFirst = existingFormat ? existingFormat.indexOf(\"M\") < existingFormat.indexOf(\"d\") : true;\n                if (mo > 12 || !monthFirst) {\n                    var tmp = mo;\n                    mo = da;\n                    da = tmp;\n                    monthFirst = false;\n                }\n                if (!runtime$4.validDate(yr, mo, da)) {\n                    return null;\n                }\n                date = runtime$4.packDate(yr, mo - 1, da);\n                if (date < 0) { date--; }\n                if (monthFirst) {\n                    format = [\"mm\", \"dd\", \"yyyy\"].join(sep);\n                } else {\n                    format = [\"dd\", \"mm\", \"yyyy\"].join(sep);\n                }\n                format += m[5];\n                input = input.substr(m[0].length); // skip the date\n            }\n            // hh:mm\n            if ((m = /^(\\d+):(\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm\",\n                    value  : date + runtime$4.packTime(hh, mm, 0, 0)\n                };\n            }\n            // mm:ss.ms\n            if ((m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n                var mm = parseInt(m[1], 10);\n                var ss = parseInt(m[2], 10);\n                var ms = parseFloat(m[3]) * 1000;\n                return {\n                    type   : \"date\",\n                    format : format + \"mm:ss.00\",\n                    value  : date + runtime$4.packTime(0, mm, ss, ms)\n                };\n            }\n            // hh:mm:ss\n            if ((m = /^(\\d+):(\\d+):(\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                var ss = parseInt(m[3], 10);\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm:ss\",\n                    value  : date + runtime$4.packTime(hh, mm, ss, 0)\n                };\n            }\n            // hh:mm:ss.ms\n            if ((m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input))) {\n                var hh = parseInt(m[1], 10);\n                var mm = parseInt(m[2], 10);\n                var ss = parseInt(m[3], 10);\n                var ms = parseFloat(m[4]) * 1000;\n                return {\n                    type   : \"date\",\n                    format : format + \"hh:mm:ss.00\",\n                    value  : date + runtime$4.packTime(hh, mm, ss, ms)\n                };\n            }\n        });\n\n        // Support numeric formats with thousands separator and/or currency symbol, like `1,234,567.00`,\n        // `$1234`, `123,456.78 $` etc.  I apologize for this code.\n        registerFormatParser(function(input){\n            var m, n;\n            var culture = kendo.culture();\n            var comma = culture.numberFormat[\",\"];\n            var dot = culture.numberFormat[\".\"];\n            var currency = culture.numberFormat.currency.symbol;\n            var rxnum = getNumberRegexp(comma, dot);\n            var rxcur = new RegExp(\"^\\\\s*\\\\\" + currency + \"\\\\s*\");\n            var sign = 1;\n            var format = \"\";\n            var suffix = \"\";\n            var has_currency = false;\n            var has_percent = false;\n\n            input = InputStream(input.replace(/^\\s+|\\s+$/g, \"\"));\n\n            // has minus before currency?\n            if (input.skip(/^-\\s*/)) {\n                sign = -1;\n            }\n\n            // has currency before number?\n            if ((m = input.skip(rxcur))) {\n                has_currency = true;\n                format += '\"' + m[0] + '\"';\n            }\n\n            // has minus after currency?\n            if (input.skip(/^-\\s*/)) {\n                if (sign < 0) {\n                    return null;    // not a number\n                }\n                sign = -1;\n            }\n\n            // read the number itself\n            if (!(n = input.skip(rxnum))) {\n                return null;        // not a number\n            }\n            format += \"0\";\n\n            // has currency after number?\n            if ((m = input.skip(rxcur))) {\n                if (has_currency) {\n                    return null;    // either before or after, not both.\n                }\n                has_currency = true;\n                suffix = '\"' + m[0] + '\"';\n            }\n\n            // has percent after number?\n            if (!has_currency && (m = input.skip(/^\\s*%\\s*/))) {\n                has_percent = true;\n                suffix = m[0];      // no quotes this time, % is special in format\n            }\n\n            if (!input.eof()) {\n                return null;        // should anything else follow, not a number\n            }\n\n            if (n[2] || has_currency) {\n                format = format.replace(\"0\", \"#\");\n                format += \",0\";\n            }\n            if (n[3]) {\n                format += \".\" + repeat(\"0\", n[3].length - 1);\n            }\n            var value = n[0]\n                .replace(new RegExp(\"\\\\\" + comma, \"g\"), \"\")\n                .replace(new RegExp(\"\\\\\" + dot, \"g\"), \".\");\n\n            value = parseFloat(value);\n            if (has_percent) {\n                value /= 100;\n            }\n\n            format += suffix;\n            if (has_currency) {\n                format += ';-' + format;\n            }\n\n            return {\n                type: \"number\",\n                currency: has_currency,\n                format: format,\n                value: sign * value\n            };\n        });\n\n        registerFormatParser(function(input){\n            var m;\n            if ((m = /^([0-9]*)\\.([0-9]+)(\\s*%)$/.exec(input))) {\n                return {\n                    type: \"number\",\n                    value: parseFloat(input) / 100,\n                    format: \"0.\" + repeat(\"0\", m[2].length) + m[3]\n                };\n            }\n        });\n\n        var NUMBER_FORMAT_RX = {};\n        function getNumberRegexp(comma, dot) {\n            var id = comma + dot;\n            var rx = NUMBER_FORMAT_RX[id];\n            if (!rx) {\n                rx = \"^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)\";\n                rx = rx.replace(/DOT/g, \"\\\\\" + dot).replace(/COM/g, \"\\\\\" + comma);\n                rx = new RegExp(rx);\n                NUMBER_FORMAT_RX[id] = rx;\n            }\n            return rx;\n        }\n\n        function repeat(str, len) {\n            var out = \"\";\n            while (len-- > 0) {\n                out += str;\n            }\n            return out;\n        }\n\n    \"use strict\";\n\n        /* global JSZip */\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var $$1 = kendo.jQuery;\n        var parseXML = kendo.util.parseXML;\n        var parseReference = kendo.spreadsheet.calc.parseReference;\n\n        var MAP_EXCEL_OPERATOR = {\n            // includes only what differs; key is Excel's operator, value\n            // is our operator.\n            greaterThanOrEqual : \"greaterThanOrEqualTo\",\n            lessThanOrEqual    : \"lessThanOrEqualTo\"\n        };\n\n        var ERROR_LOG = null;\n\n        function readExcel(file, workbook, deferred) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                var zip = new JSZip(e.target.result);\n                readWorkbook(zip, workbook, deferred);\n            };\n\n            reader.readAsArrayBuffer(file);\n        }\n\n        var SEL_CELL = [\"sheetData\", \"row\", \"c\"];\n        var SEL_COL = [\"cols\", \"col\"];\n        var SEL_DEFINED_NAME = [\"definedNames\", \"definedName\"];\n        var SEL_FORMULA = [\"sheetData\", \"row\", \"c\", \"f\"];\n        var SEL_MERGE = [\"mergeCells\", \"mergeCell\"];\n        var SEL_PANE = [\"sheetViews\", \"sheetView\", \"pane\"];\n        var SEL_ROW = [\"sheetData\", \"row\"];\n        var SEL_SELECTION = [\"sheetViews\", \"sheetView\", \"selection\"];\n        var SEL_SHEET = [\"sheets\", \"sheet\"];\n        var SEL_STRING = [\"sheetData\", \"row\", \"c\", \"is\"];\n        var SEL_TEXT = [\"t\"];\n        var SEL_SHARED_STRING = [\"si\"];\n        var SEL_VALUE = [\"sheetData\", \"row\", \"c\", \"v\"];\n        var SEL_VIEW = [\"bookViews\", \"workbookView\"];\n        var SEL_SHEET_VIEW = [\"sheetViews\", \"sheetView\"];\n        var SEL_HYPERLINK = [\"hyperlinks\", \"hyperlink\"];\n\n        /* A validation section looks like this:\n         *\n         * <dataValidations count=\"1\">\n         *   <dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\" sqref=\"B2\">\n         *     <formula1>$E$2:$E$5</formula1>\n         *   </dataValidation>\n         * </dataValidations>\n         */\n        var SEL_VALIDATION = [\"dataValidations\", \"dataValidation\"];\n        var SEL_VALIDATION_FORMULA1 = [\"dataValidations\", \"dataValidation\", \"formula1\"];\n        var SEL_VALIDATION_FORMULA2 = [\"dataValidations\", \"dataValidation\", \"formula2\"];\n\n        /* However, when a validation formula in one sheet references\n         * cells from another sheet, Excel produces this version instead:\n         *\n         * <extLst>\n         *   <ext xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" uri=\"{CCE6A557-97BC-4b89-ADB6-D9C93CAAB3DF}\">\n         *     <x14:dataValidations xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\" count=\"1\">\n         *       <x14:dataValidation type=\"list\" allowBlank=\"1\" showInputMessage=\"1\" showErrorMessage=\"1\">\n         *         <x14:formula1>\n         *           <xm:f>Sheet2!$B$3:$B$6</xm:f>\n         *         </x14:formula1>\n         *         <xm:sqref>B1</xm:sqref>\n         *       </x14:dataValidation>\n         *     </x14:dataValidations>\n         *   </ext>\n         * </extLst>\n         *\n         * I call it the \"insane version\", because that's what it is.\n         * Barring the case that the engineers who produced this horror\n         * were on LSD, the only plausible reason for it is that Microsoft\n         * does not want third party software to be compatible with Excel\n         * (sentiment I've had over and over while working on the\n         * Spreadsheet widget).\n         */\n        // XXX: technically, the aliases `x14` and `xm` below could be\n        // different, but Excel seems to be hard-coded on these; our\n        // parser does not support proper namespaces for now anyway, so\n        // hard-coded they are.\n        var SEL_VALIDATION_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\"];\n        var SEL_VALIDATION_SQREF_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"xm:sqref\"];\n        var SEL_VALIDATION_FORMULA1_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula1\", \"xm:f\"];\n        var SEL_VALIDATION_FORMULA2_INSANE = [\"x14:dataValidations\", \"x14:dataValidation\", \"x14:formula2\", \"xm:f\"];\n\n        // comment selectors (in files like comments1.xml)\n        var SEL_COMMENT = [\"commentList\", \"comment\"];\n        var SEL_AUTHOR = [\"authors\", \"author\"];\n        var SEL_COMMENT_TEXT = [\"t\"];\n\n        function xl(file) {\n            if (!/^\\//.test(file)) {\n                if (!/^xl\\//.test(file)) {\n                    file = \"xl/\" + file;\n                }\n            } else {\n                file = file.substr(1);\n            }\n            return file;\n        }\n\n        function readWorkbook(zip, workbook, progress) {\n            ERROR_LOG = workbook.excelImportErrors = [];\n\n            var strings = readStrings(zip);\n            var relationships = readRelationships(zip, \"_rels/workbook.xml\");\n            var theme = readTheme(zip, relationships.byType.theme[0]);\n            var styles = readStyles(zip, theme);\n            var items = [];\n            var activeSheet = 0;\n\n            parse$1(zip, \"xl/workbook.xml\", {\n                enter: function(tag, attrs) {\n                    if (this.is(SEL_SHEET)) {\n                        var relId = attrs[\"r:id\"];\n                        var file = relationships.byId[relId];\n                        var name = attrs.name;\n                        var dim = sheetDimensions(zip, file);\n\n                        workbook.options.columnWidth = dim.columnWidth || workbook.options.columnWidth;\n                        workbook.options.rowHeight = dim.rowHeight || workbook.options.rowHeight;\n\n                        items.push({\n                            workbook: workbook,\n                            zip: zip,\n                            strings: strings,\n                            styles: styles,\n                            file: file,\n                            options: {\n                                name: name,\n                                rows: Math.max(workbook.options.rows || 0, dim.rows),\n                                columns: Math.max(workbook.options.columns || 0, dim.cols),\n                                columnWidth: dim.columnWidth,\n                                rowHeight: dim.rowHeight\n                            }\n                        });\n                    } else if (this.is(SEL_VIEW)) {\n                        if (attrs.activeTab) {\n                            activeSheet = integer(attrs.activeTab);\n                        }\n                    }\n                },\n                text: function(text) {\n                    var attrs = this.is(SEL_DEFINED_NAME);\n                    if (attrs && !(bool(attrs[\"function\"]) || bool(attrs.vbProcedure))) {\n                        var localSheetId = attrs.localSheetId;\n                        var sheet = null;\n                        if (localSheetId != null) {\n                            sheet = items[localSheetId].options.name;\n                        }\n                        var name = attrs.name;\n                        if (name != \"_xlnm._FilterDatabase\") {\n                            if (sheet) {\n                                name = \"'\" + sheet.replace(/\\'/g, \"\\\\'\") + \"'!\" + name;\n                            }\n                            withErrorLog(sheet, null, function(){\n                                workbook.defineName(name, text, bool(attrs.hidden));\n                            }, \"reading user-defined name: \" + name);\n                        }\n                    }\n                }\n            });\n\n            var loading = new $$1.Deferred();\n            loading.progress(function(args) {\n                if (progress) {\n                    progress.notify(args);\n                }\n            })\n            .then(function() {\n                var sheets = workbook.sheets();\n                recalcSheets(sheets);\n\n                workbook.activeSheet(sheets[activeSheet]);\n\n                if (progress) {\n                    progress.resolve();\n                }\n            });\n\n            loadSheets(items, workbook, loading);\n        }\n\n        function loadSheets(items, workbook, progress) {\n            var ready = (new $$1.Deferred()).resolve();\n            for (var i = 0; i < items.length; i++) {\n\n                (function(entry, i) {\n                    ready = ready.then(function() {\n                        var sheet = workbook.insertSheet(entry.options);\n                        sheet.suspendChanges(true);\n\n                        var promise = queueSheet(sheet, entry);\n                        var args = {\n                            sheet: sheet,\n                            progress: i / (items.length - 1)\n                        };\n\n                        promise.then(function() {\n                            progress.notify(args);\n                        });\n\n                        return promise;\n                    });\n                })(items[i], i);\n            }\n\n            ready.then(function() {\n                progress.resolve();\n            });\n        }\n\n        function queueSheet(sheet, ctx) {\n            var deferred = new $$1.Deferred();\n\n            setTimeout(function() {\n                readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n                deferred.resolve();\n            }, 0);\n\n            return deferred;\n        }\n\n        function recalcSheets(sheets) {\n            for (var i = 0; i < sheets.length; i++) {\n                sheets[i]\n                    .suspendChanges(false)\n                    .triggerChange({ recalc: true });\n            }\n        }\n\n        function sheetDimensions(zip, file) {\n            var ref, dim = {\n                rows: 0,\n                cols: 0\n            };\n\n            parse$1(zip, xl(file), {\n                enter: function(tag, attrs) {\n                    if (tag == \"dimension\") {\n                        ref = parseReference(attrs.ref);\n                        if (ref.bottomRight) {\n                            dim.cols = ref.bottomRight.col + 1;\n                            dim.rows = ref.bottomRight.row + 1;\n                        }\n                    } else if (tag === \"sheetFormatPr\") {\n                        if (attrs.defaultColWidth) {\n                            dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                        }\n\n                        if (attrs.defaultRowHeight) {\n                            dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                        }\n                    } else if (this.is(SEL_ROW) && attrs.r) {\n                        dim.rows = Math.max(dim.rows, +attrs.r);\n                    } else if (this.is(SEL_CELL) && attrs.r) {\n                        ref = parseReference(attrs.r);\n                        dim.rows = Math.max(dim.rows, ref.row + 1);\n                        dim.cols = Math.max(dim.cols, ref.col + 1);\n                    }\n                }\n            });\n\n            return dim;\n        }\n\n        function toColWidth(size) {\n            // No font to compute agains, hence the magic number\n            var maximumDigitWidth = 7;\n\n            // The formula below is taken from the OOXML spec\n            var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n            return fraction * maximumDigitWidth;\n        }\n\n        function toRowHeight(pts) {\n            return pts * (4 / 3);\n        }\n\n        function readSheet(zip, file, sheet, strings, styles) {\n            var sharedFormulas = {};\n            var ref, type, value, formula, formulaRange, isArrayFormula;\n            var nCols = sheet._columns._count;\n            var prevCellRef = null;\n            var relsFile = file.replace(/worksheets\\//, \"worksheets/_rels/\");\n            var relationships = readRelationships(zip, relsFile);\n            var formula1, formula2;\n\n            var filterRef;\n            var filterColumn;\n            var customFilterLogic;\n            var customFilterCriteria;\n            var valueFilterBlanks;\n            var valueFilterValues;\n            var filters = [];\n\n            ERROR_LOG = sheet._workbook.excelImportErrors;\n\n            file = xl(file);\n\n            parse$1(zip, file, {\n                enter: function(tag, attrs, closed) {\n                    var tmp;\n                    if (this.is(SEL_FORMULA)) {\n                        if (closed) {\n                            if (attrs.t == \"shared\" && attrs.si != null) {\n                                formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                            }\n                        }\n                    }\n                    else if (this.is(SEL_CELL)) {\n                        value = null;\n                        formula = null;\n                        ref = attrs.r;\n                        formulaRange = null;\n\n                        if (ref == null) {\n                            // apparently some tools omit the `r` for\n                            // consecutive cells in a row, so we'll figure\n                            // it out from the previous cell's reference.\n                            // XXX: this could be slightly optimized by\n                            // keeping it parsed instead of stringifying\n                            // it to parse it again later.\n                            ref = parseReference(prevCellRef);\n                            ref.col++;\n                            ref = ref.toString();\n                        }\n                        prevCellRef = ref;\n\n                        // XXX: can't find no type actually, so everything is\n                        // interpreted as string.  Additionally, cells having\n                        // a formula will contain both <f> and <v> nodes,\n                        // which makes the value take precedence because it's\n                        // the second node; hence, the hack is to keep note of\n                        // them in the `text` handler, and apply the\n                        // appropriate one in the `leave` handler below.\n                        type = attrs.t;\n\n                        var styleIndex = attrs.s;\n                        if (styleIndex != null) {\n                            applyStyle(sheet, ref, styles, styleIndex);\n                        }\n                    }\n                    else if (this.is(SEL_MERGE)) {\n                        sheet.range(attrs.ref).merge();\n                    }\n                    else if (this.is(SEL_COL)) {\n                        var start = integer(attrs.min) - 1;\n                        var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                        var width;\n                        if (attrs.width) {\n                            width = toColWidth(parseFloat(attrs.width));\n                            if (width !== 0) {\n                                sheet._columns.values.value(start, stop, width);\n                            }\n                        }\n                        if (attrs.hidden === \"1\" || width === 0) {\n                            for (var ci = start; ci <= stop; ci++) {\n                                sheet.hideColumn(ci);\n                            }\n                        }\n                        if (attrs.style != null) {\n                            // apply style on a whole range of columns\n                            applyStyle(sheet, new kendo.spreadsheet.RangeRef(\n                                new kendo.spreadsheet.CellRef(-Infinity, start),\n                                new kendo.spreadsheet.CellRef(+Infinity, stop)\n                            ), styles, attrs.style);\n                        }\n                    }\n                    else if (this.is(SEL_ROW)) {\n                        var row = integer(attrs.r) - 1;\n                        var height;\n                        if (attrs.ht) {\n                            height = toRowHeight(parseFloat(attrs.ht));\n                            if (height !== 0) {\n                                sheet._rows.values.value(row, row, height);\n                            }\n                        }\n                        if (attrs.hidden === \"1\" || height === 0) {\n                            sheet.hideRow(row);\n                        }\n                    }\n                    else if (this.is(SEL_SELECTION)) {\n                        if (attrs.activeCell) {\n                            var acRef = parseReference(attrs.activeCell);\n                            sheet.select(acRef, true);\n                        }\n                    }\n                    else if (this.is(SEL_PANE)) {\n                        if (attrs.state && attrs.state.indexOf(\"frozen\") > -1) {\n                            if (attrs.xSplit) {\n                                sheet.frozenColumns(integer(attrs.xSplit));\n                            }\n\n                            if (attrs.ySplit) {\n                                sheet.frozenRows(integer(attrs.ySplit));\n                            }\n                        }\n                    }\n                    else if (this.is(SEL_SHEET_VIEW)) {\n                        sheet.showGridLines(bool(attrs.showGridLines, true));\n                    }\n                    else if (this.is(SEL_HYPERLINK)) {\n                        var relId = attrs[\"r:id\"];\n                        var target = relationships.byId[relId];\n                        if (target) {\n                            sheet.range(attrs.ref).link(target);\n                        }\n                    }\n                    else if (this.is([\"autoFilter\"])) {\n                        filterRef = attrs.ref;\n                        if (closed) {\n                            addAutoFilter();\n                        }\n                    }\n                    else if (filterRef) {\n                        if (this.is([\"filterColumn\"])) {\n                            filterColumn = parseInt(attrs.colId, 10);\n                        }\n                        else if (this.is([\"customFilters\"])) {\n                            customFilterLogic = bool(attrs.and) ? \"and\" : \"or\";\n                            customFilterCriteria = [];\n                        }\n                        else if (this.is([\"customFilter\"])) {\n                            tmp = getCustomFilter(attrs.operator, attrs.val);\n                            if (tmp) {\n                                customFilterCriteria.push({\n                                    operator: tmp.operator,\n                                    value: tmp.value\n                                });\n                            }\n                        }\n                        else if (this.is([\"dynamicFilter\"])) {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.DynamicFilter({\n                                    type: dynamicFilterType(attrs.type)\n                                })\n                            });\n                        }\n                        else if (this.is([\"top10\"])) {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.TopFilter({\n                                    value: getFilterVal(attrs.val),\n                                    type: (function(percent, top){\n                                        return percent && top ? \"topPercent\"\n                                            :  top ? \"topNumber\"\n                                            :  percent ? \"bottomPercent\"\n                                            :  \"bottomNumber\";\n                                    })(bool(attrs.percent), bool(attrs.top))\n                                })\n                            });\n                        }\n                        else if (this.is([\"filters\"])) {\n                            valueFilterBlanks = bool(attrs.blank);\n                            valueFilterValues = [];\n                        }\n                        else if (this.is([\"filter\"])) {\n                            valueFilterValues.push(getFilterVal(attrs.val));\n                        }\n                    }\n                },\n                leave: function(tag, attrs) {\n                    if (this.is(SEL_FORMULA)) {\n                        if (!formula && attrs.t == \"shared\" && attrs.si != null) {\n                            formula = sheet.range(sharedFormulas[attrs.si])._get(\"formula\");\n                        }\n                    }\n                    else if (this.is(SEL_CELL)) {\n                        if (formula != null) {\n                            var failed = withErrorLog(sheet, formulaRange || ref, function(){\n                                sheet.range(formulaRange || ref).formula(formula, isArrayFormula);\n                            }, \"parsing formula\");\n                            if (failed) {\n                                sheet.range(formulaRange || ref).value(formula)\n                                    .background(\"#ffaaaa\");\n                            }\n                        } else if (value != null) {\n                            var range = sheet.range(ref);\n\n                            if (!range._get(\"formula\")) {\n                                // Check for \"shared\" formulas before applying a value.\n                                if (!type || type == \"n\") {\n                                    value = parseFloat(value);\n                                } else if (type == \"s\") {\n                                    value = strings[integer(value)];\n                                } else if (type == \"b\") {\n                                    value = value === \"1\";\n                                } else if (type == \"d\") {\n                                    value = kendo.parseDate(value);\n                                }\n\n                                if (value != null) {\n                                    range.value(value);\n                                }\n                            }\n                        }\n                    } else if (this.is(SEL_VALIDATION) ||\n                               this.is(SEL_VALIDATION_INSANE)) {\n                        (function(){\n                            var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                            var type = attrs.type.toLowerCase();\n                            var operator = attrs.operator;\n                            if (/^(?:whole|decimal)$/.test(type)) {\n                                // we only support \"number\"\n                                type = \"number\";\n                            } else if (type == \"list\") {\n                                // there'll be no operator from Excel for lists\n                                operator = \"list\";\n                            }\n                            if (!operator && /^(?:number|date)$/.test(type)) {\n                                // Excel skips setting the operator for\n                                // \"between\", because why not.\n                                operator = \"between\";\n                            }\n                            refs.forEach(function(ref){\n                                withErrorLog(sheet, ref, function(){\n                                    sheet.range(ref).validation({\n                                        type             : bool(attrs.showErrorMessage, true) ? \"reject\" : \"warning\",\n                                        from             : formula1,\n                                        to               : formula2,\n                                        dataType         : type,\n                                        comparerType     : MAP_EXCEL_OPERATOR[operator] || operator,\n                                        allowNulls       : bool(attrs.allowBlank),\n                                        showButton       : bool(attrs.showDropDown) || type == \"date\" || type == \"list\",\n                                        messageTemplate  : attrs.error,\n                                        titleTemplate    : attrs.errorTitle\n                                    });\n                                }, \"parsing validation\");\n                            });\n                        })();\n                    } else if (tag == \"cols\") {\n                        sheet._columns._refresh();\n                    } else if (tag == \"sheetData\") {\n                        sheet._rows._refresh();\n                    } else if (tag == \"autoFilter\") {\n                        addAutoFilter();\n                    } else if (filterRef) {\n                        if (tag == \"customFilters\") {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.CustomFilter({\n                                    logic: customFilterLogic,\n                                    criteria: customFilterCriteria\n                                })\n                            });\n                        } else if (tag == \"filters\") {\n                            filters.push({\n                                column: filterColumn,\n                                filter: new kendo.spreadsheet.ValueFilter({\n                                    values: valueFilterValues,\n                                    blanks: valueFilterBlanks\n                                })\n                            });\n                        }\n                    }\n                },\n                text: function(text) {\n                    var attrs;\n                    if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                        value = text;\n                    } else if ((attrs = this.is(SEL_FORMULA))) {\n                        formula = text;\n                        isArrayFormula = attrs.t == \"array\";\n                        if (isArrayFormula) {\n                            formulaRange = attrs.ref;\n                        } else if (attrs.t == \"shared\") {\n                            sharedFormulas[attrs.si] = ref;\n                        }\n                    } else if (this.is(SEL_VALIDATION_FORMULA1) ||\n                               this.is(SEL_VALIDATION_FORMULA1_INSANE)) {\n                        formula1 = text;\n                    } else if (this.is(SEL_VALIDATION_FORMULA2) ||\n                               this.is(SEL_VALIDATION_FORMULA2_INSANE)) {\n                        formula2 = text;\n                    } else if (this.is(SEL_VALIDATION_SQREF_INSANE)) {\n                        // put it in <dataValidation>'s attributes where it should be\n                        this.stack[this.stack.length - 2].sqref = text;\n                    }\n                }\n            });\n\n            if (relationships.byType.comments) {\n                var commentFile = relative_file(file, relationships.byType.comments[0]);\n                readComments(zip, commentFile, sheet);\n            }\n\n            if (relationships.byType.drawing) {\n                var drawingFile = relative_file(file, relationships.byType.drawing[0]);\n                readDrawings(zip, drawingFile, sheet);\n            }\n\n            function addAutoFilter() {\n                sheet.range(filterRef).filter(filters);\n                filterRef = null;\n            }\n        }\n\n        function getContentType(filename) {\n            var m = /\\.([^.]+)$/.exec(filename);\n            if (m && m[1]) {\n                return {\n                    jpg  : \"image/jpeg\",\n                    jpeg : \"image/jpeg\",\n                    png  : \"image/png\",\n                    gif  : \"image/gif\",\n                    wmf  : \"image/wmf\"\n                }[m[1].toLowerCase()];\n            }\n        }\n\n        function getFileName(filename) {\n            var m = /[^/]+$/.exec(filename);\n            return m && m[0];\n        }\n\n        function readDrawings(zip, file, sheet) {\n            var sel_two_cell_anchor = [ \"xdr:twoCellAnchor\" ];\n            var sel_ext = [ \"xdr:ext\" ];\n            var sel_one_cell_anchor = [ \"xdr:oneCellAnchor\" ];\n            var sel_from = [ \"xdr:from\" ];\n            var sel_to = [ \"xdr:to\" ];\n            var sel_row = [ \"xdr:row\" ];\n            var sel_col = [ \"xdr:col\" ];\n            var sel_row_offset = [ \"xdr:rowOff\" ];\n            var sel_col_offset = [ \"xdr:colOff\" ];\n            var sel_blip = [ \"xdr:blipFill\", \"a:blip\" ];\n\n            var relsFile = file.replace(/drawings\\//, \"drawings/_rels/\");\n            var relationships = readRelationships(zip, relsFile);\n\n            if (relationships.byType.image) {\n                Object.keys(relationships.byId).forEach(function(id){\n                    var img = relative_file(file, relationships.byId[id]);\n                    var type = getContentType(img);\n\n                    if (type) {\n                        // XXX: file.asArrayBuffer() is deprecated in JSZip 3\n                        var data = zip.files[img].asArrayBuffer();\n                        var name = getFileName(img);\n                        var blob = name && !(kendo.support.browser.msie || kendo.support.browser.edge)\n                            ? new window.File([ data ], name, { type: type })\n                            : new window.Blob([ data ], { type: type });\n                        relationships.byId[id] = sheet._workbook.addImage(blob);\n                    }\n                });\n            }\n\n            var cdr, ref, width, height;\n            parse$1(zip, file, {\n                enter: function(tag, attrs) {\n                    if (this.is(sel_two_cell_anchor) || this.is(sel_one_cell_anchor)) {\n                        cdr = {};\n                    }\n                    else if (this.is(sel_from) || this.is(sel_to)) {\n                        ref = {};\n                    }\n                    else if (this.is(sel_blip)) {\n                        var id = attrs[\"r:embed\"];\n                        cdr.image = relationships.byId[id];\n                    }\n                    else if (this.is(sel_ext)) {\n                        width = excelToPixels(parseFloat(attrs.cx));\n                        height = excelToPixels(parseFloat(attrs.cy));\n                    }\n                },\n                leave: function() {\n                    if (this.is(sel_from)) {\n                        cdr.topLeftCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                        cdr.offsetX = excelToPixels(ref.colOffset);\n                        cdr.offsetY = excelToPixels(ref.rowOffset);\n                    }\n                    else if (this.is(sel_to)) {\n                        cdr.brCell = new kendo.spreadsheet.CellRef(ref.row, ref.col);\n                        cdr.brX = excelToPixels(ref.colOffset);\n                        cdr.brY = excelToPixels(ref.rowOffset);\n                    }\n                    // Add drawing only when it is image\n                    else if (this.is(sel_two_cell_anchor) && cdr.image) {\n                        var left = sheet._columns.sum(0, cdr.topLeftCell.col - 1) + cdr.offsetX;\n                        var top = sheet._rows.sum(0, cdr.topLeftCell.row - 1) + cdr.offsetY;\n                        var right = sheet._columns.sum(0, cdr.brCell.col - 1) + cdr.brX;\n                        var bottom = sheet._rows.sum(0, cdr.brCell.row - 1) + cdr.brY;\n\n                        sheet.addDrawing({\n                            topLeftCell : cdr.topLeftCell,\n                            offsetX     : cdr.offsetX,\n                            offsetY     : cdr.offsetY,\n                            width       : width != null ? width : right - left,\n                            height      : height != null ? height : bottom - top,\n                            image       : cdr.image,\n                            opacity     : 1\n                        });\n                    }\n                    // Add drawing only when it is image\n                    else if (this.is(sel_one_cell_anchor) && cdr.image) {\n                        sheet.addDrawing({\n                            topLeftCell : cdr.topLeftCell,\n                            offsetX     : cdr.offsetX,\n                            offsetY     : cdr.offsetY,\n                            width       : width,\n                            height      : height,\n                            image       : cdr.image,\n                            opacity     : 1\n                        });\n                    }\n                },\n                text: function(text) {\n                    if (this.is(sel_row)) {\n                        ref.row = parseFloat(text);\n                    }\n                    else if (this.is(sel_col)) {\n                        ref.col = parseFloat(text);\n                    }\n                    else if (this.is(sel_row_offset)) {\n                        ref.rowOffset = parseFloat(text);\n                    }\n                    else if (this.is(sel_col_offset)) {\n                        ref.colOffset = parseFloat(text);\n                    }\n                }\n            });\n        }\n\n        function readComments(zip, file, sheet) {\n            var authors = [];\n            var author;\n            var comment;\n            parse$1(zip, file, {\n                enter: function(tag, attrs) {\n                    if (this.is(SEL_COMMENT)) {\n                        comment = {\n                            author: authors[attrs.authorId],\n                            ref: attrs.ref,\n                            text: \"\"\n                        };\n                    } else if (this.is(SEL_AUTHOR)) {\n                        author = \"\";\n                    }\n                },\n                leave: function() {\n                    if (this.is(SEL_COMMENT)) {\n                        sheet.range(comment.ref).comment(comment.text);\n                    } else if (this.is(SEL_AUTHOR)) {\n                        authors.push(author);\n                    }\n                },\n                text: function(text) {\n                    if (this.is(SEL_COMMENT_TEXT)) {\n                        comment.text += text;\n                    } else if (this.is(SEL_AUTHOR)) {\n                        author += text;\n                    }\n                }\n            });\n        }\n\n        function getCustomFilter(op, value) {\n            var ourOp = {\n                equal               : \"eq\",\n                notEqual            : \"ne\",\n                greaterThan         : \"gt\",\n                greaterThanOrEqual  : \"gte\",\n                lessThan            : \"lt\",\n                lessThanOrEqual     : \"lte\"\n            }[op];\n\n            value = getFilterVal(value);\n\n            if (ourOp && typeof value == \"number\") {\n                return { operator: ourOp, value: value };\n            }\n\n            if ((op == \"notEqual\" || !op) && typeof value == \"string\") {\n                // Excel text operators support * and ? wildcards.  Since\n                // our startswith/endswith/contains filters do not, we\n                // can't really use them here, so we'll apply the more\n                // generic \"matches\" and \"doesnotmatch\" filters.\n                return {\n                    operator: op ? \"doesnotmatch\" : \"matches\",\n                    value: value\n                };\n            }\n        }\n\n        function dynamicFilterType(type) {\n            return {\n                Q1  : \"quarter1\",\n                Q2  : \"quarter2\",\n                Q3  : \"quarter3\",\n                Q4  : \"quarter4\",\n                M1  : \"january\",\n                M2  : \"february\",\n                M3  : \"march\",\n                M4  : \"april\",\n                M5  : \"may\",\n                M6  : \"june\",\n                M7  : \"july\",\n                M8  : \"august\",\n                M9  : \"september\",\n                M10 : \"october\",\n                M11 : \"november\",\n                M12 : \"december\"\n            }[type.toUpperCase()] || type;\n        }\n\n        function getFilterVal(val) {\n            var tmp = parseFloat(val);\n            if (!isNaN(tmp) && tmp == val) {\n                return tmp;\n            }\n            return val;\n        }\n\n        function withErrorLog(sheet, ref, func, context) {\n            try {\n                func();\n                return false;\n            } catch(ex) {\n                var err = { context: context, error: String(ex) };\n                if (sheet && sheet.name) {\n                    err.sheet = sheet.name();\n                } else if (sheet) {\n                    err.sheet = sheet;\n                }\n                if (ref) {\n                    err.location = String(ref);\n                }\n                ERROR_LOG.push(err);\n                return true;\n            }\n        }\n\n        var BORDER_WIDTHS = {\n            \"none\"            : 0,\n            \"thin\"            : 1,\n            \"medium\"          : 2,\n            \"dashed\"          : 1,\n            \"dotted\"          : 1,\n            \"thick\"           : 3,\n            \"double\"          : 3,\n            \"hair\"            : 1,\n            \"mediumDashed\"    : 2,\n            \"dashDot\"         : 1,\n            \"mediumDashDot\"   : 2,\n            \"dashDotDot\"      : 1,\n            \"mediumDashDotDot\": 2,\n            \"slantDashDot\"    : 1\n        };\n\n        var DEFAULT_FORMATS = {\n            0  : \"General\",\n            1  : \"0\",\n            2  : \"0.00\",\n            3  : \"#,##0\",\n            4  : \"#,##0.00\",\n            9  : \"0%\",\n            10 : \"0.00%\",\n            11 : \"0.00E+00\",\n            12 : \"# ?/?\",\n            13 : \"# ??/??\",\n            14 : \"mm-dd-yy\",\n            15 : \"d-mmm-yy\",\n            16 : \"d-mmm\",\n            17 : \"mmm-yy\",\n            18 : \"h:mm AM/PM\",\n            19 : \"h:mm:ss AM/PM\",\n            20 : \"h:mm\",\n            21 : \"h:mm:ss\",\n            22 : \"m/d/yy h:mm\",\n            37 : \"#,##0 ;(#,##0)\",\n            38 : \"#,##0 ;[Red](#,##0)\",\n            39 : \"#,##0.00;(#,##0.00)\",\n            40 : \"#,##0.00;[Red](#,##0.00)\",\n            45 : \"mm:ss\",\n            46 : \"[h]:mm:ss\",\n            47 : \"mmss.0\",\n            48 : \"##0.0E+0\",\n            49 : \"@\"\n        };\n\n        function applyStyle(sheet, ref, styles, styleIndex) {\n            var range = sheet.range(ref);\n            var xf = styles.inlineStyles[styleIndex], base, value;\n            if (xf.xfId) {\n                base = styles.namedStyles[xf.xfId];\n            }\n            if (shouldSet(\"applyBorder\", \"borderId\")) {\n                setBorder(styles.borders[value]);\n            }\n            if (shouldSet(\"applyFont\", \"fontId\")) {\n                setFont(styles.fonts[value]);\n            }\n            if (shouldSet(\"applyAlignment\", \"textAlign\")) {\n                range.textAlign(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"verticalAlign\")) {\n                range.verticalAlign(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"indent\")) {\n                range.indent(value);\n            }\n            if (shouldSet(\"applyAlignment\", \"wrapText\")) {\n                // don't use range.wrap to avoid recomputing row height\n                range._property(\"wrap\", value);\n            }\n            if (shouldSet(\"applyFill\", \"fillId\")) {\n                setFill(styles.fills[value]);\n            }\n            if (shouldSet(\"applyNumberFormat\", \"numFmtId\")) {\n                setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n            }\n\n            function setFormat(f) {\n                var format = typeof f == \"string\" ? f : f.formatCode;\n                if (format != null && !/^general$/i.test(format)) {\n                    // XXX: drop locale info.\n                    // http://stackoverflow.com/questions/894805/excel-number-format-what-is-409\n                    // not supported by the formatting library.\n                    format = format.replace(/^\\[\\$-[0-9]+\\]/, \"\");\n                    range.format(format);\n                }\n            }\n\n            function setFill(f) {\n                if (f.type == \"solid\") {\n                    range.background(f.color);\n                }\n            }\n\n            function setFont(f) {\n                range.fontFamily(f.name);\n                //range.fontSize(f.size); //XXX: will recalc row height.\n                // converting from points to pixels\n                if (f.size) {\n                    range._property(\"fontSize\", f.size * 4 / 3);\n                }\n                if (f.bold) {\n                    range.bold(true);\n                }\n                if (f.italic) {\n                    range.italic(true);\n                }\n                if (f.underline) {\n                    range.underline(true);\n                }\n                if (f.color) {\n                    range.color(f.color);\n                }\n            }\n\n            function setBorder(b) {\n                function set(side, prop) {\n                    var border = b[side];\n                    if (!border) {\n                        return;\n                    }\n\n                    var width = BORDER_WIDTHS[border.style];\n                    if (!width) {\n                        return;\n                    }\n\n                    var color = border.color;\n                    if (color == null) {\n                        color = \"#000\";\n                    }\n\n                    var value = { size: width, color: color };\n                    if (side == \"diagonal\") {\n                        value.type = border.up << 1 | border.down;\n                    }\n\n                    range._property(prop, value);\n                }\n\n                set(\"left\", \"borderLeft\");\n                set(\"top\", \"borderTop\");\n                set(\"right\", \"borderRight\");\n                set(\"bottom\", \"borderBottom\");\n                set(\"diagonal\", \"dBorders\");\n            }\n\n            function shouldSet(applyName, propName) {\n                var t = xf[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = xf[propName];\n                if (base && value == null) {\n                    t = base[applyName];\n                    if (t != null && !t) {\n                        return false;\n                    }\n                    value = base[propName];\n                }\n                return value != null;\n            }\n        }\n\n        function parse$1(zip, file, callbacks) {\n            var part = zip.files[file];\n            if (part) {\n                parseXML(part.asUint8Array(), callbacks);\n            }\n        }\n\n        function readStrings(zip) {\n            var strings = [];\n            var current = null;\n            parse$1(zip, \"xl/sharedStrings.xml\", {\n                leave: function() {\n                    if (this.is(SEL_SHARED_STRING)) {\n                        strings.push(current);\n                        current = null;\n                    }\n                },\n                text: function(text) {\n                    if (this.is(SEL_TEXT)) {\n                        if (current == null) {\n                            current = \"\";\n                        }\n                        current += text;\n                    }\n                }\n            });\n            return strings;\n        }\n\n        function readRelationships(zip, file) {\n            var map = { byId: {}, byType: { theme: [] } };\n            parse$1(zip, xl(file) + \".rels\", {\n                enter: function(tag, attrs) {\n                    if (tag == \"Relationship\") {\n                        map.byId[attrs.Id] = attrs.Target;\n\n                        var type = attrs.Type.match(/\\w+$/)[0];\n                        var entries = map.byType[type] || [];\n                        entries.push(attrs.Target);\n                        map.byType[type] = entries;\n                    }\n                }\n            });\n            return map;\n        }\n\n        var SEL_BORDER = [\"borders\", \"border\"];\n        var SEL_FILL = [\"fills\", \"fill\"];\n        var SEL_FONT = [\"fonts\", \"font\"];\n        var SEL_INLINE_STYLE = [\"cellXfs\", \"xf\"];\n        var SEL_NAMED_STYLE = [\"cellStyleXfs\", \"xf\"];\n        var SEL_NUM_FMT = [\"numFmts\", \"numFmt\"];\n\n        var INDEXED_COLORS = [\n            toCSSColor(\"FF000000\"), toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"),\n            toCSSColor(\"FF00FF00\"), toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"),\n            toCSSColor(\"FFFF00FF\"), toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF000000\"),\n            toCSSColor(\"FFFFFFFF\"), toCSSColor(\"FFFF0000\"), toCSSColor(\"FF00FF00\"),\n            toCSSColor(\"FF0000FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FFFF00FF\"),\n            toCSSColor(\"FF00FFFF\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008000\"),\n            toCSSColor(\"FF000080\"), toCSSColor(\"FF808000\"), toCSSColor(\"FF800080\"),\n            toCSSColor(\"FF008080\"), toCSSColor(\"FFC0C0C0\"), toCSSColor(\"FF808080\"),\n            toCSSColor(\"FF9999FF\"), toCSSColor(\"FF993366\"), toCSSColor(\"FFFFFFCC\"),\n            toCSSColor(\"FFCCFFFF\"), toCSSColor(\"FF660066\"), toCSSColor(\"FFFF8080\"),\n            toCSSColor(\"FF0066CC\"), toCSSColor(\"FFCCCCFF\"), toCSSColor(\"FF000080\"),\n            toCSSColor(\"FFFF00FF\"), toCSSColor(\"FFFFFF00\"), toCSSColor(\"FF00FFFF\"),\n            toCSSColor(\"FF800080\"), toCSSColor(\"FF800000\"), toCSSColor(\"FF008080\"),\n            toCSSColor(\"FF0000FF\"), toCSSColor(\"FF00CCFF\"), toCSSColor(\"FFCCFFFF\"),\n            toCSSColor(\"FFCCFFCC\"), toCSSColor(\"FFFFFF99\"), toCSSColor(\"FF99CCFF\"),\n            toCSSColor(\"FFFF99CC\"), toCSSColor(\"FFCC99FF\"), toCSSColor(\"FFFFCC99\"),\n            toCSSColor(\"FF3366FF\"), toCSSColor(\"FF33CCCC\"), toCSSColor(\"FF99CC00\"),\n            toCSSColor(\"FFFFCC00\"), toCSSColor(\"FFFF9900\"), toCSSColor(\"FFFF6600\"),\n            toCSSColor(\"FF666699\"), toCSSColor(\"FF969696\"), toCSSColor(\"FF003366\"),\n            toCSSColor(\"FF339966\"), toCSSColor(\"FF003300\"), toCSSColor(\"FF333300\"),\n            toCSSColor(\"FF993300\"), toCSSColor(\"FF993366\"), toCSSColor(\"FF333399\"),\n            toCSSColor(\"FF333333\"),\n            toCSSColor(\"FF000000\"), // System Foreground\n            toCSSColor(\"FFFFFFFF\")  // System Background\n        ];\n\n        function readStyles(zip, theme) {\n            var styles = {\n                fonts        : [],\n                numFmts      : {},\n                fills        : [],\n                borders      : [],\n                namedStyles  : [],\n                inlineStyles : []\n            };\n            var font = null;\n            var fill = null;\n            var border = null;\n            var xf = null;\n            parse$1(zip, \"xl/styles.xml\", {\n                enter: function(tag, attrs, closed) {\n                    if (this.is(SEL_NUM_FMT)) {\n                        styles.numFmts[attrs.numFmtId] = attrs;\n                    }\n                    else if (this.is(SEL_FONT)) {\n                        styles.fonts.push(font = {});\n                        if (closed) {\n                            // apparently, there's XLSX in the wild with\n                            // <font/>, because why not (also, <border/>).\n                            // if we don't null the variable, we always\n                            // enter below and effectively ignore the rest\n                            // of the file.\n                            font = null;\n                        }\n                    } else if (font) {\n                        if (tag == \"sz\") {\n                            font.size = parseFloat(attrs.val);\n                        } else if (tag == \"name\") {\n                            font.name = attrs.val;\n                        } else if (tag == \"b\") {\n                            font.bold = bool(attrs.val, true);\n                        } else if (tag == \"i\") {\n                            font.italic = bool(attrs.val, true);\n                        } else if (tag == \"u\") {\n                            font.underline = (attrs.val == null || attrs.val == \"single\");\n                        } else if (tag == \"color\") {\n                            font.color = getColor(attrs, null);\n                        }\n                    }\n                    else if (this.is(SEL_FILL)) {\n                        styles.fills.push(fill = {});\n                        if (closed) {\n                            fill = null;\n                        }\n                    } else if (fill) {\n                        if (tag == \"patternFill\") {\n                            fill.type = attrs.patternType;\n                        } else if (tag == \"fgColor\" && fill.type === \"solid\") {\n                            fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                        } else if (tag == \"bgColor\" && fill.type !== \"solid\") {\n                            fill.color = getColor(attrs, INDEXED_COLORS[0]);\n                        }\n                    }\n                    else if (this.is(SEL_BORDER)) {\n                        styles.borders.push(border = {\n                            diagonalUp   : +bool(attrs.diagonalUp, 0),\n                            diagonalDown : +bool(attrs.diagonalDown, 0)\n                        });\n                        if (closed) {\n                            border = null;\n                        }\n                    } else if (border) {\n                        if (/^(?:left|top|right|bottom|diagonal)$/.test(tag)) {\n                            border[tag] = { style: attrs.style || \"none\" };\n                            if (tag == \"diagonal\") {\n                                border.diagonal.up = border.diagonalUp;\n                                border.diagonal.down = border.diagonalDown;\n                            }\n                        }\n                        if (tag == \"color\") {\n                            var side = this.stack[this.stack.length - 2].$tag;\n                            border[side].color = getColor(attrs, INDEXED_COLORS[0]);\n                        }\n                    }\n                    else if (this.is(SEL_NAMED_STYLE)) {\n                        xf = getXf(attrs);\n                        styles.namedStyles.push(xf);\n                        if (closed) {\n                            xf = null;\n                        }\n                    } else if (this.is(SEL_INLINE_STYLE)) {\n                        xf = getXf(attrs);\n                        styles.inlineStyles.push(xf);\n                        if (closed) {\n                            xf = null;\n                        }\n                    } else if (xf) {\n                        if (tag == \"alignment\") {\n                            if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                                xf.textAlign = attrs.horizontal;\n                            }\n                            if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                                xf.verticalAlign = attrs.vertical;\n                            }\n                            if (attrs.wrapText != null) {\n                                xf.wrapText = bool(attrs.wrapText);\n                            }\n                            if (attrs.indent != null) {\n                                xf.indent = integer(attrs.indent);\n                            }\n                        }\n                    }\n                },\n                leave: function(tag) {\n                    if (this.is(SEL_FONT)) {\n                        font = null;\n                    } else if (this.is(SEL_FILL)) {\n                        fill = null;\n                    } else if (this.is(SEL_BORDER)) {\n                        border = null;\n                    } else if (tag == \"xf\") {\n                        xf = null;\n                    }\n                }\n            });\n\n            function getXf(attrs) {\n                var xf = {\n                    borderId          : integer(attrs.borderId),\n                    fillId            : integer(attrs.fillId),\n                    fontId            : integer(attrs.fontId),\n                    numFmtId          : integer(attrs.numFmtId),\n                    pivotButton       : bool(attrs.pivotButton),\n                    quotePrefix       : bool(attrs.quotePrefix),\n                    xfId              : integer(attrs.xfId)\n                };\n                addBool(\"applyAlignment\");\n                addBool(\"applyBorder\");\n                addBool(\"applyFill\");\n                addBool(\"applyFont\");\n                addBool(\"applyNumberFormat\");\n                addBool(\"applyProtection\");\n                function addBool(name) {\n                    if (attrs[name] != null) {\n                        xf[name] = bool(attrs[name]);\n                    }\n                }\n                return xf;\n            }\n\n            function getColor(attrs, defaultThemeColor) {\n                if (attrs.rgb) {\n                    return toCSSColor(attrs.rgb);\n                } else if (attrs.indexed) {\n                    return INDEXED_COLORS[integer(attrs.indexed)];\n                } else if (attrs.theme) {\n                    var themeColor = theme.colorScheme[integer(attrs.theme)];\n                    if (!themeColor) {\n                        // returning black by default for font color causes\n                        // https://github.com/telerik/kendo-ui-core/issues/5826\n                        // in default cell style, color is undefined\n                        return defaultThemeColor;\n                    }\n\n                    var color = kendo.parseColor(themeColor);\n\n                    if (attrs.tint) {\n                        color = color.toHSL();\n\n                        var tint = parseFloat(attrs.tint);\n                        if (tint < 0) {\n                            color.l = color.l * (1 + tint);\n                        } else {\n                            color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                        }\n                    }\n\n                    return color.toCssRgba();\n                }\n            }\n\n            return styles;\n        }\n\n        var SEL_SCHEME_RGBCLR = [\"a:clrScheme\", \"*\", \"a:srgbClr\"];\n        var SEL_SCHEME_SYSCLR = [\"a:clrScheme\", \"*\", \"a:sysClr\"];\n        function readTheme(zip, rel) {\n            var scheme = [];\n            var theme = {\n                colorScheme: scheme\n            };\n\n            var file = xl(rel);\n            if (zip.files[file]) {\n                parse$1(zip, file, {\n                    enter: function(tag, attrs) {\n                        if (this.is(SEL_SCHEME_SYSCLR)) {\n                            scheme.push(toCSSColor(\n                                attrs.val == \"window\" ? \"FFFFFFFF\" : \"FF000000\"\n                            ));\n                        } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                            scheme.push(toCSSColor(\"FF\" + attrs.val));\n                        }\n                    }\n                });\n\n                if (scheme.length > 3) {\n                    // lt1 <-> dk1\n                    swap(scheme, 0, 1);\n                    // lt2 <-> dk2\n                    swap(scheme, 2, 3);\n                }\n            }\n\n            function swap(arr, a, b) {\n                var tmp = arr[a];\n                arr[a] = arr[b];\n                arr[b] = tmp;\n            }\n\n            return theme;\n        }\n\n        function integer(val) {\n            return val == null ? null : parseInt(val, 10);\n        }\n\n        function bool(val, def) {\n            if (val == null) {\n                return def;\n            }\n            return val == \"true\" || val === true || val == 1;\n        }\n\n        function toCSSColor(rgb) {\n            var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n            return \"rgba(\" +\n                parseInt(m[2], 16) + \", \" +\n                parseInt(m[3], 16) + \", \" +\n                parseInt(m[4], 16) + \", \" +\n                parseInt(m[1], 16) / 255 + \")\";\n        }\n\n        function relative_file(base, name) {\n            base = base.split(/\\/+/);\n            name = name.split(/\\/+/);\n            base.pop();\n            while (name.length) {\n                var part = name.shift();\n                if (part === \"\") {\n                    base = [];      // absolute\n                } else if (part === \".\") {\n                    continue;\n                } else if (part === \"..\") {\n                    base.pop();\n                } else {\n                    base.push(part);\n                }\n            }\n            return base.join(\"/\");\n        }\n\n        function excelToPixels(val) {\n            return val / 9525;\n        }\n\n        kendo.spreadsheet.readExcel = readExcel;\n        kendo.spreadsheet._readSheet = readSheet;\n        kendo.spreadsheet._readStrings = readStrings;\n        kendo.spreadsheet._readStyles = readStyles;\n        kendo.spreadsheet._readTheme = readTheme;\n        kendo.spreadsheet._readWorkbook = readWorkbook;\n\n    (function(kendo) {\n\n\n\n\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n\n        kendo.spreadsheet.messages.workbook = {\n            defaultSheetName: \"Sheet\"\n        };\n\n        function loadBinary(url, callback) {\n            var xhr = new XMLHttpRequest();\n            xhr.onload = function() {\n                callback(xhr.response, xhr.getResponseHeader(\"Content-Type\"));\n            };\n            xhr.onerror = function() {\n                callback(null);\n            };\n            xhr.open(\"GET\", url);\n            xhr.responseType = \"arraybuffer\";\n            xhr.send();\n        }\n\n        var Workbook = kendo.Observable.extend({\n            options: {},\n\n            init: function(options, view) {\n                kendo.Observable.fn.init.call(this);\n\n                this.options = options;\n\n                this._view = view;\n                this._sheets = [];\n                this._images = {};\n                this._imgID = 0;\n\n                this._sheetsSearchCache = {};\n\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\"undo\", \"redo\"], this._onUndoRedo.bind(this));\n\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n\n                this.fromJSON(this.options);\n            },\n\n            clipboard: function() {\n                if(!this._clipboard) {\n                     this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n\n            destroy: function() {\n                this.unbind();\n\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n\n            events: [\n                \"cut\",\n                \"copy\",\n                \"paste\",\n                \"changing\",\n                \"change\",\n                \"excelImport\",\n                \"excelExport\",\n                \"insertSheet\",\n                \"removeSheet\",\n                \"selectSheet\",\n                \"renameSheet\",\n                \"insertRow\",\n                \"insertColumn\",\n                \"deleteRow\",\n                \"deleteColumn\",\n                \"hideRow\",\n                \"hideColumn\",\n                \"unhideRow\",\n                \"unhideColumn\",\n                \"select\",\n                \"changeFormat\",\n                \"dataBinding\",\n                \"dataBound\",\n                \"progress\"\n            ],\n\n            _sheetChanging: function(e) {\n                if (this.trigger(\"changing\", e)) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetChange: function(e) {\n                this.trigger(\"change\", e);\n            },\n\n            _sheetInsertRow: function(e) {\n                if (this.trigger(\"insertRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetInsertColumn: function(e) {\n                if (this.trigger(\"insertColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDeleteRow: function(e) {\n                if (this.trigger(\"deleteRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDeleteColumn: function(e) {\n                if (this.trigger(\"deleteColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetHideRow: function(e) {\n                if (this.trigger(\"hideRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetHideColumn: function(e) {\n                if (this.trigger(\"hideColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetUnhideRow: function(e) {\n                if (this.trigger(\"unhideRow\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetUnhideColumn: function(e) {\n                if (this.trigger(\"unhideColumn\", {\n                    sheet: e.sender,\n                    index: e.index\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetSelect: function(e) {\n                this.trigger(\"select\", e);\n            },\n\n            _sheetDataBinding: function(e) {\n                if (this.trigger(\"dataBinding\", {\n                    sheet: e.sender\n                })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sheetDataBound: function(e) {\n                this.trigger(\"dataBound\", {\n                    sheet: e.sender\n                });\n            },\n\n            _sheetProgress: function(e) {\n                var that = this;\n\n                setTimeout(function() {\n                    that.trigger(\"progress\", {\n                        toggle: e.toggle\n                    });\n                });\n            },\n\n            _sheetCommandRequest: function(e) {\n                this.trigger(\"commandRequest\", e);\n            },\n\n            _inputForRef: function(ref) {\n                var self = this;\n                return self._sheet.withCultureDecimals(function(){\n                    return new kendo.spreadsheet.Range(ref, self._sheet).input();\n                });\n            },\n\n            _onUndoRedo: function(e) {\n                e.command.range().select();\n            },\n\n            execute: function(options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else {\n                    command.range(sheet.selection());\n                }\n\n                if (commandOptions.editRange) {\n                    command._editRange = commandOptions.editRange;\n                }\n\n                var result = command.exec();\n\n                if (!result || result.reason !== \"error\") {\n                    if (!command.cannotUndo) {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n\n                // when the undo/redo stack is truncated (by e.g. adding a\n                // non-redo command after undoing) it's possible to\n                // discard images from the dropped commands.\n                this.cleanupImages();\n\n                return result;\n            },\n\n            resetFormulas: function() {\n                this._sheets.forEach(function(sheet){\n                    sheet.resetFormulas();\n                });\n            },\n\n            resetValidations: function() {\n                this._sheets.forEach(function(sheet){\n                    sheet.resetValidations();\n                });\n            },\n\n            refresh: function(reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n\n            activeSheet: function(sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n\n                this._sheet = sheet;\n\n                //TODO: better way to get all reasons?\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n\n            moveSheetToIndex: function(sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n\n                if (fromIndex === -1) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n\n                this.trigger(\"change\", { sheetSelection: true });\n            },\n\n            insertSheet: function(options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === \"number\" ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n\n                var getUniqueSheetName = function(sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n\n                    var name = kendo.spreadsheet.messages.workbook.defaultSheetName + sheetNameSuffix;\n\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                sheetName = options.name || getUniqueSheetName();\n\n                var sheet = new kendo.spreadsheet.Sheet(\n                    options.rows || this.options.rows,\n                    options.columns || this.options.columns,\n                    options.rowHeight || this.options.rowHeight,\n                    options.columnWidth || this.options.columnWidth,\n                    options.headerHeight || this.options.headerHeight,\n                    options.headerWidth || this.options.headerWidth,\n                    options.defaultCellStyle || this.options.defaultCellStyle\n                );\n\n                sheet._workbook = this;\n\n                sheet._name(sheetName);\n\n                this._bindSheetEvents(sheet);\n\n                sheets.splice(insertIndex, 0, sheet);\n\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n\n                this.trigger(\"change\", { sheetSelection: true });\n\n                return sheet;\n            },\n\n            _bindSheetEvents: function(sheet) {\n                sheet.bind(\"changing\", this._sheetChanging.bind(this));\n                sheet.bind(\"change\", this._sheetChange.bind(this));\n                sheet.bind(\"insertRow\", this._sheetInsertRow.bind(this));\n                sheet.bind(\"insertColumn\", this._sheetInsertColumn.bind(this));\n                sheet.bind(\"deleteRow\", this._sheetDeleteRow.bind(this));\n                sheet.bind(\"deleteColumn\", this._sheetDeleteColumn.bind(this));\n                sheet.bind(\"hideRow\", this._sheetHideRow.bind(this));\n                sheet.bind(\"hideColumn\", this._sheetHideColumn.bind(this));\n                sheet.bind(\"unhideRow\", this._sheetUnhideRow.bind(this));\n                sheet.bind(\"unhideColumn\", this._sheetUnhideColumn.bind(this));\n                sheet.bind(\"select\", this._sheetSelect.bind(this));\n                sheet.bind(\"commandRequest\", this._sheetCommandRequest.bind(this));\n                sheet.bind(\"dataBinding\", this._sheetDataBinding.bind(this));\n                sheet.bind(\"dataBound\", this._sheetDataBound.bind(this));\n                sheet.bind(\"progress\", this._sheetProgress.bind(this));\n            },\n\n            sheets: function() {\n                return this._sheets.slice();\n            },\n\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n\n            sheetByIndex: function(index) {\n                return this._sheets[index];\n            },\n\n            sheetIndex: function(sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == \"string\" ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n\n                if (idx >= 0) {\n                    return idx;\n                }\n\n                for(idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n\n                return -1;\n            },\n\n            renameSheet: function(sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n\n                if (!newSheetName ||\n                    oldSheetName === newSheetName.toLowerCase() ||\n                    this.sheetByName(newSheetName)) {\n                    return;\n                }\n\n                sheet = this.sheetByName(oldSheetName);\n\n                if (!sheet) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                if (this.trigger(\"renameSheet\", {\n                    sheet: sheet,\n                    newSheetName: newSheetName\n                })) {\n                    return;\n                }\n\n                // update references\n                this._sheets.forEach(function(sheet){\n                    sheet._forFormulas(function(formula){\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n\n                this.forEachName(function(def, name){\n                    // 1. redefine sheet-local names\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    // 2. if the value is reference or formula, update it\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n\n                sheet._name(newSheetName);\n\n                this.trigger(\"change\", { sheetSelection: true });\n\n                return sheet;\n            },\n\n            removeSheet: function(sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n\n                if (sheets.length === 1) {\n                    return;\n                }\n\n                if (this.trigger(\"removeSheet\", { sheet: sheet })) {\n                    return;\n                }\n\n                this._sheetsSearchCache = {};\n\n                if (index > -1) {\n                    sheet.unbind();\n\n                    sheets.splice(index, 1);\n\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index-1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger(\"change\", { recalc: true,  sheetSelection: true });\n                    }\n                }\n            },\n\n            _clearSheets: function() {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i]._activeDrawing = [];\n                    this._sheets[i]._drawings = [];\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n                this._images = {};\n                this._imgID = 0;\n            },\n\n            // _loadImages: function() {\n            //     var self = this;\n            //     var ids = Object.keys(self._images);\n            //     var count = ids.length;\n            //     if (count) {\n            //         ids.forEach(function(id){\n            //             var img = self._images[id];\n            //             if (!img.blob) {\n            //                 loadBinary(img.url, function(data, type) {\n            //                     // XXX: can we do something better in case of error?\n            //                     if (data != null) {\n            //                         img.blob = new Blob([ data ], { type: type });\n            //                         delete img.url;\n            //                     }\n            //                     next();\n            //                 });\n            //             }\n            //         });\n            //     } else {\n            //         next();\n            //     }\n            //     function next() {\n            //         if (--count <= 0) {\n            //             self.activeSheet().triggerChange({ layout: true });\n            //         }\n            //     }\n            // },\n\n            fromJSON: function(json) {\n                if (json.sheets) {\n                    this._clearSheets();\n\n                    if (json.images) {\n                        this._imgID = 0;\n                        this._images = {};\n                        Object.keys(json.images).forEach(function(id){\n                            if (!isNaN(id)) {\n                                var num = parseFloat(id);\n                                if (isFinite(num)) {\n                                    this._imgID = Math.max(this._imgID, num);\n                                }\n                            }\n                            this._images[id] = { url: json.images[id] };\n                        }, this);\n                        // this._loadImages();\n                    }\n\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows         : args.rowCount,\n                            columns      : args.columnCount,\n                            rowHeight    : args.rowHeight,\n                            columnWidth  : args.columnWidth,\n                            headerHeight : args.headerHeight,\n                            headerWidth  : args.headerWidth,\n                            data         : data\n                        });\n\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n\n                if (json.names) {\n                    json.names.forEach(function(def){\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n\n            toJSON: function() {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function(name){\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + \"\";\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value     : val,\n                        hidden    : def.hidden,\n                        name      : def.name,\n\n                        // these two are not really useful in\n                        // deserialization, but are handy in OOXML export.\n                        sheet     : def.nameref.sheet,\n                        localName : def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function(sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n\n            saveJSON: function() {\n                var self = this;\n                var deferred = new $.Deferred();\n                var data = self.toJSON();\n                var ids = Object.keys(self._images).filter(function(id){\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                data.images = {};\n                if (count) {\n                    ids.forEach(function(id){\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function() {\n                                data.images[id] = reader.result;\n                                next();\n                            };\n                            reader.readAsDataURL(img.blob);\n                        } else {\n                            data.images[id] = img.url;\n                            next();\n                        }\n                    });\n                } else {\n                    next();\n                }\n                return deferred.promise();\n\n                function next() {\n                    if (--count <= 0) {\n                        deferred.resolve(data);\n                    }\n                }\n            },\n\n            fromFile: function(file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = { file: file, promise: promise };\n\n                if (file && !this.trigger(\"excelImport\", args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n\n                return promise;\n            },\n\n            saveAsExcel: function(options) {\n                var self = this;\n                options = $.extend({}, self.options.excel, options);\n                var data = self.toJSON();\n\n                if (self.trigger(\"excelExport\", { workbook: data })) {\n                    return;\n                }\n\n                var ids = Object.keys(self._images).filter(function(id){\n                    return self.usesImage(id) === 1;\n                });\n                var count = ids.length;\n                var images = count ? {} : null;\n                if (count) {\n                    ids.forEach(function(id){\n                        var img = self._images[id];\n                        if (img.blob) {\n                            var reader = new FileReader();\n                            reader.onload = function() {\n                                images[id] = {\n                                    type: img.blob.type,\n                                    name: img.blob.name,\n                                    data: reader.result\n                                };\n                                next();\n                            };\n                            reader.readAsArrayBuffer(img.blob);\n                        } else {\n                            loadBinary(img.url, function(data, type){\n                                images[id] = { type: type, data: data };\n                                next();\n                            });\n                        }\n                    });\n                } else {\n                    next();\n                }\n\n                function next() {\n                    if (--count <= 0) {\n                        data.images = images;\n                        var workbook = new kendo.ooxml.Workbook(data);\n                        kendo.saveAs({\n                            dataURI: options.forceProxy ? workbook.toDataURL() : workbook.toBlob(),\n                            fileName: data.fileName || options.fileName,\n                            proxyURL: options.proxyURL,\n                            forceProxy: options.forceProxy\n                        });\n                    }\n                }\n            },\n\n            draw: function(options, callback) {\n                if (typeof options == \"function\" && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i){\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function(group){\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                })(0);\n            },\n\n            nameForRef: function(ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + \"\";\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || (val.sheet && sheet == val.sheet.toLowerCase())) {\n                            if (val + \"\" == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n\n            defineName: function(name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value   : x.value,\n                    hidden  : hidden,\n                    name    : name,\n                    nameref : x.name\n                };\n            },\n\n            undefineName: function(name) {\n                delete this._names[name.toLowerCase()];\n            },\n\n            nameValue: function(name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n\n            nameDefinition: function(name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n\n            forEachName: function(func) {\n                Object.keys(this._names).forEach(function(name){\n                    func(this._names[name], name);\n                }, this);\n            },\n\n            adjustNames: function(affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function(name){\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref &&\n                        x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    }\n                    else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? \"row\" : \"col\", start, delta);\n                    }\n                }, this);\n            },\n\n            addImage: function(image) {\n                var id = String(++this._imgID);\n                if (typeof image == \"string\") {\n                    this._images[id] = { url: image };\n                } else {\n                    this._images[id] = { blob: image };\n                }\n                return id;\n            },\n\n            imageUrl: function(id) {\n                var img = this._images[id];\n                var url = img.url;\n                if (!url) {\n                    url = img.url = window.URL.createObjectURL(img.blob);\n                }\n                return url;\n            },\n\n            cleanupImages: function() {\n                Object.keys(this._images).forEach(function(id){\n                    if (!this.usesImage(id)) {\n                        var url = this._images[id].url;\n                        if (url) {\n                            window.URL.revokeObjectURL(url);\n                        }\n                        delete this._images[id];\n                    }\n                }, this);\n            },\n\n            usesImage: function(img) {\n                var i;\n                var sheets = this._sheets;\n                for (i = sheets.length; --i >= 0;) {\n                    if (sheets[i].usesImage(img)) {\n                        return 1;\n                    }\n                }\n                var stack = this.undoRedoStack.stack;\n                for (i = stack.length; --i >= 0;) {\n                    if (stack[i].usesImage(img)) {\n                        return 2; // signal that it's only in the undo stack\n                    }\n                }\n                return false;\n            }\n\n        });\n\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n\n            var rowCount     = or(data.rowCount, options.rows, 200),\n                columnCount  = or(data.columnCount, options.columns, 50),\n                rowHeight    = or(data.rowHeight, options.rowHeight, 20),\n                columnWidth  = or(data.columnWidth, options.columnWidth, 64),\n                headerHeight = or(data.headerHeight, options.headerHeight, 20),\n                headerWidth  = or(data.headerWidth, options.headerWidth, 32);\n\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) { rowCount = ri + 1; }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) { columnCount = ci + 1; }\n                        }\n                    }\n                }\n            }\n\n            return {\n                rowCount     : rowCount,\n                columnCount  : columnCount,\n                rowHeight    : rowHeight,\n                columnWidth  : columnWidth,\n                headerHeight : headerHeight,\n                headerWidth  : headerWidth\n            };\n        }\n\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n\n            Workbook.prototype.saveAsPDF = function(options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger(\"pdfExport\", args)) {\n                    return;\n                }\n\n                this._drawPDF(options, progress)\n                .then(function(root) {\n                    return options.forceProxy\n                        ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                        : kendo.pdf.exportPDFToBlob(root);\n                })\n                .done(function(dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n\n                    progress.resolve();\n                })\n                .fail(function(err) {\n                    progress.reject(err);\n                });\n\n                return promise;\n            };\n\n            Workbook.prototype._drawPDF = function(options) {\n                var result = new $.Deferred();\n                var callback = function(group) {\n                    result.resolve(group);\n                };\n                switch(options.area) {\n                case \"workbook\":\n                    options.workbook.draw(options, callback);\n                    break;\n                case \"sheet\":\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case \"selection\":\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n\n                return result.promise();\n            };\n        }\n    })(kendo);\n\n    var spreadsheet$4 = kendo.spreadsheet;\n        var CellRef$2 = spreadsheet$4.CellRef;\n        var RangeRef$1 = spreadsheet$4.RangeRef;\n        var UnionRef$1 = spreadsheet$4.UnionRef;\n        var NameRef$1 = spreadsheet$4.NameRef;\n        var Ref$1 = spreadsheet$4.Ref;\n\n        var FormulaContext = kendo.Class.extend({\n            init: function (workbook) {\n                this.workbook = workbook;\n            },\n\n            getRefCells: function(ref, hiddenInfo, fsheet, frow, fcol, wantNulls) {\n                var sheet, formula, value, i;\n                if (ref instanceof CellRef$2) {\n                    sheet = this.workbook.sheetByName(ref.sheet);\n                    if (!sheet || !ref.valid()) {\n                        return [{\n                            value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                        }];\n                    }\n                    formula = sheet.formula(ref);\n                    value = sheet.range(ref.row, ref.col).value();\n\n                    if (wantNulls || formula != null || value != null) {\n                        return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? (sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0) : false\n                        }];\n                    } else {\n                        return [];\n                    }\n                }\n                if (ref instanceof RangeRef$1) {\n                    i = this.workbook.sheetIndex(ref.sheet);\n                    var states = [], n = i;\n                    if (ref.endSheet) {\n                        // \"3D\" reference.\n                        n = this.workbook.sheetIndex(ref.endSheet);\n                        if (i > n) {\n                            var tmp = i;\n                            i = n;\n                            n = tmp;\n                        }\n                    }\n\n                    if (i < 0 || n < 0 || !ref.valid()) {\n                        return [{\n                            value: new kendo.spreadsheet.calc.runtime.CalcError(\"REF\")\n                        }];\n                    }\n\n                    // XXX: This is nicer, but significantly slower.\n                    // Should investigate why, or add some options to make\n                    // it faster (i.e. probably because it adds all cell\n                    // properties, while we only need value and formula).\n                    //\n                    //     var add = function(row, col, data){\n                    //         data.row = row;\n                    //         data.col = col;\n                    //         data.sheet = sheet.name();\n                    //         states.push(data);\n                    //     };\n                    //     while (i <= n) {\n                    //         sheet = this.workbook.sheetByIndex(i++);\n                    //         sheet.forEach(ref, add);\n                    //     }\n                    //\n                    // For now keep doing it \"manually\".\n\n                    while (i <= n) {\n                        sheet = this.workbook.sheetByIndex(i++);\n                        var tl = sheet._grid.normalize(ref.topLeft);\n                        var br = sheet._grid.normalize(ref.bottomRight);\n\n                        var startCellIndex = sheet._grid.cellRefIndex(tl);\n                        var endCellIndex = sheet._grid.cellRefIndex(br);\n\n                        var values = sheet._properties.iterator(\"value\", startCellIndex, endCellIndex);\n\n                        for (var col = tl.col; col <= br.col; ++col) {\n                            for (var row = tl.row; row <= br.row; ++row) {\n                                var index = sheet._grid.index(row, col);\n                                formula = sheet._properties.get(\"formula\", index);\n                                value = values.at(index);\n                                if (wantNulls || formula != null || value != null) {\n                                    states.push({\n                                        formula : formula,\n                                        value   : value,\n                                        row     : row,\n                                        col     : col,\n                                        sheet   : sheet.name(),\n                                        hidden  : hiddenInfo ? (sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0) : false\n                                    });\n                                }\n                            }\n                        }\n                    }\n\n                    return states;\n                }\n                if (ref instanceof UnionRef$1) {\n                    var a = [];\n                    for (i = 0; i < ref.refs.length; ++i) {\n                        a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                    }\n                    return a;\n                }\n                if (ref instanceof NameRef$1) {\n                    var val = this.nameValue(ref, fsheet, frow, fcol);\n                    // XXX: revise this\n                    if (val instanceof Ref$1) {\n                        return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                    }\n                    return [{\n                        value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError(\"NAME\") : val\n                    }];\n                }\n                return [];\n            },\n\n            isMerged: function(ref) {\n                var sheet = this.workbook.sheetByName(ref.sheet);\n                return sheet.isMerged(ref);\n            },\n\n            nameValue: function(ref, fsheet, frow, fcol) {\n                var val;\n                if (ref.hasSheet()) {\n                    // qualified name\n                    val = this.workbook.nameValue(this._displayString(ref.print()));\n                } else {\n                    // try local name\n                    ref = ref.clone().setSheet(fsheet, true);\n                    val = this.workbook.nameValue(this._displayString(ref.print()));\n                    if (val == null) {\n                        // try global name\n                        val = this.workbook.nameValue(this._displayString(ref.name));\n                    }\n                }\n                if (val instanceof Ref$1) {\n                    val = val.absolute(frow, fcol);\n                }\n                return val;\n            },\n\n            getData: function(ref, fsheet, frow, fcol, wantNulls) {\n                var single = ref instanceof CellRef$2;\n                if (ref instanceof NameRef$1) {\n                    single = this.workbook.nameValue(ref.name) instanceof CellRef$2;\n                }\n                var data = this.getRefCells(ref, false, fsheet, frow, fcol, wantNulls).map(function(cell){\n                    var val = cell.value;\n                    if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        val = val.value;\n                    }\n                    return val;\n                });\n                return single ? data[0] : data;\n            },\n\n            onFormula: function(f) {\n                var sheet = this.workbook.sheetByName(f.sheet);\n                var row = f.row, col = f.col, value = f.value;\n                var currentFormula = sheet.formula({ row: row, col: col });\n                if (currentFormula !== f) {\n                    // could have been deleted or modified in the mean time,\n                    // if the formula was asynchronous.  ignore this result.\n                    return false;\n                }\n\n                var arrayRange = f.arrayFormulaRange;\n                if (arrayRange) {\n                    // `value` will always be a Matrix in this case;\n                    // enforced in runtime.js (Context::_resolve).  We\n                    // must fill only cells in arrayRange.\n                    var tlRow, tlCol;\n                    var width = value.width;\n                    var height = value.height;\n                    sheet.forEach(arrayRange, function(row, col){\n                        if (tlRow === undefined) {\n                            tlRow = row;\n                            tlCol = col;\n                        }\n                        var vrow = row - tlRow;\n                        var vcol = col - tlCol;\n                        var val;\n                        if (vrow < height && vcol < width) {\n                            val = value.get(vrow, vcol);\n                        } else {\n                            val = new kendo.spreadsheet.calc.runtime.CalcError(\"N/A\");\n                        }\n                        sheet._value(row, col, val);\n                    });\n                }\n                else {\n                    // formulas may return references.  if a range or union,\n                    // we'll just save the first cell.\n                    if (value instanceof Ref$1) {\n                        value = this.getData(value, f.sheet, row, col);\n                        if (Array.isArray(value)) {\n                            value = value[0];\n                        }\n                        if (value === undefined) {\n                            value = null; // clear contents\n                        }\n                    }\n\n                    // when not saved as an array formula, a formula\n                    // returning a Matrix will just save the first value.\n                    if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                        value = value.get(0, 0);\n                    }\n\n                    sheet._value(row, col, value);\n                }\n\n                clearTimeout(sheet._formulaContextRefresh);\n                sheet._formulaContextRefresh = setTimeout(function(){\n                    sheet.batch(function(){}, { layout: true });\n                }, 50);\n\n                return true;\n            },\n            _displayString: function(val) {\n                if (/^[a-z_][a-z0-9_]*$/i.test(val)) {\n                    return val;\n                }\n                return \"'\" + val.replace(/\\x27/g, \"\\\\'\") + \"'\";\n            }\n        });\n\n        var ValidationFormulaContext = FormulaContext.extend({\n            onFormula: function() {\n                return true;\n            }\n        });\n\n        spreadsheet$4.FormulaContext = FormulaContext;\n        spreadsheet$4.ValidationFormulaContext = ValidationFormulaContext;\n\n    (function(kendo) {\n        'use strict';\n\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n\n        var ACTIONS = {\n            \"up\": \"up\",\n            \"down\": \"down\",\n            \"left\": \"left\",\n            \"right\": \"right\",\n            \"home\": \"first-col\",\n            \"end\": \"last-col\",\n            \"ctrl+left\": \"word-left\",\n            \"ctrl+right\": \"word-right\",\n            \"ctrl+up\": \"word-up\",\n            \"ctrl+down\": \"word-down\",\n            \"ctrl+home\": \"first\",\n            \"ctrl+end\": \"last\",\n            \"pageup\": \"prev-page\",\n            \"pagedown\": \"next-page\"\n        };\n\n        var ENTRY_ACTIONS = {\n            \"tab\": \"next\",\n            \"shift+tab\": \"previous\",\n            \"enter\": \"lower\",\n            \"shift+enter\": \"upper\",\n            \"delete\": \"clearContents\",\n            \"backspace\": \"clearContents\",\n            \"shift+:alphanum\": \"edit\",\n            \"alt+:alphanum\": \"edit\",\n            \":alphanum\": \"edit\",\n            \"ctrl+:alphanum\": \"ctrl\",\n            \"alt+ctrl+:alphanum\": \"edit\",\n            \":edit\": \"edit\"\n        };\n\n        var CONTAINER_EVENTS = {\n            \"wheel\": \"onWheel\",\n            \"*+mousedown\": \"onMouseDown\",\n            \"contextmenu\": \"onContextMenu\",\n            \"*+mousedrag\": \"onMouseDrag\",\n            \"*+mouseup\": \"onMouseUp\",\n            \"*+dblclick\": \"onDblClick\",\n            \"mousemove\": \"onMouseMove\"\n        };\n\n        var CLIPBOARD_EVENTS = {\n            \"pageup\": \"onPageUp\",\n            \"pagedown\": \"onPageDown\",\n            \"mouseup\": \"onMouseUp\",\n            \"*+cut\": \"onCut\",\n            \"*+paste\": \"onPaste\",\n            \"*+copy\": \"onCopy\"\n        };\n\n        var EDITOR_EVENTS = {\n            \"esc\": \"onEditorEsc\",\n            \"enter\": \"onEditorBlur\",\n            \"alt+enter\": \"insertNewline\",\n            \"shift+enter\": \"onEditorBlur\",\n            \"tab\": \"onEditorBlur\",\n            \"shift+tab\": \"onEditorBlur\",\n            \"shift+ctrl+enter\": \"onEditorArrayFormula\"\n        };\n\n        var FORMULABAR_EVENTS = $.extend({ focus: \"onEditorBarFocus\" }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: \"onEditorCellFocus\" }, EDITOR_EVENTS);\n\n        var SELECTION_MODES = {\n           cell: \"range\",\n           rowheader: \"row\",\n           columnheader: \"column\",\n           topcorner: \"sheet\",\n           autofill: \"autofill\"\n        };\n\n        function toActionSelector(selectors) {\n            return selectors.map(function(action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(\",\");\n        }\n\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([ 'cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below' ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([ 'unhide-row', 'unhide-column' ]);\n\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push(\"shift+\" + key);\n        }\n\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n\n        CLIPBOARD_EVENTS[ACTION_KEYS] = \"onAction\";\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = \"onShiftAction\";\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = \"onEntryAction\";\n\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = \"onEditorAction\";\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = \"onEditorShiftAction\";\n\n        var Controller = kendo.Class.extend({\n            init: function(view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.drawingContextMenu = view.drawingContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n\n                view.nameEditor.bind(\"enter\", this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind(\"cancel\", this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind(\"select\", this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind(\"delete\", this.onNameEditorDelete.bind(this));\n\n                this.editor = view.editor;\n                this.editor.bind(\"change\", this.onEditorChange.bind(this));\n                this.editor.bind(\"activate\", this.onEditorActivate.bind(this));\n                this.editor.bind(\"deactivate\", this.onEditorDeactivate.bind(this));\n                this.editor.bind(\"update\", this.onEditorUpdate.bind(this));\n\n                $(view.scroller).on(\"scroll\", this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                $(view.scroller).on(\"mousedown\", this.onMouseDown.bind(this));\n\n                this._enableEditorEvents();\n\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind(\"select\", this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind(\"reorder\", this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind(\"rename\", this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind(\"remove\", this.onSheetBarRemove.bind(this));\n                }\n\n                this.cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n                this.drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n\n                // this is necessary for Windows to catch prevent context menu correctly\n                this.cellContextMenu.element\n                    .add(this.rowHeaderContextMenu.element)\n                    .add(this.colHeaderContextMenu.element)\n                    .add(this.drawingContextMenu.element)\n                    .on(\"contextmenu\", false);\n\n                if (this.tabstrip) {\n                    this.tabstrip.bind(\"action\", this.onCommandRequest.bind(this));\n                    this.tabstrip.bind(\"dialog\", this.onDialogRequest.bind(this));\n                }\n            },\n\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n\n            _execute: function(options) {\n                var result = this._workbook.execute(options);\n\n                if (options.command === \"EditCommand\" && !result) {\n                    this._workbook.trigger(\"change\", { editorClose: true });\n                }\n\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === \"error\") {\n                        this.editor.deactivate(true); // make sure we don't call any change hooks\n                        this.view.showError(result, function(){\n                            // we only get here in case of a validation error when the user decided to retry.\n                            this.activateEditor(false);\n                            // reset to last input from user\n                            this.editor.value(this._lastEditorValue);\n                            // however, set _value manually such that it'll detect change properly.  ugly :-\\\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            // seems like a nice UX to have the whole input selected\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n\n                return result;\n            },\n\n            _activeTooltip: function() {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n\n            onContextMenuSelect: function(e) {\n                var action = $(e.item).data(\"action\");\n                var command;\n                switch(action) {\n                  case \"cut\":\n                    command = { command: \"ToolbarCutCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"copy\":\n                    command = { command: \"ToolbarCopyCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"paste\":\n                    command = { command: \"ToolbarPasteCommand\", options: { workbook: this._workbook } };\n                    break;\n                  case \"delete-drawing\":\n                    command = { command: \"DeleteDrawingCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"bring-to-front\":\n                    command = { command: \"BringToFrontCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"send-to-back\":\n                    command = { command: \"SendToBackCommand\", options: { drawing: this.navigator._sheet._activeDrawing } };\n                    break;\n                  case \"unmerge\":\n                    command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                    break;\n                  case \"merge\":\n                    this.view.openDialog(\"merge\");\n                    break;\n                  case \"hide-row\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                  case \"hide-column\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                  case \"unhide-row\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                  case \"unhide-column\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                  case \"delete-row\":\n                    command = { command: \"DeleteRowCommand\" };\n                    break;\n                  case \"delete-column\":\n                    command = { command: \"DeleteColumnCommand\" };\n                    break;\n                }\n\n                if (command) {\n                    this._execute(command);\n                }\n            },\n\n            onSheetBarRemove: function(e) {\n                var sheet = this._workbook.sheetByName(e.name);\n\n                //TODO: move to model!\n                if (!sheet) {\n                    return;\n                }\n\n                this._workbook.removeSheet(sheet);\n            },\n\n            destroy: function() {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n\n            onSheetBarSelect: function(e) {\n                var sheet;\n                var workbook = this._workbook;\n\n                if (e.isAddButton) {\n                    if (this._workbook.trigger(\"insertSheet\")) {\n                        return;\n                    }\n\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n\n                //TODO: move to model\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                        return;\n                    }\n\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n\n                    workbook.activeSheet(sheet);\n                }\n            },\n\n            onSheetBarReorder: function(e) {\n                var workbook = this._workbook;\n                var sheet = workbook.sheetByIndex(e.oldIndex);\n                var activeSheet = workbook.activeSheet();\n                var activeSheetName = activeSheet.name();\n\n                workbook.moveSheetToIndex(sheet, e.newIndex);\n\n                if (activeSheetName !== sheet.name()) {\n                    if (workbook.trigger(\"selectSheet\", { sheet: sheet })) {\n                        workbook.activeSheet(activeSheet);\n                        return;\n                    }\n\n                    if (!this.editor.canInsertRef(false)) {\n                        this.editor.deactivate();\n                    }\n\n                    workbook.activeSheet(sheet);\n                }\n            },\n\n            onSheetBarRename: function(e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({ reason: \"error\", type: \"duplicateSheetName\" });\n                    return;\n                }\n\n                this._workbook.renameSheet(sheet, e.name);\n\n                this.clipboardElement.focus();\n            },\n\n            sheet: function(sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n\n            workbook: function(workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind(\"commandRequest\", this.onCommandRequest.bind(this));\n            },\n\n            refresh: function() {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    this.resetEditorValue();\n                }\n\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n\n            onScroll: function() {\n                this.view.render({ scroll: true });\n            },\n\n            onWheel: function(event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n\n                this.scrollWith(deltaX, deltaY);\n\n                event.preventDefault();\n            },\n\n            onAction: function(event, action) {\n                var sheet = this._workbook.activeSheet();\n                sheet._activeDrawing = null;\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n\n            onPageUp: function() {\n                this.scrollDown(-this._viewPortHeight);\n            },\n\n            onPageDown: function() {\n                this.scrollDown(this._viewPortHeight);\n            },\n\n            onEntryAction: function(event, action) {\n                var sheet = this._workbook.activeSheet();\n\n                if (event.mod) {\n                    var key = String.fromCharCode(event.keyCode);\n                    var shouldPrevent = true;\n\n                    switch(key) {\n                      case \"A\":\n                        sheet._activeDrawing = null;\n                        this.navigator.selectAll();\n                        break;\n                      case \"Y\":\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                      case \"Z\":\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                      default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = sheet.selection().enable() === false;\n                    var casual = action !== \":edit\";\n\n                    if (action == \"delete\" || action == \"backspace\") {\n                        if (sheet._activeDrawing) {\n                            this._execute({\n                                command: \"DeleteDrawingCommand\",\n                                options: { drawing: sheet._activeDrawing }\n                            });\n                        } else if (!disabled) {\n                            this._execute({ command: \"ClearContentCommand\" });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || !casual) {\n                        sheet._activeDrawing = null;\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (casual) {\n                            this.editor.value(\"\");\n                        }\n                        this.activateEditor(casual);\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n\n            onShiftAction: function(event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n                event.preventDefault();\n            },\n\n            onMouseMove: function(event) {\n                var sheet = this._workbook.activeSheet();\n\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n\n                var object = this.objectAt(event);\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n\n                sheet._renderComment(object.type == \"cell\" ? object.ref : null);\n            },\n\n            onMouseDown: function(event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n\n                if (this._startResizingDrawing(event, object)) {\n                    event.stopPropagation();\n                    return;\n                }\n\n                var sheet = this._workbook.activeSheet();\n                var win = this.container.closest('[' + kendo.attr(\"role\") + '=\"window\"]');\n                if (win.length) {\n                    win = kendo.widgetInstance(win);\n                    if (win && win.options.modal) {\n                        event.stopPropagation();\n                    }\n                }\n\n                sheet._activeDrawing = null;\n                if (object.type === \"drawing\") {\n                    sheet._activeDrawing = object.drawing;\n                    object.copy = object.drawing.clone();\n                    object.startBox = sheet.drawingBoundingBox(object.copy);\n                    sheet.startDragging(object);\n                    sheet.triggerChange({ dragging: true });\n                    event.preventDefault();\n                    return;\n                }\n\n                if (object.type === \"outside\") {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    return;\n                }\n\n                if (object.type === \"editor\") {\n                    // XXX: canceling the edits, because they might not\n                    // validate.  Not sure it's the Right Thing.\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;     // validation error\n                    }\n                }\n\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    sheet.startResizing({ x: object.x, y: object.y });\n                    event.preventDefault();\n                    return;\n                }\n\n                if (object.type === \"filtericon\") {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey, this.view);\n            },\n\n            _startResizingDrawing: function(event) {\n                var handle = $(event.target).closest(\".k-spreadsheet-drawing-handle\");\n                if (handle.length) {\n                    var location = this.translateCoords(event);\n                    var direction = handle.data(\"direction\");\n                    var sheet = this._workbook.activeSheet();\n                    var drawing = sheet._activeDrawing;\n                    sheet.startDragging({\n                        pane     : this.originFrame,\n                        drawing  : drawing,\n                        copy     : drawing.clone(),\n                        startBox : sheet.drawingBoundingBox(drawing),\n                        resize   : direction,\n                        //aspect   : drawing.width / drawing.height,\n                        startX   : location.x,\n                        startY   : location.y\n                    });\n                    return true;\n                }\n            },\n\n            onContextMenu: function(event) {\n                var sheet = this._workbook.activeSheet();\n\n                event.preventDefault();\n\n                if (sheet.resizingInProgress() || sheet.draggingInProgress()) {\n                    return;\n                }\n\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                this.drawingContextMenu.close();\n\n                var menu;\n\n                var object = this.objectAt(event);\n\n                if (object.type === \"columnresizehandle\" || object.type === \"rowresizehandle\") {\n                    return;\n                }\n\n                if (object.ref) {\n                    this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                } else if (object.type == \"drawing\") {\n                    this.navigator.selectDrawingForContextMenu(object.drawing);\n                }\n\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n\n                if (object.type == \"columnheader\") {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == \"rowheader\") {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else if (object.type == \"drawing\") {\n                    menu = this.drawingContextMenu;\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n                // avoid the immediate close\n                setTimeout(function() {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n\n            prevent: function(event) {\n                event.preventDefault();\n            },\n\n            constrainResize: function(type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n\n                return !resizeHandle || type === \"outside\" || type === \"topcorner\" || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n\n            _dragDrawing: function(event) {\n                var sheet = this._workbook.activeSheet();\n                var drag = sheet.draggingInProgress();\n                if (!drag) {\n                    return false;\n                }\n\n                var location = this.translateCoords(event);\n                var drawing = drag.drawing;\n                var deltaX = location.x - drag.startX;\n                var deltaY = location.y - drag.startY;\n\n                if (drag.resize == \"SE\") {\n                    if (drag.aspect) {\n                        if (Math.abs(deltaX) > Math.abs(deltaY)) {\n                            drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                            drawing.height = drawing.width / drag.aspect;\n                        } else {\n                            drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                            drawing.width = drawing.height * drag.aspect;\n                        }\n                    } else {\n                        drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                        drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    }\n                }\n                else if (drag.resize == \"E\") {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                }\n                else if (drag.resize == \"S\") {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                }\n                else if (drag.resize == \"N\") {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                }\n                else if (drag.resize == \"W\") {\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                else if (drag.resize == \"NE\") {\n                    drawing.width = Math.max(drag.copy.width + deltaX, 20);\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                }\n                else if (drag.resize == \"SW\") {\n                    drawing.height = Math.max(drag.copy.height + deltaY, 20);\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                else if (drag.resize == \"NW\") {\n                    if (drag.copy.height - deltaY > 20) {\n                        drawing.height = drag.copy.height - deltaY;\n                        drawing.offsetY = drag.copy.offsetY + deltaY;\n                    }\n                    if (drag.copy.width - deltaX > 20) {\n                        drawing.width = drag.copy.width - deltaX;\n                        drawing.offsetX = drag.copy.offsetX + deltaX;\n                    }\n                }\n                // just moving (no resize)\n                else {\n                    drawing.offsetX = drag.copy.offsetX + deltaX;\n                    drawing.offsetY = drag.copy.offsetY + deltaY;\n                }\n\n                sheet.triggerChange({ dragging: true });\n\n                return true;\n            },\n\n            onMouseDrag: function(event) {\n                if (this._selectionMode === \"sheet\") {\n                    return;\n                }\n\n                var location = { clientX: event.clientX, clientY: event.clientY };\n                var sheet = this._workbook.activeSheet();\n\n                if (this._dragDrawing(event)) {\n                    return;\n                }\n\n                var object = this.objectAt(location);\n\n                if (sheet.resizingInProgress()) {\n\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({ x: object.x, y: object.y });\n                    }\n\n                    return;\n                }\n\n                if (object.type === \"outside\") {\n                    this.startAutoScroll(object);\n                    return;\n                }\n\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else { // cross frame selection\n                    var frame = this.originFrame._grid;\n\n                    if (object.x > frame.right) {\n                        kendo.scrollLeft(this);\n                    }\n\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n\n                event.preventDefault();\n            },\n\n            onMouseUp: function(event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                sheet.completeDragging();\n\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n\n            onDblClick: function(event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n\n                if (object.type !== \"cell\" || disabled) {\n                    return;\n                }\n\n                var sel = this._workbook.activeSheet().selection();\n                this.activateEditor(!sel.value() && !sel.formula());\n                this.onEditorUpdate();\n            },\n\n            onCut: function(e) {\n                var self = this;\n                setTimeout(function(){\n                    self.clipboard.menuInvoked = (e === undefined);\n                    self._execute({\n                        command: \"CutCommand\",\n                        options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                    });\n                });\n            },\n\n            clipBoardValue: function() {\n                return this.clipboardElement.html();\n            },\n\n            _pasteImage: function(blob) {\n                var self = this;\n                var img = new window.Image();\n                img.src = window.URL.createObjectURL(blob);\n                img.onload = function() {\n                    self._execute({\n                        command: \"InsertImageCommand\",\n                        options: {\n                            blob: blob,\n                            width: img.width,\n                            height: img.height\n                        }\n                    });\n                };\n                setTimeout(function(){\n                    window.URL.revokeObjectURL(img.src);\n                }, 10);\n            },\n\n            onPaste: function(e) {\n                var self = this;\n                var html = \"\";\n                var plain = \"\";\n                self.clipboard.menuInvoked = (e === undefined);\n                if (e) {\n                    var clipboardData = e.originalEvent.clipboardData;\n                    if (clipboardData && clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        // Firefox uses DOMStringList, needs special handling\n                        if (window.DOMStringList && clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = clipboardData.types.contains(\"text/html\");\n                            hasPlainText = clipboardData.types.contains(\"text/plain\");\n                        } else if (Array.isArray(clipboardData.types)) {\n                            hasHTML = clipboardData.types.indexOf(\"text/html\") >= 0;\n                            hasPlainText = clipboardData.types.indexOf(\"text/plain\") >= 0;\n                        } else {\n                            hasHTML = /text\\/html/.test(clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = clipboardData.getData('text/html').trim();\n                        }\n                        if (hasPlainText) {\n                            plain = clipboardData.getData('text/plain').trim();\n                        }\n                        if (!html && !plain && clipboardData.items && clipboardData.items.length) {\n                            for (var i = 0; i < clipboardData.items.length; ++i) {\n                                var item = clipboardData.items[i];\n                                if (item.kind == \"file\" && /^image\\/(?:png|jpe?g|gif)$/i.test(item.type)) {\n                                    return self._pasteImage(item.getAsFile());\n                                }\n                            }\n                        }\n                    } else {\n                        if (window.clipboardData.files && window.clipboardData.files.length) {\n                            var file = window.clipboardData.files[0];\n                            if (/^image\\/(?:png|jpe?g|gif)$/i.test(file.type)) {\n                                return self._pasteImage(file);\n                            }\n                        }\n\n                        plain = window.clipboardData.getData(\"Text\");\n                        if (plain) {\n                            plain = plain.trim();\n                        }\n\n                        // There's no way to get the HTML clipboard contents in IE other than letting\n                        // the browser handle the event (it pastes into our clipboardElement), and then\n                        // we can read the HTML from there.  Need to allow a small timeout for this.\n                        self.clipboardElement.empty();\n                        setTimeout(function(){\n                            html = self.clipboardElement.html();\n                            if (html || plain) {\n                                self.clipboard.external({ html: html, plain: plain });\n                                self._execute({\n                                    command: \"PasteCommand\",\n                                    options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                                });\n                            }\n                        });\n\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        self.clipboardElement.trigger(\"focus\").select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        self.clipboard.menuInvoked = true;\n                    }\n                }\n\n                if (!html && !plain) {\n                    return;\n                }\n                self.clipboard.external({ html: html, plain:plain });\n                self._execute({\n                    command: \"PasteCommand\",\n                    options: { workbook: self.view._workbook, event: e.originalEvent || e }\n                });\n            },\n\n            onCopy: function(e) {\n                this.clipboard.menuInvoked = (e === undefined);\n                this._execute({\n                    command: \"CopyCommand\",\n                    options: { workbook: this.view._workbook, event: e.originalEvent || e }\n                });\n            },\n\n    ////////////////////////////////////////////////////////////////////\n\n            scrollTop: function() {\n                this.scroller.scrollTop = 0;\n            },\n\n            scrollLeft: function() {\n                this.scroller.scrollLeft = 0;\n            },\n\n            scrollDown: function(value) {\n                this.scroller.scrollTop += value;\n            },\n\n            scrollRight: function(value) {\n                this.scroller.scrollLeft += value;\n            },\n\n            scrollWith: function(right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n\n            translateCoords: function(location) {\n                var box = this.container[0].getBoundingClientRect();\n                return {\n                    x: location.clientX - box.left,\n                    y: location.clientY - box.top\n                };\n            },\n\n            objectAt: function(location, noDrawing) {\n                if (!location) {\n                    return;\n                }\n                location = this.translateCoords(location);\n                return this.view.objectAt(location.x, location.y, noDrawing);\n            },\n\n            selectToLocation: function(cellLocation) {\n                var object = this.objectAt(cellLocation, true);\n\n                if (object.pane && object.ref) { // cell, rowheader or columnheader\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n\n                this.stopAutoScroll();\n            },\n\n            extendSelection: function(object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode);\n            },\n\n            autoScroll: function() {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n\n            startAutoScroll: function(viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n\n                this.finalLocation = location || this.lastKnownCellLocation;\n\n                this._autoScrollTarget = viewObject;\n            },\n\n            stopAutoScroll: function() {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n\n            openCustomEditor: function() {\n                this.view.openCustomEditor();\n            },\n\n            openFilterMenu: function(event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n\n                filterMenu.bind(\"action\", this.onCommandRequest.bind(this));\n                filterMenu.bind(\"action\", filterMenu.close.bind(filterMenu));\n\n                filterMenu.openFor(event.target, event);\n            },\n\n    ////////////////////////////////////////////////////////////////////\n\n            _saveEditorValue: function(arrayFormula) {\n                var sheet = this.editor._range.sheet();\n                var value = this.editor.value();\n                if (this._workbook.activeSheet() !== sheet) {\n                    // remove highlighted refs (XXX: which are mostly wrong, BTW)\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    // go back to the original sheet\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = value;\n                this._execute({\n                    command: \"EditCommand\",\n                    options: {\n                        value: value,\n                        arrayFormula: arrayFormula\n                    }\n                });\n            },\n\n            onEditorChange: function() {\n                this._saveEditorValue(false);\n            },\n\n            onEditorArrayFormula: function() {\n                this._saveEditorValue(true);\n                this.editor.deactivate(true);\n            },\n\n            onEditorActivate: function() {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n\n            onEditorDeactivate: function() {\n                var sheet = this._workbook.activeSheet();\n\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n\n            onEditorUpdate: function() {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n\n            onEditorBarFocus: function() {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor\n                    .activate({\n                        range: this._workbook.activeSheet().selection(),\n                        rect: this.view.activeCellRectangle(),\n                        tooltip: this._activeTooltip()\n                    });\n            },\n\n            onEditorCellFocus: function() {\n                this.editor.scale();\n            },\n\n            onEditorEsc: function() {\n                this.resetEditorValue();\n                this.editor.deactivate();\n\n                this.clipboardElement.trigger(\"focus\");\n            },\n\n            insertNewline: function(e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n\n            onEditorBlur: function(_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n\n                this._preventNavigation = false;\n                this.editor.deactivate();\n\n                if (!this._preventNavigation) {\n                    this.clipboardElement.trigger(\"focus\");\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n\n            onEditorAction: function(event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n\n                if (this._casualEditing && /^(?:up|right|down|left)$/.test(action)) {\n                    this.deactivateEditor();\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    event.preventDefault();\n                }\n                else if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n\n            onEditorShiftAction: function(event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace(\"shift+\", \"\")], this.appendSelection);\n\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n\n                    event.preventDefault();\n                }\n            },\n\n    ////////////////////////////////////////////////////////////////////\n            resetEditorValue: function() {\n                var sheet = this._workbook.activeSheet();\n                var ref = sheet.activeCell();\n                var input = this._workbook._inputForRef(ref);\n                var x = sheet.range(ref).intersectingArrayFormula();\n                if (x) {\n                    input = \"=\" + x.formula;\n                }\n                this.editor.value(input, !!x);\n            },\n\n            activateEditor: function(casual) {\n                // This flag will be false when F2 has been pressed, and\n                // true when editing is \"casual\", i.e., user just started\n                // typing.  In this case we want arrow keys to do cell\n                // navigation rather than move the cursor.\n                // https://github.com/telerik/kendo-ui-core/issues/3644\n                this._casualEditing = casual;\n\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n\n            deactivateEditor: function() {\n                this.view.editor.deactivate();\n            },\n\n            onCommandRequest: function(e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n\n            onDialogRequest: function(e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n\n                this.view.openDialog(e.name, e.options);\n            },\n\n            onNameEditorEnter: function() {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n\n                // 1. does it look like a reference, or already defined\n                // name?  If so, just select it (don't define/modify any\n                // names)\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        // reference points to another sheet, select it if found\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n\n                // XXX: should we check if a name is already defined for this range, and update it instead?\n                // Excel just adds a new one, and provides a more complete Name Manager dialog.\n                //var def = workbook.nameForRef(ref, sheet.name());\n\n                // just define new name\n                this._execute({\n                    command: \"DefineNameCommand\",\n                    options: { name: name, value: ref }\n                });\n\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorCancel: function() {\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorSelect: function(ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        // reference points to another sheet, select it if found\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.trigger(\"focus\");\n            },\n            onNameEditorDelete: function(ev) {\n                this._execute({\n                    command: \"DeleteNameCommand\",\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.trigger(\"focus\");\n            }\n        });\n\n        kendo.spreadsheet.Controller = Controller;\n    })(window.kendo);\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = \".\";\n        var RESIZE_HANDLE_WIDTH = 7;\n        var EDIT_BUTTON_WIDTH = 20;\n        var ERROR = \"Error\";\n        var viewClassNames = {\n            view: \"k-spreadsheet-view\",\n            fixedContainer: \"k-spreadsheet-fixed-container\",\n            editContainer: \"k-spreadsheet-edit-container\",\n            scroller: \"k-spreadsheet-scroller\",\n            viewSize: \"k-spreadsheet-view-size\",\n            clipboard: \"k-spreadsheet-clipboard\",\n            cellEditor: \"k-spreadsheet-cell-editor\",\n            barEditor: \"k-spreadsheet-editor\",\n            topCorner: \"k-spreadsheet-top-corner\",\n            filterHeadersWrapper: \"k-filter-wrapper\",\n            filterRange: \"k-filter-range\",\n            filterButton: \"k-spreadsheet-filter\",\n            filterButtonSelected: \"k-selected\",\n            horizontalResize: \"k-horizontal-resize\",\n            verticalResize: \"k-vertical-resize\",\n            icon: \"k-icon\",\n            iconFilterDefault: \"k-i-arrow-60-down\",\n            sheetsBar: \"k-spreadsheet-sheets-bar\",\n            sheetsBarActive: \"k-spreadsheet-sheets-bar-active\",\n            sheetsBarInactive: \"k-spreadsheet-sheets-bar-inactive\",\n            cellContextMenu: \"k-spreadsheet-cell-context-menu\",\n            rowHeaderContextMenu: \"k-spreadsheet-row-header-context-menu\",\n            colHeaderContextMenu: \"k-spreadsheet-col-header-context-menu\",\n            drawingContextMenu: \"k-spreadsheet-drawing-context-menu\"\n        };\n\n        kendo.spreadsheet.messages.view = {\n            nameBox: \"Name Box\",\n            errors: {\n                openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n                shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n                insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n                insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n                filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n                sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n                cantSortMultipleSelection: \"Cannot sort multiple selection\",\n                cantSortNullRef: \"Cannot sort empty selection\",\n                cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n                validationError: \"The value that you entered violates the validation rules set on the cell.\",\n                cannotModifyDisabled: \"Cannot modify disabled cells.\",\n                insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n                insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n            },\n            tabs: {\n                home: \"Home\",\n                insert: \"Insert\",\n                data: \"Data\"\n            }\n        };\n\n        kendo.spreadsheet.messages.menus = {\n            \"cut\"          : \"Cut\",\n            \"copy\"         : \"Copy\",\n            \"paste\"        : \"Paste\",\n            \"merge\"        : \"Merge\",\n            \"unmerge\"      : \"Unmerge\",\n            \"delete\"       : \"Delete\",\n            \"hide\"         : \"Hide\",\n            \"unhide\"       : \"Unhide\",\n            \"bringToFront\" : \"Bring to front\",\n            \"sendToBack\"   : \"Send to back\"\n        };\n\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n\n            var range = document.createRange();\n            range.selectNodeContents(el);\n\n            sel.addRange(range);\n        }\n\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row-1];\n            var index = table.trs[row].children.length-1;\n\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n\n        function cellBorder(value) {\n            return (value.size || 1) + \"px solid \" + (value.color || \"#000\");\n        }\n\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = \"http://\" + link;\n            }\n            return link;\n        }\n\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == \"object\") {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = {\n                        textDecoration: \"none\"\n                    };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = \"underline\";\n                    }\n                    return kendo.dom.element(\"a\", {\n                        href   : asURL(link),\n                        style  : style,\n                        target : \"_blank\" // XXX: customizable?\n                    }, el ? [ el ] : []);\n                }\n                return el;\n            }\n\n            var shouldDraw = (cell.value != null || (cell.validation != null && !cell.validation.value) || // jshint ignore:line\n                              cell.background || cell.merged || cell.comment || cell.dBorders);\n            if (!cls && !shouldDraw) {\n                return;\n            }\n\n            var style = { background: [] };\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    // darken\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n\n            if (cell.dBorders) {\n                if (cell.dBorders.type & 2) {\n                    style.background.push(\"linear-gradient(to top left, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                          cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                          cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n                }\n                if (cell.dBorders.type & 1) {\n                    style.background.push(\"linear-gradient(to top right, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) calc(50% - \" +\n                                          cell.dBorders.size + \"px), \" + cell.dBorders.color + \" 50%, rgba(0, 0, 0, 0) calc(50% + \" +\n                                          cell.dBorders.size + \"px), rgba(0, 0, 0, 0) 100%)\");\n                }\n            }\n\n            if (background) {\n                style.background.push(background);\n            }\n\n            if (cell.color) {\n                style.color = cell.color;\n            }\n\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n\n            if (cell.underline) {\n                style.textDecoration = \"underline\";\n            }\n\n            if (cell.italic) {\n                style.fontStyle = \"italic\";\n            }\n\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n\n            if (cell.bold) {\n                style.fontWeight = \"bold\";\n            }\n\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + \"px\";\n            }\n\n            if (cell.wrap === true) {\n                style.whiteSpace = \"pre-wrap\";\n                style.overflowWrap = \"break-word\";\n                style.wordWrap = \"break-word\";\n            } else {\n                style.whiteSpace = \"pre\";\n                style.overflowWrap = \"normal\";\n                style.wordWrap = \"normal\";\n            }\n\n            style.left = (cell.left + 1) + \"px\";\n            style.top = (cell.top + 1) + \"px\";\n            style.width = (cell.width - 1) + \"px\";\n            style.height = (cell.height - 1) + \"px\";\n\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == \"number\" && data != Math.floor(data)) {\n                format = \"0.##############\";\n            }\n            if (format && data != null) { \n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                if(cell.html){\n                    data = kendo.dom.html(data);\n                } else {\n                    data = kendo.dom.text(data);\n                }\n            }\n\n            if (!style.textAlign) {\n                switch (type) {\n                  case \"number\":\n                  case \"date\":\n                  case \"percent\":\n                  case \"currency\":\n                    style.textAlign = \"right\";\n                    break;\n                  case \"boolean\":\n                    style.textAlign = \"center\";\n                    break;\n                }\n            }\n\n            // defined in print.js\n            kendo.spreadsheet.draw.applyIndent(cell, style);\n\n            var classNames = [ paneClassNames.cell ];\n\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push(\"k-disabled\");\n            }\n            if (cell.merged) {\n                classNames.push(\"k-spreadsheet-merged-cell\");\n            }\n            if (cell.comment) {\n                classNames.push(\"k-spreadsheet-has-comment\");\n            }\n\n            var verticalAlign = cell.verticalAlign || \"bottom\";\n\n            if (verticalAlign && data) {\n                data = kendo.dom.element(\"div\", { className: \"k-vertical-align-\" + verticalAlign }, [ maybeLink(data) ]);\n            } else {\n                data = maybeLink(data);\n            }\n\n            if (style.background.length) {\n                style.background = style.background.join(\",\");\n            } else {\n                delete style.background;\n            }\n\n            var children = data ? [ data ] : [];\n            var properties = {\n                style: style\n            };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n                classNames.push(\"k-dirty-cell\");\n\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(\" \");\n\n            var div = kendo.dom.element(\"div\", properties, children);\n            collection.push(div);\n            return div;\n        }\n\n        function addCell(table, row, cell) {\n            var style = {};\n\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n\n            if (cell.color) {\n                style.color = cell.color;\n            }\n\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n\n            if (cell.underline) {\n                style.textDecoration = \"underline\";\n            }\n\n            if (cell.italic) {\n                style.fontStyle = \"italic\";\n            }\n\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n\n            if (cell.verticalAlign) {\n                style.verticalAlign = (cell.verticalAlign === \"center\") ? \"middle\" : cell.verticalAlign;\n            }\n\n            if (cell.bold) {\n                style.fontWeight = \"bold\";\n            }\n\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + \"px\";\n            }\n\n            if (cell.wrap === true) {\n                style.whiteSpace = \"pre-wrap\";\n            }\n\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n\n            var data = cell.value, type = typeof data, format = cell.format;\n            if (!format && type == \"number\" && data != Math.floor(data)) {\n                format = \"0.##############\";\n            }\n            if (format && data != null) { \n                data = kendo.spreadsheet.formatting.format(data, format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n\n            if (!style.textAlign) {\n                switch (type) {\n                  case \"number\":\n                  case \"date\":\n                  case \"percent\":\n                  case \"currency\":\n                    style.textAlign = \"right\";\n                    break;\n                  case \"boolean\":\n                    style.textAlign = \"center\";\n                    break;\n                }\n            }\n\n            var className = null;\n\n            if (cell.enable === false) {\n                className = \"k-disabled\";\n            }\n\n            var td = table.addCell(row, data, style, className, cell.validation);\n\n            var border, sibling;\n\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n\n            return td;\n        }\n\n        var HtmlTable = kendo.Class.extend({\n            init: function() {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n\n            addColumn: function(width) {\n                this._width += width;\n\n                var col = kendo.dom.element(\"col\", { style: { width: width + \"px\" } });\n\n                col.visible = width > 0;\n\n                this.cols.push(col);\n            },\n\n            addRow: function(height) {\n                var attr = null;\n\n                attr = { style: { height: height + \"px\" } };\n\n                this._height += height;\n\n                var tr = kendo.dom.element(\"tr\", attr);\n\n                tr.visible = height > 0;\n\n                this.trs.push(tr);\n            },\n\n            addCell: function(rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = \"\";\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n\n                var children = [ text ];\n                var properties = { style: style };\n\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element(\"span\", { className: \"k-dirty\" }));\n\n                    className = (className || \"\") + (className ? \" \" : \"\") + \"k-dirty-cell\";\n                    properties.title = validation.message;\n                }\n\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element(\"td\", properties, children);\n\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n\n            toDomTree: function(x, y, className) {\n                this.trs = this.trs.filter(function(tr) {\n                    return tr.visible;\n                });\n\n                var offset = 0;\n                this.cols = this.cols.filter(function(col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function(tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n\n                    return col.visible;\n                }, this);\n\n                return kendo.dom.element(\"table\", {\n                    style: { left: x + \"px\", top: y + \"px\", height: this._height + \"px\", width: this._width + \"px\" },\n                    className: className,\n                    role: \"presentation\"\n                },[\n                    kendo.dom.element(\"colgroup\", null, this.cols),\n                    kendo.dom.element(\"tbody\", null, this.trs)\n                ]);\n            }\n        });\n\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=merge>#: messages.merge #</li>' +\n            '<li data-action=unmerge>#: messages.unmerge #</li>' +\n        '</ul>';\n\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-row\">#: messages.delete #</li>'+\n            '<li data-action=\"hide-row\">#: messages.hide #</li>'+\n            '<li data-action=\"unhide-row\">#: messages.unhide #</li>'+\n        '</ul>';\n\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' +\n            '<li data-action=cut>#: messages.cut #</li>' +\n            '<li data-action=copy>#: messages.copy #</li>' +\n            '<li data-action=paste>#: messages.paste #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-column\">#: messages.delete #</li>'+\n            '<li data-action=\"hide-column\">#: messages.hide #</li>'+\n            '<li data-action=\"unhide-column\">#: messages.unhide #</li>'+\n        '</ul>';\n\n        var DRAWING_CONTEXT_MENU = '<ul class=\"#=classNames.drawingContextMenu#\">' +\n            // '<li data-action=cut>#: messages.cut #</li>' +\n            // '<li data-action=copy>#: messages.copy #</li>' +\n            // '<li data-action=paste>#: messages.paste #</li>' +\n            // '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"bring-to-front\">#: messages.bringToFront #</li>' +\n            '<li data-action=\"send-to-back\">#: messages.sendToBack #</li>' +\n            '<li class=\"k-separator\"></li>' +\n            '<li data-action=\"delete-drawing\">#: messages.delete #</li>' +\n        '</ul>';\n\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' +\n            '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' +\n            CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU + DRAWING_CONTEXT_MENU\n        );\n\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n\n        var View = kendo.Class.extend({\n            init: function(element, options) {\n                var classNames = View.classNames;\n\n                this.element = element;\n\n                this.options = $.extend(true, {\n                    messages: kendo.spreadsheet.messages.view\n                }, this.options, options);\n\n                this._chrome();\n\n                this._dialogs = [];\n\n                element.append(VIEW_CONTENTS({\n                    classNames: classNames,\n                    messages: kendo.spreadsheet.messages.menus\n                }));\n\n                this._formulaInput();\n\n                this.wrapper =      element.find(DOT + classNames.view);\n                this.container =    element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller =     element.find(DOT + classNames.scroller)[0];\n                this.clipboard =    element.find(DOT + classNames.clipboard);\n\n                this.viewSize = $(this.scroller.firstChild);\n\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n\n                this._sheetsbar();\n\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: \"never\" // this is just an invalid event name to prevent the show\n                };\n\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n\n                this.drawingContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.drawingContextMenu), contextMenuConfig);\n            },\n\n            enableClipboard: function(enable) {\n                this.isClipboardDeactivated = !enable;\n\n                if (enable) {\n                    this.clipboard.attr(\"contenteditable\", enable);\n                } else {\n                    this.clipboard.removeAttr(\"contenteditable\");\n                }\n            },\n\n            _resize: function() {\n                var actionBar = $(this.formulaBar.element).parents(\".k-spreadsheet-action-bar\");\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = actionBar ? outerHeight(actionBar) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n\n                this.wrapper.height(\n                    this.element.height() -\n                        (tabstripHeight + formulaBarHeight + sheetsBarHeight)\n                );\n\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n\n            _chrome: function() {\n                var wrapper = $(\"<div class='k-spreadsheet-action-bar' />\").prependTo(this.element);\n\n                var nameEditor = $(\"<div class='k-spreadsheet-name-editor' />\").appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n\n                var formulaBar = $(\"<div />\").appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n\n            _formulaInput: function() {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, {\n                    autoScale: true\n                });\n            },\n\n            _sheetsbar: function() {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, {\n                        openDialog: this.openDialog.bind(this)\n                    }, this.options.sheetsbar);\n\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n\n            _tabstrip: function() {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, { home: true, insert: true, data: true }, this.options.toolbar);\n                var tabs = [];\n\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children(\".k-tabstrip\").remove();\n                }\n\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({ id: name, text: messages[name], content: \"\" });\n                    }\n                }\n\n                this.tabstrip = new kendo.spreadsheet.TabStrip($(\"<div />\").prependTo(this.element), {\n                    animation: false,\n                    dataTextField: \"text\",\n                    dataContentField: \"content\",\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n\n                this.tabstrip.select(0);\n            },\n\n            _executeCommand: function(e) {\n                this._sheet.trigger(\"commandRequest\", e);\n            },\n\n            workbook: function(workbook) {\n                this._workbook = workbook;\n                workbook._view = this;\n                this.nameEditor._workbook = workbook;\n            },\n\n            sheet: function(sheet) {\n                this._sheet = sheet;\n            },\n\n            activeCellRectangle: function() {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n\n            _rectangle: function(pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n\n            isColumnResizer: function(x, pane, col) {\n                // relative to content\n                x -= this._sheet._grid._headerWidth;\n\n                // add scroll if pane is not frozen\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                col = this._sheet._grid._columns.locate(0, col, function(w){\n                    return Math.abs(x - w) <= RESIZE_HANDLE_WIDTH/2;\n                });\n\n                return col !== null && !this._sheet.isHiddenColumn(col) ? col : null;\n            },\n\n            isRowResizer: function(y, pane, row) {\n                // relative to content\n                y -= this._sheet._grid._headerHeight;\n\n                // add scroll if pane is not frozen\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                row = this._sheet._grid._rows.locate(0, row, function(h){\n                    return Math.abs(y - h) <= RESIZE_HANDLE_WIDTH/2;\n                });\n\n                return row !== null && !this._sheet.isHiddenRow(row) ? row : null;\n            },\n\n            isFilterIcon: function(x, y, pane, ref) {\n                var self = this;\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : self.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : self.scroller.scrollLeft;\n\n                x -= self._sheet._grid._headerWidth - scrollLeft;\n                y -= self._sheet._grid._headerHeight - scrollTop;\n\n                return kendo.util.withExit(function(exit){\n                    self._sheet.forEachFilterHeader(ref, function(ref) {\n                        var rect = self._rectangle(pane, ref);\n                        if (pane.filterIconRect(rect).intersects(x, y)) {\n                            exit(true);\n                        }\n                    });\n                });\n            },\n\n            isAutoFill: function(x, y, pane) {\n                var selection = this._sheet.select();\n\n                if (selection.size > 1) {\n                    return false;\n                }\n\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                var rectangle = this._rectangle(pane, selection);\n\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n\n            isEditButton: function(x, y, pane) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var r = this.activeCellRectangle();\n                    // XXX: hard-coded button width (20)\n\n                    if (y >= r.top && y <= r.bottom) {\n                        return pane._editorInLastColumn ? x < r.left && x >= r.left - EDIT_BUTTON_WIDTH\n                            : x > r.right && x <= r.right + EDIT_BUTTON_WIDTH;\n                    }\n                }\n            },\n\n            drawingAt: function(x, y, pane) {\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n\n                var sheet = this._sheet;\n                var drawings = this._sheet._drawings;\n                for (var i = drawings.length; --i >= 0;) {\n                    var d = drawings[i];\n                    var box = sheet.drawingBoundingBox(d);\n                    if (box.intersects(x, y)) {\n                        return {\n                            drawing: d,\n\n                            // also include how far is the drawing's\n                            // top-left from the mouse position, as it's\n                            // not easy to compute some place else.\n                            drx: box.left - x,\n                            dry: box.top - y\n                        };\n                    }\n                }\n            },\n\n            objectAt: function(x, y, noDrawing) {\n                var grid = this._sheet._grid;\n                var object, pane;\n\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: \"outside\" };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: \"topcorner\" };\n                } else {\n                    pane = this.paneAt(x, y);\n\n                    if (!pane) {\n                        object = { type: \"outside\" };\n                    } else {\n                        if (!noDrawing) {\n                            var drawing = this.drawingAt(x, y, pane);\n                            if (drawing) {\n                                return {\n                                    type: \"drawing\",\n                                    drawing: drawing.drawing,\n                                    drx: drawing.drx,\n                                    dry: drawing.dry,\n                                    pane: pane,\n                                    startX: x,\n                                    startY: y\n                                };\n                            }\n                        }\n\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n\n                        var type = \"cell\";\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = \"autofill\";\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = \"filtericon\";\n                        } else if (!selecting && x < grid._headerWidth) {\n                            type = \"rowheader\";\n                            if ((row = this.isRowResizer(y, pane, row)) !== null) {\n                                ref = new CellRef(row, -Infinity);\n                                type = \"rowresizehandle\";\n                            }\n                        } else if (!selecting && y < grid._headerHeight) {\n                            type = \"columnheader\";\n                            if ((column = this.isColumnResizer(x, pane, column)) !== null) {\n                                ref = new CellRef(-Infinity, column);\n                                type = \"columnresizehandle\";\n                            }\n                        } else if (this.isEditButton(x, y, pane)) {\n                            type = \"editor\";\n                        }\n\n                        object = { type: type, ref: ref };\n                    }\n                }\n\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n\n            paneAt: function(x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n\n            containingPane: function(cell) {\n                return this.panes.filter(function(pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n\n            cellRectangle: function(cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n\n                return rectangle.offset(\n                    theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft),\n                    theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop)\n                );\n            },\n\n            refresh: function(reason) {\n                var sheet = this._sheet;\n\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n\n                this._resize();\n\n                //TODO: refresh sheets list on sheetSelection\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + \"px\";\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + \"px\";\n\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n\n                    // main or bottom or right pane\n                    this.panes = [ this._pane(frozenRows, frozenColumns) ];\n\n                    // left pane\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n\n                    // top pane\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n\n                    // left-top \"fixed\" pane\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n\n            createFilterMenu: function(column) {\n                this._destroyFilterMenu();\n\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $(\"<div />\").appendTo(this.element);\n                var options = { column: column, range: range };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n\n                this._filterMenu = filterMenu;\n\n                return filterMenu;\n            },\n\n            selectClipboardContents: function() {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n\n            scrollIntoView: function(cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n\n                var boundaries = theGrid.scrollBoundaries(cell);\n\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n\n                return willScroll;\n            },\n\n            _destroyDialog: function() {\n                this._dialogs.pop();\n            },\n\n            openCustomEditor: function() {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range      : range,\n                    rect       : self.activeCellRectangle(),\n                    view       : this,\n                    validation : this._sheet.validation(cell),\n                    callback   : function(value, parse){\n                        self._executeCommand({\n                            command: \"EditCommand\",\n                            options: {\n                                operatingRange: range,\n                                editRange: range,\n                                property: parse ? \"input\" : \"value\",\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n\n            openDialog: function(name, options) {\n                var sheet = this._sheet;\n                return sheet.withCultureDecimals(function(){\n                    var dialog = kendo.spreadsheet.dialogs.create(name, options);\n\n                    if (dialog) {\n                        dialog.bind(\"action\", this._executeCommand.bind(this));\n                        dialog.bind(\"deactivate\", this._destroyDialog.bind(this));\n                        this._dialogs.push(dialog);\n\n                        var ref = sheet.activeCell();\n                        var range = new kendo.spreadsheet.Range(ref, sheet);\n\n                        dialog.open(range);\n                        return dialog;\n                    }\n                }.bind(this));\n            },\n\n            showError: function(options, reopenEditor) {\n                var currentDialogs = this._dialogs;\n                var errorMessages = this.options.messages.errors;\n                var hasOpenedError = false;\n\n                if (currentDialogs.length > 0) {\n                    currentDialogs.forEach(function(dialog) {\n                        if (dialog.options && dialog.options.title === ERROR) {\n                            hasOpenedError = true;\n                        }\n                    });\n                }\n                if (hasOpenedError) {\n                    return;\n                }\n\n                var focusButton = function(e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find(\".k-button\").first().trigger(\"focus\");\n                    cont.find(\".k-button, input\").on(\"keydown\", function(ev){\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n\n                var onClose = function(e) {\n                    var dlg = e.sender;\n                    this.selectClipboardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = {\n                        close: onClose\n                    };\n\n                    if (options.type === \"validationError\") {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || \"Error\",\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog(\"message\", {\n                        title : options.title || \"Error\",\n                        text  : options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n\n            destroy: function() {\n                this._dialogs.forEach(function(dialog) {\n                    dialog.destroy();\n                });\n\n                if (this.cellContextMenu) {\n                    this.cellContextMenu.destroy();\n                }\n\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                this.drawingContextMenu.destroy();\n\n                this.cellContextMenu = this.rowHeaderContextMenu =\n                                       this.colHeaderContextMenu =\n                                       this.drawingContextMenu = null;\n\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.tabstrip = null;\n                }\n\n                this._destroyFilterMenu();\n            },\n\n            _destroyFilterMenu: function() {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n\n            render: function(reason) {\n                if (!this.element.is(\":visible\")) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                var scrollbarSize = kendo.support.scrollbar();\n                var contentWidth = this.wrapper[0].clientWidth - scrollbarSize;\n                var contentHeight = this.wrapper[0].clientHeight - scrollbarSize;\n\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n\n                var resizeDirection =\n                    !sheet.resizingInProgress() ? \"none\" :\n                    sheet.resizeHandlePosition().col === -Infinity ? \"column\" :\n                    \"row\";\n\n                this.wrapper\n                    .toggleClass(viewClassNames.editContainer, this.editor.isActive())\n                    .toggleClass(viewClassNames.horizontalResize, resizeDirection == \"row\")\n                    .toggleClass(viewClassNames.verticalResize, resizeDirection == \"column\");\n\n                var grid = sheet._grid;\n                var content = [];\n                var args = {\n                    scroller: this.scroller,\n                    toplevelElements: content,\n                    contentWidth: contentWidth,\n                    contentHeight: contentHeight\n                };\n                this.panes.forEach(function(pane) {\n                    content.push(pane.render(args));\n                });\n\n                var topCorner = kendo.dom.element(\"div\", {\n                    style: { width: grid._headerWidth + \"px\", height: grid._headerHeight + \"px\" },\n                    className: View.classNames.topCorner\n                });\n\n                content.push(topCorner);\n\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    content.push(this.renderResizeHint());\n                }\n\n                this.tree.render(content);\n\n                $(this.container).css({\n                    width: contentWidth,\n                    height: contentHeight\n                });\n\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!(reason.resize ||\n                             reason.comment ||\n                             sheet.selectionInProgress() ||\n                             sheet.resizingInProgress() ||\n                             sheet.draggingInProgress() ||\n                             sheet.isInEditMode())) {\n                    this.renderClipboardContents();\n                }\n            },\n\n            // this renders the big blue line during resizing\n            renderResizeHint: function() {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n\n                var horizontal = ref.col !== -Infinity;\n\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + \"px\",\n                        width: RESIZE_HANDLE_WIDTH + \"px\",\n                        left: sheet.resizeHintPosition().x + \"px\",\n                        top: \"0px\"\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + \"px\",\n                        width: this.scroller.clientWidth + \"px\",\n                        top: sheet.resizeHintPosition().y + \"px\",\n                        left: \"0px\"\n                    };\n                }\n\n                var classNames = Pane.classNames;\n\n                return kendo.dom.element(\"div\", {\n                    className: classNames.resizeHint + (!horizontal ? \" \" + classNames.resizeHintVertical : \"\"),\n                    style: style\n                },[\n                    kendo.dom.element(\"div\", { className: classNames.resizeHintHandle }),\n                    kendo.dom.element(\"div\", { className: classNames.resizeHintMarker })\n                ]);\n            },\n\n            renderClipboardContents: function() {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n\n                // if (sheet._activeDrawing && sheet._activeDrawing.image) {\n                //     var url = this._workbook.imageUrl(sheet._activeDrawing.image);\n                //     var img = kendo.dom.element(\"img\", {\n                //         src: url,\n                //         style: {\n                //             width: sheet._activeDrawing.width + \"px\",\n                //             height: sheet._activeDrawing.height + \"px\"\n                //         }\n                //     });\n                //     this.clipboardContents.render([ img ]);\n                //     this.selectClipboardContents();\n                //     return;\n                // }\n\n                var selection = grid.normalize(sheet.select().toRangeRef());\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipboardContents();\n                    return;\n                }\n\n                selection = sheet.trim(selection);\n\n                var table = new HtmlTable();\n\n                var selectionView = grid.rangeDimensions(selection);\n\n                selectionView.rows.forEach(function(height) {\n                    table.addRow(height);\n                });\n\n                selectionView.columns.forEach(function(width) {\n                    table.addColumn(width);\n                });\n\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n\n                sheet.forEach(selection, function(row, col, cell) {\n                    var location = new CellRef(row, col).print();\n\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n\n                        var mergedCell = primaryMergedCells[location];\n\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n\n                if (kendo.support.browser.msie) {\n                    this.clipboard.empty();\n                }\n\n                this.clipboardContents.render([ table.toDomTree(0, 0, \"kendo-clipboard-\" + this._workbook.clipboard()._uid) ]);\n\n                this.selectClipboardContents();\n            },\n\n            _pane: function(row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({ row: row, column: column, rowCount: rowCount, columnCount: columnCount }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n\n        var paneClassNames = {\n            cell: \"k-spreadsheet-cell\",\n            vaxis: \"k-spreadsheet-vaxis\",\n            haxis: \"k-spreadsheet-haxis\",\n            vborder: \"k-spreadsheet-vborder\",\n            hborder: \"k-spreadsheet-hborder\",\n            rowHeader: \"k-spreadsheet-row-header\",\n            columnHeader: \"k-spreadsheet-column-header\",\n            pane: \"k-spreadsheet-pane\",\n            data: \"k-spreadsheet-data\",\n            mergedCell: \"k-spreadsheet-merged-cell\",\n            mergedCellsWrapper: \"k-merged-cells-wrapper\",\n            activeCell: \"k-spreadsheet-active-cell\",\n            selection: \"k-spreadsheet-selection\",\n            selectionWrapper: \"k-selection-wrapper\",\n            autoFillWrapper: \"k-auto-fill-wrapper\",\n            single: \"k-single\",\n            top: \"k-top\",\n            right: \"k-right\",\n            bottom: \"k-bottom\",\n            left: \"k-left\",\n            resizeHandle: \"k-resize-handle\",\n            columnResizeHandle: \"k-column-resize-handle\",\n            rowResizeHandle: \"k-row-resize-handle\",\n            resizeHint: \"k-resize-hint\",\n            resizeHintHandle: \"k-resize-hint-handle\",\n            resizeHintMarker: \"k-resize-hint-marker\",\n            resizeHintVertical: \"k-resize-hint-vertical\",\n            selectionHighlight: \"k-spreadsheet-selection-highlight\",\n            series: [\n                \"k-series-a\",\n                \"k-series-b\",\n                \"k-series-c\",\n                \"k-series-d\",\n                \"k-series-e\",\n                \"k-series-f\"\n            ]\n        };\n\n        var Pane = kendo.Class.extend({\n            init: function(sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n\n            refresh: function(width, height) {\n                this._grid.refresh(width, height);\n            },\n\n            isVisible: function(scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n\n            render: function(args) {\n                var scroller = args.scroller;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n\n                var children = [];\n\n                children.push(this.renderData(args));\n\n                if (!sheet._activeDrawing) {\n                    children.push(this.renderSelection(scroller));\n                }\n\n                children.push(this.renderAutoFill());\n\n                children.push(this.renderEditorSelection());\n\n                children.push(this.renderFilterHeaders());\n\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element(\"div\", {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + \"px\",\n                            top: view.rowOffset + \"px\"\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function(row){\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element(\"div\", {\n                                className: this.headerClassName(row, \"row\"),\n                                style: {\n                                    width: grid.headerWidth + \"px\",\n                                    height: height + \"px\"\n                                }\n                            }, [ kendo.dom.element(\"div\", {\n                                className: \"k-vertical-align-center\"\n                            }, [ kendo.dom.text(text+\"\") ])]));\n                        }\n                    }.bind(this));\n                }\n\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element(\"div\", {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: \"0px\",\n                            left: view.columnOffset + \"px\",\n                            width: this._currentRect.width + \"px\",\n                            height: grid.headerHeight + \"px\"\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function(row, col){\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col),\n                                width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element(\"div\", {\n                                className: this.headerClassName(col, \"col\"),\n                                style: {\n                                    position: \"absolute\",\n                                    left: left + \"px\",\n                                    width: width + \"px\",\n                                    height: grid.headerHeight + \"px\"\n                                }\n                            }, [ kendo.dom.element(\"div\", {\n                                className: \"k-vertical-align-center\"\n                            }, [ kendo.dom.text(text+\"\") ])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    if (!sheet.resizeHintPosition()) {\n                        this.renderResizeHandle(children);\n                    }\n                }\n\n                var paneClasses = [classNames.pane];\n\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n\n                return kendo.dom.element(\"div\", {\n                    style: grid.style,\n                    className: paneClasses.join(\" \")\n                }, children);\n            },\n\n            headerClassName: function(index, type) {\n                var selectedHeaders = this._selectedHeaders;\n\n                var itemSelection;\n                var allHeaders;\n\n                if (type === \"row\") {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n\n                var className = itemSelection || (selectedHeaders.all ? \"full\" : (allHeaders ? \"partial\" : \"none\"));\n\n                if (className) {\n                    className = \"k-selection-\" + className;\n                }\n\n                return className;\n            },\n\n            renderData: function(args) {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element(\"div\", {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: \"relative\",\n                        left: view.columnOffset + \"px\",\n                        top: view.rowOffset + \"px\"\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var grid = this._grid;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    // draw axis first\n                    prev = null;\n                    layout.xCoords.forEach(function(x){\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + \"px\",\n                                    height: rect.height + \"px\",\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function(y){\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + \"px\",\n                                    width: rect.width + \"px\",\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                var activeCellRange = sheet.activeCell().toRangeRef();\n                var activeCell = activeCellRange.topLeft;\n\n                layout.cells.forEach(function(cell){\n                    var cls = null;\n                    var absRow = cell.row + view.ref.topLeft.row;\n                    var absCol = cell.col + view.ref.topLeft.col;\n                    if (sheet._activeDrawing) {\n                        var ref = sheet._activeDrawing.topLeftCell;\n                        if (ref && ref.row == absRow && ref.col == absCol) {\n                            cls = \"k-spreadsheet-drawing-anchor-cell\";\n                        }\n                    } else if (absRow == activeCell.row && absCol == activeCell.col) {\n                        // active cell.  normally we enter here only once.\n                        cls = [\n                            Pane.classNames.activeCell\n                        ].concat(this._activeFormulaColor(),\n                                 this._directionClasses(activeCellRange));\n                        if (sheet.singleCellSelection()) {\n                            cls.push(Pane.classNames.single);\n                        }\n                        cls = cls.join(\" \");\n                    }\n                    borders.add(cell);\n                    drawCell(cont.children, cell, cls, showGridLines);\n                    if (cell.comment && sheet._commentRef &&\n                        absRow == sheet._commentRef.row && absCol == sheet._commentRef.col) {\n                        var ttOffset = 4;\n                        var left = cell.right + grid.left + view.columnOffset + ttOffset;\n                        var style = { top: (cell.top + grid.top + view.rowOffset) + \"px\" };\n                        if (left + 200 > args.contentWidth) {\n                            style.right = (args.contentWidth - grid.left - cell.left - view.columnOffset + ttOffset) + \"px\";\n                        } else {\n                            style.left = left + \"px\";\n                        }\n                        var div = kendo.dom.element(\"div\", {\n                            className: \"k-tooltip k-spreadsheet-cell-comment\",\n                            style: style\n                        }, [ kendo.dom.text(cell.comment) ]);\n                        args.toplevelElements.push(div);\n                    }\n                }, this);\n                borders.vert.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left        : b.x + \"px\",\n                                top         : b.top + \"px\",\n                                height      : (b.bottom - b.top + 1) + \"px\",\n                                borderWidth : b.size + \"px\",\n                                borderColor : b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = \"translateX(-\" + (b.size-1)/2 + \"px)\";\n                            }\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function(a){\n                    a.forEach(function(b){\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top         : b.y + \"px\",\n                                left        : b.left + \"px\",\n                                width       : (b.right - b.left) + \"px\",\n                                borderWidth : b.size + \"px\",\n                                borderColor : b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = \"translateY(-\" + (b.size-1)/2 + \"px)\";\n                            }\n                            cont.children.push(kendo.dom.element(\"div\", {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                this.renderDrawings(layout, cont.children);\n                return cont;\n            },\n\n            renderDrawings: function(layout, container) {\n                var sheet = this._sheet;\n                var workbook = sheet._workbook;\n                layout.drawings.forEach(function(d){\n                    var drawing = d.drawing;\n                    var box = d.box;\n                    var div = box.toDiv(\"k-spreadsheet-drawing\");\n                    if (drawing.image) {\n                        div.children.push(kendo.dom.element(\"div\", {\n                            className: \"k-spreadsheet-drawing-image\",\n                            style: {\n                                backgroundImage: \"url('\" + workbook.imageUrl(drawing.image) + \"')\",\n                                opacity: drawing.opacity\n                            }\n                        }));\n                    }\n                    if (drawing === sheet._activeDrawing) {\n                        div.attr.className += \" k-spreadsheet-active-drawing\";\n                        drawingResizeHandles(div.children);\n                    }\n                    container.push(div);\n                });\n            },\n\n            renderResizeHandle: function(container) {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [ Pane.classNames.resizeHandle ];\n\n                var style;\n                if (ref.col !== -Infinity) {\n                    if (this._grid.rows._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: this._grid.headerHeight + \"px\",\n                        width: RESIZE_HANDLE_WIDTH + \"px\",\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                        top: \"0px\"\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    if (this._grid.columns._start > 0) {\n                        return;\n                    }\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + \"px\",\n                        width:  this._grid.headerWidth + \"px\",\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH/2  + \"px\",\n                        left: \"0px\"\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n\n                container.push(kendo.dom.element(\"div\", {\n                    className: classNames.join(\" \"),\n                    style: style\n                }));\n            },\n\n            filterIconRect: function(rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n\n                return new kendo.spreadsheet.Rectangle(\n                    rect.right - BUTTON_SIZE - BUTTON_OFFSET,\n                    rect.top + BUTTON_OFFSET,\n                    BUTTON_SIZE,\n                    BUTTON_SIZE\n                );\n            },\n\n            renderFilterHeaders: function() {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n\n                function icon(className) {\n                    return kendo.dom.element(\"span\", {\n                        className: classNames.icon + \" \" + className\n                    });\n                }\n\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + \"px\",\n                        top: position.top + \"px\"\n                    };\n                    var filtered = filter && filter.columns.some(function(c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n\n                    if (filtered) {\n                        classes += \" \" + classNames.filterButtonSelected;\n                    }\n\n                    var button = kendo.dom.element(\n                        \"span\",\n                        { className: classes, style: style },\n                        [ icon(classNames.iconFilterDefault) ]\n                    );\n\n                    return button;\n                }\n\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n\n                sheet.forEachFilterHeader(this._currentView.ref, function(ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n\n                    children.push(button);\n                }.bind(this));\n\n                return kendo.dom.element(\"div\", {\n                    className: classNames.filterHeadersWrapper\n                }, children);\n\n            },\n\n            renderEditorSelection: function() {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n\n                sheet._formulaSelections.forEach(function(range) {\n                    var ref = range.ref;\n\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n\n                    this._addDiv(selections, ref, classNames.selectionHighlight + \" \" + range.colorClass);\n                }.bind(this));\n\n                return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n\n            },\n\n            renderSelection: function(scroller) {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var selection = sheet.select();\n\n                selectionClasses = selectionClasses.concat(this._activeFormulaColor());\n\n                if (selection.size() === 1) {\n                    selectionClasses.push(\"k-single-selection\");\n                }\n\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push(\"k-dim-auto-fill-handle\");\n                }\n\n                selection.forEach(function(ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(\" \"));\n                    }\n                }.bind(this));\n\n                this._renderCustomEditorButton(selections, activeCell, scroller);\n\n                return kendo.dom.element(\"div\", { className: classNames.selectionWrapper }, selections);\n            },\n\n            renderAutoFill: function() {\n                var autoFillRectangle = [];\n\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n\n                    this._addDiv(autoFillRectangle, autoFillRef, \"k-auto-fill\");\n\n                    if (punch) { // collapsing, add overlay\n                        this._addDiv(autoFillRectangle, punch, \"k-auto-fill-punch\");\n                    } else if (direction !== undefined) { // expanding - add hint\n                        var ref, cssClass;\n\n                        switch(direction) {\n                            case 0:\n                                ref = autoFillRef.bottomRight;\n                                cssClass = \"k-auto-fill-br-hint\";\n                                break;\n                            case 1:\n                                ref = autoFillRef.bottomRight;\n                                cssClass = \"k-auto-fill-br-hint\";\n                                break;\n                            case 2:\n                                ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                                cssClass = \"k-auto-fill-tr-hint\";\n                                break;\n                            case 3:\n                                ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                                cssClass = \"k-auto-fill-bl-hint\";\n                                break;\n                        }\n\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            var hint = kendo.dom.element(\"span\", { className: \"k-tooltip\" }, [ kendo.dom.text(this._sheet._autoFillHint) ]);\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n\n                return kendo.dom.element(\"div\", { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n\n            _addDiv: function(collection, ref, className) {\n                var view = this._currentView, div;\n\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n\n            _renderCustomEditorButton: function(collection, ref, scroller) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                var ed = sheet.activeCellCustomEditor();\n\n                if (ed && view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    sheet.forEach(ref.collapse(), function(row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n\n                        var btnClass = \"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button\";\n                        var isLastColumn = col == columnCount - 1 || self._buttonOutOfVisiblePane(row, col, scroller);\n                        if (isLastColumn) {\n                            btnClass += \" k-spreadsheet-last-column\";\n                        }\n                        self._editorInLastColumn = isLastColumn;\n                        var btn = kendo.dom.element(\"div\", {\n                            className: btnClass,\n                            style: {\n                                left   : (cell.left + (isLastColumn ? 0 : cell.width)) + \"px\",\n                                top    : cell.top + \"px\",\n                                height : cell.height + \"px\"\n                            }\n                        });\n                        if (ed.icon) {\n                            btn.children.push(kendo.dom.element(\"span\", {\n                                className: \"k-icon \" + ed.icon\n                            }));\n                        }\n                        collection.push(btn);\n                    });\n                }\n            },\n\n            _activeFormulaColor: function() {\n                var activeFormulaSelection;\n                var colorClasses = [];\n\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function(sel) { return sel.active && sel.type == \"ref\"; })[0];\n\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n\n                return colorClasses;\n            },\n\n            _directionClasses: function(cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n\n                return cellClasses;\n            },\n\n            _rectangle: function(ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            },\n\n            _buttonOutOfVisiblePane: function(row, col, scroller) {\n                var self = this;\n                var theGrid = self._grid;\n                var sheet = self._sheet;\n                var ref = sheet.range(row, col)._ref;\n                var boundaries = theGrid.scrollBoundaries(ref);\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n\n                if (boundaries.right + EDIT_BUTTON_WIDTH > scrollLeft || col + 1 === sheet.frozenColumns()) {\n                    return true;\n                }\n            }\n        });\n\n        function drawingResizeHandles(container) {\n            [ \"N\", \"NE\", \"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\" ].forEach(function(direction) {\n                container.push(kendo.dom.element(\"div\", {\n                    \"className\": \"k-spreadsheet-drawing-handle \" + direction,\n                    \"data-direction\": direction\n                }));\n            });\n        }\n\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n        \"use strict\";\n\n        \n\n        var $ = kendo.jQuery;\n\n        var EDITORS = {};\n\n        var registerEditor = kendo.spreadsheet.registerEditor = function(name, editor) {\n            EDITORS[name] = editor;\n        };\n\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function() {\n            var cell = this.activeCell().first();\n\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get(\"editor\", this._grid.cellRefIndex(cell));\n                var editor;\n\n                if (key != null) {\n                    editor = EDITORS[key];\n                }\n                else if (val && val.showButton) {\n                    key = \"_validation_\" + val.dataType;\n                    editor = EDITORS[key];\n                }\n\n                if (typeof editor == \"function\") {\n                    editor = EDITORS[key] = editor();\n                }\n\n                return editor;\n            }\n        };\n\n        registerEditor(\"_validation_date\", function(){\n            var context, calendar, popup;\n\n            function create() {\n                if (!calendar) {\n                    calendar = $(\"<div>\").kendoCalendar();\n                    popup = $(\"<div>\").kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n\n                    calendar.bind(\"change\", function(){\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format(\"yyyy-mm-dd\");\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.find(\".k-spreadsheet-editor-button\")\n                });\n            }\n\n            function open() {\n                create();\n\n                var date = context.range.value();\n                var sheet = context.range.sheet();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    var fromValidation = val.from;\n                    var toValidation = val.to;\n                    var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                        }\n                    }\n                    if (val.comparerType == \"between\") {\n                        if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.to.value);\n                        }\n                    }\n                    if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                        if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                        } else {\n                            max = kendo.spreadsheet.numberToDate(val.from.value);\n                        }\n                    }\n                    calendar.setOptions({\n                        disableDates: function(date) {\n                            var from, to;\n\n                            if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                                from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                            } else {\n                                from = fromValidation ? fromValidation.value|0 : 0;\n                            }\n\n                            if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                                to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                            } else {\n                                to = toValidation ? toValidation.value|0 : 0;\n                            }\n\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation\n                                .validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({ disableDates: null, min: null, max: null });\n                }\n                popup.open();\n            }\n\n            function _rowAndColPresent(value) {\n                return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n            }\n\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"k-i-calendar\"\n            };\n        });\n\n        registerEditor(\"_validation_list\", function(){\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                        template   : \"#:value#\",\n                        selectable : true,\n                        autoBind   : false\n                    });\n                    popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n\n                    list.bind(\"change\", function(){\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({\n                    anchor: context.view.element.find(\".k-spreadsheet-editor-button\")\n                });\n            }\n            function open() {\n                create();\n                var items = context.validation.from.value;\n                var data = [], add = function(el){ data.push({ value: el }); };\n                if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                    items.each(add);\n                } else {\n                    // actually Excel expects a simple string for list\n                    // validation (comma-separated labels).\n                    (items+\"\").split(/\\s*,\\s*/).forEach(add);\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function(options) {\n                    context = options;\n                    open();\n                },\n                icon: \"k-i-arrow-60-down\"\n            };\n        });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n        \n\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n\n        var Rectangle = kendo.Class.extend({\n            init: function Rectangle(left, top, width, height) {\n                this.left = left;\n                this.top = top;\n                this.width = width;\n                this.height = height;\n                this.right = this.left + this.width;\n                this.bottom = this.top + this.height;\n            },\n\n            offset: function(left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n\n            resize: function(width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n\n            intersects: function(x, y) {\n                if (x instanceof Rectangle) {\n                    return this.intersectsRect(x);\n                }\n                return this.left < x && x < this.left + this.width &&\n                       this.top < y && y < this.top + this.height;\n            },\n\n            intersectsRect: function(b) {\n                var a = this;\n                return a.left <= b.right\n                    && b.left <= a.right\n                    && a.top <= b.bottom\n                    && b.top <= a.bottom;\n            },\n\n            toDiv: function(className) {\n                return kendo.dom.element(\"div\", {\n                    className: className,\n                    style: {\n                        width:  this.width + \"px\",\n                        height: this.height + \"px\",\n                        top:    this.top + \"px\",\n                        left:   this.left + \"px\"\n                    }\n                });\n            }\n        });\n\n        // XXX: can we use ES5 yet? :-/\n        //\n        // Object.defineProperty(Rectangle.prototype, \"right\", {\n        //     get() {\n        //         return this.left + this.width;\n        //     }\n        // });\n        // Object.defineProperty(Rectangle.prototype, \"bottom\", {\n        //     get() {\n        //         return this.top + this.height;\n        //     }\n        // });\n\n        var Grid = kendo.Class.extend({\n            init: function(rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n\n            _resize: function(new_rows, new_cols) {\n                this.rowCount = new_rows;\n                this.columnCount = new_cols;\n            },\n\n            isAxis: function(ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return (topLeft.row === 0 && bottomRight.row === this.rowCount - 1) || (topLeft.col === 0 && bottomRight.col === this.columnCount - 1);\n            },\n\n            width: function(start, end) {\n                return this._columns.sum(start, end);\n            },\n\n            height: function(start, end) {\n                return this._rows.sum(start, end);\n            },\n\n            totalHeight: function() {\n                return this._rows.total + this._headerHeight;\n            },\n\n            totalWidth: function() {\n                return this._columns.total + this._headerWidth;\n            },\n\n            index: function(row, column) {\n                return column * this.rowCount + row;\n            },\n\n            cellRef: function(index) {\n                return new CellRef(index % this.rowCount, (index / this.rowCount) >> 0);\n            },\n\n            rowRef: function(row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n\n            colRef: function(col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n\n            cellRefIndex: function(ref) {\n                return this.index(ref.row, ref.col);\n            },\n\n            normalize: function(ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(\n                        this.normalize(ref.topLeft),\n                        this.normalize(ref.bottomRight)\n                    ).setSheet(ref.sheet, ref.hasSheet());\n                }\n\n                if (ref instanceof UnionRef) {\n                    return ref.map(function(ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n\n                return ref;\n            },\n\n            rectangle: function(ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(\n                    this.width(0, topLeft.col - 1),\n                    this.height(0, topLeft.row - 1),\n                    this.width(topLeft.col, bottomRight.col),\n                    this.height(topLeft.row, bottomRight.row)\n                );\n            },\n\n            pane: function(options) {\n                return new PaneGrid(\n                    new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight),\n                    new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth),\n                    this\n                );\n            },\n\n            rangeDimensions: function(rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n\n            forEach: function(ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri ++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n\n            trim: function(ref, property) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci ++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if(values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n\n        var PaneGrid = kendo.Class.extend({\n            init: function(rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n\n            refresh: function(width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n\n                this.style = {\n                    top: y.offset  + \"px\",\n                    left: x.offset + \"px\",\n                    height: y.length + \"px\",\n                    width: x.length + \"px\"\n                };\n            },\n\n            view: function(left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n\n                return {\n                    rows: rows,\n                    columns: columns,\n\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n\n                    ref: new RangeRef(\n                        new CellRef(rows.values.start, columns.values.start),\n                        new CellRef(rows.values.end, columns.values.end)\n                    )\n                };\n            },\n\n            contains: function(ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) &&\n                    this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n\n            index: function(row, column) {\n                return this._grid.index(row, column);\n            },\n\n            boundingRectangle: function(ref) {\n                return this._grid.rectangle(ref);\n            },\n\n            cellRefIndex: function(ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n\n            scrollBoundaries: function(cell) {\n                var position = this.boundingRectangle(cell);\n\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    })(kendo);\n\n    (function(kendo) {\n\n        var Axis = kendo.Class.extend({\n            init: function(count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n\n            _resize: function(count) {\n                if (count > this._count) {\n                    this.values.value(this._count, count - 1, this._value);\n                    this._hidden.value(this._count, count - 1, 0);\n                } else if (count < this._count) {\n                    this.values.value(count, this._count - 1, 0);\n                    this._hidden.value(count, this._count - 1, 0);\n                }\n                this._count = count;\n                this._refresh();\n            },\n\n            adjust: function(start, delta) {\n                // adjust this axis for insert/remove rows/cols operation\n                if (delta < 0) {\n                    // removing -- copy from start+|delta| to start\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    // adding -- copy from start to start+delta, and set\n                    // values for inserted things to default.\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n\n            toJSON: function(field, positions) {\n                var values = [];\n\n                var iterator = this.values.iterator(0, this._count - 1);\n\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n\n                    var position = positions[idx];\n\n                    if (position === undefined) {\n                        position = values.length;\n\n                        var item = { index: idx };\n\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n\n                        values.push(item);\n\n                        positions[idx] = position;\n                    }\n                }\n\n                return values;\n            },\n\n            fromJSON: function(field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n\n                    // when this particular axis is hidden, the value for\n                    // the field (\"height\" or \"width\") will be zero, and\n                    // in the \"hidden\" field we'll have the actual value\n                    // before it was hidden.\n                    // https://github.com/telerik/kendo-ui-core/issues/3523\n                    var value = el[field];\n\n                    if (value === 0) {\n                        this._hidden.value(index, index, el.hidden || this._value);\n                        this.value(index, index, 0);\n                    } else {\n                        this.value(index, index, value);\n                    }\n                }\n            },\n\n            hide: function(index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n\n            hidden: function(index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n\n            includesHidden: function(start, end) {\n                 return this._hidden.intersecting(start, end).length > 1;\n            },\n\n            nextVisible: function(index) {\n                var end = this._count - 1, i = index;\n                while (++i <= end) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n\n            nextUntil: function(index, pred) {\n                var end = this._count - 1, i = index, advanced = false;\n                while (++i <= end) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == \"number\") {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i - 1;\n            },\n\n            nextPage: function(index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n\n            prevPage: function(index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n\n            firstVisible: function() {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n\n            lastVisible: function() {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n\n            prevVisible: function(index) {\n                var i = index;\n                while (--i >= 0) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n\n            prevUntil: function(index, pred) {\n                var i = index, advanced = false;\n                while (--i >= 0) {\n                    var val = pred(i, advanced, this.hidden(i));\n                    if (typeof val == \"number\") {\n                        return val;\n                    } else if (val) {\n                        break;\n                    }\n                    advanced = true;\n                }\n                return i + 1;\n            },\n\n            unhide: function(index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n\n            value: function(start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n\n            sum: function(start, end) {\n                var values = this.values.iterator(start, end);\n\n                var sum = 0;\n\n                for (var idx = start; idx <= end; idx ++) {\n                    sum += values.at(idx);\n                }\n\n                return sum;\n            },\n\n            locate: function(start, end, predicate) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                    var val = predicate(sum);\n                    if (val) {\n                        return idx;\n                    }\n                }\n                return null;\n            },\n\n            visible: function(start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n\n                var ranges = this._pixelValues.intersecting(start, end);\n\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n\n                if (!startSegment) {\n                    return { values: this.values.iterator(0, 0), offset: 0 };\n                }\n\n                var startOffset = start - startSegment.start;\n\n                var startIndex = ((startOffset / startSegment.value.value) >> 0) + startSegment.value.start;\n\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n\n                var endOffset = end - endSegment.start;\n                var endIndex = ((endOffset / endSegment.value.value) >> 0) + endSegment.value.start;\n\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n\n                offset = Math.min(-offset, 0);\n\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n\n            index: function(value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n\n                return index;\n            },\n\n            indexVisible: function(value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n\n            _refresh: function() {\n                var current = 0;\n                this._pixelValues = this.values.map(function(range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n\n            getState: function() {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState(),\n                    count: this._count\n                };\n            },\n\n            setState: function(state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                var nowCount = this._count;\n                if (nowCount > state.count) {\n                    this._count = state.count;\n                    this._resize(nowCount); // calls _refresh too\n                } else {\n                    this._refresh();\n                }\n            }\n        });\n\n        var PaneAxis = kendo.Class.extend({\n            init: function(axis, start, count, headerSize) {\n               this._axis = axis;\n               this._start = start;\n               this._count = count;\n               this.hasHeader = start === 0;\n               this.headerSize = headerSize;\n               this.defaultValue = axis._value;\n               this.frozen = count > 0;\n            },\n\n            viewSize: function(viewSize) {\n                this._viewSize = viewSize;\n            },\n\n            sum: function(start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n\n            start: function() {\n                return this.sum(0, this._start);\n            },\n\n            size: function() {\n                return this.sum(this._start, this._start + this._count);\n            },\n\n            index: function(value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n\n            indexVisible: function(value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n\n            //XXX: rename this method\n            paneSegment: function() {\n                var offset = this.start();\n                var length;\n\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n\n            visible: function(offset) {\n                var start = this.start();\n                var size;\n\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n\n                var result = this._axis.visible(start, start + size - 1);\n\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n\n                result.start = start;\n\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n\n                return result;\n            },\n\n            contains: function(start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n\n    })(kendo);\n\n    (function(kendo) {\n\n\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function() {\n            },\n            value: function(cell) {\n                return cell.value;\n            },\n            matches: function() {\n                throw new Error(\"The 'matches' method is not implemented.\");\n            },\n            toJSON: function() {\n                throw new Error(\"The 'toJSON' method is not implemented.\");\n            }\n        });\n\n        Filter.create = function(options) {\n            var filter = options.filter;\n\n            if (!filter) {\n                throw new Error(\"Filter type not specified.\");\n            }\n\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + \"Filter\"];\n\n            if (!constructor) {\n                throw new Error(\"Filter type not recognized.\");\n            }\n\n            return new constructor(options);\n        };\n\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n\n            _dates: [],\n\n            _blanks: false,\n\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n\n            value: function(cell) {\n                var value = cell.value;\n\n                if (this._dates.length > 0 && cell.format && typeof value === \"number\") {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                    if (type === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n\n                return value;\n            },\n\n            matches: function(value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n\n                if (value instanceof Date) {\n                    return this._dates.some(function(date) {\n                        return date.year === value.getFullYear() &&\n                            (date.month === undefined || date.month === value.getMonth()) &&\n                            (date.day === undefined || date.day === value.getDate()) &&\n                            (date.hours === undefined || date.hours === value.getHours()) &&\n                            (date.minutes === undefined || date.minutes === value.getMinutes()) &&\n                            (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"value\",\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: \"and\",\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n\n                if (options.criteria === undefined) {\n                    throw new Error(\"Must specify criteria.\");\n                }\n\n                this._criteria = options.criteria;\n\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria,\n                    accentFoldingFiltering: kendo.culture().name\n                }).expression;\n\n                this._matches = new Function(\"d\", \"return \" + expression);\n            },\n            matches: function(value) {\n                if (value === null) {\n                    return false;\n                }\n\n                return this._matches(value);\n            },\n            value: function(cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? \"date\" : typeof criterionValue;\n                var valueType = typeof value;\n\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n\n                if (valueType != criterionType) {\n                    if (criterionType == \"string\") {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + \"\";\n                    }\n                } else if (valueType == \"date\") {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n\n                return value;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"custom\",\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n\n            prepare: function(cells) {\n                var values = cells.map(this.value)\n                .sort()\n                .filter(function(value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n\n                if (this._type === \"topNumber\" || this._type == \"topPercent\") {\n                    values.sort(function(x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function(x, y) {\n                        return x - y;\n                    });\n                }\n\n                var count = this._value;\n\n                if (this._type === \"topPercent\" || this._type === \"bottomPercent\") {\n                    count = (values.length * count / 100) >> 0;\n                }\n\n                this._values = values.slice(0, count);\n            },\n            matches: function(value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"top\",\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n\n                this._predicate = this[options.type];\n\n                if (typeof this._predicate !== \"function\") {\n                    throw new Error(\"DynamicFilter type '\" + options.type + \"' not recognized.\");\n                }\n            },\n            value: function(cell) {\n                var value = cell.value;\n\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n\n                    if (type === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n\n                return value;\n            },\n            prepare: function(cells) {\n                var sum = 0;\n                var count = 0;\n\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n\n                    if (typeof value === \"number\") {\n                        sum += value;\n                        count ++;\n                    }\n                }\n\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function(value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function(value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n\n                if (typeof value !== \"number\") {\n                    return false;\n                }\n\n                return value > this._average;\n            },\n            belowAverage: function(value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n\n                if (typeof value !== \"number\") {\n                    return false;\n                }\n\n                return value < this._average;\n            },\n            tomorrow: function(value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n\n                return false;\n            },\n            today: function(value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n\n                return false;\n            },\n            yesterday: function(value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n\n                return false;\n            },\n            nextWeek: function(value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function(value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function(value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function(value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function(value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function(value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(value) - quarter(today);\n\n                    return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                           (diff == -3 && today.getFullYear() + 1 === value.getFullYear());\n                }\n\n                return false;\n            },\n            thisQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(value) - quarter(today);\n\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n\n                return false;\n            },\n            lastQuarter: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    var diff = quarter(today) - quarter(value);\n\n                    return (diff === 1 && today.getFullYear() === value.getFullYear()) ||\n                           (diff == -3 && today.getFullYear() - 1 === value.getFullYear());\n                }\n\n                return false;\n            },\n            nextYear: function(value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function(value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function(value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function(value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n\n                return false;\n            },\n            toJSON: function() {\n                return {\n                    filter: \"dynamic\",\n                    type: this._type\n                };\n            }\n        });\n\n        [1, 2, 3, 4].forEach(function(target) {\n            kendo.spreadsheet.DynamicFilter.prototype[\"quarter\" + target] = function(value) {\n               if (value instanceof Date) {\n                  return quarter(value) === target;\n               }\n\n               return false;\n            };\n        });\n\n        kendo.cultures[\"en-US\"].calendar.months.names.forEach(function(month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function(value) {\n               if (value instanceof Date) {\n                   return value.getMonth() === index;\n               }\n\n               return false;\n            };\n        });\n\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if(month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n\n                today.setFullYear(today.getFullYear() + offset);\n\n                return today.getFullYear() === value.getFullYear();\n            }\n\n            return false;\n        }\n\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n\n                today.setMonth(today.getMonth() + offset, 1);\n\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n\n            return false;\n        }\n\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n\n            return false;\n        }\n\n    })(kendo);\n\n    (function(kendo) {\n\n        var Sorter = kendo.Class.extend({\n            init: function(grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n\n            indices: function(rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft),\n                    this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n\n            sortBy: function(ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n\n                return sortedIndices;\n            }\n        });\n\n        Sorter.ascendingComparer = function(a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n\n            if (a === null) {\n                return 1;\n            }\n\n            if (b === null) {\n                return -1;\n            }\n\n            var typeA = typeof a;\n            var typeB = typeof b;\n\n            if (typeA === \"number\") {\n                if (typeB === \"number\") {\n                    return a - b;\n                } else {\n                   return -1;\n                }\n            }\n\n            if (typeA === \"string\") {\n                switch (typeB) {\n                    case \"number\":\n                        return 1;\n                    case \"string\":\n                        return a.localeCompare(b);\n                    default:\n                        return -1;\n                }\n            }\n\n            if (typeA === \"boolean\") {\n                switch (typeB) {\n                    case \"number\":\n                        return 1;\n                    case \"string\":\n                        return 1;\n                    case \"boolean\":\n                        return a - b;\n                    default:\n                        return -1;\n                }\n            }\n\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n\n            throw new Error(\"Cannot compare \" + a + \" and \" + b);\n        };\n\n        Sorter.descendingComparer = function(a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n\n            if (a === null) {\n                return 1;\n            }\n\n            if (b === null) {\n                return -1;\n            }\n\n            return Sorter.ascendingComparer(b, a);\n        };\n\n        kendo.spreadsheet.Sorter = Sorter;\n    })(kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var util$1 = kendo.util;\n        var calc$2 = kendo.spreadsheet.calc;\n        var dom = kendo.dom;\n\n        var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n        var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n\n        /* The proper amount of suffering for whoever designed the Excel\n           Custom Number Format would be to have him implement the\n           formatter himself. */\n\n        function parse(input) {\n            input = calc$2.InputStream(input);\n            var sections = [], haveConditional = false, decimalPart;\n\n            while (!input.eof()) {\n                var sec = readSection();\n                sections.push(sec);\n                if (sec.cond) {\n                    haveConditional = true;\n                }\n            }\n\n            // From https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4:\n            //\n            //    A number format can have up to four sections of code, separated by semicolons. These\n            //    code sections define the format for positive numbers, negative numbers, zero values,\n            //    and text, in that order.\n            //\n            //    You do not have to include all code sections in your custom number format. If you\n            //    specify only two code sections for your custom number format, the first section is\n            //    used for positive numbers and zeros, and the second section is used for negative\n            //    numbers. If you specify only one code section, it is used for all numbers. If you want\n            //    to skip a code section and include a code section that follows it, you must include\n            //    the ending semicolon for the section that you skip.\n            //\n            // However, if sections have conditionals, it is not clear if:\n            //\n            //    - still at most four are allowed\n            //    - is the last section still for text\n            //\n            // We will assume that if no sections have conditionals, then there must be at most 4, and\n            // they will be interpreted in the order above.  If the first section contains a\n            // conditional, then there can be any number of them; if the last one is not conditional\n            // then it will be interpreted as text format.\n\n            if (!haveConditional) {\n                if (sections.length == 1) {\n                    sections[0].cond = \"num\";\n                }\n                else if (sections.length == 2) {\n                    sections[0].cond = { op: \">=\", value: 0 };\n                    sections[1].cond = { op: \"<\", value: 0 };\n                }\n                else if (sections.length >= 3) {\n                    sections[0].cond = { op: \">\", value: 0 };\n                    sections[1].cond = { op: \"<\", value: 0 };\n                    sections[2].cond = { op: \"=\", value: 0 };\n                    if (sections.length > 3) {\n                        sections[3].cond = \"text\";\n                        sections = sections.slice(0, 4);\n                    }\n                }\n            }\n\n            return sections;\n\n            function maybeColor() {\n                var m = input.skip(RX_COLORS);\n                if (m) {\n                    return m[1].toLowerCase();\n                }\n            }\n\n            function maybeCondition() {\n                var m = input.skip(RX_CONDITION);\n                if (m) {\n                    var val = parseFloat(m[2]);\n                    if (!isNaN(val)) {\n                        return { op: m[1], value: val, custom: true };\n                    }\n                }\n            }\n\n            function readFormat() {\n                var format = [], tok, prev = null;\n                while (!input.eof() && (tok = readNext())) {\n                    // disambiguate: m/mm might mean month or minutes depending on surrounding context.\n                    if (tok.type == \"date\") {\n                        if (prev && /^(el)?time$/.test(prev.type) && prev.part == \"h\"\n                            && tok.part == \"m\" && tok.format < 3) {\n                            // m or mm that follows hours should display minutes\n                            tok.type = \"time\";\n                        }\n                    } else if (/^(el)?time$/.test(tok.type) && tok.part == \"s\") {\n                        if (prev && prev.type == \"date\" && prev.part == \"m\"\n                            && prev.format < 3) {\n                            // m or mm followed by seconds should display minutes\n                            prev.type = \"time\";\n                        }\n                    }\n                    if (!(/^(?:str|space|fill)$/.test(tok.type))) {\n                        prev = tok;\n                    }\n                    format.push(tok);\n                }\n                return format;\n            }\n\n            function maybeFraction(tok) {\n                if (tok.type != \"date\" || (tok.part == \"m\" && tok.format < 3)) {\n                    var m = input.skip(/^\\.(0+)/);\n                    if (m) {\n                        tok.fraction = m[1].length;\n                        if (tok.type == \"date\") {\n                            tok.type = \"time\";\n                        }\n                    }\n                }\n                return tok;\n            }\n\n            function readNext() {\n                var ch, m;\n                // numbers\n                if ((m = input.skip(/^([#0?]+)(?:,([#0?]+))+/))) {\n                    // thousands separator.  seems convenient to treat\n                    // this as a single token.\n                    return { type: \"digit\", sep: true, format: m[1] + m[2], decimal: decimalPart };\n                }\n                if ((m = input.skip(/^[#0?]+/))) {\n                    return { type: \"digit\", sep: false, format: m[0], decimal: decimalPart };\n                }\n                // XXX: handle this one!\n                if ((m = input.skip(/^(e)([+-])/i))) {\n                    return { type: \"exp\", ch: m[1], sign: m[2] };\n                }\n                // dates\n                if ((m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i))) {\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"date\", part: m.charAt(0), format: m.length });\n                }\n                // time (interpret as a date)\n                if ((m = input.skip(/^(hh?|ss?)/i))) { // m and mm are handled above\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"time\", part: m.charAt(0), format: m.length });\n                }\n                // elapsed time (interpret as interval of days)\n                if ((m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i))) {\n                    m = m[1].toLowerCase();\n                    return maybeFraction({ type: \"eltime\", part: m.charAt(0), format: m.length });\n                }\n                if ((m = input.skip(/^(a[.]?m[.]?\\/p[.]?m[.]?|a\\/p)/i))) {\n                    m = m[1].split(\"/\");\n                    return { type: \"ampm\", am: m[0], pm: m[1] };\n                }\n                switch ((ch = input.next())) { // JSHint sadness\n                  case \";\":\n                    return null;\n                  case \"\\\\\":\n                    // quotes next character\n                    return { type: \"str\", value: input.next() };\n                  case '\"':\n                    return { type: \"str\", value: input.readEscaped(ch) };\n                  case \"@\":\n                    return { type: \"text\" };\n                  case \"_\":\n                    // whitespace of the width of following character\n                    return { type: \"space\", value: input.next() };\n                  case \"*\":\n                    // fills cell width with the following character\n                    return { type: \"fill\", value: input.next() };\n                  case \".\":\n                    if (input.lookingAt(/^\\s*[#0?]/)) {\n                        decimalPart = true;\n                        return { type: \"dec\" };\n                    }\n                    return { type: \"str\", value: \".\" };\n                  case \"%\":\n                    return { type: \"percent\" };\n                  case \",\":\n                    return { type: \"comma\" };\n                }\n\n                // whatever we can't make sense of, output literally.\n                return { type: \"str\", value: ch };\n            }\n\n            function readSection() {\n                decimalPart = false;\n                var color = maybeColor(), cond = maybeCondition();\n                if (!color && cond) {\n                    color = maybeColor();\n                }\n                return {\n                    color : color,\n                    cond  : cond,\n                    body  : readFormat()\n                };\n            }\n        }\n\n        function print(sections) {\n            return sections.map(printSection).join(\";\");\n\n            function printSection(sec) {\n                var out = \"\";\n                if (sec.color) {\n                    out += \"[\" + sec.color + \"]\";\n                }\n                if (sec.cond) {\n                    if (!(sec.cond == \"text\" || sec.cond == \"num\")) {\n                        out += \"[\" + sec.cond.op + sec.cond.value + \"]\";\n                    }\n                }\n                out += sec.body.map(printToken).join(\"\");\n                return out;\n            }\n\n            function maybeFraction(fmt, tok) {\n                if (tok.fraction) {\n                    fmt += \".\" + padLeft(\"\", tok.fraction, \"0\");\n                }\n                return fmt;\n            }\n\n            function printToken(tok) {\n                if (tok.type == \"digit\") {\n                    if (tok.sep) {\n                        return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                    } else {\n                        return tok.format;\n                    }\n                }\n                else if (tok.type == \"exp\") {\n                    return tok.ch + tok.sign;\n                }\n                else if (tok.type == \"date\" || tok.type == \"time\") {\n                    return maybeFraction(padLeft(\"\", tok.format, tok.part), tok);\n                }\n                else if (tok.type == \"eltime\") {\n                    return maybeFraction(\"[\" + padLeft(\"\", tok.format, tok.part) + \"]\", tok);\n                }\n                else if (tok.type == \"ampm\") {\n                    return tok.am + \"/\" + tok.pm;\n                }\n                else if (tok.type == \"str\") {\n                    return JSON.stringify(tok.value);\n                }\n                else if (tok.type == \"text\") {\n                    return \"@\";\n                }\n                else if (tok.type == \"space\") {\n                    return \"_\" + tok.value;\n                }\n                else if (tok.type == \"fill\") {\n                    return \"*\" + tok.value;\n                }\n                else if (tok.type == \"dec\") {\n                    return \".\";\n                }\n                else if (tok.type == \"percent\") {\n                    return \"%\";\n                }\n                else if (tok.type == \"comma\") {\n                    return \",\";\n                }\n            }\n        }\n\n        function adjustDecimals(sections, x) {\n            sections.forEach(function(sec) {\n                var diff = x;\n                if (sec.cond == \"text\") {\n                    return;\n                }\n                var body = sec.body, adjusted = false, i = body.length;\n                while (diff !== 0 && --i >= 0) {\n                    var tok = body[i];\n                    if (tok.type == \"digit\") {\n                        if (tok.decimal) {\n                            adjusted = true;\n                            if (diff > 0) {\n                                tok.format += padLeft(\"\", diff, \"0\");\n                            } else if (diff < 0) {\n                                var tmp = tok.format.length;\n                                tok.format = tok.format.substr(0, tmp + diff);\n                                diff += tmp - tok.format.length;\n                            }\n                            if (tok.format.length === 0) {\n                                body.splice(i, 1);\n                                while (--i >= 0) {\n                                    tok = body[i];\n                                    if (tok.type == \"digit\" && tok.decimal) {\n                                        ++i;\n                                        break;\n                                    }\n                                    if (tok.type == \"dec\") {\n                                        body.splice(i, 1);\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                        if (diff > 0) {\n                            break;\n                        }\n                    }\n                }\n                if (!adjusted && diff > 0) {\n                    // no decimal part was found, insert one after the last digit token.\n                    body.splice(\n                        i + 1, 0, {\n                            type    : \"dec\"\n                        }, {\n                            type    : \"digit\",\n                            sep     : false,\n                            decimal : true,\n                            format  : padLeft(\"\", diff, \"0\")\n                        }\n                    );\n                }\n            });\n        }\n\n        function TokenStream(parts) {\n            var index = 0;\n            return {\n                next: function() {\n                    return parts[index++];\n                },\n                eof: function() {\n                    return index >= parts.length;\n                },\n                ahead: function(n, f) {\n                    if (index + n <= parts.length) {\n                        var val = f.apply(null, parts.slice(index, index + n));\n                        if (val) {\n                            index += n;\n                        }\n                        return val;\n                    }\n                },\n                restart: function() {\n                    index = 0;\n                }\n            };\n        }\n\n        function compileFormatPart(format) {\n            var input = TokenStream(format.body);\n            var hasDate = false;\n            var hasTime = false;\n            var hasAmpm = false;\n            var percentCount = 0;\n            var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n            var scaleCount = 0;\n            var code = \"var intPart, decPart, isNegative, date, time; \";\n            var separeThousands = false;\n            var declen = 0;\n            var intFormat = [], decFormat = [];\n            var condition = format.cond;\n            var preamble = \"\";\n\n            if (condition == \"text\") {\n                preamble = \"if (typeof value == 'string' || value instanceof kendo.spreadsheet.CalcError) { \";\n            }\n            else if (condition == \"num\") {\n                preamble = \"if (typeof value == 'number') { \";\n            }\n            else if (condition) {\n                var op = condition.op == \"=\" ? \"==\" : condition.op;\n                preamble = \"if (typeof value == 'number' && value \"\n                    + op + \" \" + condition.value + \") { \";\n                if (!condition.custom) {\n                    code += \"value = Math.abs(value); \";\n                }\n            }\n\n            if (format.color) {\n                code += \"result.color = \" + JSON.stringify(format.color) + \"; \";\n            }\n\n            function checkComma(a, b) {\n                if ((a.type == \"digit\" && b.type == \"comma\") ||\n                    (a.type == \"comma\" && a.hidden && b.type == \"comma\"))\n                {\n                    b.hidden = true;\n                    scaleCount++;\n                }\n            }\n\n            while (!input.eof()) {\n                input.ahead(2, checkComma);\n                var tok = input.next();\n                if (tok.type == \"percent\") {\n                    percentCount++;\n                }\n                else if (tok.type == \"digit\") {\n                    if (tok.decimal) {\n                        declen += tok.format.length;\n                        decFormat.push(tok.format);\n                    } else {\n                        intFormat.push(tok.format);\n                        if (tok.sep) {\n                            separeThousands = true;\n                        }\n                    }\n                }\n                else if (tok.type == \"time\") {\n                    hasTime = true;\n                }\n                else if (tok.type == \"date\") {\n                    hasDate = true;\n                }\n                else if (tok.type == \"ampm\") {\n                    hasAmpm = hasTime = true;\n                }\n            }\n\n            if (percentCount > 0) {\n                code += \"value *= \" + Math.pow(100, percentCount) + \"; \";\n            }\n            if (scaleCount > 0) {\n                code += \"value /= \" + Math.pow(1000, scaleCount) + \"; \";\n            }\n            if (intFormat.length) {\n                code += \"intPart = runtime.formatInt(culture, value, \" + JSON.stringify(intFormat) + \", \" + declen + \", \" + separeThousands + \"); \";\n                code += \"isNegative = parseInt(intPart[0]) < 0;\";\n            }\n            if (decFormat.length) {\n                code += \"decPart = runtime.formatDec(value, \" + JSON.stringify(decFormat) + \", \" + declen + \"); \";\n            }\n            if (intFormat.length || decFormat.length) {\n                code += \"type = 'number'; \";\n            }\n            if (hasDate) {\n                code += \"date = runtime.unpackDate(value); \";\n            }\n            if (hasTime) {\n                code += \"time = runtime.unpackTime(value); \";\n            }\n            if (hasDate || hasTime) {\n                code += \"type = 'date'; \";\n            }\n\n            if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n                if (!preamble) {\n                    preamble = \"if (typeof value == 'number') { \";\n                }\n            }\n\n            input.restart();\n            code += \"var matchedCurrency = false;\";\n            while (!input.eof()) {\n                var tok = input.next();\n                if (tok.type == \"dec\") {\n                    code += \"output += culture.numberFormat['.']; \";\n                }\n                else if (tok.type == \"comma\" && !tok.hidden) {\n                    code += \"output += ','; \";\n                }\n                else if (tok.type == \"percent\") {\n                    code += \"type = 'percent'; \";\n                    code += \"output += culture.numberFormat.percent.symbol; \";\n                }\n                else if (tok.type == \"str\") {\n                    if (currency.test(tok.value)) {\n                        code += \"type = 'currency'; \";\n                        code += \"if (isNegative) { output += '-'; matchedCurrency = true; }\";\n                    }\n                    code += \"output += \" + JSON.stringify(tok.value) + \"; \";\n                }\n                else if (tok.type == \"text\") {\n                    code += \"type = 'text'; \";\n                    code += \"output += value; \";\n                }\n                else if (tok.type == \"space\") {\n                    code += \"if (output) result.body.push(output); \";\n                    code += \"output = ''; \";\n                    code += \"result.body.push({ type: 'space', value: \" + JSON.stringify(tok.value) + \" }); \";\n                }\n                else if (tok.type == \"fill\") {\n                    code += \"output += runtime.fill(\" + JSON.stringify(tok.value) + \"); \";\n                }\n                else if (tok.type == \"digit\") {\n                    code += \"if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace('-', '');}\";\n                    code += \"output += \" + (tok.decimal ? \"decPart\" : \"intPart\") + \".shift(); \";\n                }\n                else if (tok.type == \"date\") {\n                    code += \"output += runtime.date(culture, date, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \"); \";\n                }\n                else if (tok.type == \"time\") {\n                    code += \"output += runtime.time(time, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + hasAmpm + \", \" + tok.fraction + \"); \";\n                }\n                else if (tok.type == \"eltime\") {\n                    code += \"output += runtime.eltime(value, \"\n                        + JSON.stringify(tok.part) + \", \" + tok.format + \", \" + tok.fraction + \"); \";\n                }\n                else if (tok.type == \"ampm\") {\n                    // XXX: should use culture?  As per the \"spec\", Excel\n                    // displays whatever the token was (AM/PM, a/p etc.)\n                    code += \"output += time.hours < 12 ? \" + JSON.stringify(tok.am) + \" : \" + JSON.stringify(tok.pm) + \"; \";\n                }\n            }\n\n            code += \"if (output) result.body.push(output); \";\n            code += \"result.type = type; \";\n            code += \"return result; \";\n\n            if (preamble) {\n                code = preamble + code + \"}\";\n            }\n\n            return code;\n        }\n\n        var TEXT = compileFormatPart({ cond: \"text\", body: [ { type: \"text\" } ] });\n\n        var compile = util$1.memoize(function(format) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join(\"\\n\");\n            code = \"'use strict'; return function(value, culture){ \"\n                + \"if (!culture) culture = kendo.culture(); \"\n                + \"var output = '', type = null, result = { body: [] }; \" + code + \"; return result; };\";\n            return new Function(\"runtime\", code)(runtime$3);\n        });\n\n        // Attempts to produce a format compatible with kendo.parseDate from our Excel format.  Needed\n        // in runtime.parseDate (passing Excel format to kendo.parseDate will mess up the month or\n        // minutes).  https://github.com/telerik/kendo-ui-core/issues/3797\n        var makeDateFormat = util$1.memoize(function(format){\n            var tree = parse(format);\n            var section, found = false, hasAmpm = false;\n\n            // locate a section that contains date/time formatting.  only the first will be converted.\n            for (var i = 0; i < tree.length; ++i) {\n                section = tree[i];\n                for (var j = 0; j < section.body.length; ++j) {\n                    if (/^(?:date|time|ampm)$/.test(section.body[j].type)) {\n                        found = true;\n                        if (section.body[j].type == \"ampm\") {\n                            hasAmpm = true;\n                        }\n                    }\n                }\n                if (found) {\n                    break;\n                }\n            }\n            if (!found) {\n                return null;\n            }\n\n            return section.body.map(printToken).join(\"\");\n\n            // a little copy/paste goes a long way\n\n            function maybeFraction(fmt, tok) {\n                if (tok.fraction) {\n                    fmt += padLeft(\"\", Math.max(tok.fraction, 3), \"f\");\n                }\n                return fmt;\n            }\n\n            function printToken(tok) {\n                if (tok.type == \"digit\") {\n                    if (tok.sep) {\n                        return tok.format.charAt(0) + \",\" + tok.format.substr(1);\n                    } else {\n                        return tok.format;\n                    }\n                }\n                else if (tok.type == \"exp\") {\n                    return tok.ch + tok.sign;\n                }\n                else if (tok.type == \"date\" || tok.type == \"time\") {\n                    var part = tok.part;\n                    if (tok.type == \"date\" && /^m/.test(part)) {\n                        part = \"M\"; // month, not minutes\n                    }\n                    else if (tok.type == \"time\" && /^h/.test(part)) {\n                        if (!hasAmpm) {\n                            // 24-hours clock is H or HH\n                            part = part.toUpperCase();\n                        }\n                    }\n                    return maybeFraction(padLeft(\"\", tok.format, part), tok);\n                }\n                else if (tok.type == \"ampm\") {\n                    return \"tt\";\n                }\n                else if (tok.type == \"str\") {\n                    // XXX: this is a bit wrong.  it doesn't look like kendo.toString / kendo.parseDate\n                    // support arbitrary text (in Excel formats that's quoted), for example:\n                    //    kendo.toString(new Date(), \"here's the day dude: dd\")\n                    //  → \"3ere'8 t3e 19ay 19u19e: 19\"   (it's 19th June, 3 o'clock, probably 8 seconds)\n                    return tok.value;\n                }\n                else if (tok.type == \"space\") {\n                    return \" \";\n                }\n                else if (tok.type == \"dec\") {\n                    return \".\";\n                }\n                else if (tok.type == \"percent\") {\n                    return \"%\";\n                }\n                else if (tok.type == \"comma\") {\n                    return \",\";\n                }\n                else {\n                    return \"\";\n                }\n            }\n        });\n\n        var runtime$3 = {\n\n            unpackDate: calc$2.runtime.unpackDate,\n            unpackTime: calc$2.runtime.unpackTime,\n\n            date: function(culture, d, part, length) {\n                switch (part) {\n                  case \"d\":\n                    switch (length) {\n                      case 1: return d.date;\n                      case 2: return padLeft(d.date, 2, \"0\");\n                      case 3: return culture.calendars.standard.days.namesAbbr[d.day];\n                      case 4: return culture.calendars.standard.days.names[d.day];\n                    }\n                    break;\n                  case \"m\":\n                    switch (length) {\n                      case 1: return d.month + 1;\n                      case 2: return padLeft(d.month + 1, 2, \"0\");\n                      case 3: return culture.calendars.standard.months.namesAbbr[d.month];\n                      case 4: return culture.calendars.standard.months.names[d.month];\n                      case 5: return culture.calendars.standard.months.names[d.month].charAt(0);\n                    }\n                    break;\n                  case \"y\":\n                    switch (length) {\n                      case 2: return d.year % 100;\n                      case 4: return d.year;\n                    }\n                    break;\n                }\n                return \"##\";\n            },\n\n            time: function(t, part, length, ampm, fraclen) {\n                var ret, fraction;\n                switch (part) {\n                  case \"h\":\n                    ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, \"0\");\n                    if (fraclen) {\n                        fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                    }\n                    break;\n                  case \"m\":\n                    ret = padLeft(t.minutes, length, \"0\");\n                    if (fraclen) {\n                        fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                    }\n                    break;\n                  case \"s\":\n                    ret = padLeft(t.seconds, length, \"0\");\n                    if (fraclen) {\n                        fraction = t.milliseconds / 1000;\n                    }\n                    break;\n                }\n                if (fraction) {\n                    ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n                }\n                return ret;\n            },\n\n            eltime: function(value, part, length, fraclen) {\n                var ret, fraction;\n                switch (part) {\n                  case \"h\":\n                    ret = value * 24;\n                    break;\n                  case \"m\":\n                    ret = value * 24 * 60;\n                    break;\n                  case \"s\":\n                    ret = value * 24 * 60 * 60;\n                    break;\n                }\n                if (fraclen) {\n                    fraction = ret - (ret | 0);\n                }\n                ret = padLeft(ret | 0, length, \"0\");\n                if (fraction) {\n                    ret += runtime$3.toFixed(fraction, fraclen).replace(/^0+/, \"\");\n                }\n                return ret;\n            },\n\n            fill: function(ch) {\n                // XXX: how to implement this?\n                return ch;\n            },\n\n            // formatting integer part is slightly different than decimal\n            // part, so they're implemented in two functions.  For the\n            // integer part we need to walk the value and the format\n            // backwards (right-to-left).\n\n            formatInt: function(culture, value, parts, declen, sep) {\n                // toFixed is perfect for rounding our value; if there is\n                // no format for decimals, for example, we want the number\n                // rounded up.\n                value = runtime$3.toFixed(value, declen).replace(/\\..*$/, \"\");\n                var lastPart = parts[parts.length - 1];\n\n                if (declen > 0 && lastPart[parts.length - 1] != \"0\") {\n                    // if the rounded number is zero and we have decimal\n                    // format, consider it a non-significant digit (Excel\n                    // won't display the leading zero for 0.2 in format #.#).\n                    // the zero won't e omitted if using 0.0 format\n                    if (value === \"0\") { value = \"\"; }\n                    else if (value === \"-0\") { value = \"-\"; }\n                }\n\n                var shouldInsertMinus = false;\n                var iv = value.length - 1;\n                var result = [];\n                var len = 0, str;\n\n                function add(ch, skipMinus) {\n                    if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                        str = culture.numberFormat[\",\"] + str;\n                    }\n                    if(skipMinus && ch === \"-\") {\n                        shouldInsertMinus = true;\n                        ch = \"0\";\n                    }\n                    str = ch + str;\n                    len++;\n                }\n\n                for (var j = parts.length; --j >= 0;) {\n                    var format = parts[j];\n                    str = \"\";\n                    for (var k = format.length; --k >= 0;) {\n                        var chf = format.charAt(k);\n                        if (iv < 0) {\n                            if (chf == \"0\") {\n                                add(\"0\");\n                            } else if (chf == \"?\") {\n                                add(\" \");\n                            }\n                        } else {\n                            if (value == \"0\" && chf == \"?\") {\n                                add(\" \");\n                            } else if (chf == \"0\") {\n                                add(value.charAt(iv), true);\n                            } else {\n                                add(value.charAt(iv));\n                            }\n                            iv--;\n                        }\n                    }\n                    if (j === 0) {\n                        while (iv >= 0) {\n                            add(value.charAt(iv--));\n                        }\n                    }\n                    result.unshift(str);\n                }\n\n                if(shouldInsertMinus) {\n                    result[0] = \"-\" + result[0];\n                }\n\n                return result;\n            },\n\n            // for decimal part we walk in normal direction and pad on the\n            // right if required (for '0' or '?' chars).\n\n            formatDec: function(value, parts, declen) {\n                value = runtime$3.toFixed(value, declen);\n                var pos = value.indexOf(\".\");\n                if (pos >= 0) {\n                    value = value.substr(pos + 1).replace(/0+$/, \"\");\n                } else {\n                    value = \"\";\n                }\n\n                var iv = 0;\n                var result = [];\n\n                for (var j = 0; j < parts.length; ++j) {\n                    var format = parts[j];\n                    var str = \"\";\n                    for (var k = 0; k < format.length; ++k) {\n                        var chf = format.charAt(k);\n                        if (iv < value.length) {\n                            str += value.charAt(iv++);\n                        } else if (chf == \"0\") {\n                            str += \"0\";\n                        } else if (chf == \"?\") {\n                            str += \" \";\n                        }\n                    }\n                    result.push(str);\n                }\n\n                return result;\n            },\n\n            // JS's toFixed is broken, it's only OK to use it on integers.\n            toFixed: function(value, decimals) {\n                return (function toFixed(value, last) {\n                    if (!isFinite(value)) {\n                        return \"#NUM!\";\n                    }\n\n                    // deal early with the trivial cases\n                    if (value < 0) {    // JS's Math.round is broken with negative numbers\n                        return \"-\" + toFixed(-value);\n                    }\n\n                    if (decimals === 0) { // no decimals\n                        return String(Math.round(value));\n                    }\n\n                    if (value === Math.round(value) && !/e/i.test(String(value))) { // value is integer and not too big\n                        return value.toFixed(decimals);\n                    }\n\n                    // this handles cases like 0.3.toFixed(20) == \"0.29999999999999998890\", or\n                    // 2.1825.toFixed(20) = \"2.18250000000000010658\".\n                    // https://github.com/telerik/kendo-ui-core/issues/3520#issuecomment-333768221\n                    // https://twitter.com/mcbazon/status/1035828655652593665\n                    var num = digNumber(value);\n                    var intpart = num.intpart;\n                    var decpart = num.decpart;\n                    if (decpart.length <= decimals) {\n                        while (decpart.length < decimals) {\n                            decpart += \"0\";\n                        }\n                        return intpart + \".\" + decpart;\n                    }\n\n                    if (last) {\n                        // \"we should definitely not get here\" (famous last words).  Let's MAKE SURE\n                        // there's no more recursion.\n                        return intpart + \".\" + decpart.substr(0, decimals);\n                    }\n\n                    // if there are more decimals than wanted, round and try again.\n                    // it should not recurse more than once.\n                    var f = Math.pow(10, decimals);\n                    return toFixed(Math.round(value * f) / f, true);\n\n                })(Number(value.toFixed(14))); /* restrict to 14 decimals, because 0.1 + 0.2 ===\n                                                     * 0.30000000000000004 */\n            }\n\n        };\n\n        function padLeft(val, width, ch) {\n            val += \"\";\n            while (val.length < width) {\n                val = ch + val;\n            }\n            return val;\n        }\n\n        function padRight(val, width, ch) {\n            val += \"\";\n            while (val.length < width) {\n                val += ch;\n            }\n            return val;\n        }\n\n        // given a number, return { intpart, decpart } as strings.  the main difficulty here is that JS\n        // will stringify really large values in scientific notation (e.g. 1.23e+30, which is actually\n        // the integer 1230000000000000000000000000000).\n        function digNumber(num) {\n            var str = String(num).toLowerCase();\n            var intpart, decpart, m;\n            var pos = str.indexOf(\".\");\n            if (pos < 0) {\n                pos = str.indexOf(\"e\");\n                if (pos < 0) {\n                    intpart = str;\n                    decpart = \"\";\n                } else {\n                    intpart = str.substr(0, pos);\n                    decpart = str.substr(pos);\n                }\n            } else {\n                intpart = str.substr(0, pos);\n                decpart = str.substr(pos + 1);\n            }\n            if ((m = /(\\d*)e([-+]?\\d+)/.exec(decpart))) {\n                var exp = parseInt(m[2], 10);\n                if (exp >= 0) {\n                    decpart = padRight(m[1], exp, \"0\");\n                    intpart += decpart.substr(0, exp);\n                    decpart = decpart.substr(exp);\n                } else {\n                    intpart = padLeft(intpart, -exp, \"0\");\n                    decpart = intpart.substr(exp) + m[1];\n                    intpart = intpart.substr(0, intpart.length + exp);\n                }\n            }\n            return { intpart: intpart || \"0\", decpart: decpart };\n        }\n\n        /* -----[ exports ]----- */\n\n        function text(f) {\n            var a = f.body;\n            var text = \"\";\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == \"string\") {\n                    text += el;\n                } else if (el.type == \"space\") {\n                    text += \" \";\n                }\n            }\n            return text;\n        }\n\n        kendo.spreadsheet.formatting = {\n            compile : compile,\n            parse: parse,\n            format: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                var span = dom.element(\"span\");\n                span.__dataType = f.type;\n                var a = f.body;\n                if (f.color) {\n                    span.attr.style = { color: f.color };\n                }\n                for (var i = 0; i < a.length; ++i) {\n                    var el = a[i];\n                    if (typeof el == \"string\") {\n                        span.children.push(dom.text(el));\n                    } else if (el.type == \"space\") {\n                        span.children.push(dom.element(\"span\", {\n                            style: { visibility: \"hidden\" }\n                        }, [ dom.text(el.value) ]));\n                    }\n                }\n                return span;\n            },\n            text: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                return text(f);\n            },\n            textAndColor: function(value, format, culture) {\n                var f = compile(format)(value, culture);\n                return { text: text(f), color: f.color, type: f.type };\n            },\n            type: function(value, format) {\n                return compile(format)(value).type;\n            },\n            adjustDecimals: function(format, diff) {\n                var ast = parse(format);\n                adjustDecimals(ast, diff);\n                return print(ast);\n            },\n            makeDateFormat: makeDateFormat\n        };\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var util = kendo.util;\n        var spreadsheet$3 = kendo.spreadsheet;\n        var calc$1 = spreadsheet$3.calc;\n        var runtime$2 = calc$1.runtime;\n        var defineFunction$1 = runtime$2.defineFunction;\n        var defineAlias = runtime$2.defineAlias;\n        var CalcError$1 = runtime$2.CalcError;\n        var RangeRef = spreadsheet$3.RangeRef;\n        var CellRef$1 = spreadsheet$3.CellRef;\n        var UnionRef = spreadsheet$3.UnionRef;\n        var Matrix = runtime$2.Matrix;\n        var Ref = spreadsheet$3.Ref;\n        var NameRef = spreadsheet$3.NameRef;\n        var daysInMonth$1 = runtime$2.daysInMonth;\n        var packDate$1 = runtime$2.packDate;\n        var unpackDate$1 = runtime$2.unpackDate;\n        var daysInYear$1 = runtime$2.daysInYear;\n        var limitPrecision = runtime$2.limitPrecision;\n\n        /* -----[ Math functions ]----- */\n\n        [ \"abs\", \"cos\", \"sin\", \"acos\", \"asin\", \"tan\", \"atan\", \"exp\", \"sqrt\" ].forEach(function(name){\n            defineFunction$1(name, Math[name]).args([\n                [ \"*n\", \"number\" ]\n            ]);\n        });\n\n        defineFunction$1(\"ln\", Math.log).args([\n            [ \"*n\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"log\", function(num, base){\n            return Math.log(num) / Math.log(base);\n        }).args([\n            [ \"*num\", \"number++\" ],\n            [ \"*base\", [ \"or\", \"number++\", [ \"null\", 10 ] ] ],\n            [ \"?\", [ \"assert\", \"$base != 1\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"log10\", function(num){\n            return Math.log(num) / Math.log(10);\n        }).args([\n            [ \"*num\", \"number++\" ]\n        ]);\n\n        defineFunction$1(\"pi\", function(){\n            return Math.PI;\n        }).args([]);\n\n        defineFunction$1(\"sqrtpi\", function(n){\n            return Math.sqrt(n * Math.PI);\n        }).args([\n            [ \"*num\", \"number+\" ]\n        ]);\n\n        defineFunction$1(\"degrees\", function(rad){\n            return ((180 * rad) / Math.PI) % 360;\n        }).args([\n            [ \"*radians\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"radians\", function(deg){\n            return Math.PI * deg / 180;\n        }).args([\n            [ \"*degrees\", \"number\" ]\n        ]);\n\n        function _cosh(n){\n            return (Math.exp(n) + Math.exp(-n)) / 2;\n        }\n\n        defineFunction$1(\"cosh\", _cosh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"acosh\", function(n){\n            return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n        }).args([\n            [ \"*num\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$num >= 1\" ] ]\n        ]);\n\n        function _sinh(n){\n            return (Math.exp(n) - Math.exp(-n)) / 2;\n        }\n\n        defineFunction$1(\"sinh\", _sinh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"asinh\", function(n){\n            return Math.log(n + Math.sqrt(n * n + 1));\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sec\", function(n){\n            return 1 / Math.cos(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sech\", function(n){\n            return 1 / _cosh(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"csc\", function(n){\n            return 1 / Math.sin(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"csch\", function(n){\n            return 1 / _sinh(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"atan2\", function(x, y){\n            return Math.atan(y / x);\n        }).args([\n            [ \"*x\", \"divisor\" ],\n            [ \"*y\", \"number\" ]\n        ]);\n\n        function _tanh(n) {\n            return _sinh(n) / _cosh(n);\n        }\n\n        defineFunction$1(\"tanh\", _tanh).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"atanh\", function(n){\n            return Math.log(Math.sqrt(1 - n*n) / (1 - n));\n        }).args([\n            [ \"*num\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"cot\", function(n){\n            return 1 / Math.tan(n);\n        }).args([\n            [ \"*num\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"coth\", function(n){\n            return 1 / _tanh(n);\n        }).args([\n            [ \"*num\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"acot\", function(n){\n            return Math.PI / 2 - Math.atan(n);\n        }).args([\n            [ \"*num\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"acoth\", function(n){\n            return Math.log((n + 1) / (n - 1)) / 2;\n        }).args([\n            [ \"*num\", \"number\" ],\n            [ \"?\", [ \"or\",\n                     [ \"assert\", \"$num < -1\"],\n                     [ \"assert\", \"$num > 1\" ] ] ]\n        ]);\n\n        defineFunction$1(\"power\", function(a, b){\n            return Math.pow(a, b);\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"mod\", function(a, b){\n            return a % b;\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"quotient\", function(a, b){\n            return Math.floor(a / b);\n        }).args([\n            [ \"*a\", \"number\" ],\n            [ \"*b\", \"divisor\" ]\n        ]);\n\n        defineFunction$1(\"ceiling\", function(num, s){\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n        ]);\n\n        defineFunction$1(\"ceiling.precise\", function(num, s){\n            s = Math.abs(s);\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n        // XXX: how do we know if this function is correct?\n        //\n        // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n        //\n        // “There are many combinations of Significance and Mode values that affect rounding of negative\n        // numbers in different ways.” — right, thanks for the info. :-\\\n        defineFunction$1(\"ceiling.math\", function(num, s, mode){\n            if (!s || !num) {\n                return 0;\n            }\n            if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                s = -s;\n            }\n            return s ? s * Math.ceil(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n            [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"floor\", function(num, s){\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n        ]);\n\n        defineFunction$1(\"floor.precise\", function(num, s){\n            s = Math.abs(s);\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        // XXX: check this\n        defineFunction$1(\"floor.math\", function(num, s, mode){\n            if (!s || !num) {\n                return 0;\n            }\n            if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n                s = -s;\n            }\n            return s ? s * Math.floor(num / s) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n            [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"int\", Math.floor).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"mround\", function(num, mult){\n            return mult ? mult * Math.round(num / mult) : 0;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*multiple\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"round\", function(num, digits){\n            var sign = num < 0 ? -1 : 1;\n            if (sign < 0) { num = -num; }\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = Math.round(num);\n            return sign * num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"roundup\", function(num, digits){\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"rounddown\", function(num, digits){\n            digits = Math.pow(10, digits);\n            num = limitPrecision(num * digits);\n            num = num < 0 ? Math.ceil(num) : Math.floor(num);\n            return num / digits;\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*digits\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"even\", function(num){\n            var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"odd\", function(num){\n            var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n            return n % 2 ? n : n + (n < 0 ? -1 : 1);\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"sign\", function(num){\n            return num < 0 ? -1 : num > 0 ? 1 : 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        function _gcd(a, b) {\n            while (b) {\n                var r = a % b;\n                a = b;\n                b = r;\n            }\n            return a;\n        }\n\n        function _lcm(a, b) {\n            return Math.abs(a * b) / _gcd(a, b);\n        }\n\n        defineFunction$1(\"gcd\", function(args){\n            var a = args[0];\n            for (var i = 1; i < args.length; ++i) {\n                a = _gcd(a, args[i]);\n            }\n            return a;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"lcm\", function(args){\n            var a = args[0];\n            for (var i = 1; i < args.length; ++i) {\n                a = _lcm(a, args[i]);\n            }\n            return a;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sum\", function(numbers){\n            return numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"product\", function(numbers){\n            return numbers.reduce(function(prod, num){\n                return prod * num;\n            }, 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sumproduct\", function(first, rest) {\n            var sum = 0;\n            first.each(function(p, row, col){\n                if (typeof p == \"number\") {\n                    for (var i = 0; i < rest.length; ++i) {\n                        var v = rest[i].get(row, col);\n                        if (typeof v != \"number\") {\n                            return;\n                        }\n                        p *= v;\n                    }\n                    sum += p;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a1\", \"matrix\" ],\n            [ \"+\",\n              [ \"a2\", [ \"and\", \"matrix\",\n                        [ \"assert\", \"$a2.width == $a1.width\" ],\n                        [ \"assert\", \"$a2.height == $a1.height\" ] ] ] ]\n        ]);\n\n        defineFunction$1(\"sumsq\", function(numbers){\n            return numbers.reduce(function(sum, num){\n                return sum + num * num;\n            }, 0);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"sumx2my2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += x*x - y*y;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$b.width == $a.width\" ],\n                     [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"sumx2py2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += x*x + y*y;\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$b.width == $a.width\" ],\n                     [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"sumxmy2\", function(a, b){\n            var sum = 0;\n            a.each(function(x, row, col){\n                var y = b.get(row, col);\n                if (typeof x == \"number\" && typeof y == \"number\") {\n                    sum += (x - y) * (x - y);\n                }\n            });\n            return sum;\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$b.width == $a.width\" ],\n                     [ \"assert\", \"$b.height == $a.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"seriessum\", function(x, n, m, a){\n            var sum = 0;\n            a.each(function(coef){\n                if (typeof coef != \"number\") {\n                    throw new CalcError$1(\"VALUE\");\n                }\n                sum += coef * Math.pow(x, n);\n                n += m;\n            });\n            return sum;\n        }).args([\n            [ \"x\", \"number\" ],\n            [ \"y\", \"number\" ],\n            [ \"m\", \"number\" ],\n            [ \"a\", \"matrix\" ]\n        ]);\n\n        defineFunction$1(\"min\", function(numbers){\n            return numbers.length ? Math.min.apply(Math, numbers) : 0;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ]\n        ]);\n\n        defineFunction$1(\"max\", function(numbers){\n            return numbers.length ? Math.max.apply(Math, numbers) : 0;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ]\n        ]);\n\n        defineFunction$1(\"counta\", function(values){\n            return values.length;\n        }).args([\n            [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n        ]);\n\n        defineFunction$1(\"count\", function(numbers){\n            return numbers.length;\n        }).args([\n            [ \"numbers\", [ \"#collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"countunique\", function(values){\n            var count = 0, seen = [];\n            values.forEach(function(val){\n                if (seen.indexOf(val) < 0) {\n                    count++;\n                    seen.push(val);\n                }\n            });\n            return count;\n        }).args([\n            [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n        ]);\n\n        defineFunction$1(\"countblank\", function(a){\n            var count = 0;\n            function add(val) {\n                if (val == null || val === \"\") {\n                    count++;\n                }\n            }\n            function loop(args){\n                for (var i = 0; i < args.length; ++i) {\n                    var x = args[i];\n                    if (x instanceof Matrix) {\n                        x.each(add, true);\n                    } else {\n                        add(x);\n                    }\n                }\n            }\n            loop(a);\n            return count;\n        }).args([\n            [ \"+\", [ \"args\", [ \"or\", \"matrix\", \"anyvalue\" ] ] ]\n        ]);\n\n        defineFunction$1(\"iseven\", function(num){\n            return num % 2 === 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"isodd\", function(num){\n            return num % 2 !== 0;\n        }).args([\n            [ \"*number\", \"number\" ]\n        ]);\n\n        defineFunction$1(\"n\", function(val){\n            if (typeof val == \"boolean\") {\n                return val ? 1 : 0;\n            }\n            if (typeof val == \"number\") {\n                return val;\n            }\n            return 0;\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        defineFunction$1(\"na\", function(){\n            return new CalcError$1(\"N/A\");\n        }).args([]);\n\n        /* -----[ the \"*IFS\" functions ]----- */\n\n        // helper function: take `args` like COUNTIFS (see Excel docs) and\n        // calls `f` for each cell matching all criteria.  `f` receives\n        // `chunks` (parsed args containing matrix and predicate) and\n        // row,col of matching cells.\n        function forIFS(args, f) {\n            var chunks = [], i = 0, matrix = args[0];\n            while (i < args.length) {\n                chunks.push({\n                    matrix: args[i++],\n                    pred: parseCriteria(args[i++])\n                });\n            }\n            ROW: for (var row = 0; row < matrix.height; ++row) {\n                COL: for (var col = 0; col < matrix.width; ++col) {\n                    for (i = 0; i < chunks.length; ++i) {\n                        var val = chunks[i].matrix.get(row, col);\n                        if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                            continue COL;\n                        }\n                    }\n                    f(row, col);\n                }\n            }\n        }\n\n        var ARGS_COUNTIFS = [\n            [ \"m1\", \"matrix\" ],\n            [ \"c1\", \"anyvalue\" ],\n            [ [ \"m2\", \"matrix\" ],\n              [ \"c2\", \"anyvalue\" ] ]\n        ];\n\n        defineFunction$1(\"countifs\", function(m1, c1, rest){\n            var count = 0;\n            rest.unshift(m1, c1);\n            forIFS(rest, function(){ count++; });\n            return count;\n        }).args(ARGS_COUNTIFS);\n\n        var ARGS_SUMIFS = [\n            [ \"range\", \"matrix\" ]\n        ].concat(ARGS_COUNTIFS);\n\n        defineFunction$1(\"sumifs\", function(range, m1, c1, args){\n            // hack: insert a predicate that filters out non-numeric\n            // values; should also accept blank cells.  it's safe to\n            // modify args.\n            args.unshift(range, numericPredicate, m1, c1);\n            var sum = 0;\n            forIFS(args, function(row, col){\n                var val = range.get(row, col);\n                if (val) {\n                    sum += val;\n                }\n            });\n            return sum;\n        }).args(ARGS_SUMIFS);\n\n        // similar to sumifs, but compute average of matching cells\n        defineFunction$1(\"averageifs\", function(range, m1, c1, args){\n            args.unshift(range, numericPredicate, m1, c1);\n            var sum = 0, count = 0;\n            forIFS(args, function(row, col){\n                var val = range.get(row, col);\n                if (val == null || val === \"\") {\n                    val = 0;\n                }\n                sum += val;\n                count++;\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        }).args(ARGS_SUMIFS);\n\n        defineFunction$1(\"countif\", function(matrix, criteria){\n            criteria = parseCriteria(criteria);\n            var count = 0;\n            matrix.each(function(val){\n                if (criteria(val)) {\n                    count++;\n                }\n            });\n            return count;\n        }).args([\n            [ \"range\", \"matrix\" ],\n            [ \"*criteria\", \"anyvalue\" ]\n        ]);\n\n        var ARGS_SUMIF = [\n            [ \"range\", \"matrix\" ],\n            [ \"*criteria\", \"anyvalue\" ],\n            [ \"sumRange\", [ \"or\", \"area\", \"#matrix\", [ \"null\", \"$range\" ] ] ]\n        ];\n\n        function fetchSumRange(continuation) {\n            return function(callback, range, criteria, sumRange) {\n                var self = this;\n                if (sumRange instanceof Ref) {\n                    // make sure it covers the same area as `range`, as the “spec” mentions:\n                    //\n                    //     The sum_range argument does not have to be the same size and shape as the\n                    //     range argument. The actual cells that are added are determined by using the\n                    //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n                    //     including cells that correspond in size and shape to the range argument.\n                    //\n                    // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n                    // should it be a range at all?  Oh well, Excel.\n                    var r = sumRange.clone().toRangeRef();\n                    if (r.width() != range.width || r.height() != range.height) {\n                        if (!isFinite(r.topLeft.row)) {\n                            r.topLeft.row = 0;\n                        }\n                        if (!isFinite(r.topLeft.col)) {\n                            r.topLeft.col = 0;\n                        }\n                        r.bottomRight.row = r.topLeft.row + range.height - 1;\n                        r.bottomRight.col = r.topLeft.col + range.width - 1;\n                        return self.resolveCells([ r ], function(){\n                            callback(continuation(range, criteria, self.asMatrix(r)));\n                        });\n                    }\n                }\n                callback(continuation(range, criteria, self.asMatrix(sumRange)));\n            };\n        }\n\n        defineFunction$1(\"sumif\", fetchSumRange(function(range, criteria, sumRange){\n            var sum = 0;\n            criteria = parseCriteria(criteria);\n            range.each(function(val, row, col){\n                if (criteria(val)) {\n                    var v = sumRange.get(row, col);\n                    if (numericPredicate(v)) {\n                        sum += v || 0;\n                    }\n                }\n            });\n            return sum;\n        })).argsAsync(ARGS_SUMIF);\n\n        defineFunction$1(\"averageif\", fetchSumRange(function(range, criteria, sumRange){\n            var sum = 0, count = 0;\n            criteria = parseCriteria(criteria);\n            range.each(function(val, row, col){\n                if (criteria(val)) {\n                    var v = sumRange.get(row, col);\n                    if (numericPredicate(v)) {\n                        sum += v || 0;\n                        count++;\n                    }\n                }\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        })).argsAsync(ARGS_SUMIF);\n\n        (function(def){\n            def(\"large\", function(numbers, nth){\n                return numbers.sort(descending)[nth];\n            });\n            def(\"small\", function(numbers, nth){\n                return numbers.sort(ascending)[nth];\n            });\n        })(function(name, handler){\n            defineFunction$1(name, function(matrix, nth){\n                var numbers = [];\n                var error = matrix.each(function(val){\n                    if (val instanceof CalcError$1) {\n                        return val;\n                    }\n                    if (typeof val == \"number\") {\n                        numbers.push(val);\n                    }\n                });\n                if (error) {\n                    return error;\n                }\n                if (nth > numbers.length) {\n                    return new CalcError$1(\"NUM\");\n                }\n                return handler(numbers, nth - 1);\n            }).args([\n                [ \"array\", \"matrix\" ],\n                [ \"*nth\", \"number++\" ]\n            ]);\n        });\n\n        function _avg(numbers) {\n            return numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0) / numbers.length;\n        }\n\n        function _var_sp(numbers, divisor, avg) {\n            if (avg == null) {\n                avg = _avg(numbers);\n            }\n            return numbers.reduce(function(sum, num){\n                return sum + Math.pow(num - avg, 2);\n            }, 0) / divisor;\n        }\n\n        function _stdev_sp(numbers, divisor) {\n            return Math.sqrt(_var_sp(numbers, divisor));\n        }\n\n        // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n        defineFunction$1(\"stdev.s\", function(numbers){\n            return _stdev_sp(numbers, numbers.length - 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n        defineFunction$1(\"stdev.p\", function(numbers){\n            return _stdev_sp(numbers, numbers.length);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number!\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 1\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"var.s\", function(numbers){\n            return _var_sp(numbers, numbers.length - 1);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"var.p\", function(numbers){\n            return _var_sp(numbers, numbers.length);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"median\", function(numbers){\n            var n = numbers.length;\n            numbers.sort(ascending);\n            if (n % 2) {\n                // when length is odd, the median is the number in the middle\n                return numbers[n >> 1];\n            }\n            // that's the average of the two middle numbers, written in in a fancy way\n            return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction$1(\"mode.sngl\", function(numbers){\n            numbers.sort(ascending);\n            var prev = null, count = 0, max = 1, mode = null;\n            for (var i = 0; i < numbers.length; ++i) {\n                var n = numbers[i];\n                if (n != prev) {\n                    count = 1;\n                    prev = n;\n                } else {\n                    count++;\n                }\n                if (count > max) {\n                    max = count;\n                    mode = n;\n                }\n            }\n            return mode == null ? new CalcError$1(\"N/A\") : mode;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"mode.mult\", function(numbers){\n            var seen = Object.create(null), max = 2, res = [];\n            numbers.forEach(function(num){\n                var s = seen[num] || 0;\n                seen[num] = ++s;\n                if (s == max) {\n                    res.push(num);\n                } else if (s > max) {\n                    max = s;\n                    res = [ num ];\n                }\n            });\n            var m = new Matrix(this);\n            res.forEach(function(num, i){\n                m.set(i, 0, num);\n            });\n            return m;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        defineFunction$1(\"geomean\", function(numbers){\n            var n = numbers.length;\n            var p = numbers.reduce(function(p, num){\n                if (num < 0) {\n                    throw new CalcError$1(\"NUM\");\n                }\n                return p * num;\n            }, 1);\n            return Math.pow(p, 1/n);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"harmean\", function(numbers){\n            var n = numbers.length;\n            var s = numbers.reduce(function(s, num){\n                if (!num) {\n                    throw new CalcError$1(\"DIV/0\");\n                }\n                return s + 1 / num;\n            }, 0);\n            return n / s;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"trimmean\", function(numbers, p){\n            var n = numbers.length;\n            numbers.sort(ascending);\n            var discard = Math.floor(n * p);\n            if (discard % 2) {\n                --discard;\n            }\n            discard /= 2;\n            var sum = 0;\n            for (var i = discard; i < n-discard; ++i) {\n                sum += numbers[i];\n            }\n            return sum / (n - discard * 2);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"percent\", [ \"and\", \"number\", [ \"[between)\", 0, 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n        ]);\n\n        defineFunction$1(\"frequency\", function(data, bins){\n            // apparently this always returns a vertical matrix in Excel, so we collect all numbers in\n            // bins instead of receiving it as a Matrix and try to mimic its shape.\n            data.sort(ascending);\n            bins.sort(ascending);\n            var prev = -Infinity;\n            var i = 0;\n            function count(max) {\n                var n = 0;\n                while (i < data.length && data[i] > prev && data[i] <= max) {\n                    ++n; ++i;\n                }\n                return n;\n            }\n            var m = new Matrix(this);\n            bins.forEach(function(val, i){\n                var n = count(val);\n                prev = val;\n                m.set(i, 0, n);\n            });\n            m.set(m.height, 0, data.length - i);\n            return m;\n        }).args([\n            [ \"data\", [ \"collect\", \"number\", 1 ] ],\n            [ \"bins\", [ \"collect\", \"number\", 1 ] ]\n        ]);\n\n        defineFunction$1(\"rank.eq\", function(val, numbers, asc) {\n            numbers.sort(asc ? ascending : descending);\n            var pos = numbers.indexOf(val);\n            return pos < 0 ? new CalcError$1(\"N/A\") : pos + 1;\n        }).args([\n            [ \"value\", \"number\" ],\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineAlias(\"rank\", \"rank.eq\");\n\n        defineFunction$1(\"rank.avg\", function(val, numbers, asc) {\n            numbers.sort(asc ? ascending : descending);\n            var pos = numbers.indexOf(val);\n            if (pos < 0) {\n                return new CalcError$1(\"N/A\");\n            }\n            for (var i = pos; numbers[i] == val; ++i){}\n            return (pos + i + 1) / 2;\n        }).args([\n            [ \"value\", \"number\" ],\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n        defineFunction$1(\"kurt\", function(numbers){\n            var n = numbers.length;\n            var avg = _avg(numbers);\n            var variance = _var_sp(numbers, n-1, avg);\n            var stddev = Math.sqrt(variance);\n            var sum = numbers.reduce(function(sum, num){\n                return sum + Math.pow((num - avg) / stddev, 4);\n            }, 0);\n            return n*(n+1)/((n-1)*(n-2)*(n-3)) * sum\n                - 3*Math.pow(n-1, 2)/((n-2)*(n-3));\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 4\", \"NUM\" ] ]\n        ]);\n\n        function _percentrank(numbers, x, exc) {\n            var nlt = 0, ngt = 0, left = null, right = null, found = false;\n            numbers.forEach(function(num){\n                if (num < x) {\n                    nlt++;\n                    left = left == null ? num : Math.max(left, num);\n                } else if (num > x) {\n                    ngt++;\n                    right = right == null ? num : Math.min(right, num);\n                } else {\n                    found = true;\n                }\n            });\n            if (!nlt && !ngt) {\n                return new CalcError$1(\"N/A\");\n            }\n            if (found) {\n                if (exc) {\n                    return (nlt + 1) / (numbers.length + 1);\n                }\n                return nlt / (nlt + ngt);\n            }\n            return ((right - x) * _percentrank(numbers, left, exc) +\n                    (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n        }\n\n        var ARGS_PERCENTRANK = [\n            [ \"array\", [ \"collect\", \"number\", 1 ] ],\n            [ \"x\", \"number\" ],\n            [ \"significance\", [ \"or\", [ \"null\", 3 ], \"integer++\" ] ],\n            [ \"?\", [ \"assert\", \"$array.length > 0\", \"NUM\" ] ]\n        ];\n\n        defineFunction$1(\"percentrank.inc\", function(numbers, x, significance) {\n            var p = _percentrank(numbers, x, 0);\n            p = p.toFixed(significance + 1);\n            return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n\n        defineFunction$1(\"percentrank.exc\", function(numbers, x, significance) {\n            var p = _percentrank(numbers, x, 1);\n            p = p.toFixed(significance + 1);\n            return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n\n        defineAlias(\"percentrank\", \"percentrank.inc\");\n\n        function _covariance(x, y, divisor) {\n            var sum = 0;\n            var ax = _avg(x);\n            var ay = _avg(y);\n            var n = x.length;\n            for (var i = 0; i < n; ++i) {\n                sum += (x[i] - ax) * (y[i] - ay);\n            }\n            return sum / divisor;\n        }\n\n        defineFunction$1(\"covariance.p\", function(x, y){\n            return _covariance(x, y, x.length);\n        }).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length > 0\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"covariance.s\", function(x, y){\n            return _covariance(x, y, x.length - 1);\n        }).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length > 1\", \"DIV/0\" ] ]\n        ]);\n\n        defineAlias(\"covar\", \"covariance.p\");\n\n        /* -----[ Factorials ]----- */\n\n        var _fact = util.memoize(function(n){\n            for (var i = 2, fact = 1; i <= n; ++i) {\n                fact *= i;\n            }\n            return fact;\n        });\n\n        defineFunction$1(\"fact\", _fact).args([\n            [ \"*n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"factdouble\", function(n){\n            for (var i = 2 + (n&1), fact = 1; i <= n; i += 2) {\n                fact *= i;\n            }\n            return fact;\n        }).args([\n            [ \"*n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"multinomial\", function(numbers){\n            var div = 1, sum = 0;\n            numbers.forEach(function(n){\n                if (n < 0) {\n                    throw new CalcError$1(\"NUM\");\n                }\n                sum += n;\n                div *= _fact(n);\n            });\n            return _fact(sum) / div;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ]\n        ]);\n\n        var _combinations = util.memoize(function (n, k){\n            for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n                p1 *= f1;\n                p2 *= f2;\n            }\n            return p1/p2;\n        });\n\n        defineFunction$1(\"combin\", _combinations).args([\n            [ \"*n\", \"integer++\" ],\n            [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$n\" ] ] ]\n        ]);\n\n        defineFunction$1(\"combina\", function(n, k){\n            return _combinations(n + k - 1, n - 1);\n        }).args([\n            [ \"*n\", \"integer++\" ],\n            [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 1, \"$n\" ] ] ]\n        ]);\n\n        /* -----[ Statistical functions ]----- */\n\n        defineFunction$1(\"average\", function(numbers){\n            var sum = numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0);\n            return sum / numbers.length;\n        }).args([\n            // most numeric functions must treat booleans as numbers (1 for TRUE\n            // and 0 for FALSE), but AVERAGE shouldn't.\n            [ \"numbers\", [ \"collect\", \"number!\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction$1(\"averagea\", function(values){\n            var sum = 0, count = 0;\n            values.forEach(function(num){\n                if (typeof num != \"string\") {\n                    sum += num;\n                }\n                ++count;\n            });\n            return count ? sum / count : new CalcError$1(\"DIV/0\");\n        }).args([\n            [ \"values\", [ \"collect\", \"anyvalue\" ] ]\n        ]);\n\n        function _percentile(numbers, rank) {\n            numbers.sort(ascending);\n            var n = numbers.length;\n            var k = rank | 0, d = rank - k;\n            if (k === 0) {\n                return numbers[0];\n            }\n            if (k >= n) {\n                return numbers[n - 1];\n            }\n            --k;\n            return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n        }\n\n        function _percentile_inc(numbers, p){\n            // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n            var rank = p * (numbers.length - 1) + 1;\n            return _percentile(numbers, rank);\n        }\n\n        function _percentile_exc(numbers, p){\n            // https://en.wikipedia.org/wiki/Percentile#NIST_method\n            var rank = p * (numbers.length + 1);\n            return _percentile(numbers, rank);\n        }\n\n        defineFunction$1(\"percentile.inc\", _percentile_inc).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"percentile.exc\", _percentile_exc).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"p\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"quartile.inc\", function(numbers, quarter){\n            return _percentile_inc(numbers, quarter / 4);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n        ]);\n\n        defineFunction$1(\"quartile.exc\", function(numbers, quarter){\n            return _percentile_exc(numbers, quarter / 4);\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n            [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n        ]);\n\n        defineAlias(\"quartile\", \"quartile.inc\");\n        defineAlias(\"percentile\", \"percentile.inc\");\n\n        var AGGREGATE_FUNCS = [\n            \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n            \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n            \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n            \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n        ];\n\n        function fetchValuesForAggregate(self, args, options) {\n            var values = [];\n            var opt_ignore_hidden_rows = 1;\n            var opt_ignore_errors = 2;\n            var opt_use_aggregates = 4;\n            (function fetchValues(args) {\n                if (args instanceof Ref) {\n                    self.getRefCells(args, true).forEach(function(cell){\n                        var value = cell.value;\n                        if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                            return;\n                        }\n                        if (cell.formula) {\n                            // XXX: formula.print is fast, but still, can't we do any better here?\n                            //      perhaps access the input string directly somehow?\n                            var str = cell.formula.print(cell.row, cell.col);\n                            if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                                if (!(options & opt_use_aggregates)) {\n                                    return;\n                                }\n                            }\n                        }\n                        if ((options & opt_ignore_errors) && value instanceof CalcError$1) {\n                            return;\n                        }\n                        if (typeof value == \"number\" || value instanceof CalcError$1) {\n                            values.push(value);\n                        }\n                    });\n                } else if (Array.isArray(args)) {\n                    for (var i = 0; i < args.length; ++i) {\n                        fetchValues(args[i]);\n                    }\n                } else if (args instanceof Matrix) {\n                    args.each(fetchValues);\n                } else if (typeof args == \"number\") {\n                    values.push(args);\n                } else if (args instanceof CalcError$1 && !(options & opt_ignore_errors)) {\n                    values.push(args);\n                }\n            })(args);\n            return values;\n        }\n\n        // AGGREGATE function\n        //\n        // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n        //\n        // we can only partially type-check this function.  also, we need to use the async version in\n        // order to resolve references and delegate values to the function to aggregate.\n        defineFunction$1(\"aggregate\", function(callback, funcId, options, args){\n            // options is a bit field.  that makes sense; it's the documentation which doesn't.\n            var self = this;\n            self.resolveCells(args, function(){\n                var values;\n                if (funcId > 12) {\n                    // \"array form\"\n                    values = fetchValuesForAggregate(self, args[0], options);\n                    var k = args[1];\n                    if (k instanceof CellRef$1) {\n                        k = self.getRefData(k);\n                    }\n                    if (typeof k != \"number\") {\n                        return callback(new CalcError$1(\"VALUE\"));\n                    }\n                } else {\n                    values = fetchValuesForAggregate(self, args, options);\n                }\n                self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n            });\n        }).argsAsync([\n            [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n                          11, 12, 13, 14, 15, 16, 17, 18, 19 ] ],\n            [ \"options\", [ \"or\",\n                           [ \"null\", 0 ],\n                           [ \"values\", 0, 1, 2, 3, 4, 5, 6, 7  ] ] ],\n            [ \"args\", \"rest\" ]\n        ]);\n\n        defineFunction$1(\"subtotal\", function(callback, funcId){\n            var arguments$1 = arguments;\n\n            var self = this;\n            var ignoreHidden = funcId > 100;\n            if (ignoreHidden) {\n                funcId -= 100;\n            }\n            var args = [];\n            for (var i = 2; i < arguments.length; ++i) {\n                args.push(arguments$1[i]);\n            }\n            self.resolveCells(args, function(){\n                var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n                self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n            });\n        }).argsAsync([\n            [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,\n                          101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111 ] ],\n            [ \"+\", [ \"ref\", [ \"or\", \"ref\", \"#matrix\" ] ] ]\n        ]);\n\n        // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n        defineFunction$1(\"avedev\", function(numbers){\n            var avg = numbers.reduce(function(sum, num){\n                return sum + num;\n            }, 0) / numbers.length;\n            return numbers.reduce(function(sum, num){\n                return sum + Math.abs(num - avg);\n            }, 0) / numbers.length;\n        }).args([\n            [ \"numbers\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n        ]);\n\n        function _binom_dist(x, n, p, cumulative) {\n            if (!cumulative) {\n                return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n            } else {\n                var sum = 0;\n                for (var j = 0; j <= x; ++j) {\n                    sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n                }\n                return sum;\n            }\n        }\n\n        defineFunction$1(\"binom.dist\", _binom_dist).args([\n            [ \"successes\", \"integer+\" ],\n            [ \"trials\", [ \"and\", \"integer\", [ \"assert\", \"$trials >= $successes\" ] ] ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineAlias(\"binomdist\", \"binom.dist\");\n\n        defineFunction$1(\"binom.inv\", function(n, p, alpha){\n            // XXX: could a binary search be faster?\n            for (var x = 0; x <= n; ++x) {\n                if (_binom_dist(x, n, p, true) >= alpha) {\n                    return x;\n                }\n            }\n            return new CalcError$1(\"N/A\"); // XXX: is this right?\n        }).args([\n            [ \"trials\", \"integer+\" ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineAlias(\"critbinom\", \"binom.inv\");\n\n        defineFunction$1(\"binom.dist.range\", function(n, p, s, s2){\n            var sum = 0;\n            for (var k = s; k <= s2; ++k) {\n                sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1-p, n-k);\n            }\n            return sum;\n        }).args([\n            [ \"trials\", \"integer+\" ],\n            [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"successes_min\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$trials\" ] ] ],\n            [ \"successes_max\", [ \"or\",\n                                 [ \"and\", \"integer\",\n                                   [ \"[between]\", \"$successes_min\", \"$trials\" ] ],\n                                 [ \"null\", \"$successes_min\" ] ] ]\n        ]);\n\n        defineFunction$1(\"negbinom.dist\", function(x, k, p, cumulative){\n            if (cumulative) {\n                var sum = 0;\n                while (x >= 0) {\n                    sum += _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n                    x--;\n                }\n                return sum;\n            }\n            return _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n        }).args([\n            [ \"number_f\", \"integer+\" ],\n            [ \"number_s\", \"integer+\" ],\n            [ \"probability_s\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n        /* -----[ lookup functions ]----- */\n\n        defineFunction$1(\"address\", function(row, col, abs, a1, sheet){\n            // by some lucky coincidence, we get the corret `rel` value by just subtracting 1 from the\n            // abs argument\n            var cell = new CellRef$1(row - 1, col - 1, abs - 1);\n            if (sheet) {\n                cell.setSheet(sheet, true);\n            }\n            return a1 ? cell.print(0, 0) : cell.print();\n        }).args([\n            [ \"row\", \"integer++\" ],\n            [ \"col\", \"integer++\" ],\n            [ \"abs\", [ \"or\", [ \"null\", 1 ], [ \"values\", 1, 2, 3, 4 ]]],\n            [ \"a1\", [ \"or\", [ \"null\", true ], \"logical\" ]],\n            [ \"sheet\", [ \"or\", \"null\", \"string\" ]]\n        ]);\n\n        defineFunction$1(\"areas\", function(ref){\n            var count = 0;\n            (function loop(x){\n                if (x instanceof CellRef$1 || x instanceof RangeRef) {\n                    count++;\n                } else if (x instanceof UnionRef) {\n                    x.refs.forEach(loop);\n                }\n                // XXX: NameRef if we add support\n            })(ref);\n            return count;\n        }).args([\n            [ \"ref\", \"ref\" ]\n        ]);\n\n        defineFunction$1(\"choose\", function(index, args){\n            if (index > args.length) {\n                return new CalcError$1(\"N/A\");\n            } else {\n                return args[index - 1];\n            }\n        }).args([\n            [ \"*index\", \"integer\" ],\n            [ \"+\", [ \"value\", \"anything\" ] ]\n        ]);\n\n        defineFunction$1(\"column\", function(ref){\n            if (!ref) {\n                return this.formula.col + 1;\n            }\n            if (ref instanceof CellRef$1) {\n                return ref.col + 1;\n            }\n            return this.asMatrix(ref).mapCol(function(col){\n                return col + ref.topLeft.col + 1;\n            });\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n        ]);\n\n        defineFunction$1(\"columns\", function(m){\n            return m instanceof Ref ? m.width() : m.width;\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n        ]);\n\n        defineFunction$1(\"formulatext\", function(ref){\n            var cell = this.getRefCells(ref)[0]; // XXX: overkill, but oh well.\n            if (!cell.formula) {\n                return new CalcError$1(\"N/A\");\n            }\n            return cell.formula.print(cell.row, cell.col);\n        }).args([\n            [ \"ref\", \"ref\" ]\n        ]);\n\n        defineFunction$1(\"hlookup\", function(value, m, row, approx){\n            var resultCol = null;\n            m.eachCol(function(col){\n                var data = m.get(0, col);\n                if (approx) {\n                    if (data > value) {\n                        return true;\n                    }\n                    resultCol = col;\n                } else if (data === value) {\n                    resultCol = col;\n                    return true;\n                }\n            });\n            if (resultCol == null) {\n                return new CalcError$1(\"N/A\");\n            }\n            return m.get(row - 1, resultCol);\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"row\", \"integer++\" ],\n            [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n        ]);\n\n        defineFunction$1(\"index\", function(callback, ref, row, col, areanum){\n            var self = this;\n            if (ref instanceof UnionRef) {\n                ref = ref.refs[areanum - 1];\n            }\n            if ((!row && !col) || !ref) {\n                return callback(new CalcError$1(\"N/A\"));\n            }\n            if (ref instanceof CellRef$1) {\n                ref = ref.toRangeRef();\n            }\n            if (ref instanceof RangeRef) {\n                if (row && col) {\n                    if (col > ref.width() || row > ref.height()) {\n                        return callback(new CalcError$1(\"REF\"));\n                    }\n                    // fetching a single cell\n                    var cell = ref.toCell(row - 1, col - 1);\n                    self.resolveCells([ cell ], function(){\n                        callback(self.getRefData(cell));\n                    });\n                    return;\n                }\n                if (!row) {\n                    // fetch a full column\n                    var colRange = ref.toColumn(col - 1);\n                    self.resolveCells([ colRange ], function(){\n                        callback(self.asMatrix(colRange));\n                    });\n                    return;\n                }\n                if (!col) {\n                    // fetch a full row\n                    var rowRange = ref.toRow(row - 1);\n                    self.resolveCells([ rowRange ], function(){\n                        callback(self.asMatrix(rowRange));\n                    });\n                    return;\n                }\n            }\n            else if (ref instanceof Matrix) {\n                if (ref.width > 1 && ref.height > 1) {\n                    if (row && col) {\n                        return callback(ref.get(row - 1, col - 1));\n                    }\n                    if (!row) {\n                        return callback(ref.mapRow(function(row){\n                            return ref.get(row, col - 1);\n                        }));\n                    }\n                    if (!col) {\n                        return callback(ref.mapCol(function(col){\n                            return ref.get(row - 1, col);\n                        }));\n                    }\n                }\n                if (ref.width == 1) {\n                    return callback(ref.get(row - 1, 0));\n                }\n                if (ref.height == 1) {\n                    return callback(ref.get(0, col - 1));\n                }\n            }\n            else {\n                callback(new CalcError$1(\"REF\"));\n            }\n        }).argsAsync([\n            [ \"range\", [ \"or\", \"ref\", \"matrix\" ] ],\n            [ \"row\", [ \"or\", \"integer+\", \"null\" ] ],\n            [ \"col\", [ \"or\", \"integer+\", \"null\" ] ],\n            [ \"areanum\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"indirect\", function(thing){\n            try {\n                // XXX: does more work than needed.  we could go for parseReference, but that one\n                // doesn't (yet?) support \"SheetName!\" prefix.\n                var f = this.formula;\n                var exp = calc$1.parseFormula(f.sheet, f.row, f.col, thing);\n                var ref = exp.ast;\n                if (ref instanceof NameRef) {\n                    ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n                }\n                if (!(ref instanceof Ref)) {\n                    throw 1;\n                }\n                return ref.absolute(f.row, f.col);\n            } catch(ex) {\n                return new CalcError$1(\"REF\");\n            }\n        }).args([\n            [ \"thing\", \"string\" ]\n        ]);\n\n        // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n        // XXX: double-check this one.\n        defineFunction$1(\"match\", function(val, m, type){\n            var index = 1, cmp;\n            if (type === 0) {\n                cmp = parseCriteria(val);\n            } else if (type === -1) {\n                cmp = parseCriteria(\"<=\" + val);\n            } else if (type === 1) {\n                cmp = parseCriteria(\">=\" + val);\n            }\n            if (m.each(function(el){\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n                return index;\n            } else {\n                return new CalcError$1(\"N/A\");\n            }\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"type\", [ \"or\",\n                        [ \"values\", -1, 0, 1 ],\n                        [ \"null\", 1 ]]]\n        ]);\n\n        defineFunction$1(\"offset\", function(ref, rows, cols, height, width){\n            var topLeft = (ref instanceof CellRef$1 ? ref : ref.topLeft).clone();\n            topLeft.row += rows;\n            topLeft.col += cols;\n            if (topLeft.row < 0 || topLeft.col < 0) {\n                return new CalcError$1(\"VALUE\");\n            }\n            if (height > 1 || width > 1) {\n                return new RangeRef(topLeft, new CellRef$1(topLeft.row + height - 1,\n                                                         topLeft.col + width - 1))\n                    .setSheet(ref.sheet, ref.hasSheet());\n            }\n            return topLeft;\n        }).args([\n            [ \"ref\", \"area\" ],\n            [ \"*rows\", \"integer\" ],\n            [ \"*cols\", \"integer\" ],\n            [ \"*height\", [ \"or\", \"integer++\", [ \"null\", \"$ref.height()\" ]]],\n            [ \"*width\", [ \"or\", \"integer++\", [ \"null\", \"$ref.width()\" ]]]\n        ]);\n\n        defineFunction$1(\"row\", function(ref){\n            if (!ref) {\n                return this.formula.row + 1;\n            }\n            if (ref instanceof CellRef$1) {\n                return ref.row + 1;\n            }\n            return this.asMatrix(ref).mapRow(function(row){\n                return row + ref.topLeft.row + 1;\n            });\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n        ]);\n\n        defineFunction$1(\"rows\", function(m){\n            return m instanceof Ref ? m.height() : m.height;\n        }).args([\n            [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n        ]);\n\n        defineFunction$1(\"vlookup\", function(value, m, col, approx){\n            var resultRow = null;\n            if (typeof value != \"number\") {\n                approx = false;\n            }\n            if (typeof value == \"string\") {\n                value = value.toLowerCase();\n            }\n            m.eachRow(function(row){\n                var data = m.get(row, 0);\n                if (approx) {\n                    if (data > value) {\n                        return true;\n                    }\n                    resultRow = row;\n                } else {\n                    if (typeof data == \"string\") {\n                        data = data.toLowerCase();\n                    }\n                    if (data === value) {\n                        resultRow = row;\n                        return true;\n                    }\n                }\n            });\n            if (resultRow == null) {\n                return new CalcError$1(\"N/A\");\n            }\n            return m.get(resultRow, col - 1);\n        }).args([\n            [ \"value\", \"anyvalue\" ],\n            [ \"range\", \"matrix\" ],\n            [ \"col\", \"integer++\" ],\n            [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n        ]);\n\n        /* -----[ Date and time functions ]----- */\n\n        defineFunction$1(\"date\", function(year, month, date){\n            return packDate$1(year, month-1, date);\n        }).args([\n            [ \"*year\", \"integer\" ],\n            [ \"*month\", \"integer\" ],\n            [ \"*date\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"day\", function(date){\n            return unpackDate$1(date).date;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"month\", function(date){\n            return unpackDate$1(date).month + 1;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"year\", function(date){\n            return unpackDate$1(date).year;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"weekday\", function(date){\n            // XXX: TODO type\n            return unpackDate$1(date).day + 1;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n        // XXX: this is a mess.\n        defineFunction$1(\"weeknum\", function(date, type){\n            var fw = packDate$1(unpackDate$1(date).year, 0, 1);\n            var sy = unpackDate$1(fw);\n            var diff;\n            if (type == 21) {\n                // Monday-based weeks, first week is the one containing the first Thursday of the year\n                // we want to place in fw and sy the first Thursday\n                diff = 3 - (sy.day + 6) % 7;\n                if (diff < 0) {\n                    diff += 7;\n                }\n                fw += diff;\n                sy.date += diff;\n                sy.day = 4;         // Thursday.\n                type = 1;\n            } else {\n                if (type == 1) {\n                    type = 0;\n                } else if (type == 2) {\n                    type = 1;\n                } else {\n                    type = (type - 10) % 7;\n                }\n                // finally compatible with what we got:\n                // type == 0 means week starts on Sunday\n                //         1                      Monday\n                //         2                      Tuesday\n                // ...\n            }\n            diff = sy.day - type;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw -= diff;\n            return Math.ceil((date + 1 - fw) / 7);\n        }).args([\n            [ \"*date\", \"date\" ],\n            [ \"*type\", [ \"or\", [ \"null\", 1 ],\n                         [ \"values\", 1, 2, 11, 12, 13, 14, 15, 16, 17, 21 ] ] ]\n        ]);\n\n        function weeksInYear(year) {\n            var d = unpackDate$1(packDate$1(year, 0, 1));\n            if ((d.day == 4) || (d.day == 3 && runtime$2.isLeapYear(year))) {\n                // long year\n                return 53;\n            }\n            return 52;\n        }\n\n        defineFunction$1(\"isoweeknum\", function isoweeknum(date){\n            // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_the_week_number_of_a_given_date\n            var d = unpackDate$1(date);\n            var dow = d.day || 7;\n            var wk = Math.floor((d.ord - dow + 10) / 7);\n            if (wk < 1) {\n                return weeksInYear(d.year - 1);\n            } else if (wk == 53 && wk > weeksInYear(d.year)) {\n                return 1;\n            }\n            return wk;\n        }).args([\n            [ \"*date\", \"date\" ]\n        ]);\n\n        defineFunction$1(\"now\", function(){\n            return runtime$2.dateToSerial(new Date());\n        }).args([]);\n\n        defineFunction$1(\"today\", function(){\n            return runtime$2.dateToSerial(new Date()) | 0;\n        }).args([]);\n\n        defineFunction$1(\"time\", function(hh, mm, ss){\n            return runtime$2.packTime(hh, mm, ss, 0);\n        }).args([\n            [ \"*hours\", \"integer\" ],\n            [ \"*minutes\", \"integer\" ],\n            [ \"*seconds\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"hour\", function(time){\n            return runtime$2.unpackTime(time).hours;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"minute\", function(time){\n            return runtime$2.unpackTime(time).minutes;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"second\", function(time){\n            return runtime$2.unpackTime(time).seconds;\n        }).args([\n            [ \"*time\", \"datetime\" ]\n        ]);\n\n        defineFunction$1(\"edate\", function(base, months){\n            var d = unpackDate$1(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = Math.min(d.date, daysInMonth$1(y, m));\n            return packDate$1(y, m, d);\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*months\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"eomonth\", function(base, months){\n            var d = unpackDate$1(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = daysInMonth$1(y, m);\n            return packDate$1(y, m, d);\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*months\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"workday\", function(date, n, holidays){\n            // XXX: the algorithm here is pretty dumb, can we do better?\n            var inc = n > 0 ? 1 : -1;\n            n = Math.abs(n);\n            var dow = unpackDate$1(date).day;\n            while (n > 0) {\n                date += inc;\n                dow = (dow + inc) % 7;\n                if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                    --n;\n                }\n            }\n            return date;\n        }).args([\n            [ \"start_date\", \"date\" ],\n            [ \"days\", \"integer\" ],\n            [ \"holidays\", [ \"collect\", \"date\" ] ]\n        ]);\n\n        defineFunction$1(\"networkdays\", function(date, end, holidays){\n            // XXX: the algorithm here is pretty dumb, can we do better?\n            if (date > end) {\n                var tmp = date;\n                date = end;\n                end = tmp;\n            }\n            var count = 0;\n            var dow = unpackDate$1(date).day;\n            while (date <= end) {\n                if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                    count++;\n                }\n                date++;\n                dow = (dow + 1) % 7;\n            }\n            return count;\n        }).args([\n            [ \"start_date\", \"date\" ],\n            [ \"end_date\", \"date\" ],\n            [ \"holidays\", [ \"collect\", \"date\" ] ]\n        ]);\n\n        defineFunction$1(\"days\", function(end, start){\n            return end - start;\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ]\n        ]);\n\n        function _days_360$1(start, end, method) {\n            var d1 = unpackDate$1(start);\n            var d2 = unpackDate$1(end);\n\n            // https://en.wikipedia.org/wiki/360-day_calendar\n            // humanity is a mess.\n            if (method) {\n                // EU method\n                if (d1.date == 31) {\n                    d1.date = 30;\n                }\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                // US method\n                if (d1.month == 1 && d2.month == 1\n                    && d1.date == daysInMonth$1(d1.year, 1)\n                    && d2.date == daysInMonth$1(d2.year, 1)) {\n                    d2.date = 30;\n                }\n                if (d1.date == daysInMonth$1(d1.year, d1.month)) {\n                    d1.date = 30;\n                    if (d2.date == 31) {\n                        d2.date = 30;\n                    }\n                } else {\n                    if (d1.date == 30 && d2.date == 31) {\n                        d2.date = 30;\n                    }\n                }\n            }\n\n            return (360 * (d2.year - d1.year)\n                    + 30 * (d2.month - d1.month)\n                    + (d2.date - d1.date));\n        }\n\n        runtime$2._days_360 = _days_360$1;\n\n        defineFunction$1(\"days360\", _days_360$1).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ],\n            [ \"*method\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction$1(\"yearfrac\", function(start, end, method){\n            switch (method) {\n              case 0:\n                return _days_360$1(start, end, false) / 360;\n              case 1:\n                return (end - start) / daysInYear$1(unpackDate$1(start).year);\n              case 2:\n                return (end - start) / 360;\n              case 3:\n                return (end - start) / 365;\n              case 4:\n                return _days_360$1(start, end, true) / 360;\n            }\n        }).args([\n            [ \"*start_date\", \"date\" ],\n            [ \"*end_date\", \"date\" ],\n            [ \"*method\", [ \"or\", [ \"null\", 0 ], [ \"values\", 0, 1, 2, 3, 4 ] ] ]\n        ]);\n\n        defineFunction$1(\"datevalue\", function(text){\n            var date = runtime$2.parseDate(text);\n            if (date) {\n                return runtime$2.dateToSerial(date);\n            }\n            return new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"timevalue\", function(text){\n            var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n            if (m) {\n                var hh = parseFloat(m[1]);\n                var mm = parseFloat(m[2]);\n                var ss = m[3] ? parseFloat(m[4]) : 0;\n                //var ms = m[5] ? parseFloat(m[6]) : 0;\n                var ampm = m[7];\n                if (ampm && (hh > 12 || hh < 1)) {\n                    return new CalcError$1(\"VALUE\");\n                }\n                if (/^p/.test(ampm)) {\n                    hh += 12;\n                }\n                return runtime$2.packTime(hh, mm, ss, 0);\n            }\n            return new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        /* -----[ Matrix functions ]----- */\n\n        defineFunction$1(\"mdeterm\", function(m){\n            var error = m.each(function(val){\n                if (typeof val != \"number\") {\n                    return new CalcError$1(\"VALUE\");\n                }\n            }, true);\n            return error || m.determinant();\n        }).args([\n            [ \"m\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$m.width == $m.height\" ] ] ]\n        ]);\n\n        defineFunction$1(\"transpose\", function(m){\n            return m.transpose();\n        }).args([\n            [ \"range\", \"matrix\" ]\n        ]);\n\n        defineFunction$1(\"mmult\", function(a, b){\n            return a.multiply(b);\n        }).args([\n            [ \"a\", \"matrix\" ],\n            [ \"b\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$b.height == $a.width\" ] ] ]\n        ]);\n\n        defineFunction$1(\"munit\", function(n){\n            return new Matrix(this).unit(n);\n        }).args([\n            [ \"n\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"minverse\", function(m){\n            var error = m.each(function(val){\n                if (typeof val != \"number\") {\n                    return new CalcError$1(\"VALUE\");\n                }\n            }, true);\n            return error || m.inverse() || new CalcError$1(\"VALUE\");\n        }).args([\n            [ \"m\", [ \"and\", \"matrix\",\n                     [ \"assert\", \"$m.width == $m.height\" ] ] ]\n        ]);\n\n        /* -----[ Other ]----- */\n\n        defineFunction$1(\"rand\", function() {\n            return Math.random();\n        }).args([]);\n\n        defineFunction$1(\"randbetween\", function(min, max){\n            return min + Math.floor((max - min + 1) * Math.random());\n        }).args([\n            [ \"min\", \"integer\" ],\n            [ \"max\", [ \"and\", \"integer\", [ \"assert\", \"$max >= $min\" ] ] ]\n        ]);\n\n        defineFunction$1(\"true\", function(){\n            return true;\n        }).args([]);\n\n        defineFunction$1(\"false\", function(){\n            return true;\n        }).args([]);\n\n        defineFunction$1(\"roman\", function(num){\n            return util.arabicToRoman(num).toUpperCase();\n        }).args([\n            [ \"*number\", \"integer\" ]\n        ]);\n\n        defineFunction$1(\"arabic\", function(rom){\n            var num = util.romanToArabic(rom);\n            return num == null ? new CalcError$1(\"VALUE\") : num;\n        }).args([\n            [ \"*roman\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"base\", function(number, radix, minLen){\n            var str = number.toString(radix).toUpperCase();\n            while (str.length < minLen) {\n                str = \"0\" + str;\n            }\n            return str;\n        }).args([\n            [ \"*number\", \"integer\" ],\n            [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ],\n            [ \"*minLen\", [ \"or\", \"integer+\", [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction$1(\"decimal\", function(text, radix){\n            text = text.toUpperCase();\n            var val = 0;\n            for (var i = 0; i < text.length; ++i) {\n                var d = text.charCodeAt(i);\n                if (d >= 48 && d <= 57) {\n                    d -= 48;\n                } else if (d >= 65 && d < (55 + radix)) {\n                    d -= 55;\n                } else {\n                    return new CalcError$1(\"VALUE\");\n                }\n                val = val * radix + d;\n            }\n            return val;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ]\n        ]);\n\n        /* -----[ String functions ]----- */\n\n        defineFunction$1(\"char\", function(code){\n            return String.fromCharCode(code);\n        }).args([\n            [ \"*code\", \"integer+\" ]\n        ]);\n\n        // From XRegExp\n        var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\n        defineFunction$1(\"clean\", function(text){\n            return text.replace(RX_NON_PRINTABLE, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"code\", function(text){\n            return text.charAt(0);\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineAlias(\"unichar\", \"char\");\n        defineAlias(\"unicode\", \"code\");\n\n        defineFunction$1(\"concatenate\", function(args){\n            var out = \"\";\n            for (var i = 0; i < args.length; ++i) {\n                out += args[i];\n            }\n            return out;\n        }).args([\n            [ \"+\",\n              [ \"*text\", \"string\" ] ]\n        ]);\n\n        defineFunction$1(\"dollar\", function(number, decimals){\n            var format = \"$#,##0DECIMALS;($#,##0DECIMALS)\";\n            var dec = \"\";\n            var denomitator = 1;\n\n            while (decimals-- > 0) {\n              dec += \"0\";\n            }\n\n            while (++decimals < 0) {\n              denomitator *= 10;\n            }\n\n            if (dec !== \"\") {\n              dec = \".\" + dec;\n            } else if (denomitator !== 1) {\n                number = Math.round(number / denomitator) * denomitator;\n            }\n\n            format = format.replace(/DECIMALS/g, dec);\n\n            return spreadsheet$3.formatting.text(number, format);\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ]\n        ]);\n\n        defineFunction$1(\"exact\", function(a, b){\n            return a === b;\n        }).args([\n            [ \"*text1\", \"string\" ],\n            [ \"*text2\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"find\", function(substring, string, start){\n            var pos = string.indexOf(substring, start - 1);\n            return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n        }).args([\n            [ \"*substring\", \"string\" ],\n            [ \"*string\", \"string\" ],\n            [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"fixed\", function(number, decimals, noCommas){\n            var scale = Math.pow(10, decimals);\n            number = Math.round(number * scale) / scale;\n            var format = noCommas ? \"0\" : \"#,##0\";\n            if (decimals > 0) {\n                format += \".\";\n                while (decimals-- > 0) { format += \"0\"; }\n            }\n            return spreadsheet$3.formatting.text(number, format);\n        }).args([\n            [ \"*number\", \"number\" ],\n            [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ],\n            [ \"*noCommas\", [ \"or\", \"boolean\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction$1(\"left\", function(text, length){\n            return text.substr(0, length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"right\", function(text, length){\n            return text.substr(-length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"len\", function(text){\n            return text.length;\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"lower\", function(text){\n            return text.toLowerCase();\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"upper\", function(text){\n            return text.toUpperCase();\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"ltrim\", function(text){\n            return text.replace(/^\\s+/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"rtrim\", function(text){\n            return text.replace(/\\s+$/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"trim\", function(text){\n            return text.replace(/^\\s+|\\s+$/, \"\");\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"mid\", function(text, start, length){\n            return text.substr(start - 1, length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*start\", \"integer++\" ],\n            [ \"*length\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"proper\", function(text){\n            return text.toLowerCase().replace(/\\b./g, function(s){\n                return s.toUpperCase();\n            });\n        }).args([\n            [ \"*text\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"replace\", function(text, start, length, newText){\n            return text.substr(0, --start) + newText + text.substr(start + length);\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*start\", \"integer++\" ],\n            [ \"*length\", \"integer+\" ],\n            [ \"*newText\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"rept\", function(text, number){\n            var out = \"\";\n            while (number-- > 0) { out += text; }\n            return out;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*number\", \"integer+\" ]\n        ]);\n\n        defineFunction$1(\"search\", function(substring, string, start){\n            var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n            return pos < 0 ? new CalcError$1(\"VALUE\") : pos + 1;\n        }).args([\n            [ \"*substring\", \"string\" ],\n            [ \"*string\", \"string\" ],\n            [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction$1(\"substitute\", function(text, oldText, newText, nth){\n            if (oldText === newText) {\n                return text;\n            }\n            var a = text.split(oldText);\n            if (nth == null) {\n                return a.join(newText);\n            }\n            text = \"\";\n            nth--;\n            for (var i = 0; i < a.length; ++i) {\n                text += a[i];\n                if (i < a.length - 1) {\n                    if (i === nth) {\n                        text += newText;\n                    } else {\n                        text += oldText;\n                    }\n                }\n            }\n            return text;\n        }).args([\n            [ \"*text\", \"string\" ],\n            [ \"*oldText\", \"string\" ],\n            [ \"*newText\", \"string\" ],\n            [ \"*nth\", [ \"or\", \"integer++\", \"null\" ] ]\n        ]);\n\n        defineFunction$1(\"t\", function(value){\n            return typeof value == \"string\" ? value : \"\";\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        defineFunction$1(\"text\", function(value, format){\n            return spreadsheet$3.formatting.text(value, format);\n        }).args([\n            [ \"*value\", \"anyvalue\" ],\n            [ \"*format\", \"string\" ]\n        ]);\n\n        defineFunction$1(\"value\", function(value){\n            if (typeof value == \"number\") {\n                return value;\n            }\n            if (typeof value == \"boolean\") {\n                return +value;\n            }\n            // XXX: this is dirty.  we need it so we can parse i.e. \"$12,345.50\"\n            value = (value+\"\").replace(/[$€,]/g, \"\");\n            value = parseFloat(value);\n            return isNaN(value) ? new CalcError$1(\"VALUE\") : value;\n        }).args([\n            [ \"*value\", \"anyvalue\" ]\n        ]);\n\n        function Hyperlink(link, text) {\n            this.link = link;\n            this.text = text;\n        }\n        Hyperlink.prototype.toString = function() {\n            return this.text;\n        };\n\n        defineFunction$1(\"hyperlink\", function(link, text){\n            return new Hyperlink(link, text);\n        }).args([\n            [ \"*link\", \"string\" ],\n            [ \"*text\", [ \"or\", \"string\", [ \"null\", \"$link\" ] ] ]\n        ]);\n\n        //// other misc functions\n\n        defineFunction$1(\"iferror\", function(value, valueIfError){\n            return value instanceof CalcError$1 ? valueIfError : value;\n        }).args([\n            [ \"*value\", \"forced!\" ],\n            [ \"*value_if_error\", \"anyvalue!\" ]\n        ]);\n\n        //// utils\n\n        var parseCriteria = (function(){\n            var RXCACHE = Object.create(null);\n\n            function makeComparator(cmp, x) {\n                if (typeof x == \"string\") {\n                    var num = parseFloat(x);\n                    if (!isNaN(num) && num == x) {\n                        x = num;\n                    }\n                }\n                return function(a) {\n                    var b = x;\n                    if (typeof a == \"string\" && typeof b == \"string\") {\n                        a = a.toLowerCase();\n                        b = b.toLowerCase();\n                    }\n                    return cmp(a, b);\n                };\n            }\n\n            function lc(a) {\n                var num, str;\n                if (typeof a == \"string\") {\n                    a = a.toLowerCase();\n                }\n                if (/^[0-9.]+%$/.test(a)) {\n                    str = a.substr(0, a.length - 1);\n                    num = parseFloat(str);\n                    if (!isNaN(num) && num == str) {\n                        a = num / 100;\n                    }\n                } else if (/^[0-9.]+$/.test(a)) {\n                    num = parseFloat(a);\n                    if (!isNaN(num) && num == a) {\n                        a = num;\n                    }\n                }\n                return a;\n            }\n\n            function compLT(a, b) { return lc(a) < lc(b); }\n            function compLTE(a, b) { return lc(a) <= lc(b); }\n            function compGT(a, b) { return lc(a) > lc(b); }\n            function compGTE(a, b) { return lc(a) >= lc(b); }\n            function compNE(a, b) { return !compEQ(a, b); }\n            function compEQ(a, b) {\n                if (b instanceof RegExp) {\n                    return b.test(a);\n                }\n                if (typeof a == \"string\" || typeof b == \"string\") {\n                    // if either one is string, make sure both are strings\n                    a = String(a);\n                    b = String(b);\n                }\n                return lc(a) == lc(b);\n            }\n\n            return function(cmp) {\n                if (typeof cmp == \"function\") {\n                    return cmp;\n                }\n                var m;\n                if ((m = /^=(.*)$/.exec(cmp))) {\n                    return makeComparator(compEQ, m[1]);\n                }\n                if ((m = /^<>(.*)$/.exec(cmp))) {\n                    return makeComparator(compNE, m[1]);\n                }\n                if ((m = /^<=(.*)$/.exec(cmp))) {\n                    return makeComparator(compLTE, m[1]);\n                }\n                if ((m = /^<(.*)$/.exec(cmp))) {\n                    return makeComparator(compLT, m[1]);\n                }\n                if ((m = /^>=(.*)$/.exec(cmp))) {\n                    return makeComparator(compGTE, m[1]);\n                }\n                if ((m = /^>(.*)$/.exec(cmp))) {\n                    return makeComparator(compGT, m[1]);\n                }\n                if (/[?*]/.exec(cmp)) {\n                    // has wildchars\n                    var rx = RXCACHE[cmp];\n                    if (!rx) {\n                        rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                            switch (s) {\n                              case \"~?\" : return \"\\\\?\";\n                              case \"~*\" : return \"\\\\*\";\n                              case \"?\"  : return \".\";\n                              case \"*\"  : return \".*\";\n                              default   : return \"\\\\\" + s;\n                            }\n                        });\n                        rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n                    }\n                    return makeComparator(compEQ, rx);\n                }\n                return makeComparator(compEQ, cmp);\n            };\n        })();\n\n        function numericPredicate(val) {\n            return typeof val == \"number\"\n                || typeof val == \"boolean\"\n                || val == null\n                || val === \"\";\n        }\n\n        function ascending(a, b) {\n            return a === b ? 0 : a < b ? -1 : 1;\n        }\n\n        function descending(a, b) {\n            return a === b ? 0 : a < b ? 1 : -1;\n        }\n\n        // var m = new Matrix();\n        // m.data = [[1, 2, 3], [4, 1, 6], [7, 8, 9]];\n        // //m.data = [[0, 2, 1], [2, 6, 1], [1, 1, 4]];\n        // //m.data = [[1,4,1,1], [1,4,0,1], [2,3,1,2], [3,2,6,4]];\n        // m.width = m.height = 3;\n        // var x = m.inverse();\n        // x.dump();\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n\n\n        var spreadsheet$2 = kendo.spreadsheet;\n        var calc = spreadsheet$2.calc;\n        var runtime$1 = calc.runtime;\n        var defineFunction = runtime$1.defineFunction;\n        var CalcError = runtime$1.CalcError;\n        var packDate = runtime$1.packDate;\n        var unpackDate = runtime$1.unpackDate;\n        var isLeapYear = runtime$1.isLeapYear;\n        var daysInMonth = runtime$1.daysInMonth;\n        var _days_360 = runtime$1._days_360;\n\n        /* -----[ Spreadsheet API ]----- */\n\n        defineFunction(\"ERF\", function(ll, ul) {\n            if (ul == null) {\n                return ERF(ll);\n            }\n            return ERF(ul) - ERF(ll);\n        }).args([\n            [ \"lower_limit\", \"number\" ],\n            [ \"upper_limit\", [ \"or\", \"number\", \"null\" ] ]\n        ]);\n\n        defineFunction(\"ERFC\", ERFC).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"GAMMALN\", GAMMALN).args([\n            [ \"x\", \"number++\" ]\n        ]);\n\n        defineFunction(\"GAMMA\", GAMMA).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"GAMMA.DIST\", GAMMA_DIST).args([\n            [ \"x\", \"number+\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"GAMMA.INV\", GAMMA_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ]\n        ]);\n\n        defineFunction(\"NORM.S.DIST\", NORM_S_DIST).args([\n            [ \"z\", \"number\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"NORM.S.INV\", NORM_S_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n        ]);\n\n        defineFunction(\"NORM.DIST\", NORM_DIST).args([\n            [ \"x\", \"number\" ],\n            [ \"mean\", \"number\" ],\n            [ \"stddev\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"NORM.INV\", NORM_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"mean\", \"number\" ],\n            [ \"stddev\", \"number++\" ]\n        ]);\n\n        defineFunction(\"BETADIST\", BETADIST).args([\n            [ \"x\", \"number\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"BETA.DIST\", BETA_DIST).args([\n            [ \"x\", \"number\" ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ],\n            [ \"?\", [ \"assert\", \"$x >= $A\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$x <= $B\", \"NUM\" ] ],\n            [ \"?\", [ \"assert\", \"$A < $B\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"BETA.INV\", BETA_INV).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"alpha\", \"number++\" ],\n            [ \"beta\", \"number++\" ],\n            [ \"A\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"B\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n        ]);\n\n        defineFunction(\"CHISQ.DIST\", chisq_left).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"CHISQ.DIST.RT\", chisq_right).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.INV\", chisq_left_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.INV.RT\", chisq_right_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"CHISQ.TEST\", function(ac, ex){\n            return chisq_test(ac.data, ex.data);\n        }).args([\n            [ \"actual_range\", \"matrix\" ],\n            [ \"expected_range\", \"matrix\" ],\n            [ \"?\", [ \"assert\", \"$actual_range.width == $expected_range.width\" ] ],\n            [ \"?\", [ \"assert\", \"$actual_range.height == $expected_range.height\" ] ]\n        ]);\n\n        defineFunction(\"EXPON.DIST\", expon).args([\n            [ \"x\", \"number+\" ],\n            [ \"lambda\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"POISSON.DIST\", poisson).args([\n            [ \"x\", \"integer+\" ],\n            [ \"mean\", \"number+\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"F.DIST\", Fdist).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"F.DIST.RT\", Fdist_right).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.INV\", Finv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.INV.RT\", Finv_right).args([\n            [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n            [ \"deg_freedom1\", \"integer++\" ],\n            [ \"deg_freedom2\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"F.TEST\", Ftest).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"FISHER\", fisher).args([\n            [ \"x\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n        ]);\n\n        defineFunction(\"FISHERINV\", fisherinv).args([\n            [ \"y\", \"number\" ]\n        ]);\n\n        defineFunction(\"T.DIST\", Tdist).args([\n            [ \"x\", \"number\" ],\n            [ \"deg_freedom\", \"integer++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"T.DIST.RT\", Tdist_right).args([\n            [ \"x\", \"number\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.DIST.2T\", Tdist_2tail).args([\n            [ \"x\", \"number+\" ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.INV\", Tdist_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.INV.2T\", Tdist_2tail_inv).args([\n            [ \"p\", [ \"and\", \"number\", [ \"(between]\", 0, 1 ] ] ],\n            [ \"deg_freedom\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"T.TEST\", Tdist_test).args([\n            [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n            [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n            [ \"tails\", [ \"and\", \"integer\", [ \"values\", 1, 2 ] ] ],\n            [ \"type\", [ \"and\", \"integer\", [ \"values\", 1, 2, 3 ] ] ],\n            [ \"?\", [ \"assert\", \"$type != 1 || $array1.length == $array2.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array1.length >= 2\", \"DIV/0\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length >= 2\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"CONFIDENCE.T\", confidence_t).args([\n            [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"size\", [ \"and\", \"integer++\",\n                        [ \"assert\", \"$size != 1\", \"DIV/0\" ] ] ]\n        ]);\n\n        defineFunction(\"CONFIDENCE.NORM\", confidence_norm).args([\n            [ \"alpha\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"size\", [ \"and\", \"integer++\" ] ]\n        ]);\n\n        defineFunction(\"GAUSS\", gauss).args([\n            [ \"z\", \"number\" ]\n        ]);\n\n        defineFunction(\"PHI\", phi).args([\n            [ \"x\", \"number\" ]\n        ]);\n\n        defineFunction(\"LOGNORM.DIST\", lognorm_dist).args([\n            [ \"x\", \"number++\" ],\n            [ \"mean\", \"number\" ],\n            [ \"standard_dev\", \"number++\" ],\n            [ \"cumulative\", \"logical\" ]\n        ]);\n\n        defineFunction(\"LOGNORM.INV\", lognorm_inv).args([\n            [ \"probability\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ],\n            [ \"mean\", \"number\" ],\n            [ \"standard_dev\", \"number++\" ]\n        ]);\n\n        defineFunction(\"PROB\", prob).args([\n            [ \"x_range\", [ \"collect\", \"number\", 1 ] ],\n            [ \"prob_range\", [ \"collect\", \"number\", 1 ] ],\n            [ \"lower_limit\", \"number\" ],\n            [ \"upper_limit\", [ \"or\", \"number\", [ \"null\", \"$lower_limit\" ] ] ],\n            [ \"?\", [ \"assert\", \"$prob_range.length == $x_range.length\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"SLOPE\", slope).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"INTERCEPT\", intercept).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"PEARSON\", pearson).args([\n            [ \"array1\", [ \"collect!\", \"anything\", 1 ] ],\n            [ \"array2\", [ \"collect!\", \"anything\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$array2.length == $array1.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$array2.length > 0 && $array1.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"RSQ\", rsq).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length != 1 && $known_y.length != 1\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"STEYX\", steyx).args([\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length >= 3 && $known_y.length >= 3\", \"DIV/0\" ] ]\n        ]);\n\n        defineFunction(\"FORECAST\", forecast).args([\n            [ \"x\", \"number\" ],\n            [ \"known_y\", [ \"collect\", \"number\", 1 ] ],\n            [ \"known_x\", [ \"collect\", \"number\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length == $known_y.length\", \"N/A\" ] ],\n            [ \"?\", [ \"assert\", \"$known_x.length > 0 && $known_y.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"LINEST\", linest).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction(\"LOGEST\", logest).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"stats\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n        ]);\n\n        defineFunction(\"TREND\", trend).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n        ]);\n\n        defineFunction(\"GROWTH\", growth).args([\n            [ \"known_y\", \"matrix\" ],\n            [ \"known_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"new_x\", [ \"or\", \"matrix\", \"null\" ] ],\n            [ \"const\", [ \"or\", \"logical\", [ \"null\", true ] ] ]\n        ]);\n\n        defineFunction(\"FV\", FV).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"pv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$pmt || $pv\" ] ]\n        ]);\n\n        defineFunction(\"PV\", PV).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"PMT\", PMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"NPER\", NPER).args([\n            [ \"rate\", \"number\" ],\n            [ \"pmt\", \"number\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ]\n        ]);\n\n        defineFunction(\"RATE\", RATE).args([\n            [ \"nper\", \"number\" ],\n            [ \"pmt\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"guess\", [ \"or\", \"number++\", [ \"null\", 0.01 ] ] ],\n            [ \"?\", [ \"assert\", \"$pmt || $fv\" ] ]\n        ]);\n\n        defineFunction(\"IPMT\", IPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"PPMT\", PPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"fv\", [ \"or\", \"number\", [ \"null\", 0 ] ] ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"CUMPRINC\", CUMPRINC).args([\n            [ \"rate\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number++\" ],\n            [ \"start_period\", \"number++\" ],\n            [ \"end_period\", \"number++\" ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"CUMIPMT\", CUMIPMT).args([\n            [ \"rate\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number++\" ],\n            [ \"start_period\", \"number++\" ],\n            [ \"end_period\", \"number++\" ],\n            [ \"type\", [ \"or\", [ \"values\", 0, 1 ], [ \"null\", 0 ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"NPV\", NPV).args([\n            [ \"rate\", \"number\" ],\n            [ \"values\", [ \"collect\", \"number\" ] ],\n            [ \"?\", [ \"assert\", \"$values.length > 0\", \"N/A\" ] ]\n        ]);\n\n        defineFunction(\"IRR\", IRR).args([\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ]\n        ]);\n\n        defineFunction(\"EFFECT\", EFFECT).args([\n            [ \"nominal_rate\", \"number++\" ],\n            [ \"npery\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"NOMINAL\", NOMINAL).args([\n            [ \"effect_rate\", \"number++\" ],\n            [ \"npery\", \"integer++\" ]\n        ]);\n\n        defineFunction(\"XNPV\", XNPV).args([\n            [ \"rate\", \"number\" ],\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n            [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"XIRR\", XIRR).args([\n            [ \"values\", [ \"collect\", \"number\", 1 ] ],\n            [ \"dates\", [ \"collect\", \"date\", 1 ] ],\n            [ \"guess\", [ \"or\", \"number\", [ \"null\", 0.1 ] ] ],\n            [ \"?\", [ \"assert\", \"$values.length == $dates.length\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"ISPMT\", ISPMT).args([\n            [ \"rate\", \"number\" ],\n            [ \"per\", \"number++\" ],\n            [ \"nper\", \"number++\" ],\n            [ \"pv\", \"number\" ],\n            [ \"?\", [ \"assert\", \"$per >= 1 && $per <= $nper\" ] ]\n        ]);\n\n        defineFunction(\"DB\", DB).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"period\", \"number++\" ],\n            [ \"month\", [ \"or\", \"number\", [ \"null\", 12 ] ] ]\n        ]);\n\n        defineFunction(\"DDB\", DDB).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"period\", \"number++\" ],\n            [ \"factor\", [ \"or\", \"number\", [ \"null\", 2 ] ] ]\n        ]);\n\n        defineFunction(\"SLN\", SLN).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ]\n        ]);\n\n        defineFunction(\"SYD\", SYD).args([\n            [ \"cost\", \"number\" ],\n            [ \"salvage\", \"number\" ],\n            [ \"life\", \"number++\" ],\n            [ \"per\", \"number++\" ]\n        ]);\n\n        defineFunction(\"VDB\", VDB).args([\n            [ \"cost\", \"number+\" ],\n            [ \"salvage\", \"number+\" ],\n            [ \"life\", \"number++\" ],\n            [ \"start_period\", \"number+\" ],\n            [ \"end_period\", \"number+\" ],\n            [ \"factor\", [ \"or\", \"number+\", [ \"null\", 2 ] ] ],\n            [ \"no_switch\", [ \"or\", \"logical\", [ \"null\", false ] ] ],\n            [ \"?\", [ \"assert\", \"$end_period >= $start_period\", \"NUM\" ] ]\n        ]);\n\n        var COUPS_ARGS = [\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ];\n\n        defineFunction(\"COUPDAYBS\", COUPDAYBS).args(COUPS_ARGS);\n\n        defineFunction(\"COUPDAYS\", COUPDAYS).args(COUPS_ARGS);\n\n        defineFunction(\"COUPDAYSNC\", COUPDAYSNC).args(COUPS_ARGS);\n\n        defineFunction(\"COUPPCD\", COUPPCD).args(COUPS_ARGS);\n\n        defineFunction(\"COUPNCD\", COUPNCD).args(COUPS_ARGS);\n\n        defineFunction(\"COUPNUM\", COUPNUM).args(COUPS_ARGS);\n\n        defineFunction(\"ACCRINTM\", ACCRINTM).args([\n            [ \"issue\", \"date\" ],\n            [ \"settlement\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"ACCRINT\", ACCRINT).args([\n            [ \"issue\", \"date\" ],\n            [ \"first_interest\", \"date\" ],\n            [ \"settlement\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"par\", [ \"or\", [ \"null\", 1000 ], \"number++\" ] ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"calc_method\", [ \"or\", \"logical\", [ \"null\", true ] ] ],\n            [ \"?\", [ \"assert\", \"$issue < $settlement\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"DISC\", DISC).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"pr\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"INTRATE\", INTRATE).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"investment\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"RECEIVED\", RECEIVED).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"investment\", \"number++\" ],\n            [ \"discount\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"PRICE\", PRICE).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"rate\", \"number++\" ],\n            [ \"yld\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"frequency\", [ \"and\", \"integer\", [ \"values\", 1, 2, 4 ] ] ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        defineFunction(\"PRICEDISC\", PRICEDISC).args([\n            [ \"settlement\", \"date\" ],\n            [ \"maturity\", \"date\" ],\n            [ \"discount\", \"number++\" ],\n            [ \"redemption\", \"number++\" ],\n            [ \"basis\", [ \"or\", [ \"null\", 0 ],\n                         [ \"and\", \"integer\", [ \"values\", 0, 1, 2, 3, 4 ] ] ] ],\n            [ \"?\", [ \"assert\", \"$settlement < $maturity\", \"NUM\" ] ]\n        ]);\n\n        /* -----[ utils ]----- */\n\n        // function resultAsMatrix(f) {\n        //     return function() {\n        //         var a = f.apply(this, arguments);\n        //         return this.asMatrix(a);\n        //     };\n        // }\n\n        /* -----[ definitions: statistical functions ]----- */\n\n        var MAX_IT = 300,     // Maximum allowed number of iterations\n            EPS = 2.2204e-16, // Relative accuracy; 1-3*(4/3-1) = 2.220446049250313e-16\n            FP_MIN = 1.0e-30, // Near the smallest representable as floating-point, number.\n            f_abs = Math.abs;\n\n        function ERF(x) {\n            if (f_abs(x) >= 3.3) {\n                return 1 - ERFC(x);\n            }\n            var S = x > 0 ? 1 : -1;\n            if (S == -1) {\n                x = -x;\n            }\n            var m = 0, an = 1;\n            for (var n = 1; n < 100; n++) {\n                m += an;\n                an *= 2*x*x/(2*n+1);\n            }\n            return S*2/Math.sqrt(Math.PI)*x*Math.exp(-x*x)*m;\n        }\n\n        function ERFC(x) {\n            if (f_abs(x) < 3.3) {\n                return 1 - ERF(x);\n            }\n            var s = 1;\n            if (x < 0) {\n                s = -1;\n                x = -x;\n            }\n            var frac = x;\n            for (var n = 8; n >= 1; n -= 0.5) {\n                frac = x + n/frac;\n            }\n            frac = 1 / (x + frac);\n            return s == 1\n                ? Math.exp(-x*x)/Math.sqrt(Math.PI)*frac\n                : 2 - Math.exp(-x*x)/Math.sqrt(Math.PI)*frac;\n        }\n\n        function GAMMALN(x) { // Returns the value ln[Γ(x)] for x > 0.\n            var cof = [\n                1.000000000190015, 76.18009172947146, -86.50532032941677,\n                24.01409824083091, -1.231739572450155, 0.1208650973866179e-2, -0.5395239384953e-5\n            ];\n            var y = x, tmp = x + 5.5, ser = cof[0];\n            tmp -= (x + 0.5) * Math.log(tmp);\n            for (var j = 1; j <= 6; j++) {\n                y += 1;\n                ser += cof[j] / y;\n            }\n            return -tmp + Math.log(Math.sqrt(2*Math.PI) * ser / x); // log(Γ(x)) = log(Γ(x+1)) - log(x)\n        }\n\n        function GAMMA(x) { // returns Infinity for 0 or negative _integer argument.\n            if (x > 0) {\n                return Math.exp(GAMMALN(x));\n            }\n            var pi = Math.PI, y = -x; // For x<0 we use the reflection formula: Γ(x)Γ(1-x) = PI / sin(PI*x)\n            return -pi / (y*GAMMA(y)*Math.sin(pi*y));\n        }\n\n        function BETALN(a, b) {\n            return GAMMALN(a) + GAMMALN(b) - GAMMALN(a+b);\n        }\n\n        function BETA(a, b) {\n            return Math.exp(BETALN(a, b));\n        }\n\n        function gamma_inc(a, x) { // returns the normalized incomplete gamma function P(a, x); x > 0.\n            return x < a+1.0 ? g_series(a, x) : 1 - g_contfrac(a, x);\n        }\n\n        function g_series(a, x) { // evaluate P(a, x) by its series representation (converges quickly for x < a+1).\n            var sum = 1/a,\n                frac = sum,\n                ap = a;\n            var gln = GAMMALN(a), n;\n            for (n = 1; n <= MAX_IT; n++) {\n                ap++;\n                frac *= x/ap;\n                sum += frac;\n                if (f_abs(frac) < f_abs(sum)*EPS) {\n                    break; // already the last frac is too small versus the current sum value\n                }\n            }\n            return sum * Math.exp(-x + a*Math.log(x) - gln); // e^{-x} * x^a * Γ(a) * sum\n        }\n\n        function g_contfrac(a, x) { // Q(a, x) by its continued fraction representation (converges quickly for x > a + 1); modified Lentz’s method (Numerical Recipes (The Art of Scientific Computing), 2rd Edition $5.2)\n            var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n            var gln = GAMMALN(a);\n            for (var i = 1; i <= MAX_IT; i++) {\n                d = bj + aj * d;\n    \t    if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n    \t    c = bj + aj / c;\n    \t    if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n    \t    d = 1 / d;\n    \t    var delta = c * d;\n    \t    f *= delta;\n        \t    if (f_abs(delta - 1) < EPS) {\n                    break;\n                }\n    \t    bj += 2;\n    \t    aj = -i * (i - a);\n    \t}\n    \treturn f * Math.exp(-x - gln + a * Math.log(x));\n        }\n\n        function GAMMA_DIST(x, a, b, cumulative) { // a > 0, b > 0; x >= 0\n            if (!cumulative) {\n                return Math.pow(x/b, a-1)*Math.exp(-x/b)/(b*GAMMA(a)); // the PDF of the Gamma distribution\n            }\n            return gamma_inc(a, x/b); // (else) compute the CDF (using the incomplete Gamma function)\n        }\n\n        function GAMMA_INV(p, a, b) { // the quantile function of the Gamma distribution\n    \tif (p === 0) {\n                return 0;\n            }\n    \tif (p == 1) {\n                return Infinity;\n            }\n    \tvar m = 0, M = 10, x = 0, ab = a*b;\n    \tif (ab > 1) {\n                M *= ab;\n            }\n    \tfor (var i = 0; i < MAX_IT; i++) {\n    \t    x = 0.5*(m + M); // console.log(x);\n    \t    var q = GAMMA_DIST(x, a, b, true);\n    \t    if (f_abs(p - q) < 1e-16) {\n                    break;\n                }\n    \t    if (q > p) {\n                    M = x;\n                } else {\n                    m = x;\n                }\n    \t}\n    \treturn x;\n        }\n\n        function NORM_S_DIST(x, cumulative) {\n            if (!cumulative) {\n                return Math.exp(-x*x/2)/Math.sqrt(2*Math.PI);\n            }\n            return 0.5 + 0.5*ERF(x/Math.sqrt(2));\n        }\n\n        function NORM_S_INV(p) { // see [1] $26.2.3 and http://home.online.no/~pjacklam/notes/invnorm/#References\n            // Coefficients in rational approximations.\n            var a = [-3.969683028665376e+01,  2.209460984245205e+02,\n                     -2.759285104469687e+02,  1.383577518672690e+02,\n                     -3.066479806614716e+01,  2.506628277459239e+00],\n                b = [-5.447609879822406e+01,  1.615858368580409e+02,\n                     -1.556989798598866e+02,  6.680131188771972e+01,\n                     -1.328068155288572e+01],\n                c = [-7.784894002430293e-03, -3.223964580411365e-01,\n                     -2.400758277161838e+00, -2.549732539343734e+00,\n                     4.374664141464968e+00,  2.938163982698783e+00],\n                d = [ 7.784695709041462e-03,  3.224671290700398e-01,\n                      2.445134137142996e+00,  3.754408661907416e+00];\n            // Define break-points.\n            var plow  = 0.02425,\n                phigh = 1 - plow;\n            var q, r;\n            // Rational approximation for lower region:\n            if (p < plow) {\n                q = Math.sqrt(-2*Math.log(p));\n                return (((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n            }\n            // Rational approximation for upper region:\n            if (phigh < p) {\n                q = Math.sqrt(-2*Math.log(1-p));\n                return -(((((c[0]*q+c[1])*q+c[2])*q+c[3])*q+c[4])*q+c[5]) / ((((d[0]*q+d[1])*q+d[2])*q+d[3])*q+1);\n            }\n            // Rational approximation for central region:\n            q = p - 0.5;\n            r = q*q;\n            return (((((a[0]*r+a[1])*r+a[2])*r+a[3])*r+a[4])*r+a[5])*q / (((((b[0]*r+b[1])*r+b[2])*r+b[3])*r+b[4])*r+1);\n        }\n\n        function NORM_DIST(x, m, s, cumulative) {\n            if (!cumulative) {\n                return Math.exp(-(x-m)*(x-m)/(2*s*s))/(s*Math.sqrt(2*Math.PI)); // NORM_S_DIST((x-m)/s)/s;\n            }\n            return NORM_S_DIST((x-m)/s, true);\n        }\n\n        function NORM_INV(p, m, s) {\n            return m + s*NORM_S_INV(p);\n        }\n\n        function betastd_pdf(x, a, b) {\n            return Math.exp((a-1)*Math.log(x) + (b-1)*Math.log(1-x) - BETALN(a, b));\n        }\n\n        function betastd_cdf(x, a, b) {\n            var k = Math.exp(a*Math.log(x) + b*Math.log(1-x) - BETALN(a, b));\n            return x < (a+1)/(a+b+2) ? k*beta_lentz(a, b, x)/a : 1 - k*beta_lentz(b, a, 1-x)/b;\n        }\n\n        function beta_lentz(a, b, x) { // estimates continued fraction by modified Lentz’s method ([2] $8.17.22)\n            var m, m2;\n            var aa, c, d, del, h, qab, qam, qap;\n            qab = a + b; // These q’s will be used in factors that occur in the coefficients d_n\n            qap = a + 1;\n            qam = a - 1;\n            c = 1; // First step of Lentz’s method.\n            d = 1 - qab * x / qap;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            d = 1/d;\n            h = d;\n            for (m = 1; m <= MAX_IT; m++) {\n                m2 = 2*m;\n                aa = m*(b - m)*x / ((qam + m2)*(a + m2));\n                d = 1 + aa*d; // One step (the even one) of the recurrence.\n                if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n                c = 1 + aa/c;\n                if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n                d = 1/d;\n                h *= d*c;\n                aa = -(a + m)*(qab + m)*x / ((a + m2)*(qap + m2));\n                d = 1 + aa*d; // Next step of the recurrence (the odd one).\n                if (f_abs(d) < FP_MIN) {\n                    d = FP_MIN;\n                }\n                c = 1 + aa/c;\n                if (f_abs(c) < FP_MIN) {\n                    c = FP_MIN;\n                }\n                d = 1/d;\n                del = d*c;\n                h *= del;\n                if (f_abs(del - 1) < EPS) {\n                    break;\n                }\n            }\n            return h; // if(m > MAX_IT) throw new Error(\"a or b too big, or MAX_IT too small\");\n        }\n\n        function betastd_inv(p, a, b) { // the quantile function of the standard Beta distribution\n    \tvar m = 0, M = 1, x = 0;\n    \tfor (var i = 0; i < MAX_IT; i++) {\n    \t    x = 0.5*(m + M);\n    \t    var q = betastd_cdf(x, a, b);\n    \t    if (f_abs(p - q) < EPS) {\n                    break;\n                }\n    \t    if (q > p) {\n                    M = x;\n                } else {\n                    m = x;\n                }\n    \t}\n    \treturn x;\n        }\n\n        function BETADIST(x, a, b, m, M) {\n            return betastd_cdf((x-m)/(M-m), a, b);\n        }\n\n        function BETA_DIST(x, a, b, cdf, m, M) {\n            if (cdf) {\n                return betastd_cdf((x-m)/(M-m), a, b);\n            }\n            return betastd_pdf((x-m)/(M-m), a, b) / (M-m);\n        }\n\n        function BETA_INV(p, a, b, m, M) {\n            return m + (M-m)*betastd_inv(p, a, b);\n        }\n\n        function chisq_left(x, n, cds) {  // CHISQ.DIST(x,deg_freedom,cumulative)\n            return GAMMA_DIST(x, n/2, 2, cds);\n        }\n\n        function chisq_right(x, n) { // CHISQ.DIST.RT(x,deg_freedom)\n            return 1 - chisq_left(x, n, true);\n        }\n\n        function chisq_left_inv(p, n) { // CHISQ.INV( probability, degrees_freedom )\n            return GAMMA_INV(p, n/2, 2);\n        }\n\n        function chisq_right_inv(p, n) { // CHISQ.INV.RT(probability,deg_freedom)\n            return chisq_left_inv(1-p, n);\n        }\n\n        function chisq_test(obsv, expect) {\n            var rows = obsv.length, cols = obsv[0].length;\n            var x = 0, i, j;\n            for (i = 0; i < rows; i++) {\n                for (j = 0; j < cols; j++) {\n                    var eij = expect[i][j];\n                    var delta = obsv[i][j] - eij;\n                    delta *= delta;\n                    x += delta/eij;\n                }\n            }\n            var n = (rows - 1)*(cols - 1);\n            return chisq_right(x, n);\n        }\n\n        function expon(x, r, cdf) { // EXPON.DIST(x, lambda, cumulative)\n            if (cdf) {\n                return 1 - Math.exp(-r*x);\n            }\n            return r * Math.exp(-r*x);\n        }\n\n        function poisson(k, m, cdf) { // POISSON.DIST(x, mean, cumulative)\n            if (cdf) {\n                return 1 - chisq_left(2*m, 2*(k+1), true);\n            }\n            //return chisq_left(2*m, 2*k, true) - chisq_left(2*m, 2*(k+1), true);\n            var lnf = 0;\n            for (var i = 2; i <= k; i++) {\n                lnf += Math.log(i); // compute log(k!)\n            }\n            return Math.exp(k*Math.log(m) - m - lnf);\n        }\n\n        function Fdist(x, n, d, cdf) { //F.DIST(x,deg_freedom1,deg_freedom2,cumulative)\n            if (cdf) {\n                return betastd_cdf(n*x/(d+n*x), n/2, d/2);\n            }\n            var u = n/d;\n            n /= 2; d /= 2;\n            return u/BETA(n, d) * Math.pow(u*x, n-1) / Math.pow(1+u*x, n+d);\n        }\n\n        function Fdist_right(x, n, d) { // F.DIST.RT(x,deg_freedom1,deg_freedom2)\n            return 1 - Fdist(x, n, d, true);\n        }\n\n        function Finv_right(p, n, d) { // F.INV.RT(probability,deg_freedom1,deg_freedom2\n            return d/n*(1/BETA_INV(p, d/2, n/2, 0, 1) - 1);\n        }\n\n        function Finv(p, n, d) { // F.INV(probability,deg_freedom1,deg_freedom2\n            return d/n*(1/BETA_INV(1-p, d/2, n/2, 0, 1) - 1);\n        }\n\n        function _mean(arr) {\n            var me = 0, n = arr.length;\n            for (var i = 0; i < n; i++) {\n                me += arr[i];\n            }\n            return me / n;\n        }\n\n        function _var_sq(arr, m) { // returns the (n-1)-part of the sum of the squares of deviations from m (= VAR)\n            var v = 0, n = arr.length;\n            for (var i = 0; i < n; i++) {\n                var delta = arr[i] - m;\n                v += delta*delta;\n            }\n            return v / (n-1);\n        }\n\n        function Ftest(arr1, arr2) { // F.TEST(array1,array2)\n            var n1 = arr1.length - 1, n2 = arr2.length - 1;\n            var va1 = _var_sq(arr1, _mean(arr1)),\n                va2 = _var_sq(arr2, _mean(arr2));\n            if (!va1 || !va2) {\n                throw new CalcError(\"DIV/0\");\n            }\n            return 2*Fdist(va1 / va2, n1, n2, true);\n        }\n\n        function fisher(x) { // FISHER(x)\n            return 0.5*Math.log((1+x)/(1-x));\n        }\n\n        function fisherinv(x) { // FISHERINV(x)\n            var e2 = Math.exp(2*x);\n            return (e2 - 1)/(e2 + 1);\n        }\n\n        function Tdist(x, n, cdf) { // T.DIST(x,deg_freedom, cumulative)\n            if (cdf) {\n                return 1 - 0.5*betastd_cdf(n/(x*x+n), n/2, 0.5);\n            }\n            return 1/(Math.sqrt(n)*BETA(0.5, n/2)) * Math.pow(1 + x*x/n, -(n+1)/2);\n        }\n\n        function Tdist_right(x, n) { // T.DIST.RT(x,deg_freedom)\n            return 1 - Tdist(x, n, true);\n        }\n\n        function Tdist_2tail(x, n) { // T.DIST.2T(x,deg_freedom)\n            if (x < 0) {\n                x = -x;\n            }\n            return 2*Tdist_right(x, n);\n        }\n\n        function Tdist_inv(p, n) { // T.INV(probability,deg_freedom)\n            var x = betastd_inv(2*Math.min(p, 1-p), n/2, 0.5); // ibetainv();\n            x = Math.sqrt(n * (1 - x) / x);\n            return (p > 0.5) ? x : -x;\n        }\n\n        function Tdist_2tail_inv(p, n) { // T.INV.2T(probability,deg_freedom)\n            // T2 = 2T_r = p => T_r(x,n) = p/2 => 1 - T(x,n,true) = p/2 => x = T^-1(1-p/2, n)\n            return Tdist_inv(1-p/2, n);\n        }\n\n        function Tdist_test(gr1, gr2, tail, type) { // T.TEST(array1,array2,tails,type)\n            var n1 = gr1.length, n2 = gr2.length;\n            var t_st, df; // the t-statistic and the \"degree of freedom\"\n            if (type == 1) { // paired (dependent) samples\n                var d = 0, d2 = 0;\n                for (var i = 0; i < n1; i++) {\n                    var delta = gr1[i] - gr2[i];\n                    d += delta;\n                    d2 += delta*delta;\n                }\n                var md = d/n1; //, md2 = d2 / n1;\n                t_st = md / Math.sqrt((d2 - d*md)/(n1*(n1-1))); // has a \"Student T\" distribution\n                return tail == 1 ? Tdist_right(t_st, n1-1) : Tdist_2tail(t_st, n1-1);\n            }\n            // unpaired (independent) samples\n            var m1 = _mean(gr1), m2 = _mean(gr2),\n                v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n            if (type == 3) { // unpaired, unequal variances\n                var u1 = v1/n1, u2 = v2/n2, u = u1 + u2;\n                var q1 = u1/u, q2 = u2/u; // u==0 must be invalidated\n                df = 1/(q1*q1/(n1-1) + q2*q2/(n2-1));\n                t_st =  f_abs(m1-m2)/Math.sqrt(u);\n                return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n            }\n            else { // (type == 2) unpaired, equal variances (\"equal\" in the sense that there is no significant difference in variance in both groups - a prealable F-test could revealed that)\n                df = n1 + n2 - 2;\n                t_st = f_abs(m1-m2)*Math.sqrt(df*n1*n2/((n1+n2)*((n1-1)*v1+(n2-1)*v2)));\n                return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n            }\n        }\n\n        function confidence_t(alpha, stddev, size) { // CONFIDENCE.T(alpha,standard_dev,size)\n            return -Tdist_inv(alpha/2, size-1)*stddev/Math.sqrt(size);\n        }\n\n        function confidence_norm(alpha, stddev, size) { // CONFIDENCE.NORM(alpha,standard_dev,size)\n            return -NORM_S_INV(alpha/2)*stddev/Math.sqrt(size);\n        }\n\n        function gauss(z) { // GAUSS(z)\n            return NORM_S_DIST(z, true) - 0.5;\n        }\n\n        function phi(x) { // PHI(x)\n            return NORM_S_DIST(x);\n        }\n\n        function lognorm_dist(x, m, s, cumulative) { // LOGNORM.DIST(x,mean,standard_dev,cumulative)\n            if (cumulative) {\n                return 0.5 + 0.5*ERF((Math.log(x)-m)/(s*Math.sqrt(2)));\n            }\n            var t = Math.log(x)-m;\n            return Math.exp(-t*t/(2*s*s))/(x*s*Math.sqrt(2*Math.PI));\n        }\n\n        function lognorm_inv(p, m, s) { //LOGNORM.INV(probability, mean, standard_dev)\n            return Math.exp(NORM_INV(p, m, s));\n        }\n\n        function prob(x_, p_, lw, up) { //PROB(x_range, prob_range, [lower_limit], [upper_limit])\n            var n = x_.length;\n            var s = 0, i;\n            for (i = 0; i < n; i++) {\n                if (p_[i] <= 0 || p_[i] > 1) {\n                    throw new CalcError(\"NUM\");\n                }\n                s += p_[i];\n            }\n            if (s != 1) {\n                throw new CalcError(\"NUM\");\n            }\n            var res = 0;\n            for (i = 0; i < n; i++) {\n                var x = x_[i];\n                if (x >= lw && x <= up) {\n                    res += p_[i];\n                }\n            }\n            return res;\n        }\n\n        function slope(y_, x_) { // SLOPE(known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n            for (var i = 0, n = y_.length; i < n; i++) {\n                var t = x_[i] - mx;\n                b1 += t*(y_[i] - my);\n                b2 += t*t;\n            }\n            return b1/b2;\n        }\n\n        function intercept(y_, x_) { // INTERCEPT(known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_);\n            // return my - mx*slope(y_, x_);  //but repeating the calls for _mean()\n            var b1 = 0, b2 = 0;\n            for (var i = 0, n = y_.length; i < n; i++) {\n                var t = x_[i] - mx;\n                b1 += t*(y_[i] - my);\n                b2 += t*t;\n            }\n            return my - b1*mx/b2;\n        }\n\n        function pearson(x_, y_) { // PEARSON(array1, array2)\n            whipNumberArrays(x_, y_);\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0, s3 = 0;\n            for(var i = 0, n = x_.length; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t1*t2;\n                s2 += t1*t1;\n                s3 += t2*t2;\n            }\n            return s1/Math.sqrt(s2*s3);\n        }\n\n        function rsq(x_, y_) { // RSQ(known_y's,known_x's)\n            var r = pearson(x_, y_);\n            return r*r;\n        }\n\n        function steyx(y_, x_) { //STEYX(known_y's, known_x's)\n            var n = x_.length;\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0, s3 = 0;\n            for (var i = 0; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t2*t2;\n                s2 += t1*t2;\n                s3 += t1*t1;\n            }\n            return Math.sqrt((s1 - s2*s2/s3)/(n-2));\n        }\n\n        function forecast(x, y_, x_) { //FORECAST(x, known_y's, known_x's)\n            var mx = _mean(x_), my = _mean(y_);\n            var s1 = 0, s2 = 0;\n            for (var i = 0, n = x_.length; i < n; i++) {\n                var t1 = x_[i] - mx, t2 = y_[i] - my;\n                s1 += t1*t2;\n                s2 += t1*t1;\n            }\n            if (s2 === 0) {\n                throw new CalcError(\"N/A\");\n            }\n            var b = s1/s2, a = my - b*mx;\n            return a + b*x;\n        }\n\n        function _mat_mean(Mat) { // returns the mean value of a Matrix(n, 1)\n            var n = Mat.height, sum = 0;\n            for (var i=0; i < n; i++) {\n                sum += Mat.data[i][0];\n            }\n            return sum/n;\n        }\n\n        function _mat_devsq(Mat, mean) { // returns the sum of squares of deviations for a Matrix(n, 1)\n            var n = Mat.height, sq = 0;\n            for (var i=0; i < n; i++) {\n                var x = Mat.data[i][0] - mean;\n                sq += x*x;\n            }\n            return sq;\n        }\n\n        function linest(Y, X, konst, stats) { // LINEST(known_y's, [known_x's], [const], [stats])\n            var i = 0;\n\n            if (!X) {\n                // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n                X = Y.map(function(){ return ++i; });\n            }\n\n            if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n                X = X.clone();\n                X.eachRow(function(row){\n                    X.data[row].unshift(1);\n                });\n                ++X.width;\n            }\n\n            var Xt = X.transpose();\n            var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n            var line_1 = [];\n            for (i = B.height-1; i >= 0; i--) {\n                line_1.push(B.data[i][0]); // regression coefficients ('slopes') and the y_intercept\n            }\n            if (!konst) {\n                line_1.push(0); // display 0 for y_intercept, when const==false\n            }\n            if (!stats) {\n                return this.asMatrix([ line_1 ]); // don't display statistics about the regression, when stats==false\n            }\n\n            var Y1 = X.multiply(B); // the predicted Y values\n            var y_y1 = Y.adds(Y1, true); // the errors of the predictions (= Y - Y1)\n            var mp = !konst? 0 : _mat_mean(Y1);\n            var SSreg = _mat_devsq(Y1, mp); // The regression sum of squares\n            var me = !konst? 0 : _mat_mean(y_y1);\n            var SSresid = _mat_devsq(y_y1, me); // The residual sum of squares\n            var line_5 = [];\n            line_5.push(SSreg, SSresid);\n            var R2 = SSreg / (SSreg + SSresid); // The coefficient of determination\n            var degfre = Y.height - X.width; // The degrees of freedom\n            var err_est = Math.sqrt(SSresid / degfre); // The standard error for the y estimate\n            var line_3 = [];\n            line_3.push(R2, err_est);\n            var F_sta = !konst ? (R2/X.width)/((1-R2)/(degfre)) : (SSreg/(X.width-1))/(SSresid/degfre); // The F statistic\n            var line_4 = [];\n            line_4.push(F_sta, degfre);\n            var SCP = Xt.multiply(X).inverse();\n            var line_2 = [];\n            for (i=SCP.height-1; i >= 0; i--) { // The standard errors (of coefficients an y-intercept)\n                line_2.push(Math.sqrt(SCP.data[i][i]*SSresid/degfre));\n            }\n            return this.asMatrix([line_1, line_2, line_3, line_4, line_5]);\n        }\n\n        function logest(Y, X, konst, stats) { // LOGEST(known_y's, [known_x's], [const], [stats])\n            return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n        }\n\n        function trend(Y, X, W, konst) { // TREND(known_y's, [known_x's], [new_x's], [const])\n            var i = 0;\n\n            if (!X) {\n                // if not passed, X should default to array {1, 2, 3, ...} (same size as Y)\n                X = Y.map(function(){ return ++i; });\n            }\n\n            if (konst) { // adding 1's column is unnecessary when const==false (meaning that y_intercept==0)\n                X = X.clone();\n                X.eachRow(function(row){\n                    X.data[row].unshift(1);\n                });\n                ++X.width;\n            }\n\n            var Xt = X.transpose();\n            var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y); // the last square estimate of the coefficients\n\n            if (!W) {\n                W = X;\n            } else {\n                if (konst) { // for non-zero y_intercept\n                    W = W.clone();\n                    W.eachRow(function(row){\n                        W.data[row].unshift(1);\n                    });\n                    ++W.width;\n                }\n            }\n            return W.multiply(B); // the predicted Y values for the W values\n        }\n\n        function growth(Y, X, new_X, konst) { // GROWTH(known_y's, [known_x's], [new_x's], [const])\n            // = EXP(TREND(LN(Y_), X_, new_X, const))\n            return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n        }\n\n        /*\n          [1] Handbook of Mathematical Functions (NIST, 1964-2010):\n          https://en.wikipedia.org/wiki/Abramowitz_and_Stegun\n          http://dlmf.nist.gov/\n          http://www.aip.de/groups/soe/local/numres/\n\n          [2] https://en.wikibooks.org/wiki/Statistics/Numerical_Methods/Numerics_in_Excel\n        */\n\n        /* -----[ financial functions ]----- */\n\n        //// find the root of a function known an initial guess (Newton's method) ////\n        function root_newton(func, guess, max_it, eps) { // func(x) must return [value_F(x), value_F'(x)]\n            var MAX_IT = max_it || 20, // maximum number of iterations\n                EPS = eps || 1E-7; // accuracy\n            var root = guess;\n            for (var j = 1; j <= MAX_IT; j++) {\n                var f_d = func(root),\n                    f = f_d[0], // the value of the function\n                    df = f_d[1]; // the value of the derivative\n                var dx = f / df;\n                root -= dx;\n                if (Math.abs(dx) < EPS) {\n                    return root;\n                }\n            }\n            return new CalcError(\"NUM\");\n        }\n\n\n        /* https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd\n           if(rate==0):\n           PMT * nper + PV + FV = 0\n           else: //the basic equation (with six variables) implied in financial problems\n           PV * (1+rate)^nper + PMT * (1+rate*type) * ((1+rate)^nper-1) / rate + FV = 0         [1]\n        */\n\n\n\n        //// FV (final or future value) ////\n        /* I initially invest £1000 in a saving scheme and then at the end of each month I invest an\n           extra £50. If the interest rate is 0.5% per month and I continue this process for two year,\n           how much will my saving be worth: =FV(0.005, 24, -50, -1000, 0) */\n        function FV(rate, nper, pmt, pv, type) { // FV(rate,nper,pmt,[pv],[type])\n            var h1 = Math.pow(1+rate, nper);\n            var h2 = rate ? (h1 - 1)/rate : nper;\n            return -(pv * h1 + pmt * h2 * (1 + rate*type));\n        }\n\n        //// PV (present value of investment) ////\n        /* If I wish to accumulate £5000 in four years time by depositing £75 per month in a fixed\n           rate account with interest rate of 0.4% per month, what initial investment must I also\n           make: =PV(0.004, 4*12, -75, 5000, 0) */\n        function PV(rate, nper, pmt, fv, type) { // PV(rate, nper, pmt, [fv], [type])\n            if (!rate) {\n                return -fv - pmt*nper;\n            }\n            var h1 = Math.pow(1+rate, nper);\n            return -(fv + pmt * (h1 - 1)/rate * (1 + rate*type)) / h1;\n        }\n\n        //// PMT monthly payments (= principal part PPMT + interest part IPMT) ////\n        /* How much will the monthly repayments be if I borrow £100,000 over 20 years with an\n           effective monthly interest rate is 0.5%: =PMT(0.005, 12*20, 100000, 0, 0) */\n        function PMT(rate, nper, pv, fv, type) { // PMT(rate, nper, pv, [fv], [type])\n            if (!rate) {\n                return -(fv + pv)/nper;\n            }\n            var h1 = Math.pow(1+rate, nper);\n            return -rate*(fv + pv*h1)/((1 + rate*type)*(h1 - 1));\n        }\n\n        //// NPER (number of periods for an investment) ////\n        /* How long would it take me to pay off a loan of £10,000 at a rate of 0.5% per month if I\n           can afford to pay £100 per month: =NPER(0.5%, -100, 10000, 0, 0) */\n        function NPER(rate, pmt, pv, fv, type) { // NPER(rate,pmt,pv,[fv],[type])\n            if (!rate) {\n                return -(fv + pv) / pmt;\n            }\n            var h1 = pmt*(1 + rate*type);\n            return Math.log((h1 - fv*rate)/(h1 + pv*rate)) / Math.log(1 + rate);\n        }\n\n        //// RATE (the interest rate per period) ////\n        /* I borrow £1000 over 1 year making payments of £100 per month at the end of each\n           month. What is the monthly interest rate: =RATE(12, −100, 1000, 0, 0, 0) */\n\n        function RATE (nper, pmt, pv, fv, type, guess) { // RATE(nper, pmt, pv, [fv], [type], [guess])\n            function xfd(x) { // returns F(x) and F'(x), where F is given by the equation [1]\n                var h2 = Math.pow(1+x, nper-1), h1 = h2*(1+x);\n                return [ pv*h1 + pmt*(1/x + type)*(h1 - 1) + fv,\n                         nper*pv*h2 + pmt*(-(h1 - 1)/(x*x) + (1/x + type)*nper*h2) ];\n            }\n            return root_newton(xfd, guess); // a root of the equation F(x)=0\n        }\n\n        //// IPMT (interest part of a loan or investment) ////\n        //// PPMT (principal part of a loan) ////\n\n        function IPMT(rate, per, nper, pv, fv, type) { // IPMT(rate, per, nper, pv, [fv], [type])\n            if(type==1 && per==1) { // interest before beginnig of the payments... = ZERO\n                return 0;\n            }\n            var pmt = PMT(rate, nper, pv, fv, type);\n            var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n            return type ? ipmt/(1 + rate) : ipmt;\n        }\n\n        function PPMT(rate, per, nper, pv, fv, type) { // PPMT(rate, per, nper, pv, [fv], [type])\n            var pmt = PMT(rate, nper, pv, fv, type);\n            return pmt - IPMT(rate, per, nper, pv, fv, type);\n        }\n\n        //// CUMPRINC (cumulative principal paid) ////\n        /* The amount financed is $200,000 at an interest rate of 7.25% for 30 years. How much is the amount of principal\n           and the amount of interest paid in the first year: CUMPRINC(0.0725/12, 12*30, 200000, 1, 12, 0)\n           and CUMIPMT(0.0725/12, 12*30, 200000, 1, 12, 0) */\n        function CUMPRINC(rate, nper, pv, start, end, type) { // CUMPRINC(rate, nper, pv, start_period, end_period, type)\n            if(type == 1) { // start >= 1 (as in Excel), but if pay at beginning of the period (type==1),\n                start --;    // then periods must be counted from Zero (decreasing given start and end parameters)\n                end --;\n            }\n            var tn = Math.pow(1 + rate, nper),\n                ts = Math.pow(1 + rate, start-1),\n                te = Math.pow(1 + rate, end);\n            var monthlyPayment = rate * pv * tn / (tn - 1);\n            var remainingBalanceAtStart = ts * pv - ((ts - 1) / rate) * monthlyPayment;\n            var remainingBalanceAtEnd = te * pv - ((te - 1) / rate) * monthlyPayment;\n            return remainingBalanceAtEnd - remainingBalanceAtStart;\n        }\n\n        //// CUMIPMT (cumulative  interest paid) ////\n        function CUMIPMT(rate, nper, pv, start, end, type) { // CUMIPMT(rate, nper, pv, start_period, end_period, type)\n            var cip = 0;\n            for(var i=start; i<=end; i++) {\n                cip += IPMT(rate, i, nper, pv, 0, type);\n            }\n            return cip;\n        }\n\n        //// NPV (Net Present Value of an investment based on a series of periodic cash flows and a discount rate) ////\n        function NPV(rate, flows) { // NPV(rate,value1,[value2],...)\n            var npv = 0;\n            for(var i=0, n=flows.length; i < n; i++) {\n                npv += flows[i]*Math.pow(1 + rate, -i-1);\n            }\n            return npv;\n        }\n\n        //// IRR (Internal Rate of Return on an investment based on a series of periodic cash flows) ////\n        function IRR(flows, guess) { // IRR(values, [guess])\n            function xfd(x) {\n                var npv = 0, npv1 = 0;\n                for(var j=0, n=flows.length; j < n; j++) {\n                    npv += flows[j]*Math.pow(1 + x, -j-1); // construct the NPV(x) value,\n                    npv1 += -j*flows[j]*Math.pow(1+x, -j-2); // the value in x of the NPV()-derivative\n                }\n                return [npv, npv1];\n            }\n            return root_newton(xfd, guess);\n        }\n\n        //// EFFECT (effective annual interest rate) ////\n        /* which investment option is better - one that pays 5 percent after one year, or a\n           savings account that pays a monthly interest of 4.75 percent:\n           = (5% - EFFECT(4.75%, 12)) * 10000 */\n        function EFFECT(nominal_rate, npery) { // EFFECT(nominal_rate, npery)\n            return Math.pow(1 + nominal_rate/npery, npery) - 1;\n        }\n\n        //// NOMINAL (nominal annual interest rate) ////\n        function NOMINAL(effect_rate, npery) { // NOMINAL(effect_rate, npery)\n            return npery*(Math.pow(effect_rate + 1, 1/npery) - 1);\n        }\n\n        //// XNPV (Net Present Value of a series of cashflows at irregular intervals) ////\n        function XNPV(rate, values, dates) { // XNPV(rate, values, dates)\n            var npv = 0;\n            for(var i=0, n=values.length; i < n; i++) {\n                npv += values[i]*Math.pow(1 + rate, (dates[0]-dates[i])/365);\n            }\n            return npv;\n        }\n\n        //// XIRR (Internal Rate of Return of a series of cashflows at irregular intervals) ////\n        function XIRR(values, dates, guess) { // XIRR(values, dates, [guess])\n            function xfd(x) {\n                var npv = values[0], npv1 = 0;\n                for(var j=1, n=values.length; j < n; j++) {\n                    var delta = (dates[0] - dates[j]) / 365;\n                    npv += values[j]*Math.pow(1 + x, delta); // construct the XNPV(x) value,\n                    npv1 += delta*values[j]*Math.pow(1+x, delta - 1); // the value in x of the XNPV()-derivative\n                }\n                return [npv, npv1];\n            }\n            return root_newton(xfd, guess); // , 100, 0.1);\n        }\n\n        //// ISPMT (Interest paid during a Specific Period of an investment) ////\n        function ISPMT(rate, per, nper, pv) { // ISPMT(rate, per, nper, pv)\n            var tmp = -pv*rate;\n            return tmp*(1 - per/nper);\n        }\n\n        //// DB (Declining Balance depreciation) ////\n        function DB(cost, salvage, life, period, month) { // DB(cost, salvage, life, period, [month])\n            var rate = 1 - Math.pow(salvage/cost, 1/life);\n            rate = Math.floor(rate*1000 + 0.5) / 1000; // rounded to three decimals\n            var db = cost * rate * month / 12;\n            if(period == 1) {\n                return db;\n            }\n            for(var i=1; i < life; i++) {\n                if(i == period - 1) {\n                    return (cost - db) * rate;\n                }\n                db += (cost - db) * rate;\n            }\n            return (cost - db) * rate * (12 - month) / 12;\n        }\n\n        //// DDB (Double Declining Balance depreciation) ////\n        function DDB(cost, salvage, life, period, factor) { // DDB(cost, salvage, life, period, [factor])\n            var f = factor / life;\n            var prior = -cost * (Math.pow(1-f, period-1) - 1);\n            var dep = (cost - prior) * f;\n            /* Depreciation cannot exceed book value.  */\n            dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n            return dep;\n        }\n\n        //// SLN (straight-line depreciation) ////\n        function SLN(cost, salvage, life) { // SLN(cost, salvage, life)\n            return (cost - salvage) / life;\n        }\n\n        //// SYD (Sum-of-Years' digits Depreciation) ////\n        function SYD(cost, salvage, life, per) { // SYD(cost, salvage, life, per)\n            return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n        }\n\n        //// VDB (Variable Declining Balance) ////\n        //\n        // Code adapted from Gnumeric, which in turn took it from OpenOffice.  The original code is\n        // available under GNU Lesser General Public License (LGPL).\n        // https://github.com/GNOME/gnumeric/blob/master/plugins/fn-financial/sc-fin.c\n        function VDB (cost, salvage, life, start, end, factor, no_switch) {\n            var interest = factor >= life ? 1 : factor / life;\n\n            function _getGDA(value, period) {\n                var gda, oldValue, newValue;\n                if (interest == 1) {\n                    oldValue = period == 1 ? value : 0;\n                } else {\n                    oldValue = value * Math.pow(1 - interest, period - 1);\n                }\n                newValue = value * Math.pow(1 - interest, period);\n                gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n                return gda < 0 ? 0 : gda;\n            }\n\n            function _interVDB(cost, life1, period) {\n                var remValue = cost - salvage;\n                var intEnd = Math.ceil(period);\n                var term, lia = 0, vdb = 0, nowLia = false;\n                for (var i = 1; i <= intEnd; i++) {\n                    if (!nowLia) {\n                        var gda = _getGDA(cost, i);\n                        lia = remValue / (life1 - i + 1);\n                        if (lia > gda) {\n                            term = lia;\n                            nowLia = true;\n                        } else {\n                            term = gda;\n                            remValue -= gda;\n                        }\n                    } else {\n                        term = lia;\n                    }\n                    if (i == intEnd) {\n                        term *= period + 1 - intEnd;\n                    }\n                    vdb += term;\n                }\n                return vdb;\n            }\n\n            var intStart = Math.floor(start), intEnd = Math.ceil(end);\n            var vdb = 0;\n            if (no_switch) {\n                for (var i = intStart + 1; i <= intEnd; i++) {\n                    var term = _getGDA(cost, i);\n                    if (i == intStart + 1) {\n                        term *= Math.min(end, intStart + 1) - start;\n                    } else {\n                        if (i == intEnd) {\n                            term *= end + 1 - intEnd;\n                        }\n                    }\n                    vdb += term;\n                }\n            } else {\n                var life1 = life;\n                if (start != Math.floor(start)) {\n                    if (factor > 1) {\n                        if (start >= life / 2) {\n                            var part = start - life / 2;\n                            start = life / 2;\n                            end -= part;\n                            life1 += 1;\n                        }\n                    }\n                }\n                cost -= _interVDB(cost, life1, start);\n                vdb = _interVDB(cost, life - start, end - start);\n            }\n            return vdb;\n        }\n\n        /*************************************************************************************/\n\n        /*   (from  http://beginnersinvest.about.com)\n             an investor agrees to loan money to a company or government in exchange for a predetermined interest rate for a pre-determined length of time.\n\n             If an investor wanted to buy a $25,000 Coca-Cola bond with a 30 year maturity and an 10% coupon, it would work like this: He would send in the $25,000 from his savings account and get a $25,000 engraved bond certificate in exchange. After 30 years, he would be able to get his whole $25,000 back from the Coca-Cola company (of course, he can always sell it before then if he needs the money).\n\n             Every year, he’s entitled to receive 10% interest on the money he lent, or $2,500. Since most companies in the United States pay interest semi-annually, he would likely have 60 coupons attached to his bond for $1,250 each.\n             Every June 30th and December 31st, the investor would go down, clip the proper coupon, send it in, and get their money.\n\n             Although the practice is now defunct, the terminology stuck and interest payments on bonds will forever be known as coupons.\n        */\n\n\n        // \"Use EDATE to calculate maturity dates or due dates that fall on the same day of the month as the date of issue.\"\n        // See also: DATEDIF, DAY, DAYS, DAY360, EOMONTH (wich can be useful to determine limits of coupon periods)\n        function _edate(base, months) { // EDATE(start_date, months)\n            var d = unpackDate(base);\n            var m = d.month + months;\n            var y = d.year + Math.floor(m/12);\n            m %= 12;\n            if (m < 0) {\n                m += 12;\n            }\n            d = Math.min(d.date, daysInMonth(y, m));\n            return packDate(y, m, d);\n        }\n\n        function _daysBetween(from, to, basis) {\n            if (basis == 1 || basis == 2 || basis == 3) { // Actual/Actual || Actual/360 || Actual/365\n                return to - from;\n            }\n            return _days_360(from, to, basis);\n        }\n\n        // Find coupon dates that enclose the settlement date, counting backward from the maturity date.\n        /* independent of the 'basis' convention to count days - here we have no need to count days */\n        function _borderCoupons(settlement, maturity, freq) {\n            var sett = unpackDate(settlement), base = unpackDate(maturity);\n            var periods = base.year - sett.year;\n            if (periods > 0) {\n                periods = (periods - 1) * freq;\n            }\n            var prev, next, months = 12/freq;\n            do {\n                periods++;\n                prev = _edate(maturity, - periods*months);\n            } while (settlement < prev);\n            periods--;\n            next = _edate(maturity, - periods*months);\n            return [ prev, next ];\n        }\n\n        // Find coupon dates that enclose the settlement date, counting forward from the first-coupon payment.\n        /* independent of the 'basis' convention to count days - here we have no need to count days */\n        function _borderCoupons_fw(first, settlement, freq) {\n            var sett = unpackDate(settlement), base = unpackDate(first);\n            var periods = sett.year - base.year;\n            if (periods > 0) {\n                periods = (periods - 1) * freq;\n            }\n            var prev = first, next, months = 12/freq;\n            while (settlement > prev) {\n                next = prev;\n                periods++;\n                prev = _edate(first, periods*months);\n            }\n            return [ next, prev ];\n        }\n\n        //// COUPDAYBS (COUPon DAYs Beginning to Settlement) ////\n        /* returns the number of days from the beginning of the coupon period to the settlement date */\n        function COUPDAYBS(settlement, maturity, frequency, basis) { // COUPDAYBS(settlement, maturity, frequency, [basis])\n            var prev = _borderCoupons(settlement, maturity, frequency)[0];\n            return _daysBetween(prev, settlement, basis);\n        }\n\n        //// COUPDAYS (COUPon DAYs containing Settlement) ////\n        /* Returns the number of days in the coupon period that contains the settlement date */\n        function COUPDAYS(settl, matur, freq, basis) { // COUPDAYS(settlement, maturity, frequency, [basis])\n            if (basis == 1) {\n                var borders = _borderCoupons(settl, matur, freq);\n                return _daysBetween(borders[0], borders[1], 1);\n            }\n            if (basis == 3) {\n                return 365/freq;\n            }\n            return 360/freq;\n        }\n\n        //// COUPDAYSNC (COUPon DAYs Settlement to Next Coupon) ////\n        /* Returns the number of days from the settlement date to the next coupon date */\n        function COUPDAYSNC(settl, matur, freq, basis) { // COUPDAYSNC(settlement, maturity, frequency, [basis])\n            var next = _borderCoupons(settl, matur, freq)[1];\n            return _daysBetween(settl, next, basis);\n        }\n\n        //// COUPPCD (COUPon, Previous Coupon Date) ////\n        /* Returns the previous coupon date before the settlement date */\n        function COUPPCD(settl, matur, freq/*, basis*/) { // COUPPCD(settlement, maturity, frequency, [basis])\n            // It is no need to count days, so 'basis' becomes a inutil parameter.\n            return _borderCoupons(settl, matur, freq)[0];\n        }\n\n        //// COUPNCD (COUPon, Next Coupon Date) ////\n        /* Returns the next coupon date after the settlement date */\n        function COUPNCD(settl, matur, freq/*, basis*/) { // COUPNCD(settlement, maturity, frequency, [basis])\n            // It is no need to count days, so 'basis' becomes a inutil parameter.\n            return _borderCoupons(settl, matur, freq)[1];\n        }\n\n        function COUPNUM(settl, matur, freq/*, basis*/) { // COUPNUM(settlement, maturity, frequency, [basis])\n            var sett = unpackDate(settl),\n                mat = unpackDate(matur);\n            var months = 12*(mat.year - sett.year) + mat.month - sett.month;\n            //// Discount the last month if there are not enough days? Finally - we decide to not discount.\n            //// (if this \"last month\" have 2 days, Excel.COUPNUM returns 6 but GoogleSpreads give only 5)\n            //    var res = _edate(matur, -months);\n            //    if (sett.date >= unpackDate(res).date) {\n            //        months--; // an incomplete last month correspond to a qvasi-coupon period\n            //    }\n            return 1 + (months * freq / 12 | 0);\n        }\n\n        function daysInYear(yr, basis) {\n            if (basis == 3) { return 365; }\n            if (basis == 1) { return isLeapYear(yr) ? 366 : 365; }\n            return 360;\n        }\n\n        //// ACCRINTM  the accrued interest for a security that pays interest at maturity ////\n        function ACCRINTM(issue, maturity, rate, par, basis) { // ACCRINTM(issue, settlement, rate, par, [basis])\n            var year_days = daysInYear(unpackDate(maturity).year, basis); // 360;\n            return rate*par * _daysBetween(issue, maturity, basis) / year_days;\n        }\n\n        function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n            var accr = 0, cost = par * rate / freq;\n            var brace, prev, next, prev1, next1, nrc;\n\n            var annual = basis % 2 === 0 ? 360 : 365; // only if to >> from, we eventually need to count leap years\n            function _numCoupons(from, to) { // better than COUPNUM(from, to, freq, basis)-1\n                return (to - from)*freq/annual | 0;\n            }\n\n            if (settl <= first) {\n                brace = _borderCoupons(settl, first, freq);\n                prev = brace[0];\n                next = brace[1];\n                if (prev <= issue) {\n                    return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n                }\n                brace = _borderCoupons(issue, prev, freq);\n                prev1 = brace[0];\n                next1 = brace[1];\n                nrc = _numCoupons(next1, settl); // when settl==next, days are counted implicitly by nrc\n                return cost *\n                    (nrc +\n                     _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) +\n                     (settl < next? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n            } else {\n                brace = _borderCoupons_fw(first, settl, freq);\n                prev = brace[0];\n                next = brace[1];\n                nrc = _numCoupons(first, settl); // COUPNUM(first, settl, freq, basis) - 1;\n                if (next == settl) {\n                    accr = cost * nrc;\n                } else {\n                    accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n                }\n                if (!calc) { return accr; } // Only the accrued interest between first and settlement dates.\n                brace = _borderCoupons(issue, first, freq); // Add the accrued interest between issue and first dates.\n                prev = brace[0];\n                next = brace[1];\n                nrc = _numCoupons(issue, first);\n                accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n                return accr; // accrued interest between issue and settlement dates\n            }\n        }\n\n        //// DISC  the discount rate for a security (given price and redemption values per 100$ face value) ////\n        function DISC(settl, matur, pr, redemption, basis) { // DISC(settlement, maturity, pr, redemption, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return (redemption - pr)/redemption*annual/_daysBetween(settl, matur, basis);\n        }\n\n        //// INTRATE  the interest rate for a fully invested security ////\n        function INTRATE(settl, matur, investment, redemption, basis) { // INTRATE(settlement, maturity, investment, redemption, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return (redemption - investment)/investment*annual/_daysBetween(settl, matur, basis);\n        }\n\n        //// RECEIVED  the amount received at maturity for a fully invested security ////\n        function RECEIVED(settl, matur, investment, discount, basis) { // RECEIVED(settlement, maturity, investment, discount, [basis])\n            var annual = basis % 2 === 0 ? 360 : (isLeapYear(unpackDate(settl).year) ? 366 : 365);\n            return investment/(1 - discount*_daysBetween(settl, matur, basis)/annual);\n        }\n\n        //// PRICE  the price per $100 face value of a security that pays periodic interest ////\n        function PRICE(settl, matur, rate, yld, redemption, freq, basis) { // PRICE(settlement, maturity, rate, yld, redemption, frequency, [basis])\n            var N = 1 + ((matur - settl)*freq/(basis % 2 === 0 ? 360 : 365) | 0); // coupons playable between settlement and maturity dates\n            var brace = _borderCoupons(settl, matur, freq),\n                prev = brace[0], next = brace[1];\n            var beg_settl = _daysBetween(prev, settl, basis),\n                settl_end = _daysBetween(settl, next, basis),\n                beg_end = _daysBetween(prev, next, basis);\n            var den = 100*rate/freq,\n                yf = yld/freq,\n                frac = settl_end / beg_end;\n            if (N == 1) {\n                return (redemption + den)/(1 + frac*yf) - beg_settl / beg_end * den;\n            }\n            return redemption / Math.pow(1 + yf, N-1+frac)\n                + den * Math.pow(1 + yf, 1-N-frac) * (Math.pow(1+yf, N) - 1) / yf\n                - beg_settl / beg_end * den;\n        }\n\n        //// PRICEDISC  the price per $100 face value of a discounted security ////\n        function PRICEDISC(settl, matur, discount, redemption, basis) { // PRICEDISC(settlement, maturity, discount, redemption, [basis])\n            var dsm = _daysBetween(settl, matur, basis),\n                dy = daysInYear(unpackDate(matur).year, basis);\n            return redemption - discount*redemption*dsm/dy;\n        }\n\n        // Used in PEARSON, more could follow.  In some situations Excel appears to silently ignore\n        // missing or non-numeric values, for example if some value in a is missing a corresponding\n        // value in b, then the one in a is going to be ignored as if not present.  Arrays must have the\n        // same number of elements.  I couldn't come up with a good name for this function.\n        function whipNumberArrays(a, b) {\n            for (var i = a.length; --i >= 0;) {\n                if (typeof a[i] != \"number\" || typeof b[i] != \"number\") {\n                    a.splice(i, 1);\n                    b.splice(i, 1);\n                }\n            }\n        }\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var BORDER_TYPES = [\n                \"allBorders\",\n                \"insideBorders\",\n                \"insideHorizontalBorders\",\n                \"insideVerticalBorders\",\n                \"outsideBorders\",\n                \"leftBorder\",\n                \"topBorder\",\n                \"rightBorder\",\n                \"bottomBorder\",\n                \"noBorders\"\n            ];\n\n            var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n                allBorders: \"All borders\",\n                insideBorders: \"Inside borders\",\n                insideHorizontalBorders: \"Inside horizontal borders\",\n                insideVerticalBorders: \"Inside vertical borders\",\n                outsideBorders: \"Outside borders\",\n                leftBorder: \"Left border\",\n                topBorder: \"Top border\",\n                rightBorder: \"Right border\",\n                bottomBorder: \"Bottom border\",\n                noBorders: \"No border\"\n            };\n\n            var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n                reset: \"Reset color\",\n                customColor: \"Custom color...\",\n                apply: \"Apply\",\n                cancel: \"Cancel\"\n            };\n\n            function withPreventDefault(f) {\n                return function(e) {\n                    e.preventDefault();\n                    return f.apply(this, arguments);\n                };\n            }\n\n            var ColorChooser = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    kendo.ui.Widget.call(this, element, options);\n\n                    this.element = element;\n                    this.color = options.color;\n\n                    this._resetButton();\n                    this._colorPalette();\n                    this._customColorPalette();\n                    this._customColorButton();\n\n                    this.resetButton.on(\"click\", withPreventDefault(this.resetColor.bind(this)));\n                    this.customColorButton.on(\"click\", withPreventDefault(this.customColor.bind(this)));\n                },\n\n                options: {\n                    name: \"ColorChooser\"\n                },\n\n                events: [\n                    \"change\"\n                ],\n\n                destroy: function() {\n                    kendo.unbind(this.dialog.element.find(\".k-action-buttons\"));\n                    this.dialog.destroy();\n                    this.colorPalette.destroy();\n                    this.resetButton.off(\"click\");\n                    this.customColorButton.off(\"click\");\n                },\n\n                value: function(value) {\n                    if (value !== undefined) {\n                        this.color = value;\n                        this.customColorButton.find(\".k-icon\").css(\"background-color\", this.color);\n                        this.colorPalette.value(null);\n                        this.flatColorPicker.value(this.color);\n                    } else {\n                        return this.color;\n                    }\n                },\n\n                _change: function(value) {\n                    this.color = value;\n                    this.trigger(\"change\", { value: value });\n                },\n\n                _colorPalette: function() {\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-color-palette\"\n                    });\n\n                    var colorPalette = this.colorPalette = $(\"<div />\").kendoColorPalette({\n                        palette: [ //metro palette\n                            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                        ],\n                        value: this.color,\n                        change: function(e) {\n                            this.customColorButton.find(\".k-icon\").css(\"background-color\", \"transparent\");\n                            this.flatColorPicker.value(null);\n                            this._change(e.value);\n                        }.bind(this)\n                    }).data(\"kendoColorPalette\");\n\n                    element\n                        .append(colorPalette.wrapper)\n                        .appendTo(this.element);\n                },\n\n                _customColorPalette: function() {\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-window\",\n                        \"html\": \"<div></div>\" +\n                                \"<div class='k-action-buttons'>\" +\n                                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-\" + kendo.ns + \"bind='click: apply'><span class='k-button-text'>\" + COLOR_PICKER_MESSAGES.apply + \"</span></button>\" +\n                                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-\" + kendo.ns + \"bind='click: close'><span class='k-button-text'>\" + COLOR_PICKER_MESSAGES.cancel + \"</span></button>\" +\n                                \"</div>\"\n                    });\n\n                    var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                        animation: false,\n                        scrollable: false,\n                        resizable: false,\n                        maximizable: false,\n                        modal: true,\n                        visible: false,\n                        width: \"auto\",\n                        open: function() {\n                            this.center();\n                        }\n                    }).data(\"kendoWindow\");\n\n                    dialog.one(\"activate\", function() {\n                        this.element.find(\"[\" + kendo.attr(\"role\") + \"=flatcolorpicker]\").data(\"kendoFlatColorPicker\")._view._hueSlider.resize();\n                    });\n\n                    var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data(\"kendoFlatColorPicker\");\n\n                    var viewModel = kendo.observable({\n                        apply: function() {\n                            this.customColorButton.find(\".k-icon\").css(\"background-color\", flatColorPicker.value());\n                            this.colorPalette.value(null);\n                            this._change(flatColorPicker.value());\n                            dialog.close();\n                        }.bind(this),\n                        close: function() {\n                            flatColorPicker.value(null);\n                            dialog.close();\n                        }\n                    });\n\n                    kendo.bind(dialog.element.find(\".k-action-buttons\"), viewModel);\n                },\n\n                _resetButton: function() {\n                    this.resetButton = $(\"<a role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-reset-color' href='#'>\" +\n                                        \"<span class='k-button-icon k-icon k-i-reset-color'></span>\" +\n                                        '<span class=\"k-button-text\">' + COLOR_PICKER_MESSAGES.reset + '</span>' +\n                                       \"</a>\").appendTo(this.element);\n                },\n\n                _customColorButton: function() {\n                    this.customColorButton = $(\"<a role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-custom-color' href='#'>\" +\n                                                \"<span class='k-button-icon k-icon'></span>\" +\n                                                '<span class=\"k-button-text\">' + COLOR_PICKER_MESSAGES.customColor + '</span>' +\n                                               \"</a>\").appendTo(this.element);\n                },\n\n                resetColor: function() {\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(null);\n                    this._change(null);\n                },\n\n                customColor: function() {\n                    this.dialog.open();\n                }\n\n            });\n\n            var BorderPalette = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    kendo.ui.Widget.call(this, element, options);\n\n                    this.element = element;\n                    this.color = \"#000\";\n\n                    this.element.addClass(\"k-spreadsheet-border-palette\");\n\n                    this._borderTypePalette();\n                    this._borderColorPalette();\n\n                    this.element.on(\"click\", \".k-spreadsheet-border-type-palette .k-button\", withPreventDefault(this._click.bind(this)));\n                },\n\n                options: {\n                    name: \"BorderPalette\"\n                },\n\n                events: [\n                    \"change\"\n                ],\n\n                destroy: function() {\n                    this.colorChooser.destroy();\n                    this.element.off(\"click\");\n                },\n\n                _borderTypePalette: function() {\n                    var messages = BORDER_PALETTE_MESSAGES;\n                    var buttons = BORDER_TYPES.map(function(type) {\n                        return '<a role=\"button\" title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button\">' +\n                                    '<span class=\"k-button-icon k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' +\n                               '</a>';\n                    }).join(\"\");\n\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-type-palette\",\n                        \"html\": buttons\n                    });\n\n                    element.appendTo(this.element);\n                },\n\n                _borderColorPalette: function() {\n                    var element = $(\"<div />\", {\n                        \"class\": \"k-spreadsheet-border-color-palette\"\n                    });\n\n                    element.appendTo(this.element);\n\n                    this.colorChooser = new ColorChooser(element, {\n                        color: this.color,\n                        change: this._colorChange.bind(this)\n                    });\n                },\n\n                _click: function(e) {\n                    this.type = $(e.currentTarget).data(\"borderType\");\n                    this.trigger(\"change\", { type: this.type, color: this.color });\n                },\n\n                _colorChange: function(e) {\n                    this.color = e.value;\n                    if (this.type) {\n                        this.trigger(\"change\", { type: this.type, color: this.color });\n                    }\n                }\n            });\n\n            kendo.spreadsheet.ColorChooser = ColorChooser;\n            kendo.spreadsheet.BorderPalette = BorderPalette;\n\n        })(window.kendo);\n\n    (function(kendo) {\n\n\n\n        var $ = kendo.jQuery;\n\n        var ToolBar = kendo.ui.ToolBar;\n\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: \"Add column left\",\n            addColumnRight: \"Add column right\",\n            addRowAbove: \"Add row above\",\n            addRowBelow: \"Add row below\",\n            alignment: \"Alignment\",\n            alignmentButtons: {\n                justtifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            },\n            backgroundColor: \"Background\",\n            bold: \"Bold\",\n            borders: \"Borders\",\n            copy: \"Copy\",\n            cut: \"Cut\",\n            deleteColumn: \"Delete column\",\n            deleteRow: \"Delete row\",\n            filter: \"Filter\",\n            fontFamily: \"Font\",\n            fontSize: \"Font size\",\n            format: \"Custom format...\",\n            formatTypes: {\n                automatic: \"Automatic\",\n                text: \"Text\",\n                number: \"Number\",\n                percent: \"Percent\",\n                financial: \"Financial\",\n                currency: \"Currency\",\n                date: \"Date\",\n                time: \"Time\",\n                dateTime: \"Date time\",\n                duration: \"Duration\",\n                moreFormats: \"More formats...\"\n            },\n            formatDecreaseDecimal: \"Decrease decimal\",\n            formatIncreaseDecimal: \"Increase decimal\",\n            freeze: \"Freeze panes\",\n            freezeButtons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            },\n            insertComment: \"Insert comment\",\n            insertImage: \"Insert image\",\n            italic: \"Italic\",\n            merge: \"Merge cells\",\n            mergeButtons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            },\n            open: \"Open...\",\n            paste: \"Paste\",\n            quickAccess: {\n                redo: \"Redo\",\n                undo: \"Undo\"\n            },\n            exportAs: \"Export...\",\n            toggleGridlines: \"Toggle gridlines\",\n            sort: \"Sort\",\n            sortButtons: {\n                // sortSheetAsc: \"Sort sheet A to Z\",\n                // sortSheetDesc: \"Sort sheet Z to A\",\n                sortRangeAsc: \"Sort range A to Z\",\n                sortRangeDesc: \"Sort range Z to A\"\n            },\n            textColor: \"Text Color\",\n            textWrap: \"Wrap text\",\n            underline: \"Underline\",\n            validation: \"Data validation...\",\n            hyperlink: \"Link\"\n        };\n\n        var defaultTools = {\n            home: [\n                \"open\",\n                \"exportAs\",\n                [ \"cut\", \"copy\", \"paste\" ],\n                [ \"bold\", \"italic\", \"underline\" ], \"hyperlink\", \"insertComment\", \"insertImage\",\n                \"backgroundColor\", \"textColor\",\n                \"borders\",\n                \"fontSize\", \"fontFamily\",\n                \"alignment\",\n                \"textWrap\",\n                [ \"formatDecreaseDecimal\", \"formatIncreaseDecimal\" ],\n                \"format\",\n                \"merge\",\n                \"freeze\",\n                \"filter\",\n                \"toggleGridlines\"\n            ],\n            insert: [\n                [ \"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\" ],\n                [ \"deleteColumn\", \"deleteRow\" ]\n            ],\n            data: [\n                \"sort\",\n                \"filter\",\n                \"validation\"\n            ]\n        };\n\n        var toolDefaults = {\n            //home tab\n            open:                  { type: \"open\",                                     overflow: \"never\",                          iconClass: \"file-excel\" },\n            exportAs:              { type: \"exportAsDialog\", dialogName: \"exportAs\",   overflow: \"never\",       text: \"\",        iconClass: \"file-excel\" },\n            bold:                  { type: \"button\", command: \"PropertyChangeCommand\", property: \"bold\",          value: true,     iconClass: \"bold\", togglable: true },\n            italic:                { type: \"button\", command: \"PropertyChangeCommand\", property: \"italic\",        value: true,     iconClass: \"italic\", togglable: true },\n            underline:             { type: \"button\", command: \"PropertyChangeCommand\", property: \"underline\",     value: true,     iconClass: \"underline\", togglable: true },\n            formatDecreaseDecimal: { type: \"button\", command: \"AdjustDecimalsCommand\",                            value: -1,       iconClass: \"decimal-decrease\" },\n            formatIncreaseDecimal: { type: \"button\", command: \"AdjustDecimalsCommand\",                            value: +1,       iconClass: \"decimal-increase\" },\n            textWrap:              { type: \"button\", command: \"TextWrapCommand\",       property: \"wrap\",          value: true,     iconClass: \"text-wrap\", togglable: true },\n            cut:                   { type: \"button\", command: \"ToolbarCutCommand\",                                                 iconClass: \"cut\" },\n            copy:                  { type: \"button\", command: \"ToolbarCopyCommand\",                                                iconClass: \"copy\" },\n            paste:                 { type: \"button\", command: \"ToolbarPasteCommand\",                                               iconClass: \"paste\" },\n            separator:             { type: \"separator\" },\n            alignment:             { type: \"alignment\",                           iconClass: \"align-left\" },\n            backgroundColor:       { type: \"colorPicker\", property: \"background\", iconClass: \"paint\" },\n            textColor:             { type: \"colorPicker\", property: \"color\",      iconClass: \"foreground-color\" },\n            fontFamily:            { type: \"fontFamily\",  property: \"fontFamily\", iconClass: \"font-family\" },\n            fontSize:              { type: \"fontSize\",    property: \"fontSize\",   iconClass: \"font-size\" },\n            format:                { type: \"format\",      property: \"format\",     iconClass: \"custom-format\" },\n            filter:                { type: \"filter\",      property: \"hasFilter\",  iconClass: \"filter\" },\n            merge:                 { type: \"merge\",                               iconClass: \"cells-merge\" },\n            freeze:                { type: \"freeze\",                              iconClass: \"pane-freeze\" },\n            borders:               { type: \"borders\",                             iconClass: \"borders-all\" },\n            formatCells:           { type: \"dialog\", dialogName: \"formatCells\", overflow: \"never\" },\n            hyperlink:             { type: \"dialog\", dialogName: \"hyperlink\", iconClass: \"link-horizontal\", overflow: \"never\", text: \"\" },\n            toggleGridlines:       { type: \"button\", command: \"GridLinesChangeCommand\", property: \"gridLines\", value: true, iconClass: \"border-no\", togglable: true },\n            insertComment:         { type: \"dialog\", dialogName: \"insertComment\", property: \"comment\", togglable: true, overflow: \"never\", iconClass: \"comment\", text: \"\" },\n            insertImage:           { type: \"dialog\", dialogName: \"insertImage\", overflow: \"never\", iconClass: \"image\", text: \"\" },\n\n            //insert tab\n            addColumnLeft:         { type: \"button\", command: \"AddColumnCommand\",    value: \"left\",  iconClass: \"table-column-insert-left\"  },\n            addColumnRight:        { type: \"button\", command: \"AddColumnCommand\",    value: \"right\", iconClass: \"table-column-insert-right\" },\n            addRowBelow:           { type: \"button\", command: \"AddRowCommand\",       value: \"below\", iconClass: \"table-row-insert-below\"    },\n            addRowAbove:           { type: \"button\", command: \"AddRowCommand\",       value: \"above\", iconClass: \"table-row-insert-above\"    },\n            deleteColumn:          { type: \"button\", command: \"DeleteColumnCommand\",                 iconClass: \"table-column-delete\"    },\n            deleteRow:             { type: \"button\", command: \"DeleteRowCommand\",                    iconClass: \"table-row-delete\"       },\n\n            //data tab\n            sort:                  { type: \"sort\", iconClass: \"sort-desc\" },\n            validation:            { type: \"dialog\", dialogName: \"validation\", iconClass: \"exception\", overflow: \"never\" }\n        };\n\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function(element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n\n                this.element.addClass(\"k-spreadsheet-toolbar\");\n\n                this._addSeparators(this.element);\n\n                this.element.on(\"focusout\", function () {\n                    $(this).find(\".k-toolbar-first-visible\").removeClass(\"k-focus\");\n                });\n\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _nextTool: function (direction) {\n                var that = this;\n                var tools = that.element.find(\".k-dropdownlist, .k-combobox, .k-button, .k-button-group > a\").not(\"[tabindex=-1]\");\n                var activeIndex = tools.index($(document.activeElement).closest(\".k-dropdownlist, .k-combobox, .k-button, .k-button-group > a\").not(\"[tabindex=-1]\"));\n                if (activeIndex > 0) {\n                    return tools[activeIndex + direction];\n                }\n            },\n            _addSeparators: function(element) {\n                var groups = element.children(\".k-toolbar-item, .k-dropdownlist, .k-combobox, a.k-button, .k-button-group\");\n\n                groups.before(\"<span class='k-separator'></span>\");\n            },\n            _expandTools: function(tools) {\n                function expandTool(toolName) {\n                    // expand string to object, add missing tool properties\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = \"k-icon k-i-\" + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: {\n                            showText: \"overflow\"\n                        },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment:  { spriteCssClass: spriteCssClass },\n                        merge:  { spriteCssClass: spriteCssClass },\n                        freeze:  { spriteCssClass: spriteCssClass }\n                    };\n\n                    var tool = kendo.deepExtend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: {\n                            title: MESSAGES[options.name || toolName],\n                            \"aria-label\":   MESSAGES[options.name || toolName]\n                        }\n                    }, typeDefaults[type], options);\n\n                    if (type == \"splitButton\") {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n\n                    if(tool.name === \"fontSize\" || toolName === \"fontSize\") {\n                        tool.attributes[\"aria-label\"] = null;\n                    }\n\n                    tool.attributes[\"data-tool\"] = toolName;\n\n                    if (options.property) {\n                        tool.attributes[\"data-property\"] = options.property;\n                    }\n\n                    return tool;\n                }\n\n                return tools.reduce(function(tools, tool) {\n                    if (Array.isArray(tool)) {\n                        tools.push({ type: \"buttonGroup\", buttons: tool.map(expandTool) });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n\n                    return tools;\n                }, []);\n            },\n            _click: function(e) {\n                var toolName = e.target.attr(\"data-tool\");\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n\n                if (!commandType) {\n                    return;\n                }\n\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n\n                if (typeof args.options.value === \"boolean\") {\n                    args.options.value = e.checked ? true : null;\n                }\n\n                this.action(args);\n            },\n            events: [\n                \"click\",\n                \"toggle\",\n                \"open\",\n                \"close\",\n                \"overflowOpen\",\n                \"overflowClose\",\n\n                \"action\",\n                \"dialog\"\n            ],\n            options: {\n                name: \"SpreadsheetToolBar\",\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function(args) {\n                this.trigger(\"action\", args);\n            },\n            dialog: function(args) {\n                this.trigger(\"dialog\", args);\n            },\n            refresh: function(activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = (toolbar && toolbar.options.togglable) ||\n                                     (overflow && overflow.options.togglable);\n\n                    if (!togglable) {\n                        return;\n                    }\n\n                    var toggle = false;\n\n                    if (typeof value === \"boolean\") {\n                        toggle = value;\n                    } else if (typeof value === \"string\") {\n                        if (toolbar.options.hasOwnProperty(\"value\")) {\n                            toggle = toolbar.options.value === value;\n                        } else {\n                            // if no value is specified in the tool\n                            // options, assume it should be ON if the\n                            // range value is not null, and OFF otherwise.\n                            toggle = value != null;\n                        }\n                    }\n\n                    toolbar.toggle(toggle);\n\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var selection, enabled;\n\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n\n                    if (tool.type == \"filter\") {\n                        selection = range.sheet().selection();\n\n                        if (selection && selection._ref && selection._ref.height) {\n                            enabled = value || selection._ref.height() > 1;\n                            toolbar.enable(enabled);\n                            overflow.enable(enabled);\n                        }\n                    }\n                }\n\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                    if (property == \"gridLines\") {\n                        // the law of leaky abstractions kicks in.  this\n                        // isn't really a property of the range, it's\n                        // per-sheet.\n                        value = range.sheet().showGridLines();\n                    }\n\n                    if (tool.type === \"button\") {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n                this.resize();\n            },\n            _tools: function() {\n                return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                    element = $(element);\n                    return {\n                        property: element.attr(\"data-property\"),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function() {\n                // TODO: move to ToolBar.destroy to take care of these\n                this.element.find(\"[data-command],.k-button\").each(function() {\n                    var element = $(this);\n                    var instance = element.data(\"instance\");\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n        var DropDownTool = kendo.toolbar.TemplateItem.extend({\n            init: function(options, toolbar) {\n                var dropDownList = $(\"<select />\")\n                    .attr(\"title\", options.attributes.title)\n                    .attr(\"aria-label\", options.attributes.title)\n                    .kendoDropDownList({\n                        height: \"auto\",\n                        autoWidth: true\n                    }).data(\"kendoDropDownList\");\n\n                this.dropDownList = dropDownList;\n\n                delete options.attributes[\"aria-label\"];\n\n                kendo.toolbar.TemplateItem.fn.init.call(this, dropDownList.wrapper, options, toolbar);\n\n                dropDownList.bind(\"open\", this._open.bind(this));\n                dropDownList.bind(\"change\", this._change.bind(this));\n\n                this.element.parent(\".k-toolbar-item\").width(options.width).attr({\n                    \"data-command\": \"PropertyChangeCommand\",\n                    \"data-property\": options.property\n                });\n            },\n            _open: function() {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n\n                list.css({\n                    whiteSpace: \"nowrap\",\n                    width: \"auto\"\n                });\n\n                listWidth = list.width();\n\n                if (listWidth > 0) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n\n                list.css(\"width\", listWidth + kendo.support.scrollbar());\n\n                ddl._listWidth = listWidth;\n            },\n            _change: function(e) {\n                var that = this;\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n\n                if (popupName) {\n                    setTimeout(function () {\n                        that.toolbar.dialog({ name: popupName });\n                    });\n                } else {\n                    that.toolbar.action({\n                        command: \"PropertyChangeCommand\",\n                        options: {\n                            property: this.options.property,\n                            value: value == \"null\" ? null : value\n                        }\n                    });\n                }\n            },\n            value: function(value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function(options, toolbar) {\n                this.element = $(\"<a role='button' href='#' class='k-button k-button-md k-rounded-md  k-button-solid k-button-solid-base'>\" +\n                                    \"<span class='k-button-icon k-icon \" + options.spriteCssClass + \"'></span>\" +\n                                    \"<span class='k-button-text'><span class='k-icon k-i-arrow-s'></span></span>\" +\n                                \"</a>\");\n\n                this.element\n                    .on(\"click touchend\", this.open.bind(this))\n                    .attr(\"data-command\", options.command);\n\n                this.options = options;\n                this.toolbar = toolbar;\n\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n\n                this._popup();\n            },\n            destroy: function() {\n                this.popup.destroy();\n            },\n            open: function(ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function() {\n                var element = this.element;\n\n                this.popup = $(\"<div class='k-spreadsheet-popup' />\").appendTo(element).kendoPopup({\n                    anchor: element\n                }).data(\"kendoPopup\");\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"dialog\", kendo.toolbar.ToolBarButton.extend({\n            init: function(options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n\n                this._dialogName = options.dialogName;\n\n                this.element.on(\"click touchend\", this.open.bind(this))\n                            .data(\"instance\", this);\n            },\n            open: function() {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n\n        kendo.toolbar.registerComponent(\"exportAsDialog\", kendo.toolbar.Item.extend({\n            init: function(options, toolbar) {\n                this._dialogName = options.dialogName;\n\n                this.toolbar = toolbar;\n                this._title = options.attributes.title;\n                this.element = $(\"<button type='button' role='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button'>\" +\n                                     \"<span class='k-button-icon k-icon k-i-download'></span>\" +\n                                 \"</button>\")\n                                 .attr(\"title\", this._title)\n                                 .attr(\"aria-label\", this._title)\n                                 .data(\"instance\", this);\n\n                this.element.on(\"click\", this.open.bind(this))\n                            .data(\"instance\", this);\n            },\n            open: function() {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function(options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n\n                this.element.on(\"click touchend\", this._click.bind(this));\n\n                this.message = this.options.text;\n\n                var instance = this.element.data(\"button\");\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n\n        var ColorPicker = PopupTool.extend({\n            init: function(options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass(\"k-spreadsheet-colorpicker\");\n\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, {\n                    change: this._colorChange.bind(this)\n                });\n\n                this.element.attr({\n                    \"data-property\": options.property\n                });\n\n                this.element.data({\n                    type: \"colorPicker\",\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function() {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function(value) {\n                this.value(value);\n            },\n            value: function(value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function(e) {\n                this.toolbar.action({\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function(options, toolbar) {\n                options.iconName = \"text\";\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function() {\n                this.toolbar.dialog({\n                    name: \"colorPicker\",\n                    options: {\n                        title: this.options.property, property: this.options.property\n                    }\n                });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"colorPicker\", ColorPicker, ColorPickerButton);\n\n        var FONT_SIZES = [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        var DEFAULT_FONT_SIZE = 12;\n\n        var FontSize = kendo.toolbar.TemplateItem.extend({\n            init: function(options, toolbar) {\n                var comboBox = $(\"<input />\")\n                    .attr(\"aria-label\", options.attributes.title)\n                    .attr(\"title\", options.attributes.title)\n                    .kendoComboBox({\n                        change: this._valueChange.bind(this),\n                        clearButton: false,\n                        dataSource: options.fontSizes || FONT_SIZES,\n                        value: DEFAULT_FONT_SIZE\n                    }).data(\"kendoComboBox\");\n\n                this.comboBox = comboBox;\n\n                kendo.toolbar.TemplateItem.fn.init.call(this, comboBox.wrapper, options, toolbar);\n\n                this.element.width(options.width).attr({\n                    \"data-command\": \"PropertyChangeCommand\",\n                    \"data-property\": options.property\n                });\n\n                this.element.data({\n                    type: \"fontSize\",\n                    fontSize: this\n                });\n            },\n\n            _valueChange: function(e) {\n                this.toolbar.action({\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n\n            update: function(value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n\n            value: function(value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({\n                    name: \"fontSize\",\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function(value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find(\".k-button-text\").text(this.message + \" (\" + this._value + \") ...\");\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"fontSize\", FontSize, FontSizeButton);\n\n        var FONT_FAMILIES = [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"];\n        var DEFAULT_FONT_FAMILY = \"Arial\";\n\n        var FontFamily = DropDownTool.extend({\n            init: function(options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n\n                this.element.data({\n                    type: \"fontFamily\",\n                    fontFamily: this\n                });\n            },\n            update: function(value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({\n                    name: \"fontFamily\",\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function(value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find(\".k-button-text\").text(this.message + \" (\" + this._value + \") ...\");\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"fontFamily\", FontFamily, FontFamilyButton);\n\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: \"@\",\n            number: \"#,0.00\",\n            percent: \"0.00%\",\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: \"$#,##0.00;[Red]$#,##0.00\",\n            date: \"m/d/yyyy\",\n            time: \"h:mm:ss AM/PM\",\n            dateTime: \"m/d/yyyy h:mm\",\n            duration: \"[h]:mm:ss\"\n        };\n\n        var Format = DropDownTool.extend({\n            _revertTitle: function(e) {\n                e.sender.value(\"\");\n                e.sender.wrapper.width(\"auto\");\n            },\n            init: function(options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n\n                var ddl = this.dropDownList;\n                var icon = \"<span class='k-icon k-i-\" + options.iconClass + \"' style='line-height: 1em; width: 1.35em;'></span>\";\n                ddl.bind(\"change\", this._revertTitle.bind(this));\n                ddl.bind(\"dataBound\", this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: \"format\",\n                    dataTextField: \"name\",\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template:\n                        \"# if (data.sample) { #\" +\n                            \"<span class='k-spreadsheet-sample'>#: data.sample #</span>\" +\n                        \"# } #\" +\n                        \"#: data.name #\"\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    { format: defaultFormats.automatic, name: MESSAGES.formatTypes.automatic },\n                    { format: defaultFormats.text, name: MESSAGES.formatTypes.text },\n                    { format: defaultFormats.number, name: MESSAGES.formatTypes.number , sample: \"1,499.99\" },\n                    { format: defaultFormats.percent, name: MESSAGES.formatTypes.percent , sample: \"14.50%\" },\n                    { format: defaultFormats.financial, name: MESSAGES.formatTypes.financial , sample: \"(1,000.12)\" },\n                    { format: defaultFormats.currency, name: MESSAGES.formatTypes.currency , sample: \"$1,499.99\" },\n                    { format: defaultFormats.date, name: MESSAGES.formatTypes.date , sample: \"4/21/2012\" },\n                    { format: defaultFormats.time, name: MESSAGES.formatTypes.time , sample: \"5:49:00 PM\" },\n                    { format: defaultFormats.dateTime, name: MESSAGES.formatTypes.dateTime , sample: \"4/21/2012 5:49:00\" },\n                    { format: defaultFormats.duration, name: MESSAGES.formatTypes.duration , sample: \"168:05:00\" },\n                    { popup: \"formatCells\", name: MESSAGES.formatTypes.moreFormats }\n                ]);\n\n                this.element.data({\n                    type: \"format\",\n                    format: this\n                });\n\n                ddl.wrapper.find(\"[role='option']\").attr(\"aria-label\", \"Select format\");\n            }\n        });\n\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"formatCells\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"format\", Format, FormatButton);\n\n        var BorderChangeTool = PopupTool.extend({\n            init: function(options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n\n                this.element.data({\n                    type: \"borders\",\n                    instance: this\n                });\n            },\n            destroy: function() {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function() {\n                var element = $(\"<div />\").appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                    change: this._action.bind(this)\n                });\n            },\n            _action: function(e) {\n                this.toolbar.action({\n                    command: \"BorderChangeCommand\",\n                    options: {\n                        border: e.type,\n                        style: { size: 1, color: e.color }\n                    }\n                });\n            }\n        });\n\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"borders\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"borders\", BorderChangeTool, BorderChangeButton);\n\n        var AlignmentTool = PopupTool.extend({\n            init: function(options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n\n                this.element.attr({ \"data-property\": \"alignment\" });\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on(\"click\", \".k-button\", function(e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n\n                this.element.data({\n                    type: \"alignment\",\n                    alignment: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function() {\n                this.buttons = [\n                    { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: MESSAGES.alignmentButtons.justtifyLeft },\n                    { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                    { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: MESSAGES.alignmentButtons.justifyRight },\n                    { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: MESSAGES.alignmentButtons.justifyFull },\n                    { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: MESSAGES.alignmentButtons.alignTop },\n                    { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: MESSAGES.alignmentButtons.alignMiddle },\n                    { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: MESSAGES.alignmentButtons.alignBottom }\n                ];\n            },\n            destroy: function() {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function(range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n\n                element.find(\".k-button\").removeClass(\"k-selected\");\n\n                if (textAlign) {\n                    element.find(\"[data-property=textAlign][data-value=\" + textAlign + \"]\").addClass(\"k-selected\");\n                }\n\n                if (verticalAlign) {\n                    element.find(\"[data-property=verticalAlign][data-value=\" + verticalAlign + \"]\").addClass(\"k-selected\");\n                }\n            },\n            _commandPalette: function() {\n                var buttons = this.buttons;\n                var element = $(\"<div />\").appendTo(this.popup.element);\n                buttons.forEach(function(options, index) {\n                    var button = \"<a role='button' title='\" + options.text + \"' data-property='\" + options.property + \"' data-value='\" + options.value + \"' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button'>\" +\n                                    \"<span class='k-button-icon k-icon k-i-\" + options.iconClass + \"'></span>\" +\n                                 \"</a>\";\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($(\"<span class='k-separator' />\"));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function(button) {\n                var property = button.attr(\"data-property\");\n                var value = button.attr(\"data-value\");\n\n                this.toolbar.action({\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"alignment\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"alignment\", AlignmentTool, AlignmentButton);\n\n        var MergeTool = PopupTool.extend({\n            init: function(options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n\n                this.popup.element.addClass(\"k-menu-popup\");\n\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on(\"click\", \".k-menu-item\", function(e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n\n                this.element.data({\n                    type: \"merge\",\n                    merge: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function() {\n                this.buttons = [\n                    { value: \"cells\",        iconClass: \"cells-merge\",        text: MESSAGES.mergeButtons.mergeCells },\n                    { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                    { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: MESSAGES.mergeButtons.mergeVertically },\n                    { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: MESSAGES.mergeButtons.unmerge }\n                ];\n            },\n            destroy: function() {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function() {\n                var element = $(\"<ul class='k-group k-menu-group k-reset k-menu-group-md'>\").appendTo(this.popup.element);\n\n                this.buttons.forEach(function(options) {\n                    var item = \"<li class='k-item k-menu-item' data-value='\" + options.value + \"'>\" +\n                        \"<span class='k-link k-menu-link'>\" +\n                            \"<span class='k-icon k-i-\" + options.iconClass + \"'></span>\" +\n                            \"<span class='k-menu-link-text'>\" + options.text + \"</span>\" +\n                        \"</span>\" +\n                    \"</li>\";\n\n                    element.append(item);\n                });\n            },\n            _action: function(button) {\n                var value = button.attr(\"data-value\");\n\n                this.toolbar.action({\n                    command: \"MergeCellCommand\",\n                    options: {\n                        value: value\n                    }\n                });\n            }\n        });\n\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"merge\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"merge\", MergeTool, MergeButton);\n\n        var FreezeTool = PopupTool.extend({\n            init: function(options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n\n                this.popup.element.addClass(\"k-menu-popup\");\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on(\"click\", \".k-menu-item\", function(e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n\n                this.element.data({\n                    type: \"freeze\",\n                    freeze: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function() {\n                this.buttons = [\n                    { value: \"panes\",    iconClass: \"pane-freeze\",  text: MESSAGES.freezeButtons.freezePanes },\n                    { value: \"rows\",     iconClass: \"row-freeze\",    text: MESSAGES.freezeButtons.freezeRows },\n                    { value: \"columns\",  iconClass: \"column-freeze\",    text: MESSAGES.freezeButtons.freezeColumns },\n                    { value: \"unfreeze\", iconClass: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                ];\n            },\n            destroy: function() {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function() {\n                var element = $(\"<ul class='k-group k-menu-group k-reset k-menu-group-md'>\").appendTo(this.popup.element);\n                this.buttons.forEach(function(options) {\n                    var item = \"<li class='k-item k-menu-item' data-value='\" + options.value + \"'>\" +\n                        \"<span class='k-link k-menu-link'>\" +\n                            \"<span class='k-icon k-i-\" + options.iconClass + \"'></span>\" +\n                            \"<span class='k-menu-link-text'>\" + options.text + \"</span>\" +\n                        \"</span>\" +\n                    \"</li>\";\n                    element.append(item);\n                });\n            },\n            _action: function(button) {\n                var value = button.attr(\"data-value\");\n\n                this.toolbar.action({\n                    command: \"FreezePanesCommand\",\n                    options: {\n                        value: value\n                    }\n                });\n            }\n        });\n\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"freeze\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"freeze\", FreezeTool, FreezeButton);\n\n        var Sort = DropDownTool.extend({\n            _revertTitle: function(e) {\n                e.sender.wrapper.find('[role=\"option\"]').attr(\"aria-label\", e.sender.value());\n                e.sender.value(\"\");\n                e.sender.wrapper.width(\"auto\");\n            },\n            init: function(options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n\n                var ddl = this.dropDownList;\n                ddl.bind(\"change\", this._revertTitle.bind(this));\n                ddl.bind(\"dataBound\", this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: \"<span class='k-icon k-i-\" + options.iconClass + \"' style='line-height: 1em; width: 1.35em;'></span>\",\n                    template: \"<span class='k-icon k-i-#= iconClass #' style='line-height: 1em; width: 1.35em;'></span>#=text#\",\n                    dataTextField: \"text\",\n                    dataValueField: \"value\"\n                });\n                ddl.setDataSource([\n                    // { value: \"asc\", sheet: true, asc: true,  text: MESSAGES.sortButtons.sortSheetAsc,  iconClass: \"sort-asc\" },\n                    // { value: \"desc\", sheet: true, asc: false, text: MESSAGES.sortButtons.sortSheetDesc,  , iconClass: \"sort-desc\" },\n                    { value: \"asc\", sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, iconClass: \"sort-asc\" },\n                    { value: \"desc\", sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, iconClass: \"sort-desc\" }\n                ]);\n                ddl.select(0);\n                ddl.wrapper.find('[role=\"option\"]').attr(\"aria-label\", \"asc\");\n\n                this.element.data({\n                    type: \"sort\",\n                    sort: this\n                });\n            },\n            _change: function(e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: \"SortCommand\",\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n\n        var SortButton = OverflowDialogButton.extend({\n            _click: function() {\n                this.toolbar.dialog({ name: \"sort\" });\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"sort\", Sort, SortButton);\n\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function(options, toolbar) {\n                options.showText = \"overflow\";\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n\n                this.element.on(\"click\", this._click.bind(this));\n\n                this.element.data({\n                    type: \"filter\",\n                    filter: this\n                });\n            },\n            _click: function() {\n                this.toolbar.action({ command: \"FilterCommand\" });\n            },\n            update: function(value) {\n                this.toggle(value);\n            }\n        });\n\n        var FilterButton = OverflowDialogButton.extend({\n            init: function(options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n\n                this.element.data({\n                    type: \"filter\",\n                    filter: this\n                });\n            },\n            _click: function() {\n                this.toolbar.action({ command: \"FilterCommand\" });\n            },\n            update: function(value) {\n                this.toggle(value);\n            }\n        });\n\n        kendo.toolbar.registerComponent(\"filter\", Filter, FilterButton);\n\n        var Open = kendo.toolbar.Item.extend({\n            init: function(options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $(\"<div class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-upload-button k-icon-button'>\" +\n                                     \"<span class='k-button-icon k-icon k-i-folder-open'></span>\" +\n                                 \"</div>\").data(\"instance\", this);\n\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function() {\n                this.element.find(\"input\").remove();\n\n                $(\"<input type='file' autocomplete='off' accept='.xlsx'/>\")\n                    .attr(\"title\", this._title)\n                    .attr(\"aria-label\", this._title)\n                    .one(\"change\", this._change.bind(this))\n                    .appendTo(this.element);\n            },\n            _change: function(e) {\n                this.toolbar.action({\n                    command: \"OpenCommand\",\n                    options: {\n                        file: e.target.files[0]\n                    }\n                });\n\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent(\"open\", Open);\n\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function(element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass(\"k-spreadsheet-tabstrip\");\n                this._quickAccessButtons();\n\n                this.toolbars = {};\n\n                var tabs = options.dataSource;\n\n                this.contentElements.each(function(idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n\n                this.one(\"activate\", function() { //force resize of the tabstrip after TabStrip tab is opened\n                    var toolbar = this.toolbars[this.options.dataSource[0].id];\n                    toolbar.resize();\n                });\n\n                this.bind(\"activate\", function(e) { //force resize of the tabstrip after TabStrip tab is opened\n                    var toolbar = $(e.contentElement).find(\".k-toolbar\").data(\"kendoSpreadsheetToolBar\");\n\n                    toolbar._tabIndex();\n                    this.wrapper.removeAttr(\"tabindex\");\n                    this.wrapper.find(\".k-tabstrip-content\").removeAttr(\"tabindex\");\n                });\n            },\n\n            events: kendo.ui.TabStrip.fn.events.concat([ \"action\", \"dialog\" ]),\n\n            destroy: function() {\n                this.quickAccessToolBar.off(\"click\");\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n\n            action: function(args) {\n                this.trigger(\"action\", args);\n            },\n\n            dialog: function(args) {\n                this.trigger(\"dialog\", args);\n            },\n\n            refreshTools: function(range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n\n            _quickAccessButtons: function() {\n                var buttons = [\n                    { title: MESSAGES.quickAccess.undo, iconClass: \"undo\", action: \"undo\" },\n                    { title: MESSAGES.quickAccess.redo, iconClass: \"redo\", action: \"redo\" }\n                ];\n                var buttonTemplate = kendo.template(\"<a role='button' href='\\\\#' title='#= title #' data-action='#= action #' class='k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button' aria-label='#= title #'><span class='k-button-icon k-icon k-i-#=iconClass#'></span></a>\");\n\n                this.quickAccessToolBar = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-quick-access-toolbar\",\n                    \"html\": kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n\n                this.quickAccessToolBar.on(\"click\", \".k-button\", function(e) {\n                    e.preventDefault();\n\n                    var action = $(e.currentTarget).attr(\"data-action\");\n                    this.action({ action: action });\n                }.bind(this));\n\n                this.quickAccessAdjust();\n            },\n\n            quickAccessAdjust: function() {\n                this.tabGroup.css(\"padding-left\", kendo._outerWidth(this.quickAccessToolBar));\n            },\n\n            _toolbar: function(container, name, tools) {\n                var element;\n                var options;\n\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children(\".k-toolbar\").remove();\n                }\n\n                if (tools) {\n                    element = container.html(\"<div></div>\").children(\"div\");\n\n                    options = {\n                        tools: typeof tools === \"boolean\" ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n\n        });\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n\n\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: \"Apply\",\n            save: \"Save\",\n            cancel: \"Cancel\",\n            remove: \"Remove\",\n            retry: \"Retry\",\n            revert: \"Revert\",\n            okText: \"OK\",\n            formatCellsDialog: {\n                title: \"Format\",\n                categories: {\n                    number: \"Number\",\n                    currency: \"Currency\",\n                    date: \"Date\"\n                }\n            },\n            fontFamilyDialog: {\n                title: \"Font\"\n            },\n            fontSizeDialog: {\n                title: \"Font size\"\n            },\n            bordersDialog: {\n                title: \"Borders\"\n            },\n            alignmentDialog: {\n                title: \"Alignment\",\n                buttons: {\n                    justtifyLeft: \"Align left\",\n                    justifyCenter: \"Center\",\n                    justifyRight: \"Align right\",\n                    justifyFull: \"Justify\",\n                    alignTop: \"Align top\",\n                    alignMiddle: \"Align middle\",\n                    alignBottom: \"Align bottom\"\n                }\n            },\n            mergeDialog: {\n                title: \"Merge cells\",\n                buttons: {\n                    mergeCells: \"Merge all\",\n                    mergeHorizontally: \"Merge horizontally\",\n                    mergeVertically: \"Merge vertically\",\n                    unmerge: \"Unmerge\"\n                }\n            },\n            freezeDialog: {\n                title: \"Freeze panes\",\n                buttons: {\n                    freezePanes: \"Freeze panes\",\n                    freezeRows: \"Freeze rows\",\n                    freezeColumns: \"Freeze columns\",\n                    unfreeze: \"Unfreeze panes\"\n                }\n            },\n            confirmationDialog: {\n                text: \"Are you sure you want to remove this sheet?\",\n                title: \"Sheet remove\"\n            },\n            validationDialog: {\n                title: \"Data Validation\",\n                hintMessage: \"Please enter a valid {0} value {1}.\",\n                hintTitle: \"Validation {0}\",\n                criteria: {\n                    any: \"Any value\",\n                    number: \"Number\",\n                    text: \"Text\",\n                    date: \"Date\",\n                    custom: \"Custom Formula\",\n                    list: \"List\"\n                },\n                comparers: {\n                    greaterThan: \"greater than\",\n                    lessThan: \"less than\",\n                    between: \"between\",\n                    notBetween: \"not between\",\n                    equalTo: \"equal to\",\n                    notEqualTo: \"not equal to\",\n                    greaterThanOrEqualTo: \"greater than or equal to\",\n                    lessThanOrEqualTo: \"less than or equal to\"\n                },\n                comparerMessages: {\n                    greaterThan: \"greater than {0}\",\n                    lessThan: \"less than {0}\",\n                    between: \"between {0} and {1}\",\n                    notBetween: \"not between {0} and {1}\",\n                    equalTo: \"equal to {0}\",\n                    notEqualTo: \"not equal to {0}\",\n                    greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                    lessThanOrEqualTo: \"less than or equal to {0}\",\n                    custom: \"that satisfies the formula: {0}\"\n                },\n                labels: {\n                    criteria: \"Criteria\",\n                    comparer: \"Comparer\",\n                    min: \"Min\",\n                    max: \"Max\",\n                    value: \"Value\",\n                    start: \"Start\",\n                    end: \"End\",\n                    onInvalidData: \"On invalid data\",\n                    rejectInput: \"Reject input\",\n                    showWarning: \"Show warning\",\n                    showHint: \"Show hint\",\n                    hintTitle: \"Hint title\",\n                    hintMessage: \"Hint message\",\n                    ignoreBlank: \"Ignore blank\",\n                    showListButton: \"Display button to show list\",\n                    showCalendarButton: \"Display button to show calendar\"\n                },\n                placeholders: {\n                    typeTitle: \"Type title\",\n                    typeMessage: \"Type message\"\n                }\n            },\n            exportAsDialog: {\n                title: \"Export...\",\n                defaultFileName: \"Workbook\",\n                xlsx: {\n                    description: \"Excel Workbook (.xlsx)\"\n                },\n                pdf: {\n                    description: \"Portable Document Format (.pdf)\",\n                    area: {\n                        workbook: \"Entire Workbook\",\n                        sheet: \"Active Sheet\",\n                        selection: \"Selection\"\n                    },\n                    paper: {\n                        a2        : \"A2 (420 mm × 594 mm)\",\n                        a3        : \"A3 (297 mm x 420 mm)\",\n                        a4        : \"A4 (210 mm x 297 mm)\",\n                        a5        : \"A5 (148 mm x 210 mm)\",\n                        b3        : \"B3 (353 mm × 500 mm)\",\n                        b4        : \"B4 (250 mm x 353 mm)\",\n                        b5        : \"B5 (176 mm x 250 mm)\",\n                        folio     : 'Folio (8.5\" x 13\")',\n                        legal     : 'Legal (8.5\" x 14\")',\n                        letter    : 'Letter (8.5\" x 11\")',\n                        tabloid   : 'Tabloid (11\" x 17\")',\n                        executive : 'Executive (7.25\" x 10.5\")'\n                    },\n                    margin: {\n                        normal: \"Normal\",\n                        narrow: \"Narrow\",\n                        wide: \"Wide\"\n                    }\n                },\n                labels: {\n                    scale: \"Scale\",\n                    fit: \"Fit to page\",\n                    fileName: \"File name\",\n                    saveAsType: \"Save as type\",\n                    exportArea: \"Export\",\n                    paperSize: \"Paper size\",\n                    margins: \"Margins\",\n                    orientation: \"Orientation\",\n                    print: \"Print\",\n                    guidelines: \"Guidelines\",\n                    center: \"Center\",\n                    horizontally: \"Horizontally\",\n                    vertically: \"Vertically\"\n                }\n            },\n            modifyMergedDialog: {\n                errorMessage: \"Cannot change part of a merged cell.\"\n            },\n            rangeDisabledDialog: {\n                errorMessage: \"Destination range contains disabled cells.\"\n            },\n            intersectsArrayDialog: {\n                errorMessage: \"You cannot alter part of an array\"\n            },\n            incompatibleRangesDialog: {\n                errorMessage: \"Incompatible ranges\"\n            },\n            noFillDirectionDialog: {\n                errorMessage: \"Cannot determine fill direction\"\n            },\n            duplicateSheetNameDialog: {\n                errorMessage: \"Duplicate sheet name\"\n            },\n            overflowDialog: {\n                errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n            },\n            useKeyboardDialog: {\n                title: \"Copying and pasting\",\n                errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n                labels: {\n                    forCopy: \"for copy\",\n                    forCut: \"for cut\",\n                    forPaste: \"for paste\"\n                }\n            },\n            unsupportedSelectionDialog: {\n                errorMessage: \"That action cannot be performed on multiple selection.\"\n            },\n            linkDialog: {\n                title: \"Hyperlink\",\n                labels: {\n                    text: \"Text\",\n                    url: \"Address\",\n                    removeLink: \"Remove link\"\n                }\n            },\n            insertCommentDialog: {\n                title: \"Insert comment\",\n                labels: {\n                    comment: \"Comment\",\n                    removeComment: \"Remove comment\"\n                }\n            },\n            insertImageDialog: {\n                title: \"Insert image\",\n                info: \"Drag an image here, or click to select\",\n                typeError: \"Please select a JPEG, PNG or GIF image\"\n            }\n        };\n\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function(name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function(name) {\n                return !!registry[name];\n            },\n            create: function(name, options) {\n                var dialogClass = registry[name];\n\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function(options) {\n                kendo.Observable.fn.init.call(this, options);\n\n                this.options = translate($.extend(true, {}, this.options, options));\n\n                this.bind(this.events, options);\n            },\n            events: [\n                \"close\",\n                \"activate\"\n            ],\n            options: {\n                autoFocus: true\n            },\n            dialog: function() {\n                if (!this._dialog) {\n                    var options = {\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function() {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    };\n                    this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                        .addClass(this.options.className || \"\")\n                        .append(kendo.template(this.options.template)({\n                            messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                            ns: kendo.ns,\n\n                            // this is for ImportErrorDialog.  ugly that\n                            // we need this line here, but I couldn't\n                            // figure out a better way\n                            errors: this.options.errors\n                        }))\n                        .kendoWindow(options)\n                        .data(\"kendoWindow\");\n                }\n\n                return this._dialog;\n            },\n            _onDialogClose: function() {\n                this.trigger(\"close\", {\n                    action: this._action\n                });\n            },\n            _onDialogActivate: function() {\n                this.trigger(\"activate\");\n            },\n            _onDialogDeactivate: function() {\n                this.trigger(\"deactivate\");\n                this.destroy();\n            },\n            destroy: function() {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function() {\n                this.dialog().open();\n                this.dialog().element.find(\".k-button-solid-primary\").trigger(\"focus\");\n            },\n            apply: function() {\n                this.close();\n            },\n            close: function() {\n                this._action = \"close\";\n\n                this.dialog().close();\n            }\n        });\n\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.useCategory(this.category);\n            },\n            useCategory: function(category) {\n                var type = category && category.type || \"number\";\n                var formatCurrency = type == \"currency\";\n\n                this.category = category;\n\n                this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n                if (!formatCurrency) {\n                    this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n\n                this.useFirstFormat();\n            },\n            useFirstFormat: function() {\n                if (this.formats.length) {\n                    this.set(\"format\", this.formats[0].value);\n                }\n            },\n            currency: function(currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n\n                    var info = currency.value;\n                    var formats = [\n                        { currency: info, decimals: true },\n                        { currency: info, decimals: true, iso: true },\n                        { currency: info, decimals: false }\n                    ];\n\n                    formats = formats.map(function(format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n\n                        return { value: format, name: formattedValue(1000, format) };\n                    });\n\n                    this.set(\"formats\", formats);\n\n                    this.useFirstFormat();\n                }\n\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function(category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n\n                return this.category;\n            },\n            preview: function() {\n                var format = this.get(\"format\");\n                var value = this.value || 0;\n\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n\n        FormatCellsViewModel.convert = {\n            currency: function(options) {\n                function repeat(token, n) {\n                    return new Array(n+1).join(token);\n                }\n\n                // convert culture info to spreadsheet format\n                var info = options.currency;\n                var format = info.pattern[1];\n\n                if (options.decimals) {\n                    format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n                }\n\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n                } else {\n                    format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n                }\n\n                format = format.replace(/n/g, \"?\");\n\n                return format;\n            },\n            date: function(format) {\n                if ((/T|Z/).test(format)) {\n                    return \"\";\n                }\n\n                return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n            }\n        };\n\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n\n            return result;\n        }\n\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        { type: \"number\", name: messages.categories.number },\n                        { type: \"currency\", name: messages.categories.currency },\n                        { type: \"date\", name: messages.categories.date }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._generateFormats();\n            },\n            options: {\n                className: \"k-spreadsheet-format-cells\",\n                template:\n                    \"<div class='k-edit-form-container'>\" +\n\n                        \"<div class='k-root-tabs' data-#:ns#role='tabstrip' \" +\n                            \"data-#:ns#text-field='name' \" +\n                            \"data-#:ns#bind='source: categories, value: categoryFilter' \" +\n                            \"data-#:ns#animation='false'></div>\" +\n\n                        \"<div class='k-spreadsheet-preview' data-#:ns#bind='text: preview'></div>\" +\n\n                        \"<script type='text/x-kendo-template' id='format-item-template'>\" +\n                            \"\\\\#: data.name \\\\#\" +\n                        \"</script>\" +\n\n                        \"<select data-#:ns#role='dropdownlist' class='k-format-filter' \" +\n                            \"data-#:ns#text-field='description' \" +\n                            \"data-#:ns#value-field='value.name' \" +\n                            \"data-#:ns#bind='visible: showCurrencyFilter, value: currency, source: currencies'></select>\" +\n\n                        \"<ul data-#:ns#role='staticlist' tabindex='0' \" +\n                            \"id='formats-list' \" +\n                            \"aria-label='formats list' \" +\n                            \"class='k-list k-reset' \" +\n                            \"data-#:ns#template='format-item-template' \" +\n                            \"data-#:ns#value-primitive='true' \" +\n                            \"data-#:ns#value-field='value' \" +\n                            \"data-#:ns#bind='source: formats, value: format'></ul>\" +\n\n                        \"<div class='k-action-buttons'>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                            \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                        \"</div>\"+\n\n                    \"</div>\"\n            },\n            _generateFormats: function() {\n                var options = this.options;\n\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        { value: \"#.00%\", name: \"100.00%\" },\n                        { value: \"#%\", name: \"100%\" },\n                        { value: \"#.00\", name: \"1024.00\" },\n                        { value: \"#,###.00\", name: \"1,024.00\" }\n                    ];\n                }\n\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                    options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                        format = FormatCellsViewModel.convert.date(format);\n\n                        if (!format) {\n                            return;\n                        }\n\n                        return { value: format, name: formattedValue(34567.7678, format) };\n                    }));\n                }\n            },\n            open: function(range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                kendo.bind(element, this.viewModel);\n\n                var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: \"contains\" });\n                }\n\n                element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n                element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n            },\n            apply: function() {\n                var format = this.viewModel.format;\n\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"format\",\n                        value: format\n                    }\n                });\n            }\n        });\n\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n                if (!(/-/).test(name)) {\n                    return;\n                }\n\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format(\n                    \"{0} ({1}, {2})\",\n                    currency.name,\n                    currency.abbr,\n                    currency.symbol\n                );\n\n                return { description: description, value: currency };\n            }));\n        };\n\n        kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template:\n                    \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                    \"<div class='k-action-buttons'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: \"k-spreadsheet-message\",\n                messageId: \"\",\n                template:\n                    \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                    \"<div class='k-action-buttons'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: confirm'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                            \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function() {\n                return this._confirmed;\n            },\n            confirm: function() {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-message\",\n                title: \"\",\n                messageId: \"\",\n                text: \"\",\n                template:\n                \"<div class='k-spreadsheet-message-content' data-#:ns#bind='text: text'></div>\" +\n                \"<div class='k-action-buttons'>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: retry'>\" +\n                        \"<span class='k-button-text'>#= messages.retry #</span>\" +\n                    \"</button>\" +\n                    \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'>\" +\n                        \"<span class='k-button-text'>#= messages.cancel #</span>\" +\n                    \"</button>\" +\n                \"</div>\"\n            },\n            open: function() {\n                SpreadsheetDialog.fn.open.call(this);\n\n                var options = this.options;\n                var text = options.text;\n\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function() {\n                this._retry = true;\n                this.close();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: \"#: data #\",\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontFamily\",\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: \"#: data #\",\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: \"fontSize\",\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n                this.element = this.dialog().element;\n                this._borderPalette();\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-action-buttons\"), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template:   \"<div></div>\" +\n                            \"<div class='k-action-buttons'>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                            \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                var state = this.value();\n\n                this.trigger(\"action\", {\n                    command: \"BorderChangeCommand\",\n                    options: {\n                        border: state.type,\n                        style: { size: 1, color: state.color }\n                    }\n                });\n            },\n            _borderPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                    change: this.value.bind(this)\n                });\n            },\n            value: function(state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                kendo.bind(this.element.find(\".k-action-buttons\"), this.viewModel);\n            },\n            options: {\n                template:   \"<div></div>\" +\n                            \"<div class='k-action-buttons'>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.apply #</span></button>\" +\n                                \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                            \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function(e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [ //metro palette\n                        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                    ],\n                    change: this.value.bind(this)\n                }).data(\"kendoColorPalette\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n        var CustomColorDialog = ColorChooser.extend({\n            init: function(options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one(\"activate\", this._colorPicker.bind(this));\n            },\n            _colorPicker: function() {\n                var element = this.dialog().element.find(\"div\").first();\n                this.colorPicker = element.kendoFlatColorPicker({\n                    change: this.value.bind(this)\n                }).data(\"kendoFlatColorPicker\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justtifyLeft },\n                        { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                        { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                        { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                        { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                        { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                        { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-property='#=property#' data-value='#=value#'>\" +\n                                    \"<span class='k-icon k-i-#=iconClass#'></span>\" +\n                                    \"#=text#\" +\n                               \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"PropertyChangeCommand\",\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                        { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                        { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                        { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                                \"<span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#\" +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"MergeCellCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                        { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                        { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                        { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                    ]\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n                this._list();\n            },\n            options: {\n                template: \"<ul class='k-list k-reset'></ul>\"\n            },\n            _list: function() {\n                var ul = this.dialog().element.find(\"ul\");\n\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: \"<a role='button' title='#=text#' data-value='#=value#'>\" +\n                                \"<span class='k-icon k-icon k-i-#=iconClass#'></span>#=text#\" +\n                              \"</a>\",\n                    change: this.apply.bind(this)\n                });\n\n                this.list.dataSource.fetch();\n            },\n            apply: function(e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"FreezePanesCommand\",\n                    options: {\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function(options) {\n                ObservableObject.fn.init.call(this, options);\n\n                this.bind(\"change\", (function(e) {\n\n                    if (e.field === \"criterion\") {\n                        this.reset();\n\n                        if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n\n                    if (e.field === \"comparer\") {\n                        this.setHintMessageTemplate();\n                    }\n\n                    if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n\n                    if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }).bind(this));\n\n                this.reset();\n            },\n            buildMessages: function() {\n                this._mute = true;\n                this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n                this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n                this._mute = false;\n            },\n            reset: function() {\n                this.setComparers();\n                this.set(\"comparer\", this.comparers[0].type);\n                this.set(\"from\", null);\n                this.set(\"to\", null);\n\n                this.set(\"useCustomMessages\", false);\n\n                this.shouldBuild = true;\n\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            //TODO: refactor\n            setComparers: function() {\n                var all = this.defaultComparers;\n                var comparers = [];\n\n                if (this.criterion === \"text\") {\n                    var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n\n                this.set(\"comparers\", comparers);\n            },\n            setHintMessageTemplate: function() {\n               if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n                   this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n               } else {\n                   this.set(\"hintMessageTemplate\", \"\");\n                   this.set(\"hintMessage\", \"\");\n               }\n            },\n            isAny: function() {\n                return this.get(\"criterion\") === \"any\";\n            },\n            isNumber: function() {\n                return this.get(\"criterion\") === \"number\";\n            },\n            showToForNumber: function() {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function() {\n                return this.showTo() && this.isDate();\n            },\n            isText: function() {\n                return this.get(\"criterion\") === \"text\";\n            },\n            isDate: function() {\n                return this.get(\"criterion\") === \"date\";\n            },\n            isList: function() {\n                return this.get(\"criterion\") === \"list\";\n            },\n            isCustom: function() {\n                return this.get(\"criterion\") === \"custom\";\n            },\n            showRemove: function() {\n                return this.get(\"hasValidation\");\n            },\n            showTo: function() {\n                return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n            },\n            update: function(validation) {\n                this.set(\"hasValidation\", !!validation);\n\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function(validation) {\n                this.set(\"criterion\", validation.dataType);\n                this.set(\"comparer\", validation.comparerType);\n                this.set(\"from\", validation.from);\n                this.set(\"to\", validation.to);\n                this.set(\"type\", validation.type);\n                this.set(\"ignoreBlank\", validation.allowNulls);\n                this.set(\"showButton\", validation.showButton);\n\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function() {\n                if (this.criterion === \"any\") {\n                    return null;\n                }\n\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n\n                return options;\n            }\n        });\n\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        { type: \"any\", name: messages.criteria.any },\n                        { type: \"number\", name: messages.criteria.number },\n                        { type: \"text\", name: messages.criteria.text },\n                        { type: \"date\", name: messages.criteria.date },\n                        { type: \"custom\", name: messages.criteria.custom },\n                        { type: \"list\", name: messages.criteria.list }\n                    ],\n                    comparers: [\n                        { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                        { type: \"lessThan\",    name: messages.comparers.lessThan },\n                        { type: \"between\",     name: messages.comparers.between },\n                        { type: \"notBetween\",  name: messages.comparers.notBetween },\n                        { type: \"equalTo\",     name: messages.comparers.equalTo },\n                        { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                        { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                        { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: \"any\",\n                type: \"reject\",\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate:\n                    '<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">' +\n                        '<span class=\"k-tooltip-icon k-icon k-i-warning\"></span>' +\n                        '<span class=\"k-tooltip-content\">#= message #</span>' +\n                        '<span class=\"k-callout k-callout-n\"></span>' +\n                    '</div>',\n                template:\n                    '<div class=\"k-edit-form-container\">' +\n                        '<div class=\"k-edit-label\"><label for=\"criteria\">#: messages.validationDialog.labels.criteria #:</label></div>' +\n                        '<div class=\"k-edit-field\">' +\n                            '<select id=\"criteria\" data-#:ns#role=\"dropdownlist\" ' +\n                                'title=\"#: messages.validationDialog.labels.criteria #\"' +\n                                'data-#:ns#text-field=\"name\" ' +\n                                'data-#:ns#value-field=\"type\" ' +\n                                'data-#:ns#bind=\"value: criterion, source: criteria\"></select>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isNumber\">' +\n                            '<div class=\"k-edit-label\"><label for=\"number-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"number-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"comparer-min\">#: messages.validationDialog.labels.min #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-min\" name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isNumber\" required=\"required\" /></span>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: showTo\">' +\n                                '<div class=\"k-edit-label\"><label for=\"comparer-max\">#: messages.validationDialog.labels.max #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"comparer-max\" name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isText\">' +\n                            '<div class=\"k-edit-label\"><label for=\"text-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"text-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"text-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"text-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isText\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isDate\">' +\n                            '<div class=\"k-edit-label\"><label for=\"date-comparer\">#: messages.validationDialog.labels.comparer #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<select id=\"date-comparer\" data-#:ns#role=\"dropdownlist\" ' +\n                                    'title=\"#: messages.validationDialog.labels.comparer #\"' +\n                                    'data-#:ns#text-field=\"name\" ' +\n                                    'data-#:ns#value-field=\"type\" ' +\n                                    'data-#:ns#bind=\"value: comparer, source: comparers\"></select>' +\n                            '</div>' +\n                            '<div class=\"k-edit-label\"><label for=\"date-comparer-start\">#: messages.validationDialog.labels.start #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-start\" name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isDate\" required=\"required\" /></span>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: showTo\">' +\n                                '<div class=\"k-edit-label\"><label for=\"date-comparer-end\">#: messages.validationDialog.labels.end #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"date-comparer-end\" name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-input-inner\" data-#:ns#bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isCustom\">' +\n                            '<div class=\"k-edit-label\"><label for=\"custom-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"custom-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isCustom\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isList\">' +\n                            '<div class=\"k-edit-label\"><label for=\"list-comparer-value\">#: messages.validationDialog.labels.value #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"list-comparer-value\" name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-input-inner\" data-#:ns#bind=\"value: from, enabled: isList\" required=\"required\" /></span>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"visible: isList\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                                '<label for=\"listShowButton\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.showListButton #' +\n                                '</label>' +\n                            '</div>' +\n                        \"</div>\" +\n\n                        '<div data-#:ns#bind=\"visible: isDate\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: showButton\"/>' +\n                                '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.showCalendarButton #' +\n                                '</label>' +\n                            '</div>' +\n                        \"</div>\" +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: ignoreBlank\"/>' +\n                                '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' +\n                                    ' #: messages.validationDialog.labels.ignoreBlank #' +\n                                '</label>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\">' +\n                            '<div class=\"k-hr\"></div>' +\n                            '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                                '<label for=\"validationTypeReject\" class=\"k-radio-label\">' +\n                                     \"#: messages.validationDialog.labels.rejectInput #\" +\n                                '</label> ' +\n                                '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-#:ns#bind=\"checked: type\" class=\"k-radio k-radio-md\" />' +\n                                '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' +\n                                     \"#: messages.validationDialog.labels.showWarning #\" +\n                                '</label>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div data-#:ns#bind=\"invisible: isAny\" class=\"hint-wrapper\">' +\n                            '<div class=\"k-edit-field\">' +\n                                '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox k-checkbox-md k-rounded-md\" data-#:ns#bind=\"checked: useCustomMessages\" />' +\n                                '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">'+\n                                    ' #: messages.validationDialog.labels.showHint #' +\n                                '</label>' +\n                            '</div>' +\n                            '<div data-#:ns#bind=\"visible: useCustomMessages\">' +\n                                '<div class=\"k-edit-label\"><label for=\"hint-title\">#: messages.validationDialog.labels.hintTitle #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-#:ns#bind=\"value: hintTitle\" /></span>' +\n                                '</div>' +\n                                '<div class=\"k-edit-label\"><label for=\"hint-message\">#: messages.validationDialog.labels.hintMessage #:</label></div>' +\n                                '<div class=\"k-edit-field\">' +\n                                    '<span class=\"k-textbox k-input k-input-md k-rounded-md k-input-solid\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-#:ns#bind=\"value: hintMessage\" /></span>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n\n                        '<div class=\"k-action-buttons\">' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">#: messages.remove #</span></button>' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary\" data-#:ns#bind=\"click: apply\"><span class=\"k-button-text\">#: messages.apply #</span></button>' +\n                            '<button class=\"k-button k-button-md k-rounded-md k-button-solid k-button-solid-base\" data-#:ns#bind=\"click: close\"><span class=\"k-button-text\">#: messages.cancel #</span></button>' +\n                        \"</div>\" +\n                    \"</div>\"\n            },\n            open: function(range) {\n                var options = this.options;\n                var element;\n\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n\n                this.viewModel.update(range.validation());\n\n                SpreadsheetDialog.fn.open.call(this);\n\n                element = this.dialog().element;\n\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n\n                kendo.bind(element, this.viewModel);\n\n                this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function() {\n\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n\n                    this.trigger(\"action\", {\n                        command: \"EditValidationCommand\",\n                        options: {\n                            value: this.viewModel.toValidationObject()\n                        }\n                    });\n                }\n            },\n            remove: function() {\n                this.viewModel.set(\"criterion\", \"any\");\n                this.apply();\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n        function PDF_PAPER_SIZE(size) {\n            return {\n                value: size,\n                text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n            };\n        }\n\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function(options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                options = this.options;\n\n                this.viewModel = kendo.observable({\n                    title: options.title,\n                    name: options.name,\n                    extension: options.extension,\n                    fileFormats:options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        autoPrint: options.pdfExport.autoPrint,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n\n                        fitWidth: options.pdf.fitWidth,\n                        area: options.pdf.area,\n                        areas: options.pdf.areas,\n                        paperSize: options.pdf.paperSize,\n                        paperSizes: options.pdf.paperSizes,\n                        margin: options.pdf.margin,\n                        margins: options.pdf.margins,\n                        landscape: options.pdf.landscape,\n                        guidelines: options.pdf.guidelines,\n                        hCenter: options.pdf.hCenter,\n                        vCenter: options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n\n                var dialog = this.dialog();\n                this.viewModel.bind(\"change\", function(e) {\n                    if (e.field === \"extension\") {\n                        this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                        dialog.center();\n                    }\n                });\n\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n                name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n                extension: \".xlsx\",\n                fileFormats: [{\n                    description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                    extension: \".xlsx\"\n                }, {\n                    description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                    extension: \".pdf\"\n                }],\n                pdf: {\n                    fitWidth: true,\n                    area: \"workbook\",\n                    areas: [{\n                        area: \"workbook\",\n                        text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                    },{\n                        area: \"sheet\",\n                        text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                    },{\n                        area: \"selection\",\n                        text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                    }],\n                    paperSize: \"a4\",\n                    paperSizes: [\n                        \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                    ].map(PDF_PAPER_SIZE),\n                    margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                    margins: [\n                        { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                        },\n                        { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                        },\n                        { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                          text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template:\n                    \"<div class='k-edit-label'><label id='name-label'>#: messages.exportAsDialog.labels.fileName #:</label></div>\" +\n                    \"<div class='k-edit-field'>\" +\n                        \"<span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input aria-labelledby='name-label' class='k-input-inner' data-#:ns#bind='value: name' /></span>\" +\n                    \"</div>\" +\n                    \"<div >\" +\n                        \"<div class='k-edit-label'><label id='file-format-label'>#: messages.exportAsDialog.labels.saveAsType #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                        \"<select aria-labelledby='file-format-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                            \"data-#:ns#text-field='description' \" +\n                            \"data-#:ns#value-field='extension' \" +\n                            \"data-#:ns#bind='value: extension, source: fileFormats'></select>\" +\n                        \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-export-config' data-#:ns#bind='visible: showPdfOptions'>\" +\n                        \"<hr class='k-hr' />\" +\n                        \"<div class='k-edit-label'><label id='export-area-label'>#: messages.exportAsDialog.labels.exportArea #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='export-area-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='area' \" +\n                                \"data-#:ns#bind='value: pdf.area, source: pdf.areas'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label id='paper-size-label'>#: messages.exportAsDialog.labels.paperSize#:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='paper-size-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='value' \" +\n                                \"data-#:ns#bind='value: pdf.paperSize, source: pdf.paperSizes'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label id='margins-label'>#: messages.exportAsDialog.labels.margins #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<select aria-labelledby='margins-label' data-#:ns#role='dropdownlist' class='k-file-format' \" +\n                                \"data-#:ns#value-primitive='true'\" +\n                                \"data-#:ns#text-field='text' \" +\n                                \"data-#:ns#value-field='value' \" +\n                                \"data-#:ns#bind='value: pdf.margin, source: pdf.margins'></select>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<div class='k-button-group'>\" +\n                                \"<input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='false' />\" +\n                                \"<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'><span class='k-button-icon k-icon k-i-page-portrait'></span></label>\" +\n                                \"<input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-#:ns#type='boolean' data-#:ns#bind='checked: pdf.landscape' value='true' />\" +\n                                \"<label class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'><span class='k-button-icon k-icon k-i-page-landscape'></span></label>\" +\n                            \"</div>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.print #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='guidelines' type='checkbox' data-#:ns#bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>#: messages.exportAsDialog.labels.guidelines#</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.scale #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='fitWidth' type='checkbox' data-#:ns#bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>#: messages.exportAsDialog.labels.fit #</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-edit-label'><label>#: messages.exportAsDialog.labels.center #:</label></div>\" +\n                        \"<div class='k-edit-field'>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='hCenter' type='checkbox' data-#:ns#bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>#: messages.exportAsDialog.labels.horizontally #</label>\" +\n                            \"<input class='k-checkbox k-checkbox-md k-rounded-md' id='vCenter' type='checkbox' data-#:ns#bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>#: messages.exportAsDialog.labels.vertically #</label>\" +\n                        \"</div>\" +\n                        \"<div class='k-page-orientation'>\" +\n                            \"<span class='k-icon k-i-page-portrait' data-#:ns#bind='invisible: pdf.landscape'></span>\" +\n                            \"<span class='k-icon k-i-page-landscape' data-#:ns#bind='visible: pdf.landscape'></span>\" +\n                        \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-action-buttons'>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.save #</span></button>\" +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: close'><span class='k-button-text'>#: messages.cancel #</span></button>\" +\n                    \"</div>\"\n            },\n            apply: function() {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"SaveAsCommand\",\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(\n                id,\n                MessageDialog.extend({\n                    options: { messageId: msg }\n                })\n            );\n        }\n\n        basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n        basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n        basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n        basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n        basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n        basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n        basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n        basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: \"Errors in import\",\n                template:\n                    \"<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'>\" +\n                      \"<div class='k--header-message'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>\" +\n                      \"<div class='k--errors'>\" +\n                        \"<table>\" +\n                          \"<thead>\" +\n                            \"<tr><th>Context</th><th>Error message</th></tr>\" +\n                          \"</thead>\" +\n                          \"# for (var i = 0; i < errors.length; ++i) { #\" +\n                            \"# var err = errors[i]; #\" +\n                            \"<tr><td>#: err.context #</td><td>#: err.error #</td></tr>\" +\n                          \"# } #\" +\n                        \"</table>\" +\n                      \"</div>\" +\n                    \"</div>\" +\n                    \"<div class='k-action-buttons'>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                        \"<span class='k-button-text'>#: messages.okText #</span>\" +\n                      \"</button>\" +\n                    \"</div>\"\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n        var UseKeyboardDialog = MessageDialog.extend({\n            options: {\n                title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n                template:\n                    \"#: messages.useKeyboardDialog.errorMessage #\" +\n                    \"<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>\" +\n                    \"<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>\" +\n                    \"<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>\" +\n                    '<div class=\"k-action-buttons\">' +\n                        \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: close'>\" +\n                            \"<span class='k-button-text'>#= messages.okText #</span>\" +\n                        \"</button>\" +\n                    \"</div>\"\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n                template:\n                (\"<div class='k-edit-label'><label id='url-label'>#: messages.linkDialog.labels.url #:</label></div>\" +\n                 \"<div class='k-edit-field'><span class='k-textbox k-input k-input-md k-rounded-md k-input-solid'><input class='k-input-inner' data-#:ns#bind='value: url' title='#: messages.linkDialog.labels.url #' aria-labelledby='url-label'/></span></div>\" +\n                 \"<div class='k-action-buttons'>\" + (\n                     (\"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#= messages.linkDialog.labels.removeLink #</span></button>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#= messages.okText #</span></button>\" +\n                      \"<button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\")\n                 ) + \"</div>\"\n                ),\n                autoFocus: false\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function() {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"HyperlinkCommand\",\n                            options: {\n                                link: model.url\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                // it would be nice if we could easily handle that in one\n                // place for all dialogs, but it doesn't seem easily\n                // doable.\n                element.find(\"input\")\n                    .trigger(\"focus\")\n                    .on(\"keydown\", function(ev){\n                        if (ev.keyCode == 13 /*ENTER*/) {\n                            model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.apply();\n                        } else if (ev.keyCode == 27 /*ESC*/) {\n                            ev.stopPropagation();\n                            ev.preventDefault();\n                            model.cancel();\n                        }\n                    });\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n        var InsertCommentDialog = SpreadsheetDialog.extend({\n            options: {\n                className: \"k-spreadsheet-insert-comment\",\n                template: \"\\\n<div class='k-edit-label'><label id='comment-label'>#: messages.insertCommentDialog.labels.comment #:</label></div>\\\n<div class='k-edit-field'><span class='k-input k-textarea k-input-solid k-input-md k-rounded-md'><textarea aria-labelledby='comment-label' rows='5' class='k-input-inner' data-#:ns#bind='value: comment'></textarea></span></div>\\\n<div class='k-action-buttons'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-left' data-#:ns#bind='click: remove'><span class='k-button-text'>#: messages.insertCommentDialog.labels.removeComment #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\\\n\",\n                title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n                autoFocus: false,\n                width: 450\n            },\n            open: function(range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    comment: range.comment(),\n                    apply: function() {\n                        if (!/\\S/.test(model.comment)) {\n                            model.comment = null;\n                        }\n                        self.trigger(\"action\", {\n                            command: \"InsertCommentCommand\",\n                            options: {\n                                value: model.comment\n                            }\n                        });\n                        self.close();\n                    },\n                    remove: function() {\n                        model.comment = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n\n                element.find(\"textarea\").trigger(\"focus\");\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n        var InsertImageDialog = SpreadsheetDialog.extend({\n            options: {\n                template: \"\\\n<div class='k-spreadsheet-insert-image-dialog'>\\\n  <label data-#:ns#bind='style: { background-image: imageUrl },\\\n                    css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered },\\\n                    events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\\\n    <div data-#:ns#bind='text: info'></div>\\\n    <input type='file' data-#:ns#bind='events: { change: change }'\\\n           accept='image/png, image/jpeg, image/gif' />\\\n  </label>\\\n</div>\\\n<div class='k-action-buttons'>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary' data-#:ns#bind='enabled: okEnabled, click: apply'><span class='k-button-text'>#: messages.okText #</span></button>\\\n  <button class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base' data-#:ns#bind='click: cancel'><span class='k-button-text'>#= messages.cancel #</span></button>\\\n</div>\",\n                title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n                width: \"auto\"\n            },\n            open: function() {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    okEnabled: false,\n                    info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                    imageUrl: \"\",\n                    hasImage: false,\n                    isHovered: false,\n                    _url: null,\n                    _image: null,\n                    apply: function() {\n                        window.URL.revokeObjectURL(model._url);\n                        self.trigger(\"action\", {\n                            command: \"InsertImageCommand\",\n                            options: {\n                                blob   : model._image,\n                                width  : model._width,\n                                height : model._height\n                            }\n                        });\n                        self.close();\n                    },\n                    cancel: self.close.bind(self),\n                    stopEvent: function(ev) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                    },\n                    drop: function(ev) {\n                        model.stopEvent(ev);\n                        model.selectFile(ev.originalEvent.dataTransfer.files);\n                        model.set(\"isHovered\", false);\n                    },\n                    dragEnter: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", true);\n                    },\n                    dragLeave: function(ev) {\n                        model.stopEvent(ev);\n                        model.set(\"isHovered\", false);\n                    },\n                    change: function(ev) {\n                        model.selectFile(ev.target.files);\n                    },\n                    selectFile: function(files) {\n                        var image;\n                        for (var i = 0; i < files.length; ++i) {\n                            if (/^image\\//i.test(files[i].type)) {\n                                image = files[i];\n                                break;\n                            }\n                        }\n                        if (model._url) {\n                            window.URL.revokeObjectURL(model._url);\n                        }\n                        if (image) {\n                            model._image = image;\n                            model._url = window.URL.createObjectURL(image);\n                            var img = new Image();\n                            img.src = model._url;\n                            img.onload = function() {\n                                model._width = img.width;\n                                model._height = img.height;\n                                model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                                model.set(\"okEnabled\", true);\n                                model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                                model.set(\"hasImage\", true);\n                            };\n                        } else {\n                            model._image = null;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                            model.set(\"okEnabled\", false);\n                            model.set(\"imageUrl\", \"\");\n                            model.set(\"hasImage\", false);\n                        }\n                    }\n                });\n                kendo.bind(element, model);\n            }\n        });\n\n        kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n        function Localizable(path, def) {\n            this.path = path.split(\".\");\n            this.def = def;\n        }\n\n        Localizable.prototype.trans = function() {\n            var msg = kendo.spreadsheet.messages.dialogs;\n            for (var i = 0; i < this.path.length; ++i) {\n                msg = msg[this.path[i]];\n                if (!msg) {\n                    return this.def;\n                }\n            }\n            return msg;\n        };\n\n        function TEXT(path, def) {\n            return new Localizable(path, def);\n        }\n\n        function translate(thing) {\n            if (thing instanceof Localizable) {\n                return thing.trans();\n            }\n            else if (Array.isArray(thing)) {\n                return thing.map(translate);\n            }\n            else if (thing != null && typeof thing == \"object\") {\n                return Object.keys(thing).reduce(function(ret, key){\n                    ret[key] = translate(thing[key]);\n                    return ret;\n                }, {});\n            }\n            return thing;\n        }\n\n    })(window.kendo);\n\n    (function(kendo) {\n\n\n\n        var identity = function(o) { return o; };\n\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function(options) {\n\n                this.options = kendo.jQuery.extend({}, this.options, options);\n\n                this.columns = this._normalizeColumns(this.options.columns);\n\n                this._sheet();\n                this._dataSource();\n\n                this._header();\n\n                this._boundRowsCount = 0;\n\n                this.dataSource.fetch();\n            },\n\n            _sheet: function() {\n                this.sheet = this.options.sheet;\n\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n\n                this.sheet.bind(\"change\", this._sheetChangeHandler)\n                    .bind(\"afterDeleteRow\", this._sheetDeleteRowHandler)\n                    .bind(\"afterInsertRow\", this._sheetInsertRowHandler);\n            },\n\n            _sheetInsertRow: function(e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n\n            _sheetDeleteRow: function(e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n\n            _header: function() {\n                this.sheet.batch(function() {\n                    this.columns.forEach(function(column, index) {\n                        this.sheet.range(0,index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n\n            _sheetChange: function(e) {\n                if (e.insertRow || e.deleteRow) {\n                    // these actions are handled via custom events\n                    return;\n                }\n\n                if (e.recalc && e.ref && e.isValue) {\n                    var UnionRef = kendo.spreadsheet.UnionRef;\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var values = [];\n                    var sheet = this.sheet;\n                    var fields, getters, normalizedRef, i, rangeRef, normalizedRefs;\n                    var setValues = function(ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1]; // skip header row\n\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                var currentValue = values[i][valueIndex][colValueIndex++];\n                                record.set(columns[ci].field, getters[ci](currentValue));\n                            }\n                            valueIndex++;\n                        }\n                    };\n\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n\n                    getters = columns.map(function(column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == \"date\") {\n                            return numberToDate;\n                        }\n                        return identity;\n                    });\n\n                    this._skipRebind = true;\n                    normalizedRef = sheet._grid.normalize(e.ref);\n\n                    if(!(normalizedRef instanceof UnionRef)) {\n                        normalizedRef = new UnionRef([normalizedRef]);\n                    }\n\n                    normalizedRefs = normalizedRef.refs;\n\n                    normalizedRefs.forEach(function(ref) {\n                        values.push(sheet.range(ref).values());\n                    });\n\n                    for(i = 0; i < normalizedRefs.length; i++) {\n                        rangeRef = normalizedRefs[i];\n                        rangeRef.forEach(setValues);\n                    }\n\n                    this._boundRowsCount = dataSource.view().length;\n\n                    this._skipRebind = false;\n                }\n            },\n\n            _normalizeColumns: function(columns) {\n                return columns.map(function(column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n\n            _dataSource: function() {\n                var options = this.options;\n                var dataSource = options.dataSource;\n\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind(\"change\", this._changeHandler)\n                        .unbind(\"progress\", this._progressHandler)\n                        .unbind(\"error\", this._errorHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                    this._progressHandler = this._requestStart.bind(this);\n                    this._errorHandler = this._error.bind(this);\n                }\n\n                this.dataSource = kendo.data.DataSource.create(dataSource)\n                    .bind(\"change\", this._changeHandler)\n                    .bind(\"progress\", this._progressHandler)\n                    .bind(\"error\", this._errorHandler);\n            },\n\n            _error: function() {\n                this._progress(false);\n            },\n\n            _requestStart: function() {\n                this._progress(true);\n            },\n\n            _progress: function(toggle) {\n                this.sheet.trigger(\"progress\", {\n                    toggle: toggle\n                });\n            },\n\n            _change: function() {\n                if (this._skipRebind) {\n                    return;\n                }\n\n                if (this.sheet.trigger(\"dataBinding\")) {\n                    return;\n                }\n\n                var data = this.dataSource.view();\n                var columns = this.columns;\n\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n\n                var getters = columns.map(function(column) {\n                    return kendo.getter(column.field);\n                });\n\n                this.sheet.batch(function() {\n                    var length = Math.max(data.length, this._boundRowsCount, this.sheet._grid.rowCount - 1);\n\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n\n                            //skip header row\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n\n                this._boundRowsCount = data.length;\n\n                this._progress(false);\n                this.sheet.trigger(\"dataBound\");\n            },\n\n            destroy: function() {\n                this.dataSource.unbind(\"change\", this._changeHandler)\n                    .unbind(\"progress\", this._progressHandler)\n                    .unbind(\"error\", this._errorHandler);\n\n                this.sheet.unbind(\"change\", this._sheetChangeHandler)\n                    .unbind(\"deleteRow\", this._sheetDeleteRowHandler)\n                    .unbind(\"insertRow\", this._sheetInsertRowHandler);\n            },\n\n            options: {\n                columns: []\n            }\n        });\n\n        function numberToDate(val) {\n            return val == null ? null : kendo.spreadsheet.numberToDate(val);\n        }\n\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    })(kendo);\n\n    (function(kendo) {\n\n            var $ = kendo.jQuery;\n            var Widget = kendo.ui.Widget;\n            var classNames = {\n                details: \"k-details\",\n                button: \"k-button\",\n                detailsSummary: \"k-details-summary\",\n                detailsContent: \"k-details-content\",\n                icon: \"k-icon\",\n                iconCollapse: \"k-i-arrow-45-down-right\",\n                iconExpand: \"k-i-arrow-60-right\",\n                iconSearch: \"k-i-zoom\",\n                textbox: \"k-textbox\",\n                wrapper: \"k-spreadsheet-filter-menu\",\n                filterByCondition: \"k-spreadsheet-condition-filter\",\n                filterByValue: \"k-spreadsheet-value-filter\",\n                valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n                actionButtons: \"k-action-buttons\"\n            };\n\n            kendo.spreadsheet.messages.filterMenu = {\n                all: \"All\",\n                sortAscending: \"Sort range A to Z\",\n                sortDescending: \"Sort range Z to A\",\n                filterByValue: \"Filter by value\",\n                filterByCondition: \"Filter by condition\",\n                apply: \"Apply\",\n                search: \"Search\",\n                addToCurrent: \"Add to current selection\",\n                clear: \"Clear\",\n                blanks: \"(Blanks)\",\n                operatorNone: \"None\",\n                and: \"AND\",\n                or: \"OR\",\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            };\n\n            var Details = Widget.extend({\n                init: function(element, options) {\n                    Widget.fn.init.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.details);\n\n                    this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                        .on(\"click\", this._toggle.bind(this));\n\n                    var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                    this._icon = $(\"<span />\", { \"class\": FilterMenu.classNames.icon + \" \" + iconClass })\n                        .prependTo(this._summary);\n\n                    this._container = kendo.wrap(this._summary.next(), true);\n\n                    if (!options.expanded) {\n                        this._container.hide();\n                    }\n                },\n                options: {\n                    name: \"Details\"\n                },\n                events: [ \"toggle\" ],\n                visible: function() {\n                    return this.options.expanded;\n                },\n                toggle: function(show) {\n                    var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                    animation.stop()[show ? \"reverse\" : \"play\"]();\n\n                    this._icon.toggleClass(FilterMenu.classNames.iconExpand, show)\n                              .toggleClass(FilterMenu.classNames.iconCollapse, !show);\n\n                    this.options.expanded = !show;\n                },\n                _toggle: function() {\n                    var show = this.visible();\n                    this.toggle(show);\n                    this.trigger(\"toggle\", { show: show });\n                }\n            });\n\n            kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(element, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                    this._change = this.change.bind(this);\n                    $(this.element).on(\"change\", this._change);\n                },\n                refresh: function() {\n                    var that = this,\n                        value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                    $(that.element).val(value instanceof Date ? \"\" : value);\n                },\n                change: function() {\n                    var value = this.element.value;\n                    this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n                }\n            });\n\n            kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n                init: function(widget, bindings, options) {\n                    kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                    this.widget = widget;\n                    this._change = this.change.bind(this);\n                    this.widget.first(\"change\", this._change);\n                },\n                refresh: function() {\n                    var binding = this.bindings.spreadsheetFilterValue,\n                        value = binding.get(),\n                        type = $(this.widget.element).data(\"filterType\");\n\n                    if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                        this.widget.value(value);\n                    } else {\n                        this.widget.value(null);\n                    }\n                },\n                change: function() {\n                    var value = this.widget.value(),\n                        binding = this.bindings.spreadsheetFilterValue;\n\n                    binding.set(value);\n                }\n            });\n\n            var templates = {\n                filterByValue:\n                    \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByValue #</div>\" +\n                    \"<div class='\" + classNames.detailsContent + \"'>\" +\n                        \"<div class='k-searchbox k-input k-input-md k-rounded-md k-input-solid'>\" +\n                            \"<span class='k-input-icon k-icon k-i-search'></span>\" +\n                            \"<input class='k-input-inner' autocomplete='off' placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' />\" +\n                        \"</div>\" +\n                        \"<div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox k-checkbox-md k-rounded-md' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#'/><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div>\" +\n                        \"<div class='\" + classNames.valuesTreeViewWrapper + \"'>\" +\n                            \"<div data-#=ns#role='treeview' \" +\n                                \"data-#=ns#checkboxes='{ checkChildren: true }' \"+\n                                \"data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' \"+\n                                \"></div>\" +\n                        \"</div>\" +\n                    \"</div>\",\n                filterByCondition:\n                    \"<div class='\" + classNames.detailsSummary + \"'>#= messages.filterByCondition #</div>\" +\n                    \"<div class='\" + classNames.detailsContent + \"'>\" +\n                        '<div>' +\n                            '<select ' +\n                                'aria-label=\"#= messages.filterByCondition #\" ' +\n                                'data-#=ns#role=\"dropdownlist\"' +\n                                'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' +\n                                'data-#=ns#value-primitive=\"false\"' +\n                                'data-#=ns#option-label=\"#=messages.operatorNone#\"' +\n                                'data-#=ns#height=\"auto\"' +\n                                'data-#=ns#text-field=\"text\"' +\n                                'data-#=ns#value-field=\"unique\">'+\n                            '</select>'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isString\">' +\n                            '<input aria-label=\"string-value\" data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isNumber\">' +\n                            '<input aria-label=\"number-value\" data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                        '</div>' +\n\n                        '<div data-#=ns#bind=\"visible: isDate\">' +\n                            '<input aria-label=\"date-value\" data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />'+\n                        '</div>' +\n                    \"</div>\",\n                menuItem:\n                    \"<li data-command='#=command#' data-dir='#=dir#'>\" +\n                        \"<span class='k-icon k-i-#=iconClass#'></span>#=text#\" +\n                    \"</li>\",\n                actionButtons:\n                    \"<button data-#=ns#bind='click: apply' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-primary'><span class='k-button-text'>#=messages.apply#</span></button>\" +\n                    \"<button data-#=ns#bind='click: clear' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>#=messages.clear#</span></button>\"\n            };\n\n            function distinctValues(values) {\n                var hash = {};\n                var result = [];\n\n                for (var i = 0; i < values.length; i++) {\n                    if (!hash[values[i].value]) {\n                        hash[values[i].value] = values[i];\n                        result.push(values[i]);\n                    } else if (!hash[values[i].value].checked && values[i].checked) {\n                        hash[values[i].value].checked = true;\n                    }\n                }\n\n                return result;\n            }\n\n            function filter(dataSource, query) {\n                var hasVisibleChildren = false;\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n                var valuesFilter = this;\n                var values = this.values;\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                    var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                    var filterSpread = filter.bind(valuesFilter);\n                    var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                    hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                    item.hidden = !itemVisible && !anyVisibleChildren;\n\n                    if (query.length || (values && !values.length)) {\n                        item.checked = !item.hidden;\n                    } else if (values && values.indexOf(item.text) != -1){\n                        item.checked = true;\n                    }\n                }\n\n                if (data) {\n                    // re-apply filter on children\n                    dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n                }\n\n                return hasVisibleChildren;\n            }\n\n            function uncheckAll(dataSource) {\n                var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n                for (var i = 0; i < data.length; i++) {\n                    var item = data[i];\n                    item.checked = false;\n\n                    if (item.hasChildren) {\n                        uncheckAll(item.children);\n                    }\n                }\n            }\n\n            var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n                valuesChange: function(e) {\n                    var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                    var checked = function(item) {\n                        return item.checked;\n                    };\n                    var value = function(item) {\n                        return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                    };\n                    var unique = function(value, index, array) {\n                        return array.lastIndexOf(value) === index;\n                    };\n                    var data = dataSource.data();\n                    var values = data.toJSON()[0].items;\n                    var blanks = values.filter(function(item) {\n                        return item.dataType === \"blank\";\n                    });\n\n                    blanks = blanks.length ? blanks[0].checked : false;\n                    values = values.filter(checked).map(value);\n\n                    if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                        values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                    }\n\n                    this.set(\"valueFilter\", {\n                        values: values,\n                        blanks: blanks\n                    });\n                },\n                valueSelect: function(e) {\n                    e.preventDefault();\n\n                    var node = e.sender.dataItem(e.node);\n                    node.set(\"checked\", !node.checked);\n                },\n                hasActiveSearch: false,\n                appendToSearch: false,\n                filterValues: function(e) {\n                    var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                    var dataSource = this.valuesDataSource;\n\n                    this.set(\"hasActiveSearch\", !!query);\n\n                    var filterSpread = filter.bind(this.valueFilter);\n                    uncheckAll(dataSource);\n                    filterSpread(dataSource, query);\n                },\n                reset: function() {\n                    this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                    this.set(\"valueFilter\", { values: [] });\n                },\n                operatorChange: function(e) {\n                    var dataItem = e.sender.dataItem();\n                    this.set(\"operatorType\", dataItem.type);\n\n                    // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                    // filter to “filter by condition”, the customFilter property is lost.\n                    if (!this.get(\"customFilter\")) {\n                        this.reset();\n                    }\n\n                    this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n                },\n                isNone: function() {\n                    return this.get(\"operatorType\") === undefined;\n                },\n                isString: function() {\n                    return this.get(\"operatorType\") === \"string\";\n                },\n                isNumber: function() {\n                    return this.get(\"operatorType\") === \"number\";\n                },\n                isDate: function() {\n                    return this.get(\"operatorType\") === \"date\";\n                }\n            });\n\n            function flattenOperators(operators) {\n                var messages = kendo.spreadsheet.messages.filterMenu.operators;\n                var result = [];\n                for (var type in operators) {\n                    if (!operators.hasOwnProperty(type)) {\n                        continue;\n                    }\n\n                    for (var operator in operators[type]) {\n                        if (!operators[type].hasOwnProperty(operator)) {\n                            continue;\n                        }\n\n                        result.push({\n                            text: messages[type][operator],\n                            value: operator,\n                            unique: type + \"_\" + operator,\n                            type: type\n                        });\n                    }\n                }\n                return result;\n            }\n\n            var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n                valuesTree: function(range, column) {\n                    return [{\n                        text: kendo.spreadsheet.messages.filterMenu.all,\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n                },\n                values: function(range, column) {\n                    var values = [];\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var columnRange = range.column(column);\n                    var sheet = range.sheet();\n\n                    columnRange.forEachCell(function(row, col, cell) {\n                        var checked = true;\n                        if (sheet.isHiddenRow(row)) {\n                            checked = false;\n                        }\n\n                        var value = cell.value;\n                        var dataType = cell.dataType;\n                        var text = cell.text;\n\n                        if (value === undefined) {\n                            dataType = \"blank\";\n                        } else if (cell.format) {\n                            dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                        } else {\n                            dataType = typeof value;\n                        }\n\n                        if (value !== null && cell.format) {\n                            text = kendo.spreadsheet.formatting.text(value, cell.format);\n                        } else {\n                            text = dataType == \"blank\" ? messages.blanks : value;\n                        }\n\n                        if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                            dataType = \"number\";\n                        }\n\n                        if (dataType === \"date\") {\n                            value = kendo.spreadsheet.numberToDate(value);\n                        }\n\n                        values.push({\n                            dataType: dataType,\n                            value: value,\n                            text: text,\n                            checked: checked\n                        });\n                    });\n\n                    values = distinctValues(values);\n\n                    values.sort(function(a, b) {\n                        if (a.dataType === b.dataType) {\n                            return 0;\n                        }\n\n                        if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                            return a.dataType === \"blank\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"number\" || b.dataType === \"number\") {\n                            return a.dataType === \"number\" ? -1 : 1;\n                        }\n\n                        if (a.dataType === \"date\" || b.dataType === \"date\") {\n                            return a.dataType === \"date\" ? -1 : 1;\n                        }\n\n                        return 0;\n                    });\n\n                    return values;\n                },\n\n                filterType: function(range, column) {\n                    // 1. try to infer type from current filter\n                    var sheet = range.sheet();\n                    var filter = this.filterForColumn(column, sheet);\n                    var type;\n\n                    filter = filter && filter.filter.toJSON();\n\n                    if (filter && filter.filter == \"custom\") {\n                        var value = filter.criteria[0].value;\n\n                        if (value instanceof Date) {\n                            type = \"date\";\n                        } else if (typeof value == \"string\") {\n                            type = \"string\";\n                        } else if (typeof value == \"number\") {\n                            type = \"number\";\n                        }\n                    }\n\n                    if (!type) {\n                        // 2. try to infer type from column data\n                        var topValue = this.values(range.row(1), column)[0];\n                        type = topValue && topValue.dataType;\n\n                        if (type == \"blank\") {\n                            type = null;\n                        }\n                    }\n\n                    return type;\n                },\n\n                filterForColumn: function(column, sheet) {\n                    var allFilters = sheet.filter();\n                    var filters;\n\n                    if (allFilters) {\n                        filters =  allFilters.columns.filter(function(item) {\n                            return item.index === column;\n                        })[0];\n                    }\n\n                    return filters;\n                },\n\n                filter: function(column, sheet) {\n                    var columnFilters = this.filterForColumn(column, sheet);\n\n                    if (!columnFilters) {\n                        return;\n                    }\n\n                    var options = columnFilters.filter.toJSON();\n                    var type = options.filter;\n\n                    delete options.filter;\n\n                    var result = {\n                        type: type,\n                        options: options\n                    };\n\n                    var criteria = options.criteria;\n                    if (criteria && criteria.length) {\n                        result.operator = criteria[0].operator;\n                    }\n\n                    return result;\n                }\n            };\n\n            var FilterMenu = Widget.extend({\n                init: function(element, options) {\n                    Widget.call(this, element, options);\n\n                    this.element.addClass(FilterMenu.classNames.wrapper);\n\n                    this.viewModel = new FilterMenuViewModel({\n                        active: \"value\",\n                        operator: null,\n                        operators: flattenOperators(this.options.operators),\n                        clear: this.clear.bind(this),\n                        apply: this.apply.bind(this)\n                    });\n\n                    this._filterInit();\n                    this._popup();\n                    this._sort();\n                    this._filterByCondition();\n                    this._filterByValue();\n                    this._actionButtons();\n                },\n\n                options: {\n                    name: \"FilterMenu\",\n                    column: 0,\n                    range: null,\n                    operators: {\n                        string: {\n                            contains: \"Text contains\",\n                            doesnotcontain: \"Text does not contain\",\n                            startswith: \"Text starts with\",\n                            endswith: \"Text ends with\",\n                            matches: \"Text matches\",\n                            doesnotmatch: \"Text does not match\"\n                        },\n                        date: {\n                            eq:  \"Date is\",\n                            neq: \"Date is not\",\n                            lt:  \"Date is before\",\n                            gt:  \"Date is after\"\n                        },\n                        number: {\n                            eq: \"Is equal to\",\n                            neq: \"Is not equal to\",\n                            gte: \"Is greater than or equal to\",\n                            gt: \"Is greater than\",\n                            lte: \"Is less than or equal to\",\n                            lt: \"Is less than\"\n                        }\n                    }\n                },\n\n                events: [\n                    \"action\"\n                ],\n\n                destroy: function() {\n                    Widget.fn.destroy.call(this);\n\n                    this.menu.destroy();\n                    this.valuesTreeView.destroy();\n                    this.popup.destroy();\n                },\n\n                openFor: function(anchor, event) {\n                    if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                        // on touch devices this element will sit above to\n                        // enable scrolling; it's not useful as an anchor,\n                        // use event coords instead.\n                        this.popup.open(event.pageX, event.pageY);\n                    } else {\n                        this.popup.setOptions({ anchor: anchor });\n                        this.popup.open();\n                    }\n                },\n\n                close: function() {\n                    this.popup.close();\n                },\n\n                clear: function() {\n                    this.action({\n                        command: \"ClearFilterCommand\",\n                        options: {\n                            column: this.options.column\n                        }\n                    });\n                    this.viewModel.reset();\n                    this.close();\n                },\n\n                apply: function() {\n                    this._active();\n\n                    var options = {\n                        operatingRange: this.options.range,\n                        column: this.options.column\n                    };\n\n                    var valueFilter;\n                    var customFilter;\n\n                    if (this.viewModel.active === \"value\") {\n                        this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                        valueFilter = this.viewModel.valueFilter.toJSON();\n\n                        if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                            options.valueFilter = valueFilter;\n                        }\n                    } else if (this.viewModel.active === \"custom\") {\n                        customFilter = this.viewModel.customFilter.toJSON();\n\n                        if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                            options.customFilter = customFilter;\n                        }\n                    }\n\n                    if (options.valueFilter || options.customFilter) {\n                        this.action({ command: \"ApplyFilterCommand\", options: options });\n                    }\n                },\n\n                action: function(options) {\n                    this.trigger(\"action\", $.extend({ }, options));\n                },\n\n                _filterInit: function() {\n                    var column = this.options.column;\n                    var range = this.options.range;\n                    var sheet = range.sheet();\n                    var activeFilter = FilterMenuController.filter(column, sheet);\n\n                    if (activeFilter) {\n                        var filterType = FilterMenuController.filterType(range, column);\n\n                        this.viewModel.set(\"active\", activeFilter.type);\n                        this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                        if (activeFilter.type == \"custom\") {\n                            this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                            this.viewModel.set(\"operatorType\", filterType);\n                        }\n                    } else {\n                        this.viewModel.reset();\n                    }\n                },\n\n                _popup: function() {\n                    this.popup = this.element.kendoPopup({\n                        copyAnchorStyles: false\n                    }).data(\"kendoPopup\");\n                },\n\n                _sort: function() {\n                    var template = kendo.template(FilterMenu.templates.menuItem);\n                    var messages = kendo.spreadsheet.messages.filterMenu;\n                    var items = [\n                        { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                        { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                    ];\n\n                    var ul = $(\"<ul></ul>\", {\n                        \"html\": kendo.render(template, items)\n                    }).appendTo(this.element);\n\n                    this.menu = ul.kendoMenu({\n                        orientation: \"vertical\",\n                        select: function(e) {\n                            var dir = $(e.item).data(\"dir\");\n                            var range = this.options.range.resize({ top: 1 });\n                            var options = {\n                                value: dir,\n                                sheet: false,\n                                operatingRange: range,\n                                column: this.options.column\n                            };\n\n                            this.action({ command: \"SortCommand\", options: options });\n                        }.bind(this)\n                    }).data(\"kendoMenu\");\n                },\n\n                _appendTemplate: function(template, className, details, expanded) {\n                    var compiledTemplate = kendo.template(template);\n                    var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                        messages: kendo.spreadsheet.messages.filterMenu,\n                        guid: kendo.guid(),\n                        ns: kendo.ns\n                    }));\n\n                    this.element.append(wrapper);\n\n                    if (details) {\n                        details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) }); \n                    }\n\n                    kendo.bind(wrapper, this.viewModel);\n\n                    return wrapper;\n                },\n\n                _detailToggle: function(e) {\n                    this.element\n                        .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                        .not(e.sender.element)\n                        .data(\"kendoDetails\")\n                        .toggle(!e.show);\n                },\n\n                _filterByCondition: function() {\n                    var isExpanded = this.viewModel.active === \"custom\";\n                    this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n                },\n\n                _filterByValue: function() {\n                    var isExpanded = this.viewModel.active === \"value\";\n                    var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                    this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                    var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                    this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n                },\n\n                _actionButtons: function() {\n                    this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n                },\n\n                _active: function() {\n                    var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                        return $(element).data(\"kendoDetails\").visible();\n                    });\n\n                    if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                        this.viewModel.set(\"active\", \"value\");\n                    } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                        this.viewModel.set(\"active\", \"custom\");\n                    }\n                }\n            });\n\n            kendo.spreadsheet.FilterMenu = FilterMenu;\n            $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n        })(window.kendo);\n\n    (function(kendo) {\n\n        var SheetEditor = kendo.Observable.extend({\n            init: function(view) {\n                kendo.Observable.fn.init.call(this);\n\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n\n                this.barInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n                this.cellInput.bind(\"keyup\", this._triggerUpdate.bind(this));\n\n                this.barInput.bind(\"blur\", this._blur.bind(this));\n                this.cellInput.bind(\"blur\", this._blur.bind(this));\n            },\n\n            events: [\n                \"activate\",\n                \"deactivate\",\n                \"change\",\n                \"update\"\n            ],\n\n            _blur: function() {\n                this.deactivate();\n            },\n\n            _triggerUpdate: function() {\n                this.trigger(\"update\", { value: this.value() });\n            },\n\n            activeEditor: function() {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n\n                return editor;\n            },\n\n            activate: function(options) {\n                var viewElement = this.view.element,\n                    viewWidth, scrollerElement, scrollbarWidth;\n\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n\n                if(viewElement) {\n                    viewWidth = viewElement.width();\n                    scrollerElement = viewElement.find(\".k-spreadsheet-scroller\")[0];\n                    scrollbarWidth = scrollerElement.offsetWidth - scrollerElement.clientWidth;\n\n                    this.cellInput.element.css(\"max-width\", viewWidth - scrollbarWidth - this.cellInput.element.position().left + \"px\");\n                }\n\n                this.trigger(\"activate\");\n\n                return this;\n            },\n\n            deactivate: function(noChange) {\n                var cellInput = this.cellInput;\n\n                if (!this._active) {\n                    return;\n                }\n\n                this._active = false;\n\n                if (!noChange && cellInput.value() != this._value) {\n                    this.trigger(\"change\", {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n\n                this._rect = null;\n                cellInput.hide();\n                this.trigger(\"deactivate\");\n            },\n\n            enable: function(enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n\n            barElement: function() {\n                return this.barInput.element;\n            },\n\n            cellElement: function() {\n                return this.cellInput.element;\n            },\n\n            focus: function(inputType) {\n                inputType = inputType || \"cell\";\n\n                if (inputType === \"cell\") {\n                    this.cellInput.element.trigger(\"focus\");\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.trigger(\"focus\");\n                }\n            },\n\n            isActive: function() {\n                return this._active;\n            },\n\n            isFiltered: function() {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n\n            canInsertRef: function(isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n\n            highlightedRefs: function() {\n                var editor = this.activeEditor();\n                var refs = [];\n\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n\n                return refs;\n            },\n\n            scale: function() {\n                this.cellInput.scale();\n            },\n\n            toggleTooltip: function(rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n\n            value: function(value, isArrayFormula) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n\n                if (value === null) {\n                    value = \"\";\n                }\n\n                this._value = value;\n\n                this.barInput.value(value);\n                this.cellInput.value(value);\n\n                this.barInput.element.toggleClass(\"k-spreadsheet-array-formula\", !!isArrayFormula);\n            },\n\n            insertNewline: function() {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n\n            select: function() {\n                this.activeEditor().select();\n            }\n        });\n\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    })(kendo);\n\n    // -*- fill-column: 100 -*-\n        \"use strict\";\n\n        var spreadsheet$1 = kendo.spreadsheet;\n        var Range = spreadsheet$1.Range;\n        var runtime = spreadsheet$1.calc.runtime;\n        var Formula = runtime.Formula;\n\n        var ERR_INCOMPATIBLE = \"incompatibleRanges\";\n        var ERR_NO_DIRECTION = \"noFillDirection\";\n\n        var FillError = Range.FillError = function(msg) {\n            this.code = msg;\n        };\n\n        // `srcRange`: the range containing data that we wish to fill.  `direction`: 0↓, 1→, 2↑, 3←.  So\n        // when bit 0 is set we're doing horizontal filling, and when bit 1 is set we're doing it in\n        // reverse order.\n        Range.prototype._previewFillFrom = function(srcRange, direction) {\n            var destRange = this, sheet = destRange._sheet;\n            if (typeof srcRange == \"string\") {\n                srcRange = sheet.range(srcRange);\n            }\n            var src = srcRange._ref.toRangeRef().clone().setSheet(sheet.name());\n            var dest = destRange._ref.toRangeRef().clone().setSheet(sheet.name());\n\n            if (src.intersects(dest)) {\n                // the UI will send e.g. C2:C8.fillFrom(C7:D8) (intersecting ranges).  this figures out\n                // the actual destination range.\n                if (src.eq(dest)) {\n                    return null; // nothing to do\n                }\n                dest = dest.clone();\n                if (src.topLeft.eq(dest.topLeft)) {\n                    if (src.width() == dest.width()) {\n                        dest.topLeft.row += src.height();\n                        direction = 0;\n                    } else if (src.height() == dest.height()) {\n                        dest.topLeft.col += src.width();\n                        direction = 1;\n                    } else {\n                        throw new FillError(ERR_INCOMPATIBLE);\n                    }\n                } else if (src.bottomRight.eq(dest.bottomRight)) {\n                    if (src.width() == dest.width()) {\n                        dest.bottomRight.row -= src.height();\n                        direction = 2;\n                    } else if (src.height() == dest.height()) {\n                        dest.bottomRight.col -= src.width();\n                        direction = 3;\n                    } else {\n                        throw new FillError(ERR_INCOMPATIBLE);\n                    }\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n                return sheet.range(dest)._previewFillFrom(srcRange, direction);\n            }\n\n            if (direction == null) {\n                // try to determine based on ranges location/geometry\n                if (src.topLeft.col == dest.topLeft.col) {\n                    // assume vertical filling\n                    direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n                } else if (src.topLeft.row == dest.topLeft.row) {\n                    direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n                } else {\n                    throw new FillError(ERR_NO_DIRECTION);\n                }\n            }\n            var horizontal = direction & 1;\n            var descending = direction & 2;\n            if ((horizontal && src.height() != dest.height()) ||\n                (!horizontal && src.width() != dest.width())) {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            var data = srcRange._properties(), n;\n            if (!horizontal) {\n                data = transpose(data);\n                n = dest.height();\n            } else {\n                n = dest.width();\n            }\n            var fill = new Array(data.length);\n            var hint = null;\n            for (var i = 0; i < data.length; ++i) {\n                var s = data[i];\n                var f = findSeries(s);\n                var a = fill[i] = new Array(n);\n                for (var j = 0; j < n; ++j) {\n                    var idx = descending ? -j - 1 : s.length + j;\n                    var srcIdx = descending ? s.length - (j % s.length) - 1 : (j % s.length);\n                    var cell = a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n                    if (cell.value != null) {\n                        hint = cell.value;\n                    }\n                }\n            }\n            if (!horizontal) {\n                fill = transpose(fill);\n            }\n            return { props: fill, direction: direction, dest: destRange, hint: hint };\n        };\n\n        Range.prototype.fillFrom = function(srcRange, direction) {\n            var x = this._previewFillFrom(srcRange, direction);\n            x.dest._properties(x.props, true);\n            return x.dest;\n        };\n\n        // This is essentially the FORECAST function, see ./runtime.functions.2.js.\n        // It receives an array of values, and returns a function that \"predicts\"\n        // the value in cell N.\n        function linearRegression(data) {\n            var N = data.length;\n            var mx = (N + 1) / 2, my = data.reduce(function(a, b){\n                return a + b;\n            }, 0) / N;\n            var s1 = 0, s2 = 0;\n            for (var i = 0; i < N; i++) {\n                var t1 = (i + 1) - mx, t2 = data[i] - my;\n                s1 += t1 * t2;\n                s2 += t1 * t1;\n            }\n            if (!s2) {\n                return function(N){\n                    return data[N % data.length];\n                };\n            }\n            var b = s1 / s2, a = my - b * mx;\n            return function(N) {\n                return a + b * (N + 1);\n            };\n        }\n\n        function findSeries(properties) {\n            function findStep(a) {\n                var diff = a[1] - a[0];\n                for (var i = 2; i < a.length; ++i) {\n                    if (a[i] - a[i-1] != diff) {\n                        return null;\n                    }\n                }\n                return diff;\n            }\n            function getData(a) {\n                return a.map(function(v){\n                    return v.number;\n                });\n            }\n            var series = [];\n            var data = properties.map(function(x){\n                return x.formula || x.value;\n            });\n            forEachSeries(data, function(begin, end, type, a){\n                var f, values;\n                if (type == \"number\") {\n                    values = getData(a);\n\n                    // This code would increase a date even if a single cell was selected.  Seems it's\n                    // not desirable so I commented it out.\n                    // https://github.com/telerik/kendo-ui-core/issues/3565\n                    //\n                    // if (values.length == 1 && (begin > 0 || end < data.length ||\n                    //                            formatType(values[0], properties[begin].format) == \"date\")) {\n                    //     values.push(values[0] + 1);\n                    // }\n\n                    f = linearRegression(values);\n                } else if (type == \"string\" || type == \"formula\" || type == \"boolean\") {\n                    // formulas are simply copied over; the sheet will internally clone the objects\n                    f = function(N, i) {\n                        return data[i];\n                    };\n                } else if (Array.isArray(type)) {\n                    if (a.length == 1) {\n                        f = function(N) {\n                            return type[(a[0].number + N) % type.length];\n                        };\n                    } else {\n                        // figure out the step\n                        var diff = findStep(getData(a));\n                        if (diff == null) {\n                            // seemingly no pattern, just repeat those strings\n                            f = function(N) {\n                                return a[(N) % a.length].value;\n                            };\n                        } else {\n                            f = function(N) {\n                                var idx = a[0].number + diff * N;\n                                return type[idx % type.length];\n                            };\n                        }\n                    }\n                } else if (type != \"null\") {\n                    values = getData(a);\n                    if (values.length == 1) {\n                        values.push(values[0] + 1);\n                    }\n                    values = linearRegression(values);\n                    f = function(N, i) {\n                        return data[i].replace(/^(.*[\\D0]+)\\d+/, \"$1\" + values(N, i));\n                    };\n                } else {\n                    f = function() { return null; };\n                }\n                var s = { f: f, begin: begin, end: end, len: end - begin };\n                for (var i = begin; i < end; ++i) {\n                    series[i] = s;\n                }\n            });\n            return function(N, i) {\n                var s = series[i];\n                var q = N / data.length | 0;\n                var r = N % data.length;\n                var n = q * s.len + r - s.begin;\n                var value = s.f(n, i);\n                var props = clone$1(properties[i]);\n                delete props.enable;\n                if (value instanceof Formula) {\n                    props.formula = value;\n                } else {\n                    props.value = value;\n                }\n                return props;\n            };\n        }\n\n        // function formatType(value, format) {\n        //     if (format != null) {\n        //         return spreadsheet.formatting.type(value, format);\n        //     }\n        // }\n\n        function clone$1(obj) {\n            var copy = {};\n            Object.keys(obj || {}).forEach(function(key){\n                copy[key] = obj[key];\n            });\n            return copy;\n        }\n\n        function forEachSeries(data, f) {\n            var prev = null, start = 0, a = [], type;\n            for (var i = 0; i < data.length; ++i) {\n                type = getType(data[i]);\n                a.push(type);\n                if (prev != null && type.type !== prev.type) {\n                    f(start, i, prev.type, a.slice(start, i));\n                    start = i;\n                }\n                prev = type;\n            }\n            f(start, i, prev.type, a.slice(start, i));\n        }\n\n        function getType(el) {\n            if (typeof el == \"number\") {\n                return { type: \"number\", number: el };\n            }\n            if (typeof el == \"string\") {\n                var lst = findStringList(el);\n                if (lst) {\n                    return lst;\n                }\n                var m = /^(.*\\D)(\\d+)/.exec(el);\n                if (m) {\n                    el = el.replace(/^(.*\\D)\\d+/, \"$1-######\");\n                    return { type: el, match: m, number: parseFloat(m[2]) };\n                }\n                return { type: \"string\" };\n            }\n            if (typeof el == \"boolean\") {\n                return { type: \"boolean\" };\n            }\n            if (el == null) {\n                return { type: \"null\" };\n            }\n            if (el instanceof Formula) {\n                return { type: \"formula\" };\n            }\n            window.console.error(el);\n            throw new Error(\"Cannot fill data\");\n        }\n\n        function stringLists() {\n            var culture = kendo.culture();\n            return [\n                culture.calendars.standard.days.namesAbbr,\n                culture.calendars.standard.days.names,\n                culture.calendars.standard.months.namesAbbr,\n                culture.calendars.standard.months.names\n            ];\n        }\n\n        function findStringList(str) {\n            var strl = str.toLowerCase();\n            var lists = stringLists();\n            for (var i = 0; i < lists.length; ++i) {\n                var a = lists[i];\n                for (var j = a.length; --j >= 0;) {\n                    var el = a[j].toLowerCase();\n                    if (el == strl) {\n                        return { type: a, number: j, value: str };\n                    }\n                }\n            }\n        }\n\n        function transpose(a) {\n            var height = a.length, width = a[0].length;\n            var t = [];\n            for (var i = 0; i < width; ++i) {\n                t[i] = [];\n                for (var j = 0; j < height; ++j) {\n                    t[i][j] = a[j][i];\n                }\n            }\n            return t;\n        }\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n\n        var CLASS_NAMES = {\n            input: \"k-spreadsheet-name-editor\",\n            list: \"k-spreadsheet-name-list\"\n        };\n\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n\n                var comboBoxTitle = options.messages.nameBox || \"Name Box\";\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function(options) {\n                            var data = [];\n                            this._workbook.forEachName(function(def){\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n\n                var comboElement = $(\"<input />\")\n                    .attr(\"title\", comboBoxTitle)\n                    .attr(\"aria-label\", comboBoxTitle);\n\n                this.combo = comboElement.appendTo(element)\n                    .kendoComboBox({\n                        clearButton: false,\n                        dataTextField: \"name\",\n                        dataValueField: \"name\",\n                        template: \"#:data.name#<a role='button' class='k-button-delete' href='\\\\#'><span class='k-icon k-i-close'></span></a>\",\n                        dataSource: dataSource,\n                        autoBind: false,\n                        ignoreCase: true,\n                        change: this._on_listChange.bind(this),\n                        noDataTemplate: \"<div></div>\",\n                        open: function() {\n                            dataSource.read();\n                        }\n                    }).getKendoComboBox();\n\n                this.combo.input\n                    .on(\"keydown\", this._on_keyDown.bind(this))\n                    .on(\"focus\", this._on_focus.bind(this));\n\n                this.combo.popup.element\n                    .addClass(\"k-spreadsheet-names-popup\")\n\n                    .on(\"mousemove\", function(ev){\n                        // XXX: should remove this when we find a better\n                        // solution for the popup closing as we hover the\n                        // resize handles.\n                        ev.stopPropagation();\n                    })\n\n                    .on(\"click\", \".k-button-delete\", function(ev){\n                        ev.preventDefault();\n                        ev.stopPropagation();\n                        var item = $(ev.target).closest(\".k-item\");\n                        item = this.combo.dataItem(item);\n                        this._deleteItem(item.name);\n                    }.bind(this));\n            },\n            value: function(val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function(name) {\n                this.trigger(\"delete\", { name: name });\n            },\n            _on_keyDown: function(ev) {\n                switch (ev.keyCode) {\n                  case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger(\"cancel\");\n                    break;\n                  case 13:\n                    this.trigger(\"enter\");\n                    break;\n                }\n            },\n            _on_focus: function() {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function() {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger(\"select\", { name: name });\n                }\n            }\n        });\n\n        kendo.spreadsheet.NameEditor = NameEditor;\n    })(window.kendo);\n\n    \"use strict\";\n\n        var spreadsheet = kendo.spreadsheet;\n        var CellRef = spreadsheet.CellRef;\n        var kdrw = kendo.drawing;\n        var formatting = spreadsheet.formatting;\n        var geo = kendo.geometry;\n\n        var GUIDELINE_WIDTH = 0.8;\n\n\n\n\n        // This takes a list of row heights and the page height, and\n        // produces a list of Y coordinates for each row, such that rows\n        // are not truncated across pages.  However, the algorithm will\n        // decide to truncate a row in the event that more than\n        // `maxEmpty` (default 0.2) of the available space would\n        // otherwise be left blank.\n        //\n        // It will be used for horizontal splitting too (will receive\n        // column widths and page width, and produce a list of X coords).\n        //\n        // If the third argument (headerRows) is not null, it specifies a\n        // number of rows to repeat on each page.  On pages other than the\n        // first, the necessary space will be skipped at the top.  Header\n        // coordinates (except for the first page) are pushed in\n        // headerCoords.\n        function distributeCoords(heights, pageHeight, maxEmpty, headerRows, headerCoords) {\n            var curr = 0;\n            var out = [];\n            var bottom = pageHeight;\n            var header = 0;\n            if (pageHeight && maxEmpty) {\n                maxEmpty *= pageHeight;\n            }\n            heights.forEach(function(h, i){\n                if (headerRows != null && i < headerRows) {\n                    header += h;\n                }\n                if (pageHeight && curr + h > bottom) {\n                    if (bottom - curr < maxEmpty) {\n                        // align to next page\n                        curr = pageHeight * Math.ceil(curr / pageHeight) + header;\n                        if (header > 0) {\n                            headerCoords.push(curr - header);\n                        }\n                    }\n                    // update bottom anyway; don't just add pageHeight, as\n                    // we might need multiple pages for the pathological\n                    // case of one row higher than the page.\n                    bottom += pageHeight * Math.ceil(h / pageHeight);\n                }\n                out.push(curr);\n                curr += h;\n            });\n            out.push(curr);\n            return out;\n        }\n\n        function doLayout(sheet, range, options) {\n            // normalize reference so we don't have to deal with Infinity here.\n            var grid = sheet._grid;\n            range = grid.normalize(range);\n\n            var wholeRect = grid.rectangle(range);\n            var drawings = [];\n            sheet._drawings.forEach(function(d) {\n                var box = sheet.drawingBoundingBox(d);\n                if (box.intersects(wholeRect)) {\n                    drawings.push({\n                        drawing: d,\n                        box: box.offset(-wholeRect.left, -wholeRect.top)\n                    });\n                }\n            });\n\n            // 1. obtain the list of cells that need to be printed, the\n            //    row heights and column widths.  Place in each cell row,\n            //    col (relative to range, i.e. first is 0,0), rowspan,\n            //    colspan and merged.  also place a list of drawings\n            //    anchored to that cell.\n            var cells = [];\n            var rowHeights = [];\n            var colWidths = [];\n            var mergedCells = sheet._getMergedCells(range);\n\n            var maxRow = -1, maxCol = -1;\n            sheet.forEach(range, function(row, col, cell){\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                var rh = sheet.rowHeight(row);\n                var cw = sheet.columnWidth(col);\n                if (!options.forScreen) {\n                    // for printing we'll need the list of anchored\n                    // drawings so that we can adjust them after page\n                    // splitting.\n                    cell.drawings = drawings.filter(function(d){\n                        var tl = d.drawing.topLeftCell;\n                        if (tl && tl.row == row && tl.col == col) {\n                            maxRow = Math.max(maxRow, sheet._rows.index(d.box.bottom));\n                            maxCol = Math.max(maxCol, sheet._columns.index(d.box.right));\n                            return true;\n                        }\n                    });\n                }\n                if (!relcol) {\n                    rowHeights.push(rh);\n                }\n                if (!relrow) {\n                    colWidths.push(cw);\n                }\n                var id = new CellRef(row, col).print();\n                if (mergedCells.secondary[id]) {\n                    return;\n                }\n                cell.row = relrow;\n                cell.col = relcol;\n                var m = mergedCells.primary[id];\n                if (m) {\n                    delete mergedCells.primary[id];\n                    cell.merged = true;\n                    cell.rowspan = m.height();\n                    cell.colspan = m.width();\n                    if (options.forScreen) {\n                        cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                        cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                    }\n                } else {\n                    cell.rowspan = 1;\n                    cell.colspan = 1;\n                }\n                if (!sheet._grid._columns.sum(col, col + cell.colspan - 1) ||\n                    !sheet._grid._rows.sum(row, row + cell.rowspan - 1)) {\n                    return;\n                }\n                var nonEmpty = options.forScreen || shouldDrawCell(cell);\n                if (!(options.emptyCells || nonEmpty)) {\n                    return;\n                }\n                if (nonEmpty) {\n                    maxRow = Math.max(maxRow, relrow + cell.rowspan - 1);\n                    maxCol = Math.max(maxCol, relcol + cell.colspan - 1);\n                } else {\n                    cell.empty = true;\n                }\n                cells.push(cell);\n            });\n\n            if (!options.forScreen) {\n                // keep only the drawable area\n                rowHeights = rowHeights.slice(0, maxRow + 1);\n                colWidths = colWidths.slice(0, maxCol + 1);\n            }\n\n            var pageWidth = options.pageWidth;\n            var pageHeight = options.pageHeight;\n            var scaleFactor = options.scale || 1;\n\n            // when fitWidth is requested, we must update the page size\n            // with the corresponding scale factor; the algorithm below\n            // (2) will continue to work, just drawing on a bigger page.\n            if (options.fitWidth) {\n                var width = colWidths.reduce(sum, 0);\n                if (width > pageWidth) {\n                    scaleFactor = pageWidth / width;\n                }\n            }\n            pageWidth = Math.ceil(pageWidth / scaleFactor);\n            pageHeight = Math.ceil(pageHeight / scaleFactor);\n\n            // 2. calculate top, left, bottom, right, width and height for\n            //    printable cells.  Merged cells will be split across\n            //    pages, unless the first row/col is shifted to next page.\n            //    boxWidth and boxHeight get the complete drawing size.\n            //    Note that cell coordinates keep increasing, i.e. they\n            //    are not reset to zero for a new page.  The print\n            //    function translates the view to current page.\n            var hyCoords = []; // will receive header Y coordinates, if needed\n            var yCoords = distributeCoords(rowHeights, pageHeight || 0, options.maxEmpty,\n                                           options.headerRows, hyCoords);\n            var xCoords = distributeCoords(colWidths, pageWidth || 0, options.maxEmpty);\n            var boxWidth = 0;\n            var boxHeight = 0;\n            var headerCells = [];\n            cells = cells.filter(function(cell){\n                if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                    return false;\n                }\n                if (options.headerRows && cell.row < options.headerRows) {\n                    headerCells.push(cell);\n                }\n                cell.left = xCoords[cell.col];\n                cell.top = yCoords[cell.row];\n                if (cell.merged) {\n                    if (!options.forScreen) {\n                        cell.right = orlast(xCoords, cell.col + cell.colspan);\n                        cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                        cell.width = cell.right - cell.left;\n                        cell.height = cell.bottom - cell.top;\n                    } else {\n                        cell.right = cell.left + cell.width;\n                        cell.bottom = cell.top + cell.height;\n                    }\n                } else {\n                    cell.width = colWidths[cell.col];\n                    cell.height = rowHeights[cell.row];\n                    cell.bottom = cell.top + cell.height;\n                    cell.right = cell.left + cell.width;\n                }\n                if (!options.forScreen) {\n                    // page breaking will shift cell coordinates.  adjust\n                    // anchored drawings.\n                    cell.drawings.forEach(function(d){\n                        var box = d.box;\n                        box.left = cell.left + d.drawing.offsetX;\n                        box.top = cell.top + d.drawing.offsetY;\n                        box.right = box.left + box.width;\n                        box.bottom = box.top + box.height;\n                    });\n                }\n                boxWidth = Math.max(boxWidth, cell.right);\n                boxHeight = Math.max(boxHeight, cell.bottom);\n                return true;\n            });\n\n            // 3. if any merged cells remain in \"primary\", they start\n            //    outside the printed range and we should still display\n            //    them partially.\n            Object.keys(mergedCells.primary).forEach(function(id){\n                var ref = mergedCells.primary[id];\n                sheet.forEach(ref.topLeft.toRangeRef(), function(row, col, cell){\n                    var relrow = row - range.topLeft.row;\n                    var relcol = col - range.topLeft.col;\n                    cell.merged = true;\n                    cell.colspan = ref.width();\n                    cell.rowspan = ref.height();\n                    if (relrow < 0) {\n                        cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                    } else {\n                        cell.top = yCoords[relrow];\n                    }\n                    if (relcol < 0) {\n                        cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                    } else {\n                        cell.left = xCoords[relcol];\n                    }\n                    cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                    cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                    if (cell.height > 0 && cell.width > 0) {\n                        // zero means a fully hidden merged cell (all rows/columns are hidden)\n                        // https://github.com/telerik/kendo-ui-core/issues/1794\n                        cell.right = cell.left + cell.width;\n                        cell.bottom = cell.top + cell.height;\n                        cell.row = relrow;\n                        cell.col = relcol;\n                        cells.push(cell);\n                    }\n                });\n            });\n\n            // 4. replicate header rows on all pages\n            if (options.headerRows) {\n                hyCoords.forEach(function(y){\n                    headerCells.forEach(function(cell){\n                        cell = clone(cell);\n                        cell.top += y;\n                        cell.bottom = cell.top + cell.height;\n                        cells.push(cell);\n                    });\n                    yCoords.push(y);\n                });\n                yCoords.sort(orderCoords);\n            }\n\n            return {\n                width    : boxWidth,\n                height   : boxHeight,\n                cells    : cells.sort(orderCells),\n                scale    : scaleFactor,\n                xCoords  : xCoords,\n                yCoords  : yCoords,\n                drawings : drawings\n            };\n        }\n\n        function clone(hash, target) {\n            if (!target) {\n                target = {};\n            }\n            if (Object.assign) {\n                return Object.assign(target, hash);\n            }\n            return Object.keys(hash).reduce(function(copy, key){\n                copy[key] = hash[key];\n                return copy;\n            }, target);\n        }\n\n        function sameBorder(a, b) {\n            return a.size === b.size && a.color === b.color;\n        }\n\n        function sum(a, b) {\n            return a + b;\n        }\n\n        function orlast(a, i) {\n            return i < a.length ? a[i] : a[a.length - 1];\n        }\n\n        function shouldDrawCell(cell) {\n            return cell.value != null\n                || cell.merged\n                || cell.background != null\n                || cell.borderRight != null\n                || cell.borderBottom != null\n                || cell.dBorders != null\n                || (cell.validation != null && !cell.validation.value)\n                || (cell.drawings && cell.drawings.length);\n        }\n\n        function orderCells(a, b) {\n            if (a.top < b.top) {\n                return -1;\n            } else if (a.top == b.top) {\n                if (a.left < b.left) {\n                    return -1;\n                } else if (a.left == b.left) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            } else {\n                return 1;\n            }\n        }\n\n        function orderCoords(a, b) {\n            return a < b ? -1 : a > b ? 1 : 0;\n        }\n\n        function drawLayout(sheet, layout, group, options) {\n            // options:\n            // - pageWidth\n            // - pageHeight\n            // - fitWidth\n            // - hCenter\n            // - vCenter\n            var ncols = Math.ceil(layout.width / options.pageWidth);\n            var nrows = Math.ceil(layout.height / options.pageHeight);\n            var pageWidth = Math.ceil(options.pageWidth / layout.scale);\n            var pageHeight = Math.ceil(options.pageHeight / layout.scale);\n\n            for (var j = 0; j < nrows; ++j) {\n                for (var i = 0; i < ncols; ++i) {\n                    addPage(j, i);\n                }\n            }\n\n            function addPage(row, col) {\n                var left = col * pageWidth;\n                var right = left + pageWidth;\n                var top = row * pageHeight;\n                var bottom = top + pageHeight;\n                var endbottom = 0, endright = 0;\n\n                function isInside(box) {\n                    if (box.right <= left || box.left >= right ||\n                        box.bottom <= top || box.top >= bottom) {\n                        return false;\n                    }\n                    endbottom = Math.max(box.bottom, endbottom);\n                    endright = Math.max(box.right, endright);\n                    return true;\n                }\n\n                // XXX: this can be optimized - discard cells that won't\n                // be used again, and don't walk cells that stand no\n                // chance to fit.\n                var cells = layout.cells.filter(isInside);\n\n                var drawings = layout.drawings.filter(function(d){\n                    return isInside(d.box);\n                });\n\n                // merged cells might stretch beyond page; limit to that\n                endbottom = Math.min(endbottom, bottom);\n                endright = Math.min(endright, right);\n\n                if (cells.length || drawings.length) {\n                    var page = new kdrw.Group();\n                    group.append(page);\n                    // page.clip(drawing.Path.fromRect(\n                    //     new geo.Rect([ 0, 0 ],\n                    //                  [ options.pageWidth, options.pageHeight ])));\n\n                    var content = new kdrw.Group();\n                    page.append(content);\n\n                    content.clip(kdrw.Path.fromRect(\n                        new geo.Rect([ left - 1, top - 1 ], [ endright + 1, endbottom + 1 ])\n                    ));\n\n                    var matrix = geo.Matrix.scale(layout.scale, layout.scale)\n                        .multiplyCopy(geo.Matrix.translate(-left, -top));\n\n                    if (options.hCenter || options.vCenter) {\n                        matrix = matrix.multiplyCopy(\n                            geo.Matrix.translate(\n                                options.hCenter ? (right - endright) / 2 : 0,\n                                options.vCenter ? (bottom - endbottom) / 2 : 0)\n                        );\n                    }\n\n                    content.transform(matrix);\n\n                    if (options.guidelines) {\n                        var prev = null;\n                        layout.xCoords.forEach(function(x){\n                            x = Math.min(x, endright);\n                            if (x !== prev && x >= left && x <= right) {\n                                prev = x;\n                                content.append(\n                                    new kdrw.Path()\n                                        .moveTo(x, top)\n                                        .lineTo(x, endbottom)\n                                        .close()\n                                        .stroke(options.guideColor, GUIDELINE_WIDTH)\n                                );\n                            }\n                        });\n                        var prev = null;\n                        layout.yCoords.forEach(function(y){\n                            y = Math.min(y, endbottom);\n                            if (y !== prev && y >= top && y <= bottom) {\n                                prev = y;\n                                content.append(\n                                    new kdrw.Path()\n                                        .moveTo(left, y)\n                                        .lineTo(endright, y)\n                                        .close()\n                                        .stroke(options.guideColor, GUIDELINE_WIDTH)\n                                );\n                            }\n                        });\n                    }\n\n                    var borders = Borders(); \n                    cells.forEach(function(cell){\n                        drawCell(cell, content, options);\n                        borders.add(cell, sheet);\n                    });\n\n                    var bordersGroup = new kdrw.Group();\n                    borders.vert.forEach(function(a){\n                        a.forEach(function(b){\n                            if (!b.rendered) {\n                                b.rendered = true;\n                                bordersGroup.append(\n                                    new kdrw.Path()\n                                        .moveTo(b.x, b.top)\n                                        .lineTo(b.x, b.bottom)\n                                        .close()\n                                        .stroke(b.color, b.size)\n                                );\n                            }\n                        });\n                    });\n                    borders.horiz.forEach(function(a){\n                        a.forEach(function(b){\n                            if (!b.rendered) {\n                                b.rendered = true;\n                                bordersGroup.append(\n                                    new kdrw.Path()\n                                        .moveTo(b.left, b.y)\n                                        .lineTo(b.right, b.y)\n                                        .close()\n                                        .stroke(b.color, b.size)\n                                );\n                            }\n                        });\n                    });\n                    content.append(bordersGroup);\n\n                    drawings.forEach(function(d){\n                        var drawing = d.drawing;\n                        var image = drawing.image;\n                        if (image != null) {\n                            var box = d.box;\n                            var url = sheet._workbook.imageUrl(image);\n                            content.append(\n                                new kdrw.Image(url, new geo.Rect(\n                                    [ box.left, box.top ],\n                                    [ box.width, box.height ]\n                                )).opacity(drawing.opacity)\n                            );\n                        }\n                    });\n                }\n            }\n        }\n\n        function drawCell(cell, content, options) {\n            var g = new kdrw.Group();\n            content.append(g);\n            var rect = new geo.Rect([ cell.left, cell.top ],\n                                    [ cell.width, cell.height ]);\n            if (cell.background || cell.merged) {\n                var r2d2 = rect;\n                if (options.guidelines) {\n                    r2d2 = rect.clone();\n                    r2d2.origin.x += GUIDELINE_WIDTH/2 + 0.1;\n                    r2d2.origin.y += GUIDELINE_WIDTH/2 + 0.1;\n                    r2d2.size.width -= GUIDELINE_WIDTH + 0.2;\n                    r2d2.size.height -= GUIDELINE_WIDTH + 0.2;\n                }\n                g.append(\n                    new kdrw.Rect(r2d2)\n                        .fill(cell.background || \"#fff\")\n                        .stroke(null)\n                );\n            }\n            if (cell.dBorders) {\n                if (cell.dBorders.type & 2) {\n                    g.append(\n                        new kdrw.Path()\n                            .moveTo(cell.left, cell.bottom)\n                            .lineTo(cell.right, cell.top)\n                            .stroke(cell.dBorders.color, cell.dBorders.size)\n                    );\n                }\n                if (cell.dBorders.type & 1) {\n                    g.append(\n                        new kdrw.Path()\n                            .moveTo(cell.left, cell.top)\n                            .lineTo(cell.right, cell.bottom)\n                            .stroke(cell.dBorders.color, cell.dBorders.size)\n                    );\n                }\n            }\n            var val = cell.value;\n            if (val != null) {\n                var type = typeof val == \"number\" ? \"number\" : null;\n                var clip = new kdrw.Group();\n                clip.clip(kdrw.Path.fromRect(rect));\n                g.append(clip);\n                var f, format = cell.format;\n                if (!format && type == \"number\" && val != Math.floor(val)) {\n                    format = \"0.##############\";\n                }\n                if (format) {\n                    f = formatting.textAndColor(val, format);\n                    val = f.text;\n                    if (f.type) {\n                        type = f.type;\n                    }\n                } else {\n                    val += \"\";\n                }\n                if (!cell.textAlign) {\n                    switch (type) {\n                      case \"number\":\n                      case \"date\":\n                      case \"percent\":\n                      case \"currency\":\n                        cell.textAlign = \"right\";\n                        break;\n                      case \"boolean\":\n                        cell.textAlign = \"center\";\n                        break;\n                    }\n                }\n                drawText(val, (f && f.color) || cell.color || \"#000\", cell, clip);\n            }\n        }\n\n        function applyIndent(cell, style) {\n            if (cell.indent) {\n                // OOXML spec states the indent is \"An integer value,\n                // where an increment of 1 represents 3 spaces\".  This, of\n                // course, bears no resemblance to what Excel actually\n                // does, so we need magic numbers here.\n                var indent = 1.4 * cell.indent;\n                switch (style.textAlign) {\n                  case null:\n                  case \"left\":\n                    style.paddingLeft = indent + \"ch\";\n                    break;\n                  case \"right\":\n                    style.paddingRight = indent + \"ch\";\n                    break;\n                  case \"center\":\n                    style.paddingLeft = indent/2 + \"ch\";\n                    style.paddingRight = indent/2 + \"ch\";\n                    break;\n                }\n            }\n        }\n\n        var CONT;\n        function drawText(text, color, cell, group) {\n            if (!CONT) {\n                CONT = document.createElement(\"div\");\n                CONT.style.position = \"fixed\";\n                CONT.style.left = \"0px\";\n                CONT.style.top = \"0px\";\n                CONT.style.visibility = \"hidden\";\n                CONT.style.overflow = \"hidden\";\n                CONT.style.boxSizing = \"border-box\";\n                CONT.style.lineHeight = \"normal\";\n                document.body.appendChild(CONT);\n            }\n\n            if (CONT.firstChild) {\n                CONT.removeChild(CONT.firstChild);\n            }\n\n            CONT.style.padding = \"2px 4px\";\n            CONT.style.color = color;\n            CONT.style.font = makeFontDef(cell);\n            CONT.style.width = cell.width + \"px\";\n            CONT.style.textAlign = cell.textAlign || \"left\";\n            CONT.style.textDecoration = cell.underline ? \"underline\" : \"none\";\n\n            applyIndent(cell, CONT.style);\n\n            if (cell.wrap) {\n                CONT.style.whiteSpace = \"pre-wrap\";\n                CONT.style.overflowWrap = CONT.style.wordWrap = \"break-word\";\n            } else {\n                CONT.style.whiteSpace = \"pre\";\n                CONT.style.overflowWrap = CONT.style.wordWrap = \"normal\";\n            }\n\n            CONT.appendChild(document.createTextNode(text));\n\n            var vtrans = 0;\n            switch (cell.verticalAlign) {\n              case \"center\":\n                vtrans = (cell.height - CONT.offsetHeight) >> 1;\n                break;\n\n              case undefined:\n              case null:\n              case \"bottom\":\n                vtrans = (cell.height - CONT.offsetHeight);\n                break;\n            }\n            if (vtrans < 0) { vtrans = 0; }\n\n            var text_group  = kendo.drawing.drawDOM.drawText(CONT);\n            text_group.transform(geo.Matrix.translate(cell.left, cell.top + vtrans));\n            group.append(text_group);\n        }\n\n        function makeFontDef(cell) {\n            var font = [];\n            if (cell.italic) {\n                font.push(\"italic\");\n            }\n            if (cell.bold) {\n                font.push(\"bold\");\n            }\n            font.push((cell.fontSize || 12) + \"px\");\n            font.push((cell.fontFamily || \"Arial\"));\n            return font.join(\" \");\n        }\n\n        function draw(sheet, range, options, callback) {\n            if (options == null && callback == null) {\n                callback = range;\n                options = {};\n                range = spreadsheet.SHEETREF;\n            }\n            if (callback == null) {\n                callback = options;\n                if (range instanceof spreadsheet.Range\n                    || range instanceof spreadsheet.Ref\n                    || typeof range == \"string\") {\n                    options = {};\n                } else {\n                    options = range;\n                    range = spreadsheet.SHEETREF;\n                }\n            }\n            options = kendo.jQuery.extend({\n                paperSize  : \"A4\",\n                landscape  : true,\n                margin     : \"1cm\",\n                guidelines : true,\n                guideColor : \"#aaa\",\n                emptyCells : true,\n                fitWidth   : false,\n                center     : false,\n                headerRows : null,\n                maxEmpty   : 0.2,\n                scale      : 1\n            }, options);\n            var group = new kdrw.Group();\n            var paper = kendo.pdf.getPaperOptions(options);\n            group.options.set(\"pdf\", {\n                author    : options.author,\n                creator   : options.creator,\n                date      : options.date,\n                keywords  : options.keywords,\n                margin    : paper.margin,\n                multiPage : true,\n                paperSize : paper.paperSize,\n                subject   : options.subject,\n                title     : options.title,\n                autoPrint : options.autoPrint\n            });\n            var pageWidth = paper.paperSize[0];\n            var pageHeight = paper.paperSize[1];\n            if (paper.margin) {\n                pageWidth -= paper.margin.left + paper.margin.right + 1;\n                pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n            }\n            options.pageWidth = pageWidth;\n            options.pageHeight = pageHeight;\n            var layout = doLayout(sheet, sheet._ref(range), options);\n            drawLayout(sheet, layout, group, options);\n            callback(group);\n        }\n\n        spreadsheet.Sheet.prototype.draw = function(range, options, callback) {\n            var sheet = this;\n            if (sheet._workbook) {\n                sheet.recalc(sheet._workbook._context, function(){\n                    draw(sheet, range, options, callback);\n                });\n            } else {\n                draw(sheet, range, options, callback);\n            }\n        };\n\n        // Hack: since we index the border arrays by relative row/col we\n        // could end up with negative indexes, i.e. horiz[-2] = border.\n        // Array forEach will ignore these, so we provide a simple\n        // container here (outside code only needs forEach at this time).\n        function Container() {}\n        Container.prototype = {\n            forEach: function(f) {\n                Object.keys(this).forEach(function(key){\n                    f(this[key], key, this);\n                }, this);\n            }\n        };\n\n        function Borders() {\n            var horiz = new Container();\n            var vert = new Container();\n            function add(cell, sheet) {\n                if (sheet) {\n                    // reset borders here; the propertybag doesn't keep track of merged cells :-/ this\n                    // is ugly, but the inner details of data storage have leaked everywhere anyway.\n                    var pb = sheet._properties;\n                    var grid = sheet._grid;\n                    cell.borderLeft    = pb.get(\"vBorders\", grid.index(cell.row, cell.col));\n                    cell.borderRight   = pb.get(\"vBorders\", grid.index(cell.row, cell.col + cell.colspan));\n                    cell.borderTop     = pb.get(\"hBorders\", grid.index(cell.row, cell.col));\n                    cell.borderBottom  = pb.get(\"hBorders\", grid.index(cell.row + cell.rowspan, cell.col));\n                }\n                if (cell.borderLeft) {\n                    addVert(cell.row, cell.col, cell.borderLeft,\n                            cell.left, cell.top, cell.bottom);\n                }\n                if (cell.borderRight) {\n                    addVert(cell.row, cell.col + cell.colspan, cell.borderRight,\n                            cell.right, cell.top, cell.bottom);\n                }\n                if (cell.borderTop) {\n                    addHoriz(cell.row, cell.col, cell.borderTop,\n                             cell.top, cell.left, cell.right);\n                }\n                if (cell.borderBottom) {\n                    addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom,\n                             cell.bottom, cell.left, cell.right);\n                }\n            }\n            function addVert(row, col, border, x, top, bottom) {\n                var a = vert[col] || (vert[col] = new Container());\n                var prev = row > 0 && a[row - 1];\n                if (prev && sameBorder(prev, border)) {\n                    a[row] = prev;\n                    prev.bottom = bottom;\n                } else {\n                    a[row] = {\n                        size: border.size,\n                        color: border.color || \"#000\",\n                        x: x,\n                        top: top,\n                        bottom: bottom\n                    };\n                }\n            }\n            function addHoriz(row, col, border, y, left, right) {\n                var a = horiz[row] || (horiz[row] = new Container());\n                var prev = col > 0 && a[col - 1];\n                if (prev && sameBorder(prev, border)) {\n                    a[col] = prev;\n                    prev.right = right;\n                } else {\n                    a[col] = {\n                        size: border.size,\n                        color: border.color || \"#000\",\n                        y: y,\n                        left: left,\n                        right: right\n                    };\n                }\n            }\n            return { add: add, horiz: horiz, vert: vert };\n        }\n\n        function drawTabularData(options) {\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n\n            options = clone(options, {\n                dataSource       : null,\n                guidelines       : true,\n                guideColor       : \"#000\",\n                columns          : null,\n                headerBackground : \"#999\",\n                headerColor      : \"#000\",\n                oddBackground    : null,\n                evenBackground   : null,\n                fontFamily       : \"Arial\",\n                fontSize         : 12,\n                paperSize        : \"A4\",\n                margin           : \"1cm\",\n                landscape        : true,\n                fitWidth         : false,\n                scale            : 1,\n                rowHeight        : 20,\n                maxEmpty         : 1,\n                useGridFormat    : true\n            });\n\n            // retrieve fonts; custom fonts should be already loaded\n            kendo.drawing.pdf.defineFont(\n                kendo.drawing.drawDOM.getFontFaces(document)\n            );\n\n            var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n            function textWidth(value) {\n                if (value != null) {\n                    var width = 12;         // magic numbers :-/\n                    for (var i = value.length; --i >= 0;) {\n                        width += charWidth(value.charAt(i));\n                    }\n                    return width;\n                }\n                return 0;\n            }\n\n            var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n            function mkCell(data) {\n                if (!border) {\n                    return data;\n                }\n                return clone(data, {\n                    borderLeft: border,\n                    borderTop: border,\n                    borderRight: border,\n                    borderBottom: border\n                });\n            }\n\n            options.dataSource.fetch(function(){\n                var data = options.dataSource.data();\n                if (!data.length) {\n                    return progress.reject(\"Empty dataset\");\n                }\n\n                // this really must be present\n                var columns = options.columns.map(function(col){\n                    if (typeof col == \"string\") {\n                        return { title: col, field: col };\n                    } else {\n                        return col;\n                    }\n                });\n                var columnTitles = columns.map(function(col){\n                    return col.title || col.field;\n                });\n                var columnWidths = columnTitles.map(textWidth);\n\n                // prepare data for a Sheet object's fromJSON method\n                var rows = data.map(function(row, rowIndex){\n                    return {\n                        cells: columns.map(function(col, colIndex){\n                            var value = row[col.field];\n\n                            // NOTE: value might not be string.  I added option useGridFormat (default\n                            // true), which will use a column's format, if present, to convert the value\n                            // to a string, so that we can measure the width right now.\n                            if (options.useGridFormat) {\n                                if (value != null) {\n                                    if (col.format) {\n                                        value = kendo.format(col.format, value);\n                                    } else {\n                                        value += \"\";\n                                    }\n                                }\n                                // adjust the column widths while we're at it\n                                columnWidths[colIndex] = Math.max(\n                                    textWidth(value),\n                                    columnWidths[colIndex]\n                                );\n                            }\n\n                            // if options.useGridFormat is false and col.format is present, pass it over\n                            // to the spreadsheet.  In that case we should calculate the widths after\n                            // the spreadsheet is created (XXX to be implemented when someone needs it).\n                            return mkCell({\n                                value: value,\n                                format: options.useGridFormat ? null : col.format,\n                                background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                            });\n                        })\n                    };\n                });\n\n                // insert header line\n                rows.unshift({\n                    cells: columnTitles.map(function(label){\n                        return mkCell({\n                            value: label,\n                            background: options.headerBackground,\n                            color: options.headerColor\n                        });\n                    })\n                });\n\n                // init a Sheet object.  Note that we have to add one\n                // extra-row and column, because the very last ones can't\n                // have right/bottom borders (known limitation).\n                var sheet = new kendo.spreadsheet.Sheet(\n                    rows.length + 1,        // rows\n                    columns.length + 1,     // columns\n                    options.rowHeight,      // row height\n                    50,                     // column width\n                    20,                     // header height\n                    20,                     // header width,\n                    {                       // default cell style\n                        fontFamily: options.fontFamily,\n                        fontSize: options.fontSize,\n                        verticalAlign: \"center\"\n                    }\n                );\n\n                // load data\n                sheet.fromJSON({\n                    name: \"Sheet1\",\n                    rows: rows,\n                    columns: columnWidths.map(function(w, i){\n                        return { index: i, width: w };\n                    })\n                });\n\n                sheet.draw({\n                    paperSize  : options.paperSize,\n                    landscape  : options.landscape,\n                    margin     : options.margin,\n                    guidelines : false, // using borders instead (better contrast)\n                    scale      : options.scale,\n                    fitWidth   : options.fitWidth,\n                    maxEmpty   : options.maxEmpty,\n                    headerRows : 1\n                }, progress.resolve.bind(progress));\n            });\n\n            return promise;\n        }\n\n        var CACHE_CHAR_WIDTH = {};\n\n        var charWidthFunction = function(fontFamily, fontSize) {\n            var id = fontSize + \":\" + fontFamily;\n            var func = CACHE_CHAR_WIDTH[id];\n            if (!func) {\n                var span, div = document.createElement(\"div\");\n                div.style.position = \"fixed\";\n                div.style.left = \"-10000px\";\n                div.style.top = \"-10000px\";\n                div.style.fontFamily = fontFamily;\n                div.style.fontSize = fontSize + \"px\";\n                div.style.whiteSpace = \"pre\";\n                for (var i = 32; i < 128; ++i) {\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                    div.appendChild(span);\n                }\n                document.body.appendChild(div);\n                var widths = {};\n                for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                    widths[i] = span.offsetWidth;\n                }\n                while ((span = div.firstChild)) {\n                    div.removeChild(span);\n                }\n                func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                    var code = ch.charCodeAt(0);\n                    var width = widths[code];\n                    if (width == null) {\n                        // probably not an ASCII character, let's cache its width as well\n                        span = document.createElement(\"span\");\n                        span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                        div.appendChild(span);\n                        width = widths[code] = span.offsetWidth;\n                        div.removeChild(span);\n                    }\n                    return width;\n                };\n            }\n            return func;\n        };\n\n        spreadsheet.draw = {\n            Borders         : Borders,\n            doLayout        : doLayout,\n            applyIndent     : applyIndent\n        };\n\n        spreadsheet.drawTabularData = drawTabularData;\n\n    var __meta__ = {\n            id: \"spreadsheet\",\n            name: \"Spreadsheet\",\n            category: \"web\",\n            description: \"Spreadsheet component\",\n            depends: [\n                \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n                \"menu\", \"ooxml\", \"popup\", \"sortable\", \"tabstrip\", \"toolbar\", \"treeview\",\n                \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\" ]\n        };\n\n        (function(kendo, undefined$1) {\n            if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n                return;\n            }\n\n            var $ = kendo.jQuery;\n            var keys = $.extend({ F10: 121, F11: 122, B: 66, I: 73, U: 85, N: 78, H: 72, A: 65, PAGEDOWN: 34, PAGEUP: 33, DELETE: 46, R: 82 }, kendo.keys);\n            var Widget = kendo.ui.Widget;\n            var Workbook = kendo.spreadsheet.Workbook;\n            var Controller = kendo.spreadsheet.Controller;\n            var View = kendo.spreadsheet.View;\n            var NS = \".kendoSpreadsheet\";\n\n            var ALL_REASONS = {\n                recalc: true,\n                selection: true,\n                activeCell: true,\n                layout: true,\n                sheetSelection: true,\n                resize: true,\n                editorChange: false,\n                editorClose: false\n            };\n\n            var classNames = {\n                wrapper: \"k-widget k-spreadsheet\"\n            };\n\n            var Spreadsheet = kendo.ui.Widget.extend({\n                init: function(element, options) {\n                    Widget.fn.init.call(this, element, options);\n\n                    this.element.addClass(Spreadsheet.classNames.wrapper);\n                    this.element.attr(\"role\", \"application\");\n\n                    this._view = new View(this.element, {\n                        messages: this.options.messages.view,\n                        toolbar: this.options.toolbar,\n                        sheetsbar: this.options.sheetsbar\n                    });\n\n                    this._workbook = new Workbook(this.options, this._view);\n\n                    this._controller = new Controller(this._view, this._workbook);\n\n                    this._autoRefresh = true;\n\n                    this._bindWorkbookEvents();\n\n                    this._view.workbook(this._workbook);\n\n                    this._view.enableClipboard(false);\n                    this.refresh();\n                    this._view.enableClipboard(true);\n\n                    this._resizeHandler = function() { this.resize(); }.bind(this);\n                    $(window).on(\"resize\" + NS, this._resizeHandler);\n\n                    this.element.on(\"keydown\" + NS, this._keyDown.bind(this));\n                },\n\n                _keyDown: function(e) {\n                    var key = e.keyCode;\n\n                    if (key === keys.F11 && e.shiftKey) {\n                        this._view.sheetsbar._onAddSelect();\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.PAGEDOWN) {\n                        this._view.sheetsbar.trigger(\"select\", {\n                                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                                        isAddButton: false\n                        });\n                    } else if (e.altKey && key === keys.PAGEUP) {\n                        this._view.sheetsbar.trigger(\"select\", {\n                                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                                        isAddButton: false\n                        });\n                    } else if (e.altKey && key === keys.DELETE) {\n                        var closeCallback = function(e) {\n                            var dlg = e.sender;\n\n                            if (dlg.isConfirmed()) {\n                                this._view.sheetsbar.trigger(\"remove\", { name: this.activeSheet()._name(), confirmation: true });\n                            }\n                        }.bind(this);\n\n                        this._view.sheetsbar._openDialog(\"confirmation\", {\n                            close: closeCallback\n                        });\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.R) {\n                        this._view.sheetsbar._createEditor();\n                        e.preventDefault();\n                        return;\n                    } else if (e.ctrlKey && key === keys.B) {\n                        $(\"[data-tool=bold]\")[0].click();\n                    } else if (e.ctrlKey && key === keys.I) {\n                        $(\"[data-tool=italic]\")[0].click();\n                    } else if (e.ctrlKey && key === keys.U) {\n                        $(\"[data-tool=underline]\")[0].click();\n                    } else if (e.altKey && key === keys.H) {\n                        this._view.tabstrip.select(0);\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.N) {\n                        this._view.tabstrip.select(1);\n                        e.preventDefault();\n                        return;\n                    } else if (e.altKey && key === keys.A) {\n                        this._view.tabstrip.select(2);\n                        e.preventDefault();\n                        return;\n                    }\n                },\n\n                _resize: function() {\n                    this.refresh({ layout: true });\n                },\n\n                _workbookChanging: function(e) {\n                    if (this.trigger(\"changing\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookChange: function(e) {\n                    if (this._autoRefresh) {\n                        this.refresh(e);\n                    }\n\n                    if (e.recalc && e.ref) {\n                        var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                        this.trigger(\"change\", { range: range });\n                    }\n                },\n\n                _workbookCut: function(e) {\n                    this.trigger(\"cut\", e);\n                },\n\n                _workbookCopy: function(e) {\n                    this.trigger(\"copy\", e);\n                },\n\n                _workbookPaste: function(e) {\n                    this.trigger(\"paste\", e);\n                },\n\n                activeSheet: function(sheet) {\n                    return this._workbook.activeSheet(sheet);\n                },\n\n                moveSheetToIndex: function(sheet, index) {\n                    return this._workbook.moveSheetToIndex(sheet, index);\n                },\n\n                insertSheet: function(options) {\n                    return this._workbook.insertSheet(options);\n                },\n\n                sheets: function() {\n                    return this._workbook.sheets();\n                },\n\n                removeSheet: function(sheet) {\n                    return this._workbook.removeSheet(sheet);\n                },\n\n                sheetByName: function(sheetName) {\n                    return this._workbook.sheetByName(sheetName);\n                },\n\n                sheetIndex: function(sheet) {\n                    return this._workbook.sheetIndex(sheet);\n                },\n\n                sheetByIndex: function(index) {\n                    return this._workbook.sheetByIndex(index);\n                },\n\n                renameSheet: function(sheet, newSheetName) {\n                    return this._workbook.renameSheet(sheet, newSheetName);\n                },\n\n                refresh: function(reason) {\n                    if (!reason) {\n                        reason = ALL_REASONS;\n                    }\n\n                    if (!reason.editorClose) {\n                        this._view.sheet(this._workbook.activeSheet());\n                        this._controller.sheet(this._workbook.activeSheet());\n\n                        this._workbook.refresh(reason);\n                    }\n\n                    if (!reason.editorChange) {\n                        this._view.refresh(reason);\n                        this._controller.refresh();\n\n                        this._view.render(reason);\n                        this.trigger(\"render\");\n                    }\n\n                    return this;\n                },\n\n                openDialog: function(name, options) {\n                    return this._view.openDialog(name, options);\n                },\n\n                autoRefresh: function(value) {\n                    if (value !== undefined$1) {\n                        this._autoRefresh = value;\n\n                        if (value === true) {\n                            this.refresh();\n                        }\n\n                        return this;\n                    }\n\n                    return this._autoRefresh;\n                },\n\n                toJSON: function() {\n                    return this._workbook.toJSON();\n                },\n\n                fromJSON: function(json) {\n                    if (json.sheets) {\n                        this._workbook.destroy();\n\n                        this._workbook = new Workbook($.extend({}, this.options, json));\n\n                        this._bindWorkbookEvents();\n\n                        this._view.workbook(this._workbook);\n                        this._controller.workbook(this._workbook);\n\n                        this.activeSheet(this.activeSheet());\n                    } else {\n                        this.refresh();\n                    }\n                },\n\n                saveJSON: function() {\n                    return this._workbook.saveJSON();\n                },\n\n                fromFile: function(blob, name) {\n                    return this._workbook.fromFile(blob, name);\n                },\n\n                saveAsPDF: function(options) {\n                    this._workbook.saveAsPDF(\n                        $.extend({}, this.options.pdf, options, { workbook: this._workbook })\n                    );\n                },\n\n                saveAsExcel: function(options) {\n                    this._workbook.saveAsExcel(options);\n                },\n\n                draw: function(options, callback) {\n                    this._workbook.draw(options, callback);\n                },\n\n                _workbookExcelExport: function(e) {\n                    if (this.trigger(\"excelExport\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookExcelImport: function(e) {\n                    if (this.trigger(\"excelImport\", e)) {\n                        e.preventDefault();\n                    } else {\n                        this._initProgress(e.promise);\n                    }\n                },\n\n                _initProgress: function(deferred) {\n                    var loading =\n                        $(\"<div class='k-loading-mask' \" +\n                               \"style='width: 100%; height: 100%; top: 0;'>\" +\n                            \"<div class='k-loading-color'></div>\" +\n                        \"</div>\")\n                        .appendTo(this.element);\n\n                    var pb = $(\"<div class='k-loading-progress'>\")\n                    .appendTo(loading)\n                    .kendoProgressBar({\n                        type: \"chunk\", chunkCount: 10,\n                        min: 0, max: 1, value: 0\n                    }).data(\"kendoProgressBar\");\n\n                    deferred.progress(function(e) {\n                        pb.value(e.progress);\n                    })\n                    .always(function() {\n                        kendo.destroy(loading);\n                        loading.remove();\n                    });\n                },\n\n                _workbookPdfExport: function(e) {\n                    if (this.trigger(\"pdfExport\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertSheet: function(e) {\n                    if (this.trigger(\"insertSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookRemoveSheet: function(e) {\n                    if (this.trigger(\"removeSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookSelectSheet: function(e) {\n                    if (this.trigger(\"selectSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookRenameSheet: function(e) {\n                    if (this.trigger(\"renameSheet\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertRow: function(e) {\n                    if (this.trigger(\"insertRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookInsertColumn: function(e) {\n                    if (this.trigger(\"insertColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDeleteRow: function(e) {\n                    if (this.trigger(\"deleteRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDeleteColumn: function(e) {\n                    if (this.trigger(\"deleteColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookHideRow: function(e) {\n                    if (this.trigger(\"hideRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookHideColumn: function(e) {\n                    if (this.trigger(\"hideColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookUnhideRow: function(e) {\n                    if (this.trigger(\"unhideRow\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookUnhideColumn: function(e) {\n                    if (this.trigger(\"unhideColumn\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookSelect: function(e) {\n                    this.trigger(\"select\", e);\n                },\n\n                _workbookChangeFormat: function(e) {\n                   this.trigger(\"changeFormat\", e);\n                },\n\n                _workbookDataBinding: function(e) {\n                    if (this.trigger(\"dataBinding\", e)) {\n                        e.preventDefault();\n                    }\n                },\n\n                _workbookDataBound: function(e) {\n                    this.trigger(\"dataBound\", e);\n                },\n\n                _workbookProgress: function(e) {\n                    kendo.ui.progress(this.element, e.toggle);\n                },\n\n                _bindWorkbookEvents: function() {\n                    this._workbook.bind(\"cut\", this._workbookCut.bind(this));\n                    this._workbook.bind(\"copy\", this._workbookCopy.bind(this));\n                    this._workbook.bind(\"paste\", this._workbookPaste.bind(this));\n                    this._workbook.bind(\"changing\", this._workbookChanging.bind(this));\n                    this._workbook.bind(\"change\", this._workbookChange.bind(this));\n                    this._workbook.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n                    this._workbook.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n                    this._workbook.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n                    this._workbook.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n                    this._workbook.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n                    this._workbook.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n                    this._workbook.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n                    this._workbook.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n                    this._workbook.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n                    this._workbook.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n                    this._workbook.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n                    this._workbook.bind(\"hideRow\", this._workbookHideRow.bind(this));\n                    this._workbook.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n                    this._workbook.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n                    this._workbook.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n                    this._workbook.bind(\"select\", this._workbookSelect.bind(this));\n                    this._workbook.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n                    this._workbook.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n                    this._workbook.bind(\"dataBound\", this._workbookDataBound.bind(this));\n                    this._workbook.bind(\"progress\", this._workbookProgress.bind(this));\n                },\n\n                destroy: function() {\n                    kendo.ui.Widget.fn.destroy.call(this);\n\n                    this._workbook.destroy();\n                    this._controller.destroy();\n                    this._view.destroy();\n\n                    if (this._resizeHandler) {\n                        $(window).off(\"resize\" + NS, this._resizeHandler);\n                    }\n                },\n\n                options: {\n                    name: \"Spreadsheet\",\n                    toolbar: true,\n                    sheetsbar: true,\n                    rows: 200,\n                    columns: 50,\n                    rowHeight: 20,\n                    columnWidth: 64,\n                    headerHeight: 20,\n                    headerWidth: 32,\n                    excel: {\n                        proxyURL: \"\",\n                        fileName: \"Workbook.xlsx\"\n                    },\n                    messages: {},\n                    pdf: {\n                        // which part of the workbook to be exported\n                        area: \"workbook\",\n                        fileName: \"Workbook.pdf\",\n                        proxyURL: \"\",\n                        // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                        // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                        // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                        // by content.\n                        paperSize: \"a4\",\n                        // True to reverse the paper dimensions if needed such that width is the larger edge.\n                        landscape: true,\n                        // An object containing { left, top, bottom, right } margins with units.\n                        margin: null,\n                        // Optional information for the PDF Info dictionary; all strings except for the date.\n                        title: null,\n                        author: null,\n                        subject: null,\n                        keywords: null,\n                        creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                        // Creation Date; defaults to new Date()\n                        date: null\n                    },\n                    defaultCellStyle: {\n                        fontFamily: \"Arial\",\n                        fontSize: 12\n                    },\n                    useCultureDecimals: false\n                },\n\n                defineName: function(name, value, hidden) {\n                    return this._workbook.defineName(name, value, hidden);\n                },\n\n                undefineName: function(name) {\n                    return this._workbook.undefineName(name);\n                },\n\n                nameValue: function(name) {\n                    return this._workbook.nameValue(name);\n                },\n\n                forEachName: function(func) {\n                    return this._workbook.forEachName(func);\n                },\n\n                cellContextMenu: function() {\n                    return this._view.cellContextMenu;\n                },\n\n                rowHeaderContextMenu: function() {\n                    return this._view.rowHeaderContextMenu;\n                },\n\n                colHeaderContextMenu: function() {\n                    return this._view.colHeaderContextMenu;\n                },\n\n                addImage: function(image) {\n                    return this._workbook.addImage(image);\n                },\n\n                cleanupImages: function() {\n                    return this._workbook.cleanupImages();\n                },\n\n                events: [\n                    \"cut\",\n                    \"copy\",\n                    \"paste\",\n                    \"pdfExport\",\n                    \"excelExport\",\n                    \"excelImport\",\n                    \"changing\",\n                    \"change\",\n                    \"render\",\n                    \"removeSheet\",\n                    \"selectSheet\",\n                    \"renameSheet\",\n                    \"insertRow\",\n                    \"insertColumn\",\n                    \"deleteRow\",\n                    \"insertSheet\",\n                    \"deleteColumn\",\n                    \"hideRow\",\n                    \"hideColumn\",\n                    \"unhideRow\",\n                    \"unhideColumn\",\n                    \"select\",\n                    \"changeFormat\",\n                    \"dataBinding\",\n                    \"dataBound\"\n                ]\n            });\n\n            kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n            kendo.ui.plugin(Spreadsheet);\n            $.extend(true, Spreadsheet, { classNames: classNames });\n        })(window.kendo);\n\n}));\n"]}