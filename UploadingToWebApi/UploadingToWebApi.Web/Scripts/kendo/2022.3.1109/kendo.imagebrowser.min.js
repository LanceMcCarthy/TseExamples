/**
 * Kendo UI v2022.3.1109 (http://www.telerik.com/kendo-ui)
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e){"function"==typeof define&&define.amd?define(["kendo.filebrowser.min"],e):e()}((function(){!function(e,t){var i=window.kendo,a=i.ui.FileBrowser,n=e.isPlainObject,s=e.extend,o=i.isFunction,r=/(^\/|\/$)/g,l="error",d=".kendoImageBrowser",p="name",c="size",f="type",u={field:f,dir:"asc"},m=i.template('<div class="k-listview-item k-listview-item-empty"><span class="k-file-preview"><span class="k-file-icon k-icon k-i-none"></span></span><span class="k-file-name">${text}</span></div>');function h(e){if(!e)return"";var t=" bytes";return e>=1073741824?(t=" GB",e/=1073741824):e>=1048576?(t=" MB",e/=1048576):e>=1024&&(t=" KB",e/=1024),Math.round(100*e)/100+t}s(!0,i.data,{schemas:{imagebrowser:{data:function(e){return e.items||e||[]},model:{id:"name",fields:{name:"name",size:"size",type:"type"}}}}}),s(!0,i.data,{transports:{imagebrowser:i.data.RemoteTransport.extend({init:function(t){i.data.RemoteTransport.fn.init.call(this,e.extend(!0,{},this.options,t))},_call:function(t,a){a.data=e.extend({},a.data,{path:this.options.path()}),o(this.options[t])?this.options[t].call(this,a):i.data.RemoteTransport.fn[t].call(this,a)},read:function(e){this._call("read",e)},create:function(e){this._call("create",e)},destroy:function(e){this._call("destroy",e)},update:function(){},options:{read:{type:"POST"},update:{type:"POST"},create:{type:"POST"},destroy:{type:"POST"}}})}});var g=a.extend({init:function(e,t){t=t||{},a.fn.init.call(this,e,t),this.element.addClass("k-imagebrowser")},options:{name:"ImageBrowser",fileTypes:"*.png,*.gif,*.jpg,*.jpeg"},value:function(){var e,a=this,n=a._selectedItem(),s=a.options.transport.imageUrl;if(n&&"f"===n.get(f))return e=function(e,i){return e!==t&&e.match(/\/$/)||(e=(e||"")+"/"),e+i}(a.path(),n.get(p)).replace(r,""),s&&(e=o(s)?s(e):i.format(s,encodeURIComponent(e))),e},_fileUpload:function(e){var a,n=this,s=n.options,o=s.fileTypes,r=new RegExp(("("+o.split(",").join(")|(")+")").replace(/\*\./g,".*."),"i"),l=e.files[0].name,d=e.files[0].size,f=p,u=c;r.test(l)?(e.data={path:n.path()},(a=n._createFile(l,d))?(a._uploading=!0,n.upload.one("error",(function(){a=t})),n.upload.one("success",(function(e){if(a){delete a._uploading;var t=n._insertFileToList(a);t.set(f,e.response[n._getFieldName(f)]),t.set(u,e.response[n._getFieldName(u)]),n._tiles=n.listView.items().filter("["+i.attr("type")+"=f]"),n._scroll()}}))):e.preventDefault()):(e.preventDefault(),n._showMessage(i.format(s.messages.invalidFileType,l,o)))},_content:function(){var t=this;t.list=e('<div class="k-filemanager-listview" />').appendTo(t.element).on("dblclick"+d,".k-listview-item",t._dblClick.bind(t)),t.listView=new i.ui.ListView(t.list,{layout:"flex",flex:{direction:"row",wrap:"wrap"},dataSource:t.dataSource,template:t._itemTmpl(),editTemplate:t._editTmpl(),selectable:!0,autoBind:!1,dataBinding:function(e){t.toolbar.find(".k-i-close").parent().addClass("k-disabled"),"remove"!==e.action&&"sync"!==e.action||(e.preventDefault(),i.ui.progress(t.listView.content,!1))},dataBound:function(){t.dataSource.view().length?(t._tiles=this.items().filter("["+i.attr("type")+"=f]"),t._scroll()):this.content.append(m({text:t.options.messages.emptyFolder}))},change:t._listViewChange.bind(t)}),t.listView.content.on("scroll"+d,t._scroll.bind(t))},_dataSource:function(){var e=this,t=e.options,a=t.transport,o=s({},u),r={field:p,dir:"asc"},d={type:a.type||"imagebrowser",sort:[o,r]};n(a)&&(a.path=e.path.bind(e),d.transport=a),n(t.schema)?d.schema=t.schema:a.type&&n(i.data.schemas[a.type])&&i.data.schemas[a.type],e.dataSource&&e._errorHandler?e.dataSource.unbind(l,e._errorHandler):e._errorHandler=e._error.bind(e),e.dataSource=i.data.DataSource.create(d).bind(l,e._errorHandler)},_loadImage:function(t){var a=this,n=e(t),s=a.dataSource.getByUid(n.attr(i.attr("uid"))),r=s.get(p),l=a.options.transport.thumbnailUrl,c=e("<img />",{alt:r}),f="?";s._uploading||(c.hide().on("load"+d,(function(){e(this).prev().remove().end().addClass("k-image k-file-image").fadeIn()})),n.find(".k-i-loading").after(c),o(l)?l=l(a.path(),encodeURIComponent(r)):(l.indexOf("?")>=0&&(f="&"),l=l+f+"path="+encodeURIComponent(a.path()+r),s._override&&(l+="&_="+(new Date).getTime(),delete s._override)),c.attr("src",l),t.loaded=!0)},_scroll:function(){var t=this;t.options.transport&&t.options.transport.thumbnailUrl&&(clearTimeout(t._timeout),t._timeout=setTimeout((function(){var a=i._outerHeight(t.listView.content),n=t.listView.content.scrollTop(),s=n+a;t._tiles.each((function(){var i,a=(i=this).offsetTop-e(i).height(),o=a+this.offsetHeight;if((a>=n&&a<s||o>=n&&o<s)&&t._loadImage(this),a>s)return!1})),t._tiles=t._tiles.filter((function(){return!this.loaded}))}),250))},_itemTmpl:function(){var e='<div class="k-listview-item" '+i.attr("uid")+'="#=uid#" ';return e+=i.attr("type")+'="${'+'type}">',e+='#if(type == "d") { #',e+='<div class="k-file-preview"><span class="k-file-icon k-icon k-i-folder"></span></div>',e+="#}else{#",this.options.transport&&this.options.transport.thumbnailUrl?e+='<div class="k-file-preview"><span class="k-file-icon k-icon k-i-loading"></span></div>':e+='<div class="k-file-preview"><span class="k-file-icon k-icon k-i-file"></span></div>',e+="#}#",e+='<span class="k-file-name">${name}</span>',e+='#if(type == "f") { # <span class="k-file-size">${this.sizeFormatter(size)}</span> #}#',e+="</div>",i.template(e).bind({sizeFormatter:h})}});i.ui.plugin(g)}(window.kendo.jQuery)}));
//# sourceMappingURL=kendo.imagebrowser.min.js.map
