/**
 * Kendo UI v2022.3.1109 (http://www.telerik.com/kendo-ui)
 * Copyright 2022 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(t){"function"==typeof define&&define.amd?define(["kendo.core.min","kendo.draganddrop.min"],t):t()}((function(){var t,e,r,a,n,i,o,d,s,l,g,c,u,p,f;t=window.kendo.jQuery,e=window.kendo,r=e.ui.Widget,a=e._outerWidth,n=e.attr,i=t.extend,o=t.each,d=!1,s="asc",l="group-sort",g=".kendoGroupable",c=e.template('<div class="k-group-indicator" data-#=data.ns#field="${data.field}" ${data.id ? ("data-" + data.ns + "id="+data.id) : ""} data-#=data.ns#title="${data.title || ""}" data-#=data.ns#dir="${data.dir || "asc"}"><a role="button" title="(sorted ${(data.dir || "asc") == "asc" ? "ascending": "descending"})" href="\\#" class="k-link"><span class="k-icon k-i-sort-${(data.dir || "asc") == "asc" ? "asc-sm" : "desc-sm"}" title="(sorted ${(data.dir || "asc") == "asc" ? "ascending": "descending"})"></span>${data.title ? data.title: data.field}</a><a href="\\#" role="button" data-role="button" aria-label="Remove grouping by ${data.title || data.field} field" class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button"><span class="k-button-icon k-icon k-i-close"></span></a></div>',{useWithBlock:!1}),u=function(r){var a=r.attr(e.attr("title"));return a&&(a=e.htmlEncode(a)),t('<div class="k-group-clue k-drag-clue" />').html(a||r.attr(e.attr("field"))).prepend('<span class="k-icon k-drag-status k-i-cancel"></span>')},p=t('<div class="k-grouping-dropclue"/>'),f=r.extend({init:function(o,c){var f,h,m=this,v=e.guid(),b=m._intializePositions.bind(m),k=m._dropCuePositions=[];r.fn.init.call(m,o,c),d=e.support.isRtl(o),h=d?"right":"left",m.draggable=f=m.options.draggable||new e.ui.Draggable(m.element,{filter:m.options.draggableElements,hint:u,group:v}),m.groupContainer=t(m.options.groupContainer,m.element).kendoDropTarget({group:f.options.group,dragenter:function(t){m._canDrag(t.draggable.currentTarget)&&(t.draggable.hint.find(".k-drag-status").removeClass("k-i-cancel").addClass("k-i-plus"),p.css(h,0).appendTo(m.groupContainer))},dragleave:function(t){t.draggable.hint.find(".k-drag-status").removeClass("k-i-plus").addClass("k-i-cancel"),p.remove()},drop:function(r){var a,n=r.draggable.currentTarget,o=n.attr(e.attr("field")),s=n.attr(e.attr("title")),g=n.attr("id"),c=m.indicator(o),u=m._dropCuePositions,f=u[u.length-1],h=i({},m.options.sort,n.data(l)),v=h.dir;(n.hasClass("k-group-indicator")||m._canDrag(n))&&(f?(a=m._dropCuePosition(e.getOffset(p).left+parseInt(f.element.css("marginLeft"),10)*(d?-1:1)+parseInt(f.element.css("marginRight"),10)))&&m._canDrop(t(c),a.element,a.left)&&(a.before?a.element.before(c||m.buildIndicator(o,s,v,g)):a.element.after(c||m.buildIndicator(o,s,v,g)),m._setIndicatorSortOptions(o,h),m._change()):(m.groupContainer.empty(),m.groupContainer.append(m.buildIndicator(o,s,v,g)),m._setIndicatorSortOptions(o,h),m._change()))}}).kendoDraggable({filter:"div.k-group-indicator",hint:u,group:f.options.group,dragcancel:m._dragCancel.bind(m),dragstart:function(t){var e=t.currentTarget,r=parseInt(e.css("marginLeft"),10),n=e.position(),i=d?n.left-r:n.left+a(e);b(),p.css("left",i).appendTo(m.groupContainer),this.hint.find(".k-drag-status").removeClass("k-i-cancel").addClass("k-i-plus")},dragend:function(){m._dragEnd(this)},drag:m._drag.bind(m)}).on("click"+g,".k-button",(function(e){e.preventDefault(),m._removeIndicator(t(this).parent())})).on("click"+g,".k-link",(function(e){var r=t(this).parent(),a=r.attr(n("dir"))===s?"desc":s;r.attr(n("dir"),a),m._change(),e.preventDefault()})),f.bind(["dragend","dragcancel","dragstart","drag"],{dragend:function(){m._dragEnd(this)},dragcancel:m._dragCancel.bind(m),dragstart:function(t){var e;m.options.allowDrag||m._canDrag(t.currentTarget)?(b(),k.length&&(e=k[k.length-1].element,parseInt(e.css("marginRight"),10),e.position().left,a(e))):t.preventDefault()},drag:m._drag.bind(m)}),m.dataSource=m.options.dataSource,m.dataSource&&m._refreshHandler?m.dataSource.unbind("change",m._refreshHandler):m._refreshHandler=m.refresh.bind(m),m.dataSource&&(m.dataSource.bind("change",m._refreshHandler),m.refresh())},refresh:function(){var e,r=this,a=r.dataSource.group()||[],d=n("field"),s=n("title");r.groupContainer&&(r.groupContainer.empty(),o(a,(function(a,n){var o=n.field,l=n.dir,g=r.element.find(r.options.filter).filter((function(){return t(this).attr(d)===o}));e=r.buildIndicator(o,g.attr(s),l,g.attr("id")),r.groupContainer.append(e),r._setIndicatorSortOptions(o,i({},r.options.sort,{dir:l,compare:n.compare}))}))),r._invalidateGroupContainer()},destroy:function(){var t=this;r.fn.destroy.call(t),t.groupContainer.off(g),t.groupContainer.data("kendoDropTarget")&&t.groupContainer.data("kendoDropTarget").destroy(),t.groupContainer.data("kendoDraggable")&&t.groupContainer.data("kendoDraggable").destroy(),t.options.draggable||t.draggable.destroy(),t.dataSource&&t._refreshHandler&&(t.dataSource.unbind("change",t._refreshHandler),t._refreshHandler=null),t.groupContainer=t.element=t.draggable=null},events:["change","removeGroup"],options:{name:"Groupable",filter:"th",draggableElements:"th",messages:{empty:"Drag a column header and drop it here to group by that column"},sort:{dir:s,compare:null}},indicator:function(r){var a=t(".k-group-indicator",this.groupContainer);return t.grep(a,(function(a){return t(a).attr(e.attr("field"))===r}))[0]},buildIndicator:function(t,r,a,n){return c({ns:e.ns,field:t.replace(/"/g,"'"),title:r,id:n,dir:a||(this.options.sort||{}).dir||s})},_setIndicatorSortOptions:function(e,r){t(this.indicator(e)).data(l,r)},aggregates:function(){var r,a,n;return this.element.find(this.options.filter).map((function(){var i=t(this),o=i.attr(e.attr("aggregates")),d=i.attr(e.attr("field"));if(o&&""!==o)for(r=o.split(","),o=[],a=0,n=r.length;a<n;a++)o.push({field:d,aggregate:r[a]});return o})).toArray()},descriptors:function(){var r,a=this,n=t(".k-group-indicator",a.groupContainer),i=a.aggregates();return t.map(n,(function(n){n=t(n),r=n.attr(e.attr("field"));var o=a.options.sort||{},d=n.data(l)||{};return{field:r,dir:n.attr(e.attr("dir")),aggregates:i||[],colID:n.attr(e.attr("id")),compare:d.compare||o.compare}}))},_removeIndicator:function(t){var r=this;r.trigger("removeGroup",{field:t.attr(e.attr("field")),colID:t.attr(e.attr("id"))}),t.off(),t.removeData(),t.remove(),r._invalidateGroupContainer(),r._change()},_change:function(){var t=this;if(t.dataSource){var e=t.descriptors();if(t.trigger("change",{groups:e}))return void t.refresh();t.dataSource.group(e)}},_dropCuePosition:function(e){var r=this._dropCuePositions;if(p.is(":visible")&&0!==r.length){e=Math.ceil(e);var n=r[r.length-1],i=n.left,o=n.right,s=parseInt(n.element.css("marginLeft"),10),l=parseInt(n.element.css("marginRight"),10);return e>=o&&!d||e<i&&d?e={left:n.element.position().left+(d?-s:a(n.element)+l),element:n.element,before:!1}:(e=t.grep(r,(function(t){return t.left<=e&&e<=t.right||d&&e>t.right}))[0])&&(e={left:d?e.element.position().left+a(e.element)+l:e.element.position().left-s,element:e.element,before:!0}),e}},_drag:function(t){var e=this._dropCuePosition(t.x.location);e&&p.css({left:e.left,right:"auto"})},_canDrag:function(t){var r=t.attr(e.attr("field"));return"false"!=t.attr(e.attr("groupable"))&&r&&(t.hasClass("k-group-indicator")||!this.indicator(r))},_canDrop:function(t,e,r){var a=t.next();return t[0]!==e[0]&&(!a[0]||e[0]!==a[0]||!d&&r>a.position().left||d&&r<a.position().left)},_dragEnd:function(r){var a=this,n=r.currentTarget.attr(e.attr("field")),i=a.indicator(n);r!==a.options.draggable&&!r.dropped&&i&&a._removeIndicator(t(i)),a._dragCancel()},_dragCancel:function(){p.remove(),this._dropCuePositions=[]},_intializePositions:function(){var r,n=t(".k-group-indicator",this.groupContainer);this._dropCuePositions=t.map(n,(function(n){return n=t(n),r=e.getOffset(n).left,{left:parseInt(r,10),right:parseInt(r+a(n),10),element:n}}))},_invalidateGroupContainer:function(){var t=this.groupContainer;t&&t.is(":empty")&&t.html(this.options.messages.empty)}}),e.ui.plugin(f)}));
//# sourceMappingURL=kendo.groupable.min.js.map
